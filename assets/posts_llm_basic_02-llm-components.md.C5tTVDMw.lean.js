import{_ as s,c as a,o as l,ah as e,j as Q,a as T}from"./chunks/framework.CvbyeFFO.js";const o4=JSON.parse('{"title":"语言模型重要组件","description":"","frontmatter":{"title":"语言模型重要组件","date":"2025-07-03T16:48:14.000Z","create":"2025-07-03T16:48:14.000Z","categories":["llm"],"tags":["Attention","MHA","MQA","GQA","Flash Attention","Batch Norm","Layer Norm","RMS Norm","RoPE","GeLU","TopK","TopP","Temperature"]},"headers":[],"relativePath":"posts/llm/basic/02-llm-components.md","filePath":"posts/llm/basic/02-llm-components.md","lastUpdated":1753200077000}'),o={name:"posts/llm/basic/02-llm-components.md"},n={class:"custom-block important"},m={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},r={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"16.395ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 7246.4 1000","aria-hidden":"true"},d={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},i={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"9.589ex",height:"1.439ex",role:"img",focusable:"false",viewBox:"0 -442 4238.3 636","aria-hidden":"true"},h={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},p={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.308ex"},xmlns:"http://www.w3.org/2000/svg",width:"39.658ex",height:"5.741ex",role:"img",focusable:"false",viewBox:"0 -1517.7 17528.7 2537.7","aria-hidden":"true"},g={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},H={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.372ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.128ex",height:"2.398ex",role:"img",focusable:"false",viewBox:"0 -895.6 1824.4 1060","aria-hidden":"true"},u={class:"custom-block danger"},w={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},x={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.435ex",height:"2.032ex",role:"img",focusable:"false",viewBox:"0 -704 2402.4 898","aria-hidden":"true"},c={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},L={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.186ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.023ex",height:"1.505ex",role:"img",focusable:"false",viewBox:"0 -583 1778 665","aria-hidden":"true"},f={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},M={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.023ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.176ex",height:"1.593ex",role:"img",focusable:"false",viewBox:"0 -694 520 704","aria-hidden":"true"},k={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},y={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.023ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.804ex",height:"1.74ex",role:"img",focusable:"false",viewBox:"0 -759 797.5 769","aria-hidden":"true"},V={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Z={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"36.517ex",height:"2.731ex",role:"img",focusable:"false",viewBox:"0 -957 16140.7 1207","aria-hidden":"true"},b={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},v={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.225ex",height:"2.009ex",role:"img",focusable:"false",viewBox:"0 -694 1425.7 888","aria-hidden":"true"},D={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},_={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.854ex",height:"2.009ex",role:"img",focusable:"false",viewBox:"0 -694 1703.4 888","aria-hidden":"true"},A={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},j={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.023ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.176ex",height:"1.593ex",role:"img",focusable:"false",viewBox:"0 -694 520 704","aria-hidden":"true"},C={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},S={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"26.44ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 11686.7 1000","aria-hidden":"true"},E={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},P={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"47.997ex",height:"2.565ex",role:"img",focusable:"false",viewBox:"0 -883.9 21214.8 1133.9","aria-hidden":"true"},R={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},B={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.372ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.128ex",height:"2.398ex",role:"img",focusable:"false",viewBox:"0 -895.6 1824.4 1060","aria-hidden":"true"},N={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},I={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.801ex",height:"2.032ex",role:"img",focusable:"false",viewBox:"0 -704 1680 898","aria-hidden":"true"},O={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},z={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.811ex",height:"1.956ex",role:"img",focusable:"false",viewBox:"0 -853.7 1242.7 864.7","aria-hidden":"true"},q={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},G={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"12.615ex",height:"2.938ex",role:"img",focusable:"false",viewBox:"0 -1048.5 5575.6 1298.5","aria-hidden":"true"},J={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},F={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.372ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.128ex",height:"2.398ex",role:"img",focusable:"false",viewBox:"0 -895.6 1824.4 1060","aria-hidden":"true"},X={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},K={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.593ex",height:"2.451ex",role:"img",focusable:"false",viewBox:"0 -833.2 3355.9 1083.2","aria-hidden":"true"},W={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},U={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.854ex",height:"2.009ex",role:"img",focusable:"false",viewBox:"0 -694 1703.4 888","aria-hidden":"true"},$={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Y={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.205ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.106ex",height:"2.398ex",role:"img",focusable:"false",viewBox:"0 -969.5 1373 1060","aria-hidden":"true"},Q1={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},t1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.669ex"},xmlns:"http://www.w3.org/2000/svg",width:"56.983ex",height:"5.768ex",role:"img",focusable:"false",viewBox:"0 -1370 25186.3 2549.5","aria-hidden":"true"},T1={class:"custom-block important"},a1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},l1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.68ex",height:"1.553ex",role:"img",focusable:"false",viewBox:"0 -675.5 1184.7 686.5","aria-hidden":"true"},e1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},s1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"9.251ex",height:"2.046ex",role:"img",focusable:"false",viewBox:"0 -893.3 4088.7 904.3","aria-hidden":"true"},o1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},n1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"9.251ex",height:"2.046ex",role:"img",focusable:"false",viewBox:"0 -893.3 4088.7 904.3","aria-hidden":"true"},m1={class:"custom-block important"},r1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},d1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"3.119ex",height:"1.887ex",role:"img",focusable:"false",viewBox:"0 -833.9 1378.8 833.9","aria-hidden":"true"},i1={class:"custom-block tip"},h1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},p1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.489ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.229ex",height:"1.486ex",role:"img",focusable:"false",viewBox:"0 -441 543 657","aria-hidden":"true"},g1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},H1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.281ex",height:"2.034ex",role:"img",focusable:"false",viewBox:"0 -705 566 899","aria-hidden":"true"},u1={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},w1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.76ex"},xmlns:"http://www.w3.org/2000/svg",width:"33.907ex",height:"6.063ex",role:"img",focusable:"false",viewBox:"0 -1460 14987.1 2680","aria-hidden":"true"},x1={class:"custom-block tip"},c1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},L1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.448ex",height:"1.025ex",role:"img",focusable:"false",viewBox:"0 -442 640 453","aria-hidden":"true"},f1={class:"custom-block important"},M1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},k1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.883ex"},xmlns:"http://www.w3.org/2000/svg",width:"21.521ex",height:"6.923ex",role:"img",focusable:"false",viewBox:"0 -1785.8 9512.3 3060","aria-hidden":"true"},y1={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},V1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-6.833ex"},xmlns:"http://www.w3.org/2000/svg",width:"42.382ex",height:"9.362ex",role:"img",focusable:"false",viewBox:"0 -1118 18732.6 4138","aria-hidden":"true"},Z1={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},b1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-3.252ex"},xmlns:"http://www.w3.org/2000/svg",width:"22.492ex",height:"8.281ex",role:"img",focusable:"false",viewBox:"0 -2222.7 9941.4 3660","aria-hidden":"true"},v1={class:"custom-block important"},D1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},_1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.315ex",height:"1.357ex",role:"img",focusable:"false",viewBox:"0 -442 1023.4 599.8","aria-hidden":"true"},A1={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},j1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.452ex"},xmlns:"http://www.w3.org/2000/svg",width:"46.345ex",height:"2.149ex",role:"img",focusable:"false",viewBox:"0 -750 20484.3 950","aria-hidden":"true"},C1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},S1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.671ex",height:"1.595ex",role:"img",focusable:"false",viewBox:"0 -694 2064.4 705","aria-hidden":"true"},E1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},P1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.159ex",height:"1.439ex",role:"img",focusable:"false",viewBox:"0 -442 954.4 636","aria-hidden":"true"},R1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},B1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.912ex",height:"1.532ex",role:"img",focusable:"false",viewBox:"0 -666 845 677","aria-hidden":"true"},N1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},I1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.186ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.809ex",height:"1.692ex",role:"img",focusable:"false",viewBox:"0 -666 2567.4 748","aria-hidden":"true"},O1={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},z1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-3.039ex"},xmlns:"http://www.w3.org/2000/svg",width:"22.676ex",height:"7.209ex",role:"img",focusable:"false",viewBox:"0 -1843.2 10022.9 3186.4","aria-hidden":"true"},q1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},G1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"12.385ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 5474 1000","aria-hidden":"true"},J1={class:"custom-block important"},F1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},X1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"0.781ex",height:"1.52ex",role:"img",focusable:"false",viewBox:"0 -661 345 672","aria-hidden":"true"},K1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},W1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.462ex"},xmlns:"http://www.w3.org/2000/svg",width:"0.932ex",height:"1.957ex",role:"img",focusable:"false",viewBox:"0 -661 412 865","aria-hidden":"true"},U1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},$1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.452ex"},xmlns:"http://www.w3.org/2000/svg",width:"11.242ex",height:"2.149ex",role:"img",focusable:"false",viewBox:"0 -750 4969 950","aria-hidden":"true"},Y1={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},Q2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-8.342ex"},xmlns:"http://www.w3.org/2000/svg",width:"30.689ex",height:"17.816ex",role:"img",focusable:"false",viewBox:"0 -4187.3 13564.6 7874.7","aria-hidden":"true"},t2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},T2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.97ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.242ex",height:"2.874ex",role:"img",focusable:"false",viewBox:"0 -841.7 1874.8 1270.4","aria-hidden":"true"},a2={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},l2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-9.671ex"},xmlns:"http://www.w3.org/2000/svg",width:"64.729ex",height:"20.472ex",role:"img",focusable:"false",viewBox:"0 -4774.4 28610.2 9048.7","aria-hidden":"true"},e2={class:"custom-block tip"},s2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},o2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.666ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.985ex",height:"1.666ex",role:"img",focusable:"false",viewBox:"0 -442 877.3 736.2","aria-hidden":"true"},n2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},m2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.666ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.561ex",height:"2.211ex",role:"img",focusable:"false",viewBox:"0 -683 1573.9 977.2","aria-hidden":"true"},r2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},d2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.666ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.561ex",height:"2.211ex",role:"img",focusable:"false",viewBox:"0 -683 1573.9 977.2","aria-hidden":"true"},i2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},h2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.462ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.478ex",height:"1.957ex",role:"img",focusable:"false",viewBox:"0 -661 1979.4 865","aria-hidden":"true"},p2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},g2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.308ex",height:"1.457ex",role:"img",focusable:"false",viewBox:"0 -450 2788.1 644","aria-hidden":"true"},H2={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},u2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.788ex"},xmlns:"http://www.w3.org/2000/svg",width:"30.945ex",height:"6.708ex",role:"img",focusable:"false",viewBox:"0 -1732.4 13677.8 2964.8","aria-hidden":"true"},w2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},x2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-1.018ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.912ex",height:"2.919ex",role:"img",focusable:"false",viewBox:"0 -840.3 2171.3 1290.2","aria-hidden":"true"},c2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},L2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.666ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.985ex",height:"1.666ex",role:"img",focusable:"false",viewBox:"0 -442 877.3 736.2","aria-hidden":"true"},f2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},M2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.666ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.361ex",height:"2.211ex",role:"img",focusable:"false",viewBox:"0 -683 1927.4 977.2","aria-hidden":"true"},k2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},y2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.878ex",height:"1.439ex",role:"img",focusable:"false",viewBox:"0 -442 830 636","aria-hidden":"true"},V2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Z2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.294ex",height:"1.025ex",role:"img",focusable:"false",viewBox:"0 -442 572 453","aria-hidden":"true"},b2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},v2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.097ex",height:"1.027ex",role:"img",focusable:"false",viewBox:"0 -443 485 454","aria-hidden":"true"},D2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},_2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.666ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.361ex",height:"2.211ex",role:"img",focusable:"false",viewBox:"0 -683 1927.4 977.2","aria-hidden":"true"},A2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},j2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.666ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.944ex",height:"1.668ex",role:"img",focusable:"false",viewBox:"0 -443 859.3 737.2","aria-hidden":"true"},C2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},S2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.554ex"},xmlns:"http://www.w3.org/2000/svg",width:"17.283ex",height:"4.25ex",role:"img",focusable:"false",viewBox:"0 -750 7639.3 1878.6","aria-hidden":"true"},E2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},P2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-1.018ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.912ex",height:"2.919ex",role:"img",focusable:"false",viewBox:"0 -840.3 2171.3 1290.2","aria-hidden":"true"},R2={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},B2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.885ex"},xmlns:"http://www.w3.org/2000/svg",width:"24.722ex",height:"2.903ex",role:"img",focusable:"false",viewBox:"0 -891.7 10927.2 1283","aria-hidden":"true"},N2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},I2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.666ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.124ex",height:"2.261ex",role:"img",focusable:"false",viewBox:"0 -705 1380.9 999.2","aria-hidden":"true"},O2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},z2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.462ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.478ex",height:"1.957ex",role:"img",focusable:"false",viewBox:"0 -661 1979.4 865","aria-hidden":"true"},q2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},G2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.462ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.478ex",height:"1.957ex",role:"img",focusable:"false",viewBox:"0 -661 1979.4 865","aria-hidden":"true"},J2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},F2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.483ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 3307.4 1000","aria-hidden":"true"},X2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},K2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.97ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.242ex",height:"2.874ex",role:"img",focusable:"false",viewBox:"0 -841.7 1874.8 1270.4","aria-hidden":"true"},W2={class:"custom-block important"},U2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},$2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.041ex",height:"1.439ex",role:"img",focusable:"false",viewBox:"0 -442 460 636","aria-hidden":"true"},Y2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Q3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.179ex",height:"1.595ex",role:"img",focusable:"false",viewBox:"0 -694 521 705","aria-hidden":"true"},t3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},T3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"0.781ex",height:"1.52ex",role:"img",focusable:"false",viewBox:"0 -661 345 672","aria-hidden":"true"},a3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},l3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.462ex"},xmlns:"http://www.w3.org/2000/svg",width:"0.932ex",height:"1.957ex",role:"img",focusable:"false",viewBox:"0 -661 412 865","aria-hidden":"true"},e3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},s3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.462ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.719ex",height:"1.957ex",role:"img",focusable:"false",viewBox:"0 -661 1201.7 865","aria-hidden":"true"},o3={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},n3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.666ex"},xmlns:"http://www.w3.org/2000/svg",width:"28.259ex",height:"2.363ex",role:"img",focusable:"false",viewBox:"0 -750 12490.3 1044.2","aria-hidden":"true"},m3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},r3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.749ex",height:"1.439ex",role:"img",focusable:"false",viewBox:"0 -442 773 636","aria-hidden":"true"},d3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},i3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.666ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.026ex",height:"2.236ex",role:"img",focusable:"false",viewBox:"0 -694 895.3 988.2","aria-hidden":"true"},h3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},p3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.462ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.478ex",height:"1.957ex",role:"img",focusable:"false",viewBox:"0 -661 1979.4 865","aria-hidden":"true"},g3={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},H3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"35.025ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 15481.1 1000","aria-hidden":"true"},u3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},w3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.038ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 3110.7 1000","aria-hidden":"true"},x3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},c3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.023ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.061ex",height:"1.618ex",role:"img",focusable:"false",viewBox:"0 -705 469 715","aria-hidden":"true"},L3={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},f3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-5.676ex"},xmlns:"http://www.w3.org/2000/svg",width:"55.501ex",height:"8.956ex",role:"img",focusable:"false",viewBox:"0 -1450 24531.3 3958.8","aria-hidden":"true"},M3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},k3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"13.18ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 5825.8 1000","aria-hidden":"true"},y3={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},V3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.576ex"},xmlns:"http://www.w3.org/2000/svg",width:"47.645ex",height:"2.594ex",role:"img",focusable:"false",viewBox:"0 -891.7 21059.3 1146.5","aria-hidden":"true"},Z3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},b3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"14.89ex",height:"2.446ex",role:"img",focusable:"false",viewBox:"0 -923.4 6581.4 1081.2","aria-hidden":"true"},v3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},D3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.023ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.061ex",height:"1.618ex",role:"img",focusable:"false",viewBox:"0 -705 469 715","aria-hidden":"true"},_3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},A3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.462ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.478ex",height:"1.957ex",role:"img",focusable:"false",viewBox:"0 -661 1979.4 865","aria-hidden":"true"},j3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},C3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.666ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.409ex",height:"2.236ex",role:"img",focusable:"false",viewBox:"0 -694 2390.7 988.2","aria-hidden":"true"},S3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},E3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.199ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2298 1000","aria-hidden":"true"},P3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},R3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.199ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2298 1000","aria-hidden":"true"},B3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},N3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.023ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.061ex",height:"1.618ex",role:"img",focusable:"false",viewBox:"0 -705 469 715","aria-hidden":"true"},I3={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},O3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.149ex"},xmlns:"http://www.w3.org/2000/svg",width:"24.877ex",height:"5.43ex",role:"img",focusable:"false",viewBox:"0 -1450 10995.6 2400","aria-hidden":"true"},z3={class:"custom-block tip"},q3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},G3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.233ex",height:"2.343ex",role:"img",focusable:"false",viewBox:"0 -841.7 2312.8 1035.7","aria-hidden":"true"},J3={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},F3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"65.653ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 29018.7 1000","aria-hidden":"true"},X3={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},K3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.827ex"},xmlns:"http://www.w3.org/2000/svg",width:"57.696ex",height:"6.785ex",role:"img",focusable:"false",viewBox:"0 -1749.5 25501.8 2999","aria-hidden":"true"},W3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},U3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.281ex",height:"2.034ex",role:"img",focusable:"false",viewBox:"0 -705 566 899","aria-hidden":"true"},$3={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},Y3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"28.193ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 12461.4 1000","aria-hidden":"true"};function Q4(t4,t,T4,a4,l4,e4){return l(),a("div",null,[t[430]||(t[430]=e("",5)),Q("div",n,[t[19]||(t[19]=Q("div",{class:"custom-block-title"},"Attention机制",-1)),Q("ul",null,[t[7]||(t[7]=Q("li",null,[Q("strong",null,"Input"),T("：一般是一个句子，乘以矩阵，得到Q、K、V 3个向量。")],-1)),t[8]||(t[8]=Q("li",null,[Q("strong",null,"Query"),T("：表示当前查询query")],-1)),t[9]||(t[9]=Q("li",null,[Q("strong",null,"Key、Value"),T("：Key是各个位置的键，Value各个位置的信息")],-1)),Q("li",null,[Q("strong",null,[Q("mjx-container",m,[(l(),a("svg",r,t[0]||(t[0]=[e("",1)]))),t[1]||(t[1]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"s"),Q("mi",null,"o"),Q("mi",null,"f"),Q("mi",null,"t"),Q("mi",null,"m"),Q("mi",null,"a"),Q("mi",null,"x"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"Q"),Q("mo",null,"∗"),Q("mi",null,"K"),Q("mo",{stretchy:"false"},")")])],-1))])]),t[4]||(t[4]=T("： 计算注意力权重，即当前query对各个位置的注意力")),Q("mjx-container",d,[(l(),a("svg",i,t[2]||(t[2]=[e("",1)]))),t[3]||(t[3]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"α"),Q("mn",null,"1")]),Q("mo",null,","),Q("mo",null,"⋯"),Q("mo",null,","),Q("msub",null,[Q("mi",null,"α"),Q("mi",null,"l")])])],-1))]),t[5]||(t[5]=T("。 ")),t[6]||(t[6]=Q("ul",null,[Q("li",null,[T("早期QK有 dot/concat/w 这3种"),Q("a",{href:"https://plmsmile.github.io/posts/olds/nlp/Attention-based-NMT.html#global-attention",target:"_blank",rel:"noreferrer"},"score计算的3种方式")])],-1))]),t[10]||(t[10]=Q("li",null,[Q("strong",null,"加权求和"),T("：利用注意力权重对各位置Value加权求和，就得到输出")],-1))]),Q("mjx-container",h,[(l(),a("svg",p,t[11]||(t[11]=[e("",1)]))),t[12]||(t[12]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mi",null,"A"),Q("mi",null,"t"),Q("mi",null,"t"),Q("mi",null,"e"),Q("mi",null,"n"),Q("mi",null,"t"),Q("mi",null,"i"),Q("mi",null,"o"),Q("mi",null,"n"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"Q"),Q("mo",null,","),Q("mi",null,"K"),Q("mo",null,","),Q("mi",null,"V"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("mtext",null,"softmax"),Q("mo",{stretchy:"false"},"("),Q("mfrac",null,[Q("mrow",null,[Q("mi",null,"Q"),Q("msup",null,[Q("mi",null,"K"),Q("mi",null,"T")])]),Q("msqrt",null,[Q("msub",null,[Q("mi",null,"d"),Q("mi",null,"k")])])]),Q("mo",{stretchy:"false"},")"),Q("mi",null,"V")])],-1))]),Q("ul",null,[Q("li",null,[t[15]||(t[15]=T("除以")),Q("mjx-container",g,[(l(),a("svg",H,t[13]||(t[13]=[e("",1)]))),t[14]||(t[14]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msqrt",null,[Q("msub",null,[Q("mi",null,"d"),Q("mi",null,"k")])])])],-1))]),t[16]||(t[16]=T("进行缩放，")),t[17]||(t[17]=Q("strong",null,"防止梯度爆炸",-1)),t[18]||(t[18]=T(","))])])]),t[431]||(t[431]=e("",8)),Q("div",u,[t[91]||(t[91]=Q("div",{class:"custom-block-title"},"重要思考",-1)),t[92]||(t[92]=Q("p",null,[Q("strong",null,"1、Self-Attention Padding 做 Mask")],-1)),Q("ul",null,[Q("li",null,[Q("mjx-container",w,[(l(),a("svg",x,t[20]||(t[20]=[e("",1)]))),t[21]||(t[21]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"Q"),Q("mo",null,"⋅"),Q("mi",null,"K")])],-1))]),t[24]||(t[24]=T(" ，需要对padding部分置为")),Q("mjx-container",c,[(l(),a("svg",L,t[22]||(t[22]=[e("",1)]))),t[23]||(t[23]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mo",null,"−"),Q("mi",{mathvariant:"normal"},"∞")])],-1))]),t[25]||(t[25]=T("负无穷，再过Softmax才会为0。"))])]),t[93]||(t[93]=Q("p",null,[Q("strong",null,"2、Transformer Multi-Head Attention 要对head 进行降维")],-1)),Q("ul",null,[Q("li",null,[t[30]||(t[30]=T("输入向量维度为")),Q("mjx-container",f,[(l(),a("svg",M,t[26]||(t[26]=[Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D451",d:"M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z",style:{"stroke-width":"3"}})])])],-1)]))),t[27]||(t[27]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"d")])],-1))]),t[31]||(t[31]=T("，需要降维到 ")),Q("mjx-container",k,[(l(),a("svg",y,t[28]||(t[28]=[e("",1)]))),t[29]||(t[29]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msup",null,[Q("mi",null,"d"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{"data-mjx-alternate":"1"},"′")])])])],-1))]),t[32]||(t[32]=T("（远小于d），主要是为了")),t[33]||(t[33]=Q("mark",null,"降低计算复杂度",-1))]),Q("li",null,[t[36]||(t[36]=T("时间复杂度：")),Q("mjx-container",V,[(l(),a("svg",Z,t[34]||(t[34]=[e("",1)]))),t[35]||(t[35]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"o"),Q("mo",{stretchy:"false"},"("),Q("msup",null,[Q("mi",null,"d"),Q("mn",null,"2")]),Q("mo",{stretchy:"false"},")"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mo",null,"、")]),Q("mi",null,"o"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"h"),Q("msup",null,[Q("mi",null,"d"),Q("mn",null,"2")]),Q("mo",{stretchy:"false"},")"),Q("mstyle",{scriptlevel:"0"},[Q("mspace",{width:"1em"})]),Q("mo",{stretchy:"false"},"→"),Q("mstyle",{scriptlevel:"0"},[Q("mspace",{width:"1em"})]),Q("mi",null,"o"),Q("mo",{stretchy:"false"},"("),Q("msup",null,[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("msup",null,[Q("mi",null,"d"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{"data-mjx-alternate":"1"},"′")])])]),Q("mn",null,"2")]),Q("mo",{stretchy:"false"},")"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mo",null,"、")]),Q("mi",null,"o"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"h"),Q("msup",null,[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("msup",null,[Q("mi",null,"d"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{"data-mjx-alternate":"1"},"′")])])]),Q("mn",null,"2")]),Q("mo",{stretchy:"false"},")")])],-1))])])]),t[94]||(t[94]=Q("p",null,[Q("strong",null,"3、维度和点击的关系")],-1)),Q("ul",null,[Q("li",null,[Q("p",null,[Q("mjx-container",b,[(l(),a("svg",v,t[37]||(t[37]=[e("",1)]))),t[38]||(t[38]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"q"),Q("mo",null,","),Q("mi",null,"k")])],-1))]),t[43]||(t[43]=T("向量 维度d越大，点积值")),Q("mjx-container",D,[(l(),a("svg",_,t[39]||(t[39]=[e("",1)]))),t[40]||(t[40]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"q"),Q("mo",null,"⋅"),Q("mi",null,"k")])],-1))]),t[44]||(t[44]=T("越大，点积属于均值0、方差")),Q("mjx-container",A,[(l(),a("svg",j,t[41]||(t[41]=[Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D451",d:"M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z",style:{"stroke-width":"3"}})])])],-1)]))),t[42]||(t[42]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"d")])],-1))]),t[45]||(t[45]=T("的正态分布。"))]),Q("mjx-container",C,[(l(),a("svg",S,t[46]||(t[46]=[e("",1)]))),t[47]||(t[47]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mi",null,"E"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"q"),Q("mo",null,"⋅"),Q("mi",null,"k"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("mn",null,"0"),Q("mo",null,","),Q("mstyle",{scriptlevel:"0"},[Q("mspace",{width:"1em"})]),Q("mi",null,"D"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"q"),Q("mo",null,"⋅"),Q("mi",null,"k"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("mi",null,"d")])],-1))])]),Q("li",null,[t[50]||(t[50]=Q("p",null,"方差的性质",-1)),Q("mjx-container",E,[(l(),a("svg",P,t[48]||(t[48]=[e("",1)]))),t[49]||(t[49]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mi",null,"D"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"c"),Q("mi",null,"x"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("msup",null,[Q("mi",null,"c"),Q("mn",null,"2")]),Q("mi",null,"D"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"x"),Q("mo",{stretchy:"false"},")"),Q("mo",null,","),Q("mstyle",{scriptlevel:"0"},[Q("mspace",{width:"1em"})]),Q("mi",null,"D"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"c"),Q("mo",null,"+"),Q("mi",null,"x"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("mi",null,"D"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"x"),Q("mo",{stretchy:"false"},")"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mo",null,"。")]),Q("mstyle",{scriptlevel:"0"},[Q("mspace",{width:"1em"})]),Q("mi",null,"c"),Q("mi",{mathvariant:"normal"},"为"),Q("mi",{mathvariant:"normal"},"常"),Q("mi",{mathvariant:"normal"},"数")])],-1))])])]),Q("p",null,[Q("strong",null,[t[53]||(t[53]=T("3、深入理解")),Q("mjx-container",R,[(l(),a("svg",B,t[51]||(t[51]=[e("",1)]))),t[52]||(t[52]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msqrt",null,[Q("msub",null,[Q("mi",null,"d"),Q("mi",null,"k")])])])],-1))]),t[54]||(t[54]=T("缓解梯度爆炸问题"))])]),Q("ul",null,[Q("li",null,[Q("p",null,[t[59]||(t[59]=T("Attention计算过程：内积")),Q("mjx-container",N,[(l(),a("svg",I,t[55]||(t[55]=[e("",1)]))),t[56]||(t[56]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"Q"),Q("mi",null,"K")])],-1))]),t[60]||(t[60]=T("后 -> softmax。softmax主要入参是")),Q("mjx-container",O,[(l(),a("svg",z,t[57]||(t[57]=[e("",1)]))),t[58]||(t[58]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msup",null,[Q("mi",null,"e"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"q"),Q("mi",null,"k")])])])],-1))]),t[61]||(t[61]=T("。"))])]),Q("li",null,[Q("p",null,[t[64]||(t[64]=Q("strong",null,"如果不进行缩放",-1)),t[65]||(t[65]=T("，softmax参数在")),Q("mjx-container",q,[(l(),a("svg",G,t[62]||(t[62]=[e("",1)]))),t[63]||(t[63]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mo",{stretchy:"false"},"["),Q("msup",null,[Q("mi",null,"e"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mo",null,"−"),Q("mn",null,"3"),Q("msqrt",null,[Q("mi",null,"d")])])]),Q("mo",null,","),Q("mstyle",{scriptlevel:"0"},[Q("mspace",{width:"0.278em"})]),Q("msup",null,[Q("mi",null,"e"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mn",null,"3"),Q("msqrt",null,[Q("mi",null,"d")])])]),Q("mo",{stretchy:"false"},"]")])],-1))]),t[66]||(t[66]=T("之间， ")),t[67]||(t[67]=Q("mark",null,"参数会很大或很小，导致attention接近one-hot分布",-1)),t[68]||(t[68]=T("。"))]),t[69]||(t[69]=Q("ul",null,[Q("li",null,[Q("strong",null,"饱和区梯度消失"),T("："),Q("mark",null,"x值继续变大，y几乎不变")])],-1))]),Q("li",null,[Q("p",null,[t[76]||(t[76]=T("因此，QK后才除以")),Q("mjx-container",J,[(l(),a("svg",F,t[70]||(t[70]=[e("",1)]))),t[71]||(t[71]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msqrt",null,[Q("msub",null,[Q("mi",null,"d"),Q("mi",null,"k")])])])],-1))]),t[77]||(t[77]=T(" ，")),Q("mark",null,[t[74]||(t[74]=T("使得softmax入参在")),Q("mjx-container",X,[(l(),a("svg",K,t[72]||(t[72]=[e("",1)]))),t[73]||(t[73]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mo",{stretchy:"false"},"["),Q("msup",null,[Q("mi",null,"e"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mo",null,"−"),Q("mn",null,"3")])]),Q("mo",null,","),Q("msup",null,[Q("mi",null,"e"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mn",null,"3")])]),Q("mo",{stretchy:"false"},"]")])],-1))]),t[75]||(t[75]=T("之间，不大也不小"))]),t[78]||(t[78]=T("。"))])]),Q("li",null,[t[89]||(t[89]=Q("p",null,"数学思路",-1)),Q("ul",null,[Q("li",null,[Q("mjx-container",W,[(l(),a("svg",U,t[79]||(t[79]=[e("",1)]))),t[80]||(t[80]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"q"),Q("mo",null,"⋅"),Q("mi",null,"k")])],-1))]),t[83]||(t[83]=T(" 除以")),Q("mjx-container",$,[(l(),a("svg",Y,t[81]||(t[81]=[e("",1)]))),t[82]||(t[82]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msqrt",null,[Q("mi",null,"d")])])],-1))]),t[84]||(t[84]=T("，抵消掉，由0-d正态分布，")),t[85]||(t[85]=Q("strong",null,"又回到0-1正态分布",-1)),t[86]||(t[86]=T("。"))])]),Q("mjx-container",Q1,[(l(),a("svg",t1,t[87]||(t[87]=[e("",1)]))),t[88]||(t[88]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mi",null,"E"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"q"),Q("mo",null,"⋅"),Q("mi",null,"k"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("mn",null,"0"),Q("mo",null,","),Q("mstyle",{scriptlevel:"0"},[Q("mspace",{width:"1em"})]),Q("mi",null,"D"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"q"),Q("mo",null,"⋅"),Q("mi",null,"k"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("mi",null,"d"),Q("mstyle",{scriptlevel:"0"},[Q("mspace",{width:"1em"})]),Q("mo",{stretchy:"false"},"⇒"),Q("mstyle",{scriptlevel:"0"},[Q("mspace",{width:"1em"})]),Q("mi",null,"D"),Q("mo",{stretchy:"false"},"("),Q("mfrac",null,[Q("mrow",null,[Q("mi",null,"q"),Q("mo",null,"⋅"),Q("mi",null,"k")]),Q("msqrt",null,[Q("mi",null,"d")])]),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("mfrac",null,[Q("mrow",null,[Q("mi",null,"q"),Q("mo",null,"⋅"),Q("mi",null,"k")]),Q("mrow",null,[Q("mo",{stretchy:"false"},"("),Q("msqrt",null,[Q("mi",null,"d")]),Q("msup",null,[Q("mo",{stretchy:"false"},")"),Q("mn",null,"2")])])]),Q("mo",null,"="),Q("mn",null,"1")])],-1))]),t[90]||(t[90]=Q("ul",null,[Q("li",null,"方差为1，有效控制点积结果发散，应对了梯度消失问题。")],-1))])])]),t[432]||(t[432]=e("",11)),Q("div",T1,[t[109]||(t[109]=Q("div",{class:"custom-block-title"},"Softmax Tiling",-1)),t[110]||(t[110]=Q("p",null,[T("参考文章："),Q("a",{href:"https://zhuanlan.zhihu.com/p/683191121",target:"_blank",rel:"noreferrer"},"FlashAttention中的softmax快分块计算详解")],-1)),Q("ul",null,[Q("li",null,[t[106]||(t[106]=Q("strong",null,"数值稳定",-1)),t[107]||(t[107]=T("：")),Q("mark",null,[t[99]||(t[99]=T("避免数值")),Q("mjx-container",a1,[(l(),a("svg",l1,t[95]||(t[95]=[e("",1)]))),t[96]||(t[96]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msup",null,[Q("mi",null,"e"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("msub",null,[Q("mi",null,"x"),Q("mi",null,"i")])])])])],-1))]),t[100]||(t[100]=T("过大溢出，每个元素都减去最大值得")),Q("mjx-container",e1,[(l(),a("svg",s1,t[97]||(t[97]=[e("",1)]))),t[98]||(t[98]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msup",null,[Q("mi",null,"e"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("msub",null,[Q("mi",null,"x"),Q("mi",null,"i")]),Q("mo",null,"−"),Q("mi",null,"m"),Q("mi",null,"a"),Q("mi",null,"x"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"x"),Q("mo",{stretchy:"false"},")")])])])],-1))])]),Q("ul",null,[Q("li",null,[Q("strong",null,[t[103]||(t[103]=T("改进后")),Q("mjx-container",o1,[(l(),a("svg",n1,t[101]||(t[101]=[e("",1)]))),t[102]||(t[102]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msup",null,[Q("mi",null,"e"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("msub",null,[Q("mi",null,"x"),Q("mi",null,"i")]),Q("mo",null,"−"),Q("mi",null,"m"),Q("mi",null,"a"),Q("mi",null,"x"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"x"),Q("mo",{stretchy:"false"},")")])])])],-1))]),t[104]||(t[104]=T("落在[0,1]区间"))]),t[105]||(t[105]=T("。softmax结果和原softmax一致"))])])]),t[108]||(t[108]=e("",1))])]),t[433]||(t[433]=Q("p",null,[Q("strong",null,"3、Flash Attention 算法")],-1)),Q("div",m1,[t[122]||(t[122]=Q("div",{class:"custom-block-title"},"Flash Attention 算法",-1)),Q("ul",null,[t[119]||(t[119]=Q("li",null,"主要目标：避免从GPU-HBM中读取和写入注意力矩阵。",-1)),t[120]||(t[120]=Q("li",null,[Q("strong",null,"计算softmax不需要全局信息"),Q("ul",null,[Q("li",null,[T("把输入分块，以分块增量方式计算softmax，即 "),Q("code",null,"softmax tiling"),T("算法。")])])],-1)),Q("li",null,[Q("strong",null,[t[113]||(t[113]=T("反向传播不存储中间attention矩阵(")),Q("mjx-container",r1,[(l(),a("svg",d1,t[111]||(t[111]=[e("",1)]))),t[112]||(t[112]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msup",null,[Q("mi",null,"N"),Q("mn",null,"2")])])],-1))]),t[114]||(t[114]=T(")"))]),t[115]||(t[115]=T("，")),t[116]||(t[116]=Q("strong",null,"只存储softmax归一化系数",-1)),t[117]||(t[117]=T("。 ")),t[118]||(t[118]=Q("ul",null,[Q("li",null,"标准Attention：需要把过程中的S、P写入HBM中，矩阵大小和输入序列长度有关，非常大"),Q("li",null,[Q("strong",null,"FlashAttention"),T("："),Q("strong",null,"不使用中间注意力矩阵"),T("，"),Q("mark",null,"通过存储归一化因子来减少HBM内存的消耗"),T("。")])],-1))]),t[121]||(t[121]=Q("li",null,[T("算法流程，具体见论文。 "),Q("ul",null,[Q("li",null,"简单讲：每次只计算一个block的只，通过多轮双for循环完成注意力计算。")])],-1))])]),t[434]||(t[434]=e("",6)),Q("div",i1,[t[135]||(t[135]=Q("div",{class:"custom-block-title"},"Batch Normalization",-1)),t[136]||(t[136]=Q("p",null,[Q("strong",null,"BN定义")],-1)),Q("ul",null,[t[131]||(t[131]=Q("li",null,[T("范围："),Q("strong",null,"对一个Batch的样本"),T("，"),Q("strong",null,"为每个通道数据做归一化")],-1)),t[132]||(t[132]=Q("li",null,[Q("strong",null,"求均值、方差"),T("，"),Q("mark",null,"让数据标准化到(0, 1)正态分布"),T("，避免发生梯度消失")],-1)),Q("li",null,[Q("strong",null,[t[127]||(t[127]=T("加入缩放")),Q("mjx-container",h1,[(l(),a("svg",p1,t[123]||(t[123]=[Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D6FE",d:"M31 249Q11 249 11 258Q11 275 26 304T66 365T129 418T206 441Q233 441 239 440Q287 429 318 386T371 255Q385 195 385 170Q385 166 386 166L398 193Q418 244 443 300T486 391T508 430Q510 431 524 431H537Q543 425 543 422Q543 418 522 378T463 251T391 71Q385 55 378 6T357 -100Q341 -165 330 -190T303 -216Q286 -216 286 -188Q286 -138 340 32L346 51L347 69Q348 79 348 100Q348 257 291 317Q251 355 196 355Q148 355 108 329T51 260Q49 251 47 251Q45 249 31 249Z",style:{"stroke-width":"3"}})])])],-1)]))),t[124]||(t[124]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"γ")])],-1))]),t[128]||(t[128]=T("和平移变量")),Q("mjx-container",g1,[(l(),a("svg",H1,t[125]||(t[125]=[Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D6FD",d:"M29 -194Q23 -188 23 -186Q23 -183 102 134T186 465Q208 533 243 584T309 658Q365 705 429 705H431Q493 705 533 667T573 570Q573 465 469 396L482 383Q533 332 533 252Q533 139 448 65T257 -10Q227 -10 203 -2T165 17T143 40T131 59T126 65L62 -188Q60 -194 42 -194H29ZM353 431Q392 431 427 419L432 422Q436 426 439 429T449 439T461 453T472 471T484 495T493 524T501 560Q503 569 503 593Q503 611 502 616Q487 667 426 667Q384 667 347 643T286 582T247 514T224 455Q219 439 186 308T152 168Q151 163 151 147Q151 99 173 68Q204 26 260 26Q302 26 349 51T425 137Q441 171 449 214T457 279Q457 337 422 372Q380 358 347 358H337Q258 358 258 389Q258 396 261 403Q275 431 353 431Z",style:{"stroke-width":"3"}})])])],-1)]))),t[126]||(t[126]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"β")])],-1))])]),t[129]||(t[129]=T("：使数据在归一化后")),t[130]||(t[130]=Q("mark",null,"保留原有学习来的特征",-1))])]),Q("mjx-container",u1,[(l(),a("svg",w1,t[133]||(t[133]=[e("",1)]))),t[134]||(t[134]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mi",null,"y"),Q("mo",null,"="),Q("mi",null,"γ"),Q("mo",null,"⋅"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mover",null,[Q("mi",null,"x"),Q("mo",{stretchy:"false"},"^")])]),Q("mo",null,"+"),Q("mi",null,"β"),Q("mo",null,","),Q("mstyle",{scriptlevel:"0"},[Q("mspace",{width:"1em"})]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mover",null,[Q("mi",null,"x"),Q("mo",{stretchy:"false"},"^")])]),Q("mo",null,"="),Q("mfrac",null,[Q("mrow",null,[Q("mi",null,"x"),Q("mo",null,"−"),Q("mi",null,"E"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"x"),Q("mo",{stretchy:"false"},")")]),Q("msqrt",null,[Q("mi",null,"V"),Q("mi",null,"a"),Q("mi",null,"r"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"x"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"+"),Q("mi",null,"ϵ")])])])],-1))]),t[137]||(t[137]=e("",4))]),t[435]||(t[435]=e("",8)),Q("div",x1,[t[147]||(t[147]=Q("div",{class:"custom-block-title"},"Deep Norm",-1)),t[148]||(t[148]=Q("p",null,[Q("strong",null,"定义")],-1)),Q("ul",null,[t[146]||(t[146]=Q("li",null,[T("范围：对Post-Layer Norm的改进。 "),Q("ul",null,[Q("li",null,"Post-LN问题：不稳定性来自梯度消失以及太大模型更新。")])],-1)),Q("li",null,[t[145]||(t[145]=T("算法： ")),Q("ul",null,[Q("li",null,[Q("strong",null,[t[140]||(t[140]=T("在LN之前，乘以")),Q("mjx-container",c1,[(l(),a("svg",L1,t[138]||(t[138]=[Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D6FC",d:"M34 156Q34 270 120 356T309 442Q379 442 421 402T478 304Q484 275 485 237V208Q534 282 560 374Q564 388 566 390T582 393Q603 393 603 385Q603 376 594 346T558 261T497 161L486 147L487 123Q489 67 495 47T514 26Q528 28 540 37T557 60Q559 67 562 68T577 70Q597 70 597 62Q597 56 591 43Q579 19 556 5T512 -10H505Q438 -10 414 62L411 69L400 61Q390 53 370 41T325 18T267 -2T203 -11Q124 -11 79 39T34 156ZM208 26Q257 26 306 47T379 90L403 112Q401 255 396 290Q382 405 304 405Q235 405 183 332Q156 292 139 224T121 120Q121 71 146 49T208 26Z",style:{"stroke-width":"3"}})])])],-1)]))),t[139]||(t[139]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"α")])],-1))]),t[141]||(t[141]=T("扩大残差连接"))]),t[142]||(t[142]=T("。")),t[143]||(t[143]=Q("code",null,"LayerNorm(x * alpha + f(x))",-1))]),t[144]||(t[144]=Q("li",null,[T("以β减小部分参数的初始化范围，"),Q("a",{href:"https://plmsmile.github.io/posts/olds/dl/35-nerual-network-optim.html#xavier%E5%9D%87%E5%8C%80%E5%88%86%E5%B8%83%E5%88%9D%E5%A7%8B%E5%8C%96",target:"_blank",rel:"noreferrer"},"Xavier均匀分布初始化")],-1))])])]),t[149]||(t[149]=Q("p",null,[Q("strong",null,"优点")],-1)),t[150]||(t[150]=Q("ul",null,[Q("li",null,"具备Post-LN的好性能，且具有Pre-LN 的稳定训练")],-1))]),t[436]||(t[436]=Q("h3",{id:"rms-norm-2019-prms-norm",tabindex:"-1"},[T("RMS Norm(2019) & pRMS Norm "),Q("a",{class:"header-anchor",href:"#rms-norm-2019-prms-norm","aria-label":'Permalink to "RMS Norm(2019) & pRMS Norm"'},"​")],-1)),Q("div",f1,[t[161]||(t[161]=Q("div",{class:"custom-block-title"},"RMS Norm",-1)),t[162]||(t[162]=Q("p",null,[Q("strong",null,"RMS Norm")],-1)),Q("ul",null,[t[158]||(t[158]=Q("li",null,[Q("p",null,[T("针对LayerNorm改进，主要区别在于"),Q("mark",null,"去掉了减去均值的部分"),T("，采用"),Q("strong",null,"根均方"),T("。")])],-1)),Q("li",null,[Q("p",null,[t[153]||(t[153]=T("RMS 操作 (")),t[154]||(t[154]=Q("code",null,"Root Mean Squre",-1)),t[155]||(t[155]=T(")：")),Q("mjx-container",M1,[(l(),a("svg",k1,t[151]||(t[151]=[e("",1)]))),t[152]||(t[152]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"R"),Q("mi",null,"M"),Q("mi",null,"S"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"x"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("msqrt",null,[Q("mfrac",null,[Q("mn",null,"1"),Q("mi",null,"n")]),Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,"="),Q("mn",null,"1")]),Q("mi",null,"n")]),Q("msubsup",null,[Q("mi",null,"x"),Q("mi",null,"i"),Q("mn",null,"2")])])])],-1))])]),Q("mjx-container",y1,[(l(),a("svg",V1,t[156]||(t[156]=[e("",1)]))),t[157]||(t[157]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mover",null,[Q("msub",null,[Q("mi",null,"x"),Q("mi",null,"i")]),Q("mo",{stretchy:"false"},"^")])]),Q("mo",null,"="),Q("mfrac",null,[Q("msub",null,[Q("mi",null,"x"),Q("mi",null,"i")]),Q("mrow",null,[Q("mi",null,"R"),Q("mi",null,"M"),Q("mi",null,"S"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"x"),Q("mo",{stretchy:"false"},")")])]),Q("mo",null,"⋅"),Q("mi",null,"γ"),Q("mo",null,"+"),Q("mi",null,"β"),Q("mo",null,"="),Q("mfrac",null,[Q("msub",null,[Q("mi",null,"x"),Q("mi",null,"i")]),Q("msqrt",null,[Q("mfrac",null,[Q("mn",null,"1"),Q("mi",null,"n")]),Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,"="),Q("mn",null,"1")]),Q("mi",null,"n")]),Q("msubsup",null,[Q("mi",null,"x"),Q("mi",null,"i"),Q("mn",null,"2")])])]),Q("mo",null,"⋅"),Q("mi",null,"γ"),Q("mo",null,"+"),Q("mi",null,"β")])],-1))])])]),t[163]||(t[163]=Q("p",null,[Q("strong",null,"pRMS Norm")],-1)),t[164]||(t[164]=Q("ul",null,[Q("li",null,"核心思想：用部分数据，代替全部的计算，p为前p%的数据")],-1)),Q("mjx-container",Z1,[(l(),a("svg",b1,t[159]||(t[159]=[e("",1)]))),t[160]||(t[160]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mi",null,"R"),Q("mi",null,"M"),Q("mi",null,"S"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"x"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("msqrt",null,[Q("mfrac",null,[Q("mn",null,"1"),Q("mi",null,"k")]),Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,"="),Q("mn",null,"1")]),Q("mi",null,"k")]),Q("msubsup",null,[Q("mi",null,"x"),Q("mi",null,"i"),Q("mn",null,"2")])])])],-1))])]),t[437]||(t[437]=e("",11)),Q("div",v1,[t[202]||(t[202]=Q("div",{class:"custom-block-title"},"绝对位置编码",-1)),Q("p",null,[t[169]||(t[169]=T("核心思想：")),Q("strong",null,[t[167]||(t[167]=T("直接为输入")),Q("mjx-container",D1,[(l(),a("svg",_1,t[165]||(t[165]=[e("",1)]))),t[166]||(t[166]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"x"),Q("mi",null,"k")])])],-1))]),t[168]||(t[168]=T("向量增加一个位置向量"))])]),Q("mjx-container",A1,[(l(),a("svg",j1,t[170]||(t[170]=[e("",1)]))),t[171]||(t[171]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mstyle",{mathcolor:"blue"},[Q("msub",null,[Q("mi",null,"x"),Q("mi",null,"k")]),Q("mo",null,"="),Q("msub",null,[Q("mi",null,"x"),Q("mi",null,"k")]),Q("mo",null,"+"),Q("msub",null,[Q("mi",null,"p"),Q("mi",null,"k")]),Q("mo",null,",")]),Q("mstyle",{scriptlevel:"0"},[Q("mspace",{width:"1em"})]),Q("msub",null,[Q("mi",null,"p"),Q("mi",null,"k")]),Q("mtext",null,"为位置编码，与位置k有关"),Q("mi",null,"，")])],-1))]),t[203]||(t[203]=Q("p",null,[Q("strong",null,"1. 可训练式")],-1)),Q("ul",null,[Q("li",null,[t[174]||(t[174]=T("定义：把位置向量作为可训练的参数，如")),Q("mjx-container",C1,[(l(),a("svg",S1,t[172]||(t[172]=[e("",1)]))),t[173]||(t[173]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"n"),Q("mo",null,"∗"),Q("mi",null,"d")])],-1))]),t[175]||(t[175]=T("维度。"))]),t[176]||(t[176]=Q("li",null,[T("缺点："),Q("strong",null,"没有外推性"),T("，难处理超过最大长度n的位置")],-1))]),t[204]||(t[204]=Q("p",null,[Q("strong",null,"2. 三角式")],-1)),Q("ul",null,[Q("li",null,[Q("p",null,[t[187]||(t[187]=T("定义：")),Q("mjx-container",E1,[(l(),a("svg",P1,t[177]||(t[177]=[e("",1)]))),t[178]||(t[178]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"p"),Q("mi",null,"k")])])],-1))]),t[188]||(t[188]=T("中")),Q("strong",null,[t[183]||(t[183]=T("第")),Q("mjx-container",R1,[(l(),a("svg",B1,t[179]||(t[179]=[e("",1)]))),t[180]||(t[180]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mn",null,"2"),Q("mi",null,"i")])],-1))]),t[184]||(t[184]=T("和")),Q("mjx-container",N1,[(l(),a("svg",I1,t[181]||(t[181]=[e("",1)]))),t[182]||(t[182]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mn",null,"2"),Q("mi",null,"i"),Q("mo",null,"+"),Q("mn",null,"1")])],-1))]),t[185]||(t[185]=Q("strong",null,"各位置的值，分别",-1)),t[186]||(t[186]=T("由sin和cos函数来定义"))]),t[189]||(t[189]=T("。"))]),Q("mjx-container",O1,[(l(),a("svg",z1,t[190]||(t[190]=[e("",1)]))),t[191]||(t[191]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mtable",{columnalign:"left left",columnspacing:"1em",rowspacing:"4pt"},[Q("mtr",null,[Q("mtd",null,[Q("msub",null,[Q("mi",null,"p"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"k"),Q("mo",null,","),Q("mn",null,"2"),Q("mi",null,"i")])])]),Q("mtd",null,[Q("mo",null,"="),Q("mi",null,"sin"),Q("mo",{"data-mjx-texclass":"NONE"},"⁡"),Q("mo",{stretchy:"false"},"("),Q("mfrac",null,[Q("mi",null,"k"),Q("msup",null,[Q("mn",null,"10000"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mn",null,"2"),Q("mi",null,"i"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mo",null,"/")]),Q("mi",null,"d")])])]),Q("mo",{stretchy:"false"},")")])]),Q("mtr",null,[Q("mtd",null,[Q("msub",null,[Q("mi",null,"p"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"k"),Q("mo",null,","),Q("mn",null,"2"),Q("mi",null,"i"),Q("mo",null,"+"),Q("mn",null,"1")])])]),Q("mtd",null,[Q("mo",null,"="),Q("mi",null,"cos"),Q("mo",{"data-mjx-texclass":"NONE"},"⁡"),Q("mo",{stretchy:"false"},"("),Q("mfrac",null,[Q("mi",null,"k"),Q("msup",null,[Q("mn",null,"10000"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mn",null,"2"),Q("mi",null,"i"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mo",null,"/")]),Q("mi",null,"d")])])]),Q("mo",{stretchy:"false"},")")])])])])],-1))])]),t[192]||(t[192]=Q("li",null,[Q("p",null,[T("优点：三角函数有"),Q("strong",null,"一定外推性"),T("，不用训练。")])],-1)),t[193]||(t[193]=Q("li",null,[Q("p",null,"缺点：但现在很少看到这种绝对位置编码的工作。")],-1))]),t[205]||(t[205]=Q("p",null,[Q("strong",null,"3. 递归式")],-1)),Q("ul",null,[Q("li",null,[t[196]||(t[196]=T("定义：通过递归计算位置编码，")),Q("mjx-container",q1,[(l(),a("svg",G1,t[194]||(t[194]=[e("",1)]))),t[195]||(t[195]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"p"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"k"),Q("mo",null,"+"),Q("mn",null,"1")])]),Q("mo",null,"="),Q("mi",null,"f"),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"p"),Q("mi",null,"k")]),Q("mo",{stretchy:"false"},")")])],-1))]),t[197]||(t[197]=T("，示例")),t[198]||(t[198]=Q("a",{href:"https://arxiv.org/abs/2003.09229",target:"_blank",rel:"noreferrer"},"论文",-1)),t[199]||(t[199]=T("。"))]),t[200]||(t[200]=Q("li",null,"优点：具有较好外推性",-1)),t[201]||(t[201]=Q("li",null,"缺点：牺牲并行性，计算不足",-1))])]),t[438]||(t[438]=Q("h3",{id:"相对位置编码",tabindex:"-1"},[T("相对位置编码 "),Q("a",{class:"header-anchor",href:"#相对位置编码","aria-label":'Permalink to "相对位置编码"'},"​")],-1)),t[439]||(t[439]=Q("p",null,[Q("strong",null,"核心思想")],-1)),t[440]||(t[440]=Q("ul",null,[Q("li",null,[T("不建模输入位置的全局信息，"),Q("strong",null,"在计算attention时，考虑当前位置和目标位置的相对距离")]),Q("li",null,[T("NLP任务更适合"),Q("strong",null,"相对位置编码"),T("👍。")])],-1)),Q("div",J1,[t[228]||(t[228]=Q("div",{class:"custom-block-title"},"绝对位置编码Attention 公式",-1)),Q("p",null,[t[215]||(t[215]=T("💥")),Q("strong",null,[t[210]||(t[210]=T("计算")),Q("mjx-container",F1,[(l(),a("svg",X1,t[206]||(t[206]=[Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D456",d:"M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z",style:{"stroke-width":"3"}})])])],-1)]))),t[207]||(t[207]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"i")])],-1))]),t[211]||(t[211]=T("和")),Q("mjx-container",K1,[(l(),a("svg",W1,t[208]||(t[208]=[Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D457",d:"M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z",style:{"stroke-width":"3"}})])])],-1)]))),t[209]||(t[209]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"j")])],-1))]),t[212]||(t[212]=T("的attention"))]),t[216]||(t[216]=T("，其中")),Q("mjx-container",U1,[(l(),a("svg",$1,t[213]||(t[213]=[e("",1)]))),t[214]||(t[214]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"q"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mo",null,"、")]),Q("mi",null,"k"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mo",null,"、")]),Q("mi",null,"v"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mo",null,"、")]),Q("mi",null,"p")])],-1))]),t[217]||(t[217]=T("均为向量。"))]),Q("mjx-container",Y1,[(l(),a("svg",Q2,t[218]||(t[218]=[e("",1)]))),t[219]||(t[219]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mtable",{columnalign:"left",columnspacing:"1em",rowspacing:"4pt"},[Q("mtr",null,[Q("mtd",null,[Q("msub",null,[Q("mi",null,"q"),Q("mi",null,"i")]),Q("mo",null,"="),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"x"),Q("mi",null,"i")]),Q("mo",null,"+"),Q("msub",null,[Q("mi",null,"p"),Q("mi",null,"i")]),Q("mo",{stretchy:"false"},")"),Q("msub",null,[Q("mi",null,"W"),Q("mi",null,"Q")]),Q("mstyle",{scriptlevel:"0"},[Q("mspace",{width:"1em"})]),Q("mo",null,"="),Q("msub",null,[Q("mi",null,"f"),Q("mi",null,"q")]),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"x"),Q("mi",null,"i")]),Q("mo",null,","),Q("mi",null,"i"),Q("mo",{stretchy:"false"},")")])]),Q("mtr",null,[Q("mtd",null,[Q("msub",null,[Q("mi",null,"k"),Q("mi",null,"j")]),Q("mo",null,"="),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"x"),Q("mi",null,"j")]),Q("mo",null,"+"),Q("msub",null,[Q("mi",null,"p"),Q("mi",null,"j")]),Q("mo",{stretchy:"false"},")"),Q("msub",null,[Q("mi",null,"W"),Q("mi",null,"K")]),Q("mstyle",{scriptlevel:"0"},[Q("mspace",{width:"1em"})]),Q("mo",null,"="),Q("msub",null,[Q("mi",null,"f"),Q("mi",null,"k")]),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"x"),Q("mi",null,"j")]),Q("mo",null,","),Q("mi",null,"j"),Q("mo",{stretchy:"false"},")")])]),Q("mtr",null,[Q("mtd",null,[Q("msub",null,[Q("mi",null,"v"),Q("mi",null,"j")]),Q("mo",null,"="),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"x"),Q("mi",null,"j")]),Q("mo",null,"+"),Q("msub",null,[Q("mi",null,"p"),Q("mi",null,"j")]),Q("mo",{stretchy:"false"},")"),Q("msub",null,[Q("mi",null,"W"),Q("mi",null,"V")]),Q("mstyle",{scriptlevel:"0"},[Q("mspace",{width:"1em"})]),Q("mo",null,"="),Q("msub",null,[Q("mi",null,"f"),Q("mi",null,"v")]),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"x"),Q("mi",null,"j")]),Q("mo",null,","),Q("mi",null,"j"),Q("mo",{stretchy:"false"},")")])]),Q("mtr",null,[Q("mtd",null,[Q("msub",null,[Q("mi",null,"α"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,","),Q("mi",null,"j")])]),Q("mo",null,"="),Q("mtext",null,"softmax"),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"q"),Q("mi",null,"i")]),Q("msubsup",null,[Q("mi",null,"k"),Q("mi",null,"j"),Q("mi",null,"T")]),Q("mo",{stretchy:"false"},")")])]),Q("mtr",null,[Q("mtd",null,[Q("msub",null,[Q("mi",null,"o"),Q("mi",null,"i")]),Q("mo",null,"="),Q("munder",null,[Q("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"j")])]),Q("msub",null,[Q("mi",null,"α"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,","),Q("mi",null,"j")])]),Q("msub",null,[Q("mi",null,"v"),Q("mi",null,"j")])])])])])],-1))]),Q("p",null,[t[223]||(t[223]=T("⭐")),Q("strong",null,[Q("mjx-container",t2,[(l(),a("svg",T2,t[220]||(t[220]=[e("",1)]))),t[221]||(t[221]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"q"),Q("mi",null,"i")]),Q("msubsup",null,[Q("mi",null,"k"),Q("mi",null,"j"),Q("mi",null,"T")])])],-1))]),t[222]||(t[222]=T("展开项"))]),t[224]||(t[224]=T("，")),t[225]||(t[225]=Q("strong",null,"后续相对位置编码都是基于此修改",-1))]),Q("mjx-container",a2,[(l(),a("svg",l2,t[226]||(t[226]=[e("",1)]))),t[227]||(t[227]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mstyle",{mathcolor:"blue"},[Q("mtable",{columnalign:"left left",columnspacing:"1em",rowspacing:"4pt"},[Q("mtr",null,[Q("mtd",null,[Q("msub",null,[Q("mi",null,"q"),Q("mi",null,"i")]),Q("msubsup",null,[Q("mi",null,"k"),Q("mi",null,"j"),Q("mi",null,"T")])]),Q("mtd",null,[Q("mo",null,"="),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"x"),Q("mi",null,"i")]),Q("mo",null,"+"),Q("msub",null,[Q("mi",null,"p"),Q("mi",null,"i")]),Q("mo",{stretchy:"false"},")"),Q("msub",null,[Q("mi",null,"W"),Q("mi",null,"Q")]),Q("mo",null,"⋅"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mo",{minsize:"2.047em",maxsize:"2.047em"},"(")]),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"x"),Q("mi",null,"j")]),Q("mo",null,"+"),Q("msub",null,[Q("mi",null,"p"),Q("mi",null,"j")]),Q("mo",{stretchy:"false"},")"),Q("msub",null,[Q("mi",null,"W"),Q("mi",null,"K")]),Q("msup",null,[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mo",{minsize:"2.047em",maxsize:"2.047em"},")")]),Q("mi",null,"T")])])]),Q("mtr",null,[Q("mtd"),Q("mtd",null,[Q("mo",null,"="),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"x"),Q("mi",null,"i")]),Q("mo",null,"+"),Q("msub",null,[Q("mi",null,"p"),Q("mi",null,"i")]),Q("mo",{stretchy:"false"},")"),Q("msub",null,[Q("mi",null,"W"),Q("mi",null,"Q")]),Q("mo",null,"⋅"),Q("msubsup",null,[Q("mi",null,"W"),Q("mi",null,"K"),Q("mi",null,"T")]),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"x"),Q("mi",null,"j")]),Q("mo",null,"+"),Q("msub",null,[Q("mi",null,"p"),Q("mi",null,"j")]),Q("msup",null,[Q("mo",{stretchy:"false"},")"),Q("mi",null,"T")])])]),Q("mtr",null,[Q("mtd"),Q("mtd",null,[Q("mo",null,"="),Q("mstyle",{mathcolor:"red"},[Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"x"),Q("mi",null,"i")]),Q("msub",null,[Q("mi",null,"W"),Q("mi",null,"Q")]),Q("mo",null,"+"),Q("msub",null,[Q("mi",null,"p"),Q("mi",null,"i")]),Q("msub",null,[Q("mi",null,"W"),Q("mi",null,"Q")]),Q("mo",{stretchy:"false"},")"),Q("mo",null,"⋅"),Q("mo",{stretchy:"false"},"("),Q("msubsup",null,[Q("mi",null,"W"),Q("mi",null,"K"),Q("mi",null,"T")]),Q("msubsup",null,[Q("mi",null,"x"),Q("mi",null,"j"),Q("mi",null,"T")]),Q("mo",null,"+"),Q("msubsup",null,[Q("mi",null,"W"),Q("mi",null,"K"),Q("mi",null,"T")]),Q("msubsup",null,[Q("mi",null,"p"),Q("mi",null,"j"),Q("mi",null,"T")]),Q("mo",{stretchy:"false"},")")])])]),Q("mtr",null,[Q("mtd"),Q("mtd",null,[Q("mo",null,"="),Q("munder",null,[Q("mrow",{"data-mjx-texclass":"OP"},[Q("munder",null,[Q("mrow",null,[Q("msub",null,[Q("mi",null,"x"),Q("mi",null,"i")]),Q("msub",null,[Q("mi",null,"W"),Q("mi",null,"Q")]),Q("msubsup",null,[Q("mi",null,"W"),Q("mi",null,"K"),Q("mi",null,"T")]),Q("msubsup",null,[Q("mi",null,"x"),Q("mi",null,"j"),Q("mi",null,"T")])]),Q("mo",null,"⏟")])]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mstyle",{mathcolor:"red"},[Q("mi",{mathvariant:"normal"},"输"),Q("mi",{mathvariant:"normal"},"入"),Q("mi",null,"i"),Q("mo",null,"−"),Q("mi",{mathvariant:"normal"},"输"),Q("mi",{mathvariant:"normal"},"入"),Q("mi",null,"j")])])]),Q("mo",null,"+"),Q("munder",null,[Q("mrow",{"data-mjx-texclass":"OP"},[Q("munder",null,[Q("mrow",null,[Q("msub",null,[Q("mi",null,"x"),Q("mi",null,"i")]),Q("msub",null,[Q("mi",null,"W"),Q("mi",null,"Q")]),Q("msubsup",null,[Q("mi",null,"W"),Q("mi",null,"K"),Q("mi",null,"T")]),Q("msubsup",null,[Q("mi",null,"p"),Q("mi",null,"j"),Q("mi",null,"T")])]),Q("mo",null,"⏟")])]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mstyle",{mathcolor:"red"},[Q("mi",{mathvariant:"normal"},"输"),Q("mi",{mathvariant:"normal"},"入"),Q("mi",null,"i"),Q("mo",null,"−"),Q("mi",{mathvariant:"normal"},"位"),Q("mi",{mathvariant:"normal"},"置"),Q("mi",null,"j")])])]),Q("mo",null,"+"),Q("munder",null,[Q("mrow",{"data-mjx-texclass":"OP"},[Q("munder",null,[Q("mrow",null,[Q("msub",null,[Q("mi",null,"p"),Q("mi",null,"i")]),Q("msub",null,[Q("mi",null,"W"),Q("mi",null,"Q")]),Q("msubsup",null,[Q("mi",null,"W"),Q("mi",null,"K"),Q("mi",null,"T")]),Q("msubsup",null,[Q("mi",null,"x"),Q("mi",null,"j"),Q("mi",null,"T")])]),Q("mo",null,"⏟")])]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mstyle",{mathcolor:"red"},[Q("mi",{mathvariant:"normal"},"位"),Q("mi",{mathvariant:"normal"},"置"),Q("mi",null,"i"),Q("mo",null,"−"),Q("mi",{mathvariant:"normal"},"输"),Q("mi",{mathvariant:"normal"},"入"),Q("mi",null,"j")])])]),Q("mo",null,"+"),Q("mstyle",{mathcolor:"red"},[Q("munder",null,[Q("mrow",{"data-mjx-texclass":"OP"},[Q("munder",null,[Q("mrow",null,[Q("msub",null,[Q("mi",null,"p"),Q("mi",null,"i")]),Q("msub",null,[Q("mi",null,"W"),Q("mi",null,"Q")]),Q("msubsup",null,[Q("mi",null,"W"),Q("mi",null,"K"),Q("mi",null,"T")]),Q("msubsup",null,[Q("mi",null,"p"),Q("mi",null,"j"),Q("mi",null,"T")])]),Q("mo",null,"⏟")])]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{mathvariant:"normal"},"位"),Q("mi",{mathvariant:"normal"},"置"),Q("mi",null,"i"),Q("mo",null,"−"),Q("mi",{mathvariant:"normal"},"位"),Q("mi",{mathvariant:"normal"},"置"),Q("mi",null,"j")])])])])])])])])],-1))])]),Q("div",e2,[t[309]||(t[309]=Q("div",{class:"custom-block-title"},"相对位置编码",-1)),t[310]||(t[310]=Q("p",null,[T("🧠 ​"),Q("strong",null,"1、经典相对位置编码核心思想")],-1)),Q("ul",null,[Q("li",null,[t[238]||(t[238]=Q("p",null,[Q("strong",null,"核心")],-1)),Q("ul",null,[t[237]||(t[237]=Q("li",null,"从绝对位置attention公式出发",-1)),Q("li",null,[Q("mark",null,[t[233]||(t[233]=T("去掉")),Q("mjx-container",s2,[(l(),a("svg",o2,t[229]||(t[229]=[e("",1)]))),t[230]||(t[230]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"p"),Q("mi",null,"j")])])],-1))]),t[234]||(t[234]=T("及复杂内容, 由二元位置向量")),Q("mjx-container",n2,[(l(),a("svg",m2,t[231]||(t[231]=[e("",1)]))),t[232]||(t[232]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"R"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,","),Q("mi",null,"j")])])])],-1))]),t[235]||(t[235]=T("来代替"))]),t[236]||(t[236]=T("，主要在softmax和v加权里变换。"))])])]),Q("li",null,[Q("p",null,[t[245]||(t[245]=T("💥")),Q("strong",null,[t[241]||(t[241]=T("相对位置")),Q("mjx-container",r2,[(l(),a("svg",d2,t[239]||(t[239]=[e("",1)]))),t[240]||(t[240]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"R"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,","),Q("mi",null,"j")])])])],-1))])]),t[246]||(t[246]=T(" ：")),Q("mark",null,[t[244]||(t[244]=T("只依赖相对距离")),Q("mjx-container",i2,[(l(),a("svg",h2,t[242]||(t[242]=[e("",1)]))),t[243]||(t[243]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"i"),Q("mo",null,"−"),Q("mi",null,"j")])],-1))])]),t[247]||(t[247]=T("，再进行截断，缩小至")),t[248]||(t[248]=Q("strong",null,"有限范围",-1)),t[249]||(t[249]=T(" ❤️。"))]),Q("ul",null,[t[253]||(t[253]=Q("li",null,"Clip裁切：把相对距离缩短至有限范围。",-1)),Q("li",null,[Q("mjx-container",p2,[(l(),a("svg",g2,t[250]||(t[250]=[e("",1)]))),t[251]||(t[251]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("msub",null,[Q("mi",{mathvariant:"bold"},"p"),Q("mi",{mathvariant:"bold"},"k")]),Q("mo",{mathvariant:"bold"},","),Q("msub",null,[Q("mi",{mathvariant:"bold"},"p"),Q("mi",{mathvariant:"bold"},"v")])])])],-1))]),t[252]||(t[252]=T("：位置向量"))])])])]),Q("mjx-container",H2,[(l(),a("svg",u2,t[254]||(t[254]=[e("",1)]))),t[255]||(t[255]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mstyle",{mathcolor:"blue"},[Q("mtable",{columnalign:"left left",columnspacing:"1em",rowspacing:"4pt"},[Q("mtr",null,[Q("mtd",null,[Q("msubsup",null,[Q("mi",null,"R"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,","),Q("mi",null,"j")]),Q("mi",null,"K")]),Q("mo",null,"="),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("msub",null,[Q("mi",{mathvariant:"bold"},"p"),Q("mi",{mathvariant:"bold"},"k")])]),Q("mo",{stretchy:"false"},"["),Q("mtext",null,"clip"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"i"),Q("mo",null,"−"),Q("mi",null,"j"),Q("mo",null,","),Q("msub",null,[Q("mi",null,"p"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"m"),Q("mi",null,"i"),Q("mi",null,"n")])]),Q("mo",null,","),Q("msub",null,[Q("mi",null,"p"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"m"),Q("mi",null,"a"),Q("mi",null,"x")])]),Q("mo",{stretchy:"false"},")"),Q("mo",{stretchy:"false"},"]")])]),Q("mtr",null,[Q("mtd",null,[Q("msubsup",null,[Q("mi",null,"R"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,","),Q("mi",null,"j")]),Q("mi",null,"V")]),Q("mo",null,"="),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("msub",null,[Q("mi",{mathvariant:"bold"},"p"),Q("mi",{mathvariant:"bold"},"v")])]),Q("mo",{stretchy:"false"},"["),Q("mtext",null,"clip"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"i"),Q("mo",null,"−"),Q("mi",null,"j"),Q("mo",null,","),Q("msub",null,[Q("mi",null,"p"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"m"),Q("mi",null,"i"),Q("mi",null,"n")])]),Q("mo",null,","),Q("msub",null,[Q("mi",null,"p"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"m"),Q("mi",null,"a"),Q("mi",null,"x")])]),Q("mo",{stretchy:"false"},")"),Q("mo",{stretchy:"false"},"]")])])])])])],-1))]),t[311]||(t[311]=Q("ul",null,[Q("li",null,[Q("strong",null,"优点"),Q("ul",null,[Q("li",null,[Q("strong",null,"只需要有有限个位置向量，即可表示任意相对位置(因为进行了截断)"),T(" 👍")])])])],-1)),t[312]||(t[312]=Q("p",null,[Q("strong",null,"2、XLNet式相对位置编码")],-1)),Q("ul",null,[Q("li",null,[t[285]||(t[285]=Q("strong",null,"核心",-1)),Q("ul",null,[Q("li",null,[t[273]||(t[273]=T("从公式")),Q("mjx-container",w2,[(l(),a("svg",x2,t[256]||(t[256]=[e("",1)]))),t[257]||(t[257]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("msub",null,[Q("mi",{mathvariant:"bold"},"q"),Q("mi",{mathvariant:"bold"},"i")]),Q("msubsup",null,[Q("mi",{mathvariant:"bold"},"k"),Q("mi",{mathvariant:"bold"},"j"),Q("mi",{mathvariant:"bold"},"T")])])])],-1))]),t[274]||(t[274]=T("展开，")),Q("mark",null,[t[268]||(t[268]=T("把")),Q("mjx-container",c2,[(l(),a("svg",L2,t[258]||(t[258]=[e("",1)]))),t[259]||(t[259]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"p"),Q("mi",null,"j")])])],-1))]),t[269]||(t[269]=T(" 改成相对位置向量")),Q("mjx-container",f2,[(l(),a("svg",M2,t[260]||(t[260]=[e("",1)]))),t[261]||(t[261]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"R"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,"−"),Q("mi",null,"j")])])])],-1))]),t[270]||(t[270]=T("， 把2个")),Q("mjx-container",k2,[(l(),a("svg",y2,t[262]||(t[262]=[e("",1)]))),t[263]||(t[263]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"p"),Q("mi",null,"i")])])],-1))]),t[271]||(t[271]=T("替换为可训练向量")),Q("mjx-container",V2,[(l(),a("svg",Z2,t[264]||(t[264]=[Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D462",d:"M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z",style:{"stroke-width":"3"}})])])],-1)]))),t[265]||(t[265]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"u")])],-1))]),t[272]||(t[272]=T("和")),Q("mjx-container",b2,[(l(),a("svg",v2,t[266]||(t[266]=[Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D463",d:"M173 380Q173 405 154 405Q130 405 104 376T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Q21 294 29 316T53 368T97 419T160 441Q202 441 225 417T249 361Q249 344 246 335Q246 329 231 291T200 202T182 113Q182 86 187 69Q200 26 250 26Q287 26 319 60T369 139T398 222T409 277Q409 300 401 317T383 343T365 361T357 383Q357 405 376 424T417 443Q436 443 451 425T467 367Q467 340 455 284T418 159T347 40T241 -11Q177 -11 139 22Q102 54 102 117Q102 148 110 181T151 298Q173 362 173 380Z",style:{"stroke-width":"3"}})])])],-1)]))),t[267]||(t[267]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"v")])],-1))])])]),Q("li",null,[Q("mjx-container",D2,[(l(),a("svg",_2,t[275]||(t[275]=[e("",1)]))),t[276]||(t[276]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"R"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,"−"),Q("mi",null,"j")])])])],-1))]),t[277]||(t[277]=T("不做截断，用了Sinusoidal式的生成方案。"))]),Q("li",null,[Q("strong",null,[Q("mjx-container",A2,[(l(),a("svg",j2,t[278]||(t[278]=[e("",1)]))),t[279]||(t[279]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"v"),Q("mi",null,"j")])])],-1))]),t[280]||(t[280]=T("加权时不再需要位置偏置"))]),t[283]||(t[283]=T("，直接是")),Q("mjx-container",C2,[(l(),a("svg",S2,t[281]||(t[281]=[e("",1)]))),t[282]||(t[282]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"o"),Q("mi",null,"i")]),Q("mo",null,"="),Q("munder",null,[Q("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),Q("mi",null,"j")]),Q("msub",null,[Q("mi",null,"α"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,","),Q("mi",null,"j")])]),Q("mtext",null," "),Q("msub",null,[Q("mi",null,"x"),Q("mi",null,"j")]),Q("mtext",null," "),Q("msub",null,[Q("mi",null,"W"),Q("mi",null,"v")])])],-1))])]),t[284]||(t[284]=Q("li",null,[Q("mark",null,"后期工作相对位置只在attention权重上计算，不在v上了"),T("。")],-1))])])]),t[313]||(t[313]=Q("p",null,[Q("strong",null,"3、T5")],-1)),Q("ul",null,[Q("li",null,[Q("p",null,[t[288]||(t[288]=Q("strong",null,"核心",-1)),t[289]||(t[289]=T("：从")),Q("mjx-container",E2,[(l(),a("svg",P2,t[286]||(t[286]=[e("",1)]))),t[287]||(t[287]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("msub",null,[Q("mi",{mathvariant:"bold"},"q"),Q("mi",{mathvariant:"bold"},"i")]),Q("msubsup",null,[Q("mi",{mathvariant:"bold"},"k"),Q("mi",{mathvariant:"bold"},"j"),Q("mi",{mathvariant:"bold"},"T")])])])],-1))]),t[290]||(t[290]=T("展开出发做简化。认为输入和位置当解耦不做交互，直接删掉很多项，增加相对位置编码可训练参数"))]),Q("mjx-container",R2,[(l(),a("svg",B2,t[291]||(t[291]=[e("",1)]))),t[292]||(t[292]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mstyle",{mathcolor:"blue"},[Q("msub",null,[Q("mi",null,"q"),Q("mi",null,"i")]),Q("msubsup",null,[Q("mi",null,"k"),Q("mi",null,"j"),Q("mi",null,"T")]),Q("mo",null,"="),Q("msub",null,[Q("mi",null,"x"),Q("mi",null,"i")]),Q("msub",null,[Q("mi",null,"W"),Q("mi",null,"Q")]),Q("msubsup",null,[Q("mi",null,"W"),Q("mi",null,"K"),Q("mi",null,"T")]),Q("msub",null,[Q("mi",null,"x"),Q("mi",null,"j")]),Q("mo",null,"+"),Q("mstyle",{mathcolor:"red"},[Q("msub",null,[Q("mi",null,"β"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,","),Q("mi",null,"j")])])])])])],-1))])]),Q("li",null,[Q("p",null,[Q("mjx-container",N2,[(l(),a("svg",I2,t[293]||(t[293]=[e("",1)]))),t[294]||(t[294]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"β"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,","),Q("mi",null,"j")])])])],-1))]),t[301]||(t[301]=T("不做")),Q("mjx-container",O2,[(l(),a("svg",z2,t[295]||(t[295]=[e("",1)]))),t[296]||(t[296]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"i"),Q("mo",null,"−"),Q("mi",null,"j")])],-1))]),t[302]||(t[302]=T("截断，做分桶处理，相对位置")),Q("mjx-container",q2,[(l(),a("svg",G2,t[297]||(t[297]=[e("",1)]))),t[298]||(t[298]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"i"),Q("mo",null,"−"),Q("mi",null,"j")])],-1))]),t[303]||(t[303]=T("对应")),Q("mjx-container",J2,[(l(),a("svg",F2,t[299]||(t[299]=[e("",1)]))),t[300]||(t[300]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"f"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"i"),Q("mo",null,"−"),Q("mi",null,"j"),Q("mo",{stretchy:"false"},")")])],-1))]),t[304]||(t[304]=T("。近的位置使用独立精细编码，越远越共用一个位置编码。"))])])]),t[314]||(t[314]=Q("p",null,[Q("strong",null,"4、Deberta式")],-1)),Q("ul",null,[Q("li",null,[t[307]||(t[307]=T("核心：从")),Q("mjx-container",X2,[(l(),a("svg",K2,t[305]||(t[305]=[e("",1)]))),t[306]||(t[306]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"q"),Q("mi",null,"i")]),Q("msubsup",null,[Q("mi",null,"k"),Q("mi",null,"j"),Q("mi",null,"T")])])],-1))]),t[308]||(t[308]=T("出发，扔掉第4项，保留2、3项并改为相对位置编码。"))])])]),t[441]||(t[441]=e("",4)),Q("div",W2,[t[399]||(t[399]=Q("div",{class:"custom-block-title"},"RoPE",-1)),t[400]||(t[400]=Q("p",null,[T("🌟"),Q("strong",null,"核心思想")],-1)),Q("ul",null,[t[332]||(t[332]=Q("li",null,[Q("strong",null,"RoPE位置编码通过将一个向量旋转某个角度，为其赋予位置信息"),T("。")],-1)),t[333]||(t[333]=Q("li",null,[T("RoPE"),Q("strong",null,"通过绝对位置方式实现相对位置编码"),T("😍， 综合了绝对和相对的优点。")],-1)),Q("li",null,[t[327]||(t[327]=T("为")),Q("mjx-container",U2,[(l(),a("svg",$2,t[315]||(t[315]=[Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D45E",d:"M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z",style:{"stroke-width":"3"}})])])],-1)]))),t[316]||(t[316]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"q")])],-1))]),t[328]||(t[328]=T("、")),Q("mjx-container",Y2,[(l(),a("svg",Q3,t[317]||(t[317]=[Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D458",d:"M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z",style:{"stroke-width":"3"}})])])],-1)]))),t[318]||(t[318]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"k")])],-1))]),t[329]||(t[329]=T("向量")),Q("strong",null,[t[323]||(t[323]=T("注入绝对位置信息")),Q("mjx-container",t3,[(l(),a("svg",T3,t[319]||(t[319]=[Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D456",d:"M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z",style:{"stroke-width":"3"}})])])],-1)]))),t[320]||(t[320]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"i")])],-1))]),t[324]||(t[324]=T(",")),Q("mjx-container",a3,[(l(),a("svg",l3,t[321]||(t[321]=[Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D457",d:"M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z",style:{"stroke-width":"3"}})])])],-1)]))),t[322]||(t[322]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"j")])],-1))])]),t[330]||(t[330]=T(" (注：很多文章使用的是m和n，这里为了保持和上文一致所以使用")),Q("mjx-container",e3,[(l(),a("svg",s3,t[325]||(t[325]=[e("",1)]))),t[326]||(t[326]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"i"),Q("mo",null,","),Q("mi",null,"j")])],-1))]),t[331]||(t[331]=T(")"))])]),Q("mjx-container",o3,[(l(),a("svg",n3,t[334]||(t[334]=[e("",1)]))),t[335]||(t[335]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("msub",null,[Q("mi",null,"q"),Q("mi",null,"i")]),Q("mo",null,"="),Q("msub",null,[Q("mi",null,"f"),Q("mi",null,"q")]),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"q"),Q("mi",null,"i")]),Q("mo",null,","),Q("mi",null,"i"),Q("mo",{stretchy:"false"},")"),Q("mo",null,","),Q("mstyle",{scriptlevel:"0"},[Q("mspace",{width:"1em"})]),Q("msub",null,[Q("mi",null,"k"),Q("mi",null,"j")]),Q("mo",null,"="),Q("msub",null,[Q("mi",null,"f"),Q("mi",null,"k")]),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"k"),Q("mi",null,"j")]),Q("mo",null,","),Q("mi",null,"j"),Q("mo",{stretchy:"false"},")")])],-1))]),Q("ul",null,[Q("li",null,[Q("strong",null,[Q("mjx-container",m3,[(l(),a("svg",r3,t[336]||(t[336]=[e("",1)]))),t[337]||(t[337]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"q"),Q("mi",null,"i")])])],-1))]),t[342]||(t[342]=T(" 和 ")),Q("mjx-container",d3,[(l(),a("svg",i3,t[338]||(t[338]=[e("",1)]))),t[339]||(t[339]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"k"),Q("mi",null,"j")])])],-1))]),t[343]||(t[343]=T(" 向量内积时，带上相对位置信息")),Q("mjx-container",h3,[(l(),a("svg",p3,t[340]||(t[340]=[e("",1)]))),t[341]||(t[341]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"i"),Q("mo",null,"−"),Q("mi",null,"j")])],-1))])])])]),Q("mjx-container",g3,[(l(),a("svg",H3,t[344]||(t[344]=[e("",1)]))),t[345]||(t[345]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mi",null,"q"),Q("mo",null,"⋅"),Q("mi",null,"k"),Q("mo",null,"="),Q("mi",null,"f"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"q"),Q("mo",null,","),Q("mi",null,"i"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"⋅"),Q("mi",null,"f"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"k"),Q("mo",null,","),Q("mi",null,"j"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("mstyle",{mathcolor:"red"},[Q("mi",null,"g"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"q"),Q("mo",null,","),Q("mi",null,"k"),Q("mo",null,","),Q("mi",null,"i"),Q("mo",null,"−"),Q("mi",null,"j"),Q("mo",{stretchy:"false"},")")])])],-1))]),t[401]||(t[401]=Q("p",null,[Q("strong",null,"推导过程")],-1)),Q("ul",null,[Q("li",null,[t[382]||(t[382]=Q("p",null,"通过复数方程找到使等式成立的g函数，最终求解得到",-1)),Q("ul",null,[Q("li",null,[t[350]||(t[350]=T("💥")),Q("mjx-container",u3,[(l(),a("svg",w3,t[346]||(t[346]=[e("",1)]))),t[347]||(t[347]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mstyle",{mathcolor:"blue"},[Q("mi",null,"f"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"q"),Q("mo",null,","),Q("mi",null,"m"),Q("mo",{stretchy:"false"},")")])])],-1))]),t[351]||(t[351]=T("公式，")),t[352]||(t[352]=Q("strong",null,"绝对位置编码",-1)),t[353]||(t[353]=T(" (假设是q是二维向量, ")),Q("mjx-container",x3,[(l(),a("svg",c3,t[348]||(t[348]=[Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D703",d:"M35 200Q35 302 74 415T180 610T319 704Q320 704 327 704T339 705Q393 701 423 656Q462 596 462 495Q462 380 417 261T302 66T168 -10H161Q125 -10 99 10T60 63T41 130T35 200ZM383 566Q383 668 330 668Q294 668 260 623T204 521T170 421T157 371Q206 370 254 370L351 371Q352 372 359 404T375 484T383 566ZM113 132Q113 26 166 26Q181 26 198 36T239 74T287 161T335 307L340 324H145Q145 321 136 286T120 208T113 132Z",style:{"stroke-width":"3"}})])])],-1)]))),t[349]||(t[349]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"θ")])],-1))]),t[354]||(t[354]=T("是常数)"))])]),Q("mjx-container",L3,[(l(),a("svg",f3,t[355]||(t[355]=[e("",1)]))),t[356]||(t[356]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mstyle",{mathcolor:"blue"},[Q("mi",null,"f"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"q"),Q("mo",null,","),Q("mi",null,"i"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("mi",null,"f"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"q"),Q("mo",null,","),Q("mi",null,"m"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("mstyle",{mathcolor:"red"},[Q("msub",null,[Q("mi",null,"R"),Q("mi",null,"m")]),Q("mo",null,"⋅"),Q("mi",null,"q")]),Q("mo",null,"="),Q("mstyle",{mathcolor:"red"},[Q("munder",null,[Q("mrow",{"data-mjx-texclass":"OP"},[Q("munder",null,[Q("mrow",{"data-mjx-texclass":"INNER"},[Q("mo",{"data-mjx-texclass":"OPEN"},"("),Q("mtable",{columnalign:"left left",columnspacing:"1em",rowspacing:"4pt"},[Q("mtr",null,[Q("mtd",null,[Q("mi",null,"cos"),Q("mo",{"data-mjx-texclass":"NONE"},"⁡"),Q("mi",null,"m"),Q("mi",null,"θ")]),Q("mtd",null,[Q("mo",null,"−"),Q("mi",null,"sin"),Q("mo",{"data-mjx-texclass":"NONE"},"⁡"),Q("mi",null,"m"),Q("mi",null,"θ")])]),Q("mtr",null,[Q("mtd",null,[Q("mi",null,"sin"),Q("mo",{"data-mjx-texclass":"NONE"},"⁡"),Q("mi",null,"m"),Q("mi",null,"θ")]),Q("mtd",null,[Q("mo",null,"−"),Q("mi",null,"cos"),Q("mo",{"data-mjx-texclass":"NONE"},"⁡"),Q("mi",null,"m"),Q("mi",null,"θ")])])]),Q("mo",{"data-mjx-texclass":"CLOSE"},")")]),Q("mo",null,"⏟")])]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mtext",null,"旋转矩阵")])]),Q("mo",null,"⋅"),Q("munder",null,[Q("mrow",{"data-mjx-texclass":"OP"},[Q("munder",null,[Q("mrow",{"data-mjx-texclass":"INNER"},[Q("mo",{"data-mjx-texclass":"OPEN"},"("),Q("mtable",{columnalign:"left",columnspacing:"1em",rowspacing:"4pt"},[Q("mtr",null,[Q("mtd",null,[Q("msub",null,[Q("mi",null,"q"),Q("mn",null,"0")])])]),Q("mtr",null,[Q("mtd",null,[Q("msub",null,[Q("mi",null,"q"),Q("mn",null,"1")])])])]),Q("mo",{"data-mjx-texclass":"CLOSE"},")")]),Q("mo",null,"⏟")])]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"q"),Q("mi",{mathvariant:"normal"},"向"),Q("mi",{mathvariant:"normal"},"量")])])])])])],-1))]),Q("ul",null,[Q("li",null,[t[359]||(t[359]=T("💥 ")),Q("mjx-container",M3,[(l(),a("svg",k3,t[357]||(t[357]=[e("",1)]))),t[358]||(t[358]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mstyle",{mathcolor:"blue"},[Q("mi",null,"g"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"q"),Q("mo",null,","),Q("mi",null,"k"),Q("mo",null,","),Q("mi",null,"m"),Q("mo",null,"−"),Q("mi",null,"n"),Q("mo",{stretchy:"false"},")")])])],-1))]),t[360]||(t[360]=T(" 公式，")),t[361]||(t[361]=Q("strong",null,"相对位置融入",-1))])]),Q("mjx-container",y3,[(l(),a("svg",V3,t[362]||(t[362]=[e("",1)]))),t[363]||(t[363]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mstyle",{mathcolor:"blue"},[Q("mi",null,"q"),Q("mo",null,"⋅"),Q("mi",null,"k"),Q("mo",null,"="),Q("mi",null,"g"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"q"),Q("mo",null,","),Q("mi",null,"k"),Q("mo",null,","),Q("mi",null,"m"),Q("mo",null,"−"),Q("mi",null,"n"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("msub",null,[Q("mi",null,"q"),Q("mi",null,"m")]),Q("mo",null,"⋅"),Q("msubsup",null,[Q("mi",null,"k"),Q("mi",null,"n"),Q("mi",null,"T")]),Q("mo",null,"="),Q("mo",null,"⋯"),Q("mo",null,"="),Q("mstyle",{mathcolor:"red"},[Q("msup",null,[Q("mi",null,"q"),Q("mi",null,"T")]),Q("msub",null,[Q("mi",null,"R"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"m"),Q("mo",null,"−"),Q("mi",null,"n")])]),Q("mi",null,"k")])])])],-1))]),Q("ul",null,[t[381]||(t[381]=Q("li",null,"多维向量旋转：多维向量，两两一组，分别旋转，得到旋转公式。",-1)),Q("li",null,[t[378]||(t[378]=Q("strong",null,"远程衰减",-1)),t[379]||(t[379]=T("：")),Q("mjx-container",Z3,[(l(),a("svg",b3,t[364]||(t[364]=[e("",1)]))),t[365]||(t[365]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"θ"),Q("mi",null,"i")]),Q("mo",null,"="),Q("msup",null,[Q("mn",null,"10000"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mo",null,"−"),Q("mn",null,"2"),Q("mi",null,"i"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mo",null,"/")]),Q("mi",null,"d")])])])],-1))]),t[380]||(t[380]=T("。 ")),Q("ul",null,[Q("li",null,[t[375]||(t[375]=T("相反，如果")),Q("mjx-container",v3,[(l(),a("svg",D3,t[366]||(t[366]=[Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D703",d:"M35 200Q35 302 74 415T180 610T319 704Q320 704 327 704T339 705Q393 701 423 656Q462 596 462 495Q462 380 417 261T302 66T168 -10H161Q125 -10 99 10T60 63T41 130T35 200ZM383 566Q383 668 330 668Q294 668 260 623T204 521T170 421T157 371Q206 370 254 370L351 371Q352 372 359 404T375 484T383 566ZM113 132Q113 26 166 26Q181 26 198 36T239 74T287 161T335 307L340 324H145Q145 321 136 286T120 208T113 132Z",style:{"stroke-width":"3"}})])])],-1)]))),t[367]||(t[367]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"θ")])],-1))]),t[376]||(t[376]=T("是1，")),Q("strong",null,[t[372]||(t[372]=T("随着")),Q("mjx-container",_3,[(l(),a("svg",A3,t[368]||(t[368]=[e("",1)]))),t[369]||(t[369]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"i"),Q("mo",null,"−"),Q("mi",null,"j")])],-1))]),t[373]||(t[373]=T("距离增加，")),Q("mjx-container",j3,[(l(),a("svg",C3,t[370]||(t[370]=[e("",1)]))),t[371]||(t[371]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"q"),Q("mi",null,"i")]),Q("mo",null,"⋅"),Q("msub",null,[Q("mi",null,"k"),Q("mi",null,"j")])])],-1))]),t[374]||(t[374]=T("内积会震荡不会远程衰减"))]),t[377]||(t[377]=T("，这就是问题。"))])])])])])]),t[402]||(t[402]=Q("p",null,[Q("strong",null,"旋转矩阵")],-1)),Q("ul",null,[Q("li",null,[t[391]||(t[391]=T("二维空间存在旋转矩阵")),Q("mjx-container",S3,[(l(),a("svg",E3,t[383]||(t[383]=[e("",1)]))),t[384]||(t[384]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"M"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"θ"),Q("mo",{stretchy:"false"},")")])],-1))]),t[392]||(t[392]=T("，二维向量左乘")),Q("mjx-container",P3,[(l(),a("svg",R3,t[385]||(t[385]=[e("",1)]))),t[386]||(t[386]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"M"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"θ"),Q("mo",{stretchy:"false"},")")])],-1))]),t[393]||(t[393]=T("，相当于")),Q("strong",null,[t[389]||(t[389]=T("逆时针旋转")),Q("mjx-container",B3,[(l(),a("svg",N3,t[387]||(t[387]=[Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D703",d:"M35 200Q35 302 74 415T180 610T319 704Q320 704 327 704T339 705Q393 701 423 656Q462 596 462 495Q462 380 417 261T302 66T168 -10H161Q125 -10 99 10T60 63T41 130T35 200ZM383 566Q383 668 330 668Q294 668 260 623T204 521T170 421T157 371Q206 370 254 370L351 371Q352 372 359 404T375 484T383 566ZM113 132Q113 26 166 26Q181 26 198 36T239 74T287 161T335 307L340 324H145Q145 321 136 286T120 208T113 132Z",style:{"stroke-width":"3"}})])])],-1)]))),t[388]||(t[388]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"θ")])],-1))]),t[390]||(t[390]=T("弧度"))]),t[394]||(t[394]=T("。")),t[395]||(t[395]=Q("code",null,"RoPE",-1)),t[396]||(t[396]=T("旋转编码名称的来源。"))])]),Q("mjx-container",I3,[(l(),a("svg",O3,t[397]||(t[397]=[e("",1)]))),t[398]||(t[398]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mi",null,"M"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"θ"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("mrow",{"data-mjx-texclass":"INNER"},[Q("mo",{"data-mjx-texclass":"OPEN"},"("),Q("mtable",{columnalign:"left left",columnspacing:"1em",rowspacing:"4pt"},[Q("mtr",null,[Q("mtd",null,[Q("mi",null,"cos"),Q("mo",{"data-mjx-texclass":"NONE"},"⁡"),Q("mi",null,"θ")]),Q("mtd",null,[Q("mo",null,"−"),Q("mi",null,"sin"),Q("mo",{"data-mjx-texclass":"NONE"},"⁡"),Q("mi",null,"θ")])]),Q("mtr",null,[Q("mtd",null,[Q("mi",null,"sin"),Q("mo",{"data-mjx-texclass":"NONE"},"⁡"),Q("mi",null,"θ")]),Q("mtd",null,[Q("mo",null,"−"),Q("mi",null,"cos"),Q("mo",{"data-mjx-texclass":"NONE"},"⁡"),Q("mi",null,"θ")])])]),Q("mo",{"data-mjx-texclass":"CLOSE"},")")])])],-1))]),t[403]||(t[403]=Q("ul",null,[Q("li",null,"只要对向量进行旋转，就能添加对应的位置信息，且具有周期性。")],-1))]),t[442]||(t[442]=Q("img",{src:"https://pic4.zhimg.com/v2-7a27119e4fe9272ce6c26450ad8070ad_1440w.jpg",style:{display:"block",margin:"auto"},width:"80%"},null,-1)),t[443]||(t[443]=Q("h3",{id:"alibi-attention-with-linear-bias",tabindex:"-1"},[T("ALiBi (Attention with Linear Bias) "),Q("a",{class:"header-anchor",href:"#alibi-attention-with-linear-bias","aria-label":'Permalink to "ALiBi (Attention with Linear Bias)"'},"​")],-1)),Q("div",z3,[t[414]||(t[414]=Q("div",{class:"custom-block-title"},"Attention with Linear Bias",-1)),t[415]||(t[415]=Q("p",null,[Q("strong",null,"核心")],-1)),Q("ul",null,[t[412]||(t[412]=Q("li",null,"目的：解决训练推理长度不一致的问题，如 训练 1024，推理 2048",-1)),Q("li",null,[t[408]||(t[408]=T("思想：")),Q("strong",null,[t[406]||(t[406]=T("在")),Q("mjx-container",q3,[(l(),a("svg",G3,t[404]||(t[404]=[e("",1)]))),t[405]||(t[405]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"Q"),Q("msup",null,[Q("mi",null,"K"),Q("mi",null,"T")])])],-1))]),t[407]||(t[407]=T("计算时加一个阈值好的偏置"))]),t[409]||(t[409]=T("，偏置包括了Q和K的")),t[410]||(t[410]=Q("strong",null,"相对位置",-1)),t[411]||(t[411]=T("，相距越远贡献越低。不直接输入位置编码。"))]),t[413]||(t[413]=Q("li",null,"外推性会更好点。",-1))]),t[416]||(t[416]=Q("img",{src:"https://wdndev.github.io/llm_interview_note/02.%E5%A4%A7%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E6%9E%B6%E6%9E%84/3.%E4%BD%8D%E7%BD%AE%E7%BC%96%E7%A0%81/image/image_B907xoFOlR.png",style:{display:"block",margin:"auto"},width:"80%"},null,-1))]),t[444]||(t[444]=e("",6)),Q("mjx-container",J3,[(l(),a("svg",F3,t[417]||(t[417]=[e("",1)]))),t[418]||(t[418]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mi",null,"F"),Q("mi",null,"F"),Q("mi",null,"N"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"x"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("mtext",null,"Linear"),Q("mo",{stretchy:"false"},"("),Q("mtext",null,"ReLU"),Q("mo",{stretchy:"false"},"("),Q("mtext",null,"Linear"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"x"),Q("mo",{stretchy:"false"},")"),Q("mo",{stretchy:"false"},")"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("mstyle",{mathcolor:"red"},[Q("mtext",null,"ReLU"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"x"),Q("msub",null,[Q("mi",null,"W"),Q("mn",null,"1")]),Q("mo",null,"+"),Q("msub",null,[Q("mi",null,"b"),Q("mn",null,"1")]),Q("mo",{stretchy:"false"},")"),Q("mo",null,"⋅"),Q("msub",null,[Q("mi",null,"W"),Q("mn",null,"2")]),Q("mo",null,"+"),Q("msub",null,[Q("mi",null,"b"),Q("mn",null,"2")])])])],-1))]),t[445]||(t[445]=e("",4)),Q("mjx-container",X3,[(l(),a("svg",K3,t[419]||(t[419]=[e("",1)]))),t[420]||(t[420]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mtext",null,"GeLU"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"x"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("mn",null,"0.5"),Q("mo",null,"⋅"),Q("mi",null,"x"),Q("mo",null,"⋅"),Q("mrow",{"data-mjx-texclass":"INNER"},[Q("mo",{"data-mjx-texclass":"OPEN"},"("),Q("mn",null,"1"),Q("mo",null,"+"),Q("mi",null,"tanh"),Q("mo",{"data-mjx-texclass":"NONE"},"⁡"),Q("mo",{stretchy:"false"},"("),Q("msqrt",null,[Q("mfrac",null,[Q("mn",null,"2"),Q("mi",null,"π")])]),Q("mo",null,"⋅"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"x"),Q("mo",null,"+"),Q("mn",null,"0.044715"),Q("mo",null,"⋅"),Q("msup",null,[Q("mi",null,"x"),Q("mn",null,"3")]),Q("mo",{stretchy:"false"},")"),Q("mo",{stretchy:"false"},")"),Q("mo",{"data-mjx-texclass":"CLOSE"},")")])])],-1))]),t[446]||(t[446]=Q("img",{src:"https://wdndev.github.io/llm_interview_note/02.%E5%A4%A7%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E6%9E%B6%E6%9E%84/6.%E6%BF%80%E6%B4%BB%E5%87%BD%E6%95%B0/image/image_IPa0sZKGAr.png",style:{display:"block",margin:"auto"},width:"80%"},null,-1)),t[447]||(t[447]=Q("h3",{id:"swish",tabindex:"-1"},[T("Swish "),Q("a",{class:"header-anchor",href:"#swish","aria-label":'Permalink to "Swish"'},"​")],-1)),Q("ul",null,[t[425]||(t[425]=Q("li",null,"特点：接近0时，像线性函数；远离0时，具有非线性特性。",-1)),t[426]||(t[426]=Q("li",null,"优点：相比ReLU/Tanh等具有更好性能和收敛速度。",-1)),t[427]||(t[427]=Q("li",null,"缺点：计算使用sigmoid，开销大。",-1)),Q("li",null,[t[423]||(t[423]=T("公式如下，")),Q("mjx-container",W3,[(l(),a("svg",U3,t[421]||(t[421]=[Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D6FD",d:"M29 -194Q23 -188 23 -186Q23 -183 102 134T186 465Q208 533 243 584T309 658Q365 705 429 705H431Q493 705 533 667T573 570Q573 465 469 396L482 383Q533 332 533 252Q533 139 448 65T257 -10Q227 -10 203 -2T165 17T143 40T131 59T126 65L62 -188Q60 -194 42 -194H29ZM353 431Q392 431 427 419L432 422Q436 426 439 429T449 439T461 453T472 471T484 495T493 524T501 560Q503 569 503 593Q503 611 502 616Q487 667 426 667Q384 667 347 643T286 582T247 514T224 455Q219 439 186 308T152 168Q151 163 151 147Q151 99 173 68Q204 26 260 26Q302 26 349 51T425 137Q441 171 449 214T457 279Q457 337 422 372Q380 358 347 358H337Q258 358 258 389Q258 396 261 403Q275 431 353 431Z",style:{"stroke-width":"3"}})])])],-1)]))),t[422]||(t[422]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"β")])],-1))]),t[424]||(t[424]=T("是可调节参数。"))])]),Q("mjx-container",$3,[(l(),a("svg",Y3,t[428]||(t[428]=[e("",1)]))),t[429]||(t[429]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mtext",null,"Swish"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"x"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("mi",null,"x"),Q("mo",null,"⋅"),Q("mtext",null,"sigmoid"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"β"),Q("mo",null,"⋅"),Q("mi",null,"x"),Q("mo",{stretchy:"false"},")")])],-1))]),t[448]||(t[448]=e("",17))])}const n4=s(o,[["render",Q4]]);export{o4 as __pageData,n4 as default};

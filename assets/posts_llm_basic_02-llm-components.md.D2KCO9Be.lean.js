import{_ as s,c as a,o as l,ah as e,j as Q,a as T}from"./chunks/framework.CvbyeFFO.js";const q4=JSON.parse('{"title":"语言模型重要组件","description":"","frontmatter":{"title":"语言模型重要组件","date":"2025-07-03T16:48:14.000Z","create":"2025-07-03T16:48:14.000Z","categories":["llm"],"tags":["Attention","MHA","MQA","GQA","Flash Attention","Batch Norm","Layer Norm","RMS Norm","RoPE","GeLU","TopK","TopP","Temperature"]},"headers":[],"relativePath":"posts/llm/basic/02-llm-components.md","filePath":"posts/llm/basic/02-llm-components.md","lastUpdated":1761231250000}'),m={name:"posts/llm/basic/02-llm-components.md"},n={class:"custom-block important"},o={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},d={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"16.395ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 7246.4 1000","aria-hidden":"true"},r={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},i={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"9.589ex",height:"1.439ex",role:"img",focusable:"false",viewBox:"0 -442 4238.3 636","aria-hidden":"true"},h={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},p={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.308ex"},xmlns:"http://www.w3.org/2000/svg",width:"39.658ex",height:"5.741ex",role:"img",focusable:"false",viewBox:"0 -1517.7 17528.7 2537.7","aria-hidden":"true"},g={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},H={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.372ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.128ex",height:"2.398ex",role:"img",focusable:"false",viewBox:"0 -895.6 1824.4 1060","aria-hidden":"true"},u={class:"custom-block warning"},L={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},w={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.198ex",height:"1.927ex",role:"img",focusable:"false",viewBox:"0 -694 971.4 851.8","aria-hidden":"true"},c={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},x={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.65ex"},xmlns:"http://www.w3.org/2000/svg",width:"17.618ex",height:"2.347ex",role:"img",focusable:"false",viewBox:"0 -750 7787.4 1037.2","aria-hidden":"true"},f={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},M={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"14.74ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 6515.3 1000","aria-hidden":"true"},V={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},y={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.651ex"},xmlns:"http://www.w3.org/2000/svg",width:"52.545ex",height:"3.108ex",role:"img",focusable:"false",viewBox:"0 -1086 23224.8 1373.9","aria-hidden":"true"},k={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},Z={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-4.905ex"},xmlns:"http://www.w3.org/2000/svg",width:"58.553ex",height:"10.941ex",role:"img",focusable:"false",viewBox:"0 -2667.9 25880.3 4835.8","aria-hidden":"true"},b={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},v={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.651ex"},xmlns:"http://www.w3.org/2000/svg",width:"28.293ex",height:"3.108ex",role:"img",focusable:"false",viewBox:"0 -1086 12505.4 1373.9","aria-hidden":"true"},D={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},_={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.651ex"},xmlns:"http://www.w3.org/2000/svg",width:"41.345ex",height:"3.108ex",role:"img",focusable:"false",viewBox:"0 -1086 18274.7 1373.9","aria-hidden":"true"},j={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},A={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-16.508ex"},xmlns:"http://www.w3.org/2000/svg",width:"81.565ex",height:"34.147ex",role:"img",focusable:"false",viewBox:"0 -7796.4 36051.9 15092.9","aria-hidden":"true"},C={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},E={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.651ex"},xmlns:"http://www.w3.org/2000/svg",width:"28.293ex",height:"3.108ex",role:"img",focusable:"false",viewBox:"0 -1086 12505.4 1373.9","aria-hidden":"true"},S={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},R={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.651ex"},xmlns:"http://www.w3.org/2000/svg",width:"41.345ex",height:"3.108ex",role:"img",focusable:"false",viewBox:"0 -1086 18274.7 1373.9","aria-hidden":"true"},P={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},B={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.685ex"},xmlns:"http://www.w3.org/2000/svg",width:"54.398ex",height:"3.142ex",role:"img",focusable:"false",viewBox:"0 -1086 24044.1 1388.8","aria-hidden":"true"},N={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},I={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.709ex",height:"1.977ex",role:"img",focusable:"false",viewBox:"0 -716 2523.4 873.8","aria-hidden":"true"},O={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},z={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.811ex",height:"2.032ex",role:"img",focusable:"false",viewBox:"0 -704 1242.4 898","aria-hidden":"true"},q={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},G={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.79ex",height:"2.032ex",role:"img",focusable:"false",viewBox:"0 -704 791 898","aria-hidden":"true"},J={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},X={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.811ex",height:"2.032ex",role:"img",focusable:"false",viewBox:"0 -704 1242.4 898","aria-hidden":"true"},K={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},F={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.725ex",height:"1.984ex",role:"img",focusable:"false",viewBox:"0 -683 2530.6 877","aria-hidden":"true"},W={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},U={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.315ex",height:"1.357ex",role:"img",focusable:"false",viewBox:"0 -442 1023.4 599.8","aria-hidden":"true"},$={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Y={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.471ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.36ex",height:"1.471ex",role:"img",focusable:"false",viewBox:"0 -442 1927.1 650","aria-hidden":"true"},Q1={class:"custom-block danger"},t1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},T1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.435ex",height:"2.032ex",role:"img",focusable:"false",viewBox:"0 -704 2402.4 898","aria-hidden":"true"},a1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},l1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.186ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.023ex",height:"1.505ex",role:"img",focusable:"false",viewBox:"0 -583 1778 665","aria-hidden":"true"},e1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},s1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.023ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.176ex",height:"1.593ex",role:"img",focusable:"false",viewBox:"0 -694 520 704","aria-hidden":"true"},m1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},n1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.023ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.804ex",height:"1.74ex",role:"img",focusable:"false",viewBox:"0 -759 797.5 769","aria-hidden":"true"},o1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},d1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"36.517ex",height:"2.731ex",role:"img",focusable:"false",viewBox:"0 -957 16140.7 1207","aria-hidden":"true"},r1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},i1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.225ex",height:"2.009ex",role:"img",focusable:"false",viewBox:"0 -694 1425.7 888","aria-hidden":"true"},h1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},p1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.854ex",height:"2.009ex",role:"img",focusable:"false",viewBox:"0 -694 1703.4 888","aria-hidden":"true"},g1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},H1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.023ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.176ex",height:"1.593ex",role:"img",focusable:"false",viewBox:"0 -694 520 704","aria-hidden":"true"},u1={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},L1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"26.44ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 11686.7 1000","aria-hidden":"true"},w1={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},c1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"47.997ex",height:"2.565ex",role:"img",focusable:"false",viewBox:"0 -883.9 21214.8 1133.9","aria-hidden":"true"},x1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},f1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.372ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.128ex",height:"2.398ex",role:"img",focusable:"false",viewBox:"0 -895.6 1824.4 1060","aria-hidden":"true"},M1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},V1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.801ex",height:"2.032ex",role:"img",focusable:"false",viewBox:"0 -704 1680 898","aria-hidden":"true"},y1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},k1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.811ex",height:"1.956ex",role:"img",focusable:"false",viewBox:"0 -853.7 1242.7 864.7","aria-hidden":"true"},Z1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},b1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"12.615ex",height:"2.938ex",role:"img",focusable:"false",viewBox:"0 -1048.5 5575.6 1298.5","aria-hidden":"true"},v1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},D1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.372ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.128ex",height:"2.398ex",role:"img",focusable:"false",viewBox:"0 -895.6 1824.4 1060","aria-hidden":"true"},_1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},j1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.593ex",height:"2.451ex",role:"img",focusable:"false",viewBox:"0 -833.2 3355.9 1083.2","aria-hidden":"true"},A1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},C1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.854ex",height:"2.009ex",role:"img",focusable:"false",viewBox:"0 -694 1703.4 888","aria-hidden":"true"},E1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},S1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.205ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.106ex",height:"2.398ex",role:"img",focusable:"false",viewBox:"0 -969.5 1373 1060","aria-hidden":"true"},R1={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},P1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.669ex"},xmlns:"http://www.w3.org/2000/svg",width:"56.983ex",height:"5.768ex",role:"img",focusable:"false",viewBox:"0 -1370 25186.3 2549.5","aria-hidden":"true"},B1={class:"custom-block important"},N1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},I1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.68ex",height:"1.553ex",role:"img",focusable:"false",viewBox:"0 -675.5 1184.7 686.5","aria-hidden":"true"},O1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},z1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"9.251ex",height:"2.046ex",role:"img",focusable:"false",viewBox:"0 -893.3 4088.7 904.3","aria-hidden":"true"},q1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},G1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"9.251ex",height:"2.046ex",role:"img",focusable:"false",viewBox:"0 -893.3 4088.7 904.3","aria-hidden":"true"},J1={class:"custom-block important"},X1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},K1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"3.119ex",height:"1.887ex",role:"img",focusable:"false",viewBox:"0 -833.9 1378.8 833.9","aria-hidden":"true"},F1={class:"custom-block tip"},W1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},U1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.489ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.229ex",height:"1.486ex",role:"img",focusable:"false",viewBox:"0 -441 543 657","aria-hidden":"true"},$1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Y1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.281ex",height:"2.034ex",role:"img",focusable:"false",viewBox:"0 -705 566 899","aria-hidden":"true"},Q2={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},t2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.76ex"},xmlns:"http://www.w3.org/2000/svg",width:"33.907ex",height:"6.063ex",role:"img",focusable:"false",viewBox:"0 -1460 14987.1 2680","aria-hidden":"true"},T2={class:"custom-block tip"},a2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},l2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.448ex",height:"1.025ex",role:"img",focusable:"false",viewBox:"0 -442 640 453","aria-hidden":"true"},e2={class:"custom-block important"},s2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},m2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.883ex"},xmlns:"http://www.w3.org/2000/svg",width:"21.521ex",height:"6.923ex",role:"img",focusable:"false",viewBox:"0 -1785.8 9512.3 3060","aria-hidden":"true"},n2={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},o2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-6.833ex"},xmlns:"http://www.w3.org/2000/svg",width:"42.382ex",height:"9.362ex",role:"img",focusable:"false",viewBox:"0 -1118 18732.6 4138","aria-hidden":"true"},d2={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},r2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-3.252ex"},xmlns:"http://www.w3.org/2000/svg",width:"22.492ex",height:"8.281ex",role:"img",focusable:"false",viewBox:"0 -2222.7 9941.4 3660","aria-hidden":"true"},i2={class:"custom-block important"},h2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},p2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.315ex",height:"1.357ex",role:"img",focusable:"false",viewBox:"0 -442 1023.4 599.8","aria-hidden":"true"},g2={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},H2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.452ex"},xmlns:"http://www.w3.org/2000/svg",width:"46.345ex",height:"2.149ex",role:"img",focusable:"false",viewBox:"0 -750 20484.3 950","aria-hidden":"true"},u2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},L2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.671ex",height:"1.595ex",role:"img",focusable:"false",viewBox:"0 -694 2064.4 705","aria-hidden":"true"},w2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},c2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.159ex",height:"1.439ex",role:"img",focusable:"false",viewBox:"0 -442 954.4 636","aria-hidden":"true"},x2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},f2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.912ex",height:"1.532ex",role:"img",focusable:"false",viewBox:"0 -666 845 677","aria-hidden":"true"},M2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},V2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.186ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.809ex",height:"1.692ex",role:"img",focusable:"false",viewBox:"0 -666 2567.4 748","aria-hidden":"true"},y2={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},k2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-3.039ex"},xmlns:"http://www.w3.org/2000/svg",width:"22.676ex",height:"7.209ex",role:"img",focusable:"false",viewBox:"0 -1843.2 10022.9 3186.4","aria-hidden":"true"},Z2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},b2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"12.385ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 5474 1000","aria-hidden":"true"},v2={class:"custom-block important"},D2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},_2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"0.781ex",height:"1.52ex",role:"img",focusable:"false",viewBox:"0 -661 345 672","aria-hidden":"true"},j2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},A2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.462ex"},xmlns:"http://www.w3.org/2000/svg",width:"0.932ex",height:"1.957ex",role:"img",focusable:"false",viewBox:"0 -661 412 865","aria-hidden":"true"},C2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},E2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.452ex"},xmlns:"http://www.w3.org/2000/svg",width:"11.242ex",height:"2.149ex",role:"img",focusable:"false",viewBox:"0 -750 4969 950","aria-hidden":"true"},S2={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},R2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-8.342ex"},xmlns:"http://www.w3.org/2000/svg",width:"30.689ex",height:"17.816ex",role:"img",focusable:"false",viewBox:"0 -4187.3 13564.6 7874.7","aria-hidden":"true"},P2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},B2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.97ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.242ex",height:"2.874ex",role:"img",focusable:"false",viewBox:"0 -841.7 1874.8 1270.4","aria-hidden":"true"},N2={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},I2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-9.671ex"},xmlns:"http://www.w3.org/2000/svg",width:"64.729ex",height:"20.472ex",role:"img",focusable:"false",viewBox:"0 -4774.4 28610.2 9048.7","aria-hidden":"true"},O2={class:"custom-block tip"},z2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},q2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.666ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.985ex",height:"1.666ex",role:"img",focusable:"false",viewBox:"0 -442 877.3 736.2","aria-hidden":"true"},G2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},J2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.666ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.561ex",height:"2.211ex",role:"img",focusable:"false",viewBox:"0 -683 1573.9 977.2","aria-hidden":"true"},X2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},K2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.666ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.561ex",height:"2.211ex",role:"img",focusable:"false",viewBox:"0 -683 1573.9 977.2","aria-hidden":"true"},F2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},W2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.462ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.478ex",height:"1.957ex",role:"img",focusable:"false",viewBox:"0 -661 1979.4 865","aria-hidden":"true"},U2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},$2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.308ex",height:"1.457ex",role:"img",focusable:"false",viewBox:"0 -450 2788.1 644","aria-hidden":"true"},Y2={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},Q3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.788ex"},xmlns:"http://www.w3.org/2000/svg",width:"30.945ex",height:"6.708ex",role:"img",focusable:"false",viewBox:"0 -1732.4 13677.8 2964.8","aria-hidden":"true"},t3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},T3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-1.018ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.912ex",height:"2.919ex",role:"img",focusable:"false",viewBox:"0 -840.3 2171.3 1290.2","aria-hidden":"true"},a3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},l3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.666ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.985ex",height:"1.666ex",role:"img",focusable:"false",viewBox:"0 -442 877.3 736.2","aria-hidden":"true"},e3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},s3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.666ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.361ex",height:"2.211ex",role:"img",focusable:"false",viewBox:"0 -683 1927.4 977.2","aria-hidden":"true"},m3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},n3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.878ex",height:"1.439ex",role:"img",focusable:"false",viewBox:"0 -442 830 636","aria-hidden":"true"},o3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},d3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.294ex",height:"1.025ex",role:"img",focusable:"false",viewBox:"0 -442 572 453","aria-hidden":"true"},r3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},i3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.097ex",height:"1.027ex",role:"img",focusable:"false",viewBox:"0 -443 485 454","aria-hidden":"true"},h3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},p3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.666ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.361ex",height:"2.211ex",role:"img",focusable:"false",viewBox:"0 -683 1927.4 977.2","aria-hidden":"true"},g3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},H3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.666ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.944ex",height:"1.668ex",role:"img",focusable:"false",viewBox:"0 -443 859.3 737.2","aria-hidden":"true"},u3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},L3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.554ex"},xmlns:"http://www.w3.org/2000/svg",width:"17.283ex",height:"4.25ex",role:"img",focusable:"false",viewBox:"0 -750 7639.3 1878.6","aria-hidden":"true"},w3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},c3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-1.018ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.912ex",height:"2.919ex",role:"img",focusable:"false",viewBox:"0 -840.3 2171.3 1290.2","aria-hidden":"true"},x3={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},f3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.885ex"},xmlns:"http://www.w3.org/2000/svg",width:"24.722ex",height:"2.903ex",role:"img",focusable:"false",viewBox:"0 -891.7 10927.2 1283","aria-hidden":"true"},M3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},V3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.666ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.124ex",height:"2.261ex",role:"img",focusable:"false",viewBox:"0 -705 1380.9 999.2","aria-hidden":"true"},y3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},k3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.462ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.478ex",height:"1.957ex",role:"img",focusable:"false",viewBox:"0 -661 1979.4 865","aria-hidden":"true"},Z3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},b3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.462ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.478ex",height:"1.957ex",role:"img",focusable:"false",viewBox:"0 -661 1979.4 865","aria-hidden":"true"},v3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},D3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.483ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 3307.4 1000","aria-hidden":"true"},_3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},j3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.97ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.242ex",height:"2.874ex",role:"img",focusable:"false",viewBox:"0 -841.7 1874.8 1270.4","aria-hidden":"true"},A3={class:"custom-block important"},C3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},E3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.041ex",height:"1.439ex",role:"img",focusable:"false",viewBox:"0 -442 460 636","aria-hidden":"true"},S3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},R3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.179ex",height:"1.595ex",role:"img",focusable:"false",viewBox:"0 -694 521 705","aria-hidden":"true"},P3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},B3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"0.781ex",height:"1.52ex",role:"img",focusable:"false",viewBox:"0 -661 345 672","aria-hidden":"true"},N3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},I3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.462ex"},xmlns:"http://www.w3.org/2000/svg",width:"0.932ex",height:"1.957ex",role:"img",focusable:"false",viewBox:"0 -661 412 865","aria-hidden":"true"},O3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},z3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.462ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.719ex",height:"1.957ex",role:"img",focusable:"false",viewBox:"0 -661 1201.7 865","aria-hidden":"true"},q3={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},G3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.666ex"},xmlns:"http://www.w3.org/2000/svg",width:"28.259ex",height:"2.363ex",role:"img",focusable:"false",viewBox:"0 -750 12490.3 1044.2","aria-hidden":"true"},J3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},X3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.749ex",height:"1.439ex",role:"img",focusable:"false",viewBox:"0 -442 773 636","aria-hidden":"true"},K3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},F3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.666ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.026ex",height:"2.236ex",role:"img",focusable:"false",viewBox:"0 -694 895.3 988.2","aria-hidden":"true"},W3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},U3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.462ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.478ex",height:"1.957ex",role:"img",focusable:"false",viewBox:"0 -661 1979.4 865","aria-hidden":"true"},$3={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},Y3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"35.025ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 15481.1 1000","aria-hidden":"true"},Q4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},t4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.038ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 3110.7 1000","aria-hidden":"true"},T4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},a4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.023ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.061ex",height:"1.618ex",role:"img",focusable:"false",viewBox:"0 -705 469 715","aria-hidden":"true"},l4={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},e4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-5.676ex"},xmlns:"http://www.w3.org/2000/svg",width:"55.501ex",height:"8.956ex",role:"img",focusable:"false",viewBox:"0 -1450 24531.3 3958.8","aria-hidden":"true"},s4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},m4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"13.18ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 5825.8 1000","aria-hidden":"true"},n4={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},o4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.576ex"},xmlns:"http://www.w3.org/2000/svg",width:"47.645ex",height:"2.594ex",role:"img",focusable:"false",viewBox:"0 -891.7 21059.3 1146.5","aria-hidden":"true"},d4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},r4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"14.89ex",height:"2.446ex",role:"img",focusable:"false",viewBox:"0 -923.4 6581.4 1081.2","aria-hidden":"true"},i4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},h4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.023ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.061ex",height:"1.618ex",role:"img",focusable:"false",viewBox:"0 -705 469 715","aria-hidden":"true"},p4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},g4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.462ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.478ex",height:"1.957ex",role:"img",focusable:"false",viewBox:"0 -661 1979.4 865","aria-hidden":"true"},H4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},u4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.666ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.409ex",height:"2.236ex",role:"img",focusable:"false",viewBox:"0 -694 2390.7 988.2","aria-hidden":"true"},L4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},w4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.199ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2298 1000","aria-hidden":"true"},c4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},x4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.199ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2298 1000","aria-hidden":"true"},f4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},M4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.023ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.061ex",height:"1.618ex",role:"img",focusable:"false",viewBox:"0 -705 469 715","aria-hidden":"true"},V4={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},y4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.149ex"},xmlns:"http://www.w3.org/2000/svg",width:"24.877ex",height:"5.43ex",role:"img",focusable:"false",viewBox:"0 -1450 10995.6 2400","aria-hidden":"true"},k4={class:"custom-block tip"},Z4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},b4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.233ex",height:"2.343ex",role:"img",focusable:"false",viewBox:"0 -841.7 2312.8 1035.7","aria-hidden":"true"},v4={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},D4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"65.653ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 29018.7 1000","aria-hidden":"true"},_4={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},j4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.827ex"},xmlns:"http://www.w3.org/2000/svg",width:"57.696ex",height:"6.785ex",role:"img",focusable:"false",viewBox:"0 -1749.5 25501.8 2999","aria-hidden":"true"},A4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},C4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.281ex",height:"2.034ex",role:"img",focusable:"false",viewBox:"0 -705 566 899","aria-hidden":"true"},E4={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},S4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"28.193ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 12461.4 1000","aria-hidden":"true"};function R4(P4,t,B4,N4,I4,O4){return l(),a("div",null,[t[508]||(t[508]=e("",6)),Q("div",n,[t[19]||(t[19]=Q("div",{class:"custom-block-title"},"Attention机制",-1)),Q("ul",null,[t[9]||(t[9]=e("",2)),Q("li",null,[t[8]||(t[8]=Q("p",null,[Q("strong",null,"注意力权重")],-1)),Q("ul",null,[Q("li",null,[Q("strong",null,[Q("mjx-container",o,[(l(),a("svg",d,t[0]||(t[0]=[e("",1)]))),t[1]||(t[1]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"s"),Q("mi",null,"o"),Q("mi",null,"f"),Q("mi",null,"t"),Q("mi",null,"m"),Q("mi",null,"a"),Q("mi",null,"x"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"Q"),Q("mo",null,"∗"),Q("mi",null,"K"),Q("mo",{stretchy:"false"},")")])],-1))])]),t[4]||(t[4]=T("： 即")),t[5]||(t[5]=Q("code",null,"当前query对各个位置的注意力",-1)),Q("mjx-container",r,[(l(),a("svg",i,t[2]||(t[2]=[e("",1)]))),t[3]||(t[3]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"α"),Q("mn",null,"1")]),Q("mo",null,","),Q("mo",null,"⋯"),Q("mo",null,","),Q("msub",null,[Q("mi",null,"α"),Q("mi",null,"l")])])],-1))]),t[6]||(t[6]=T("。"))]),t[7]||(t[7]=Q("li",null,[T("早期QK有 "),Q("code",null,"dot/concat/w"),T(" 这3种"),Q("a",{href:"https://plmsmile.github.io/posts/olds/nlp/Attention-based-NMT.html#global-attention",target:"_blank",rel:"noreferrer"},"score计算的3种方式")],-1))])]),t[10]||(t[10]=Q("li",null,[Q("p",null,[Q("strong",null,"加权求和")]),Q("ul",null,[Q("li",null,"利用注意力权重对各位置Value加权求和，就得到输出")])],-1))]),Q("mjx-container",h,[(l(),a("svg",p,t[11]||(t[11]=[e("",1)]))),t[12]||(t[12]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mi",null,"A"),Q("mi",null,"t"),Q("mi",null,"t"),Q("mi",null,"e"),Q("mi",null,"n"),Q("mi",null,"t"),Q("mi",null,"i"),Q("mi",null,"o"),Q("mi",null,"n"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"Q"),Q("mo",null,","),Q("mi",null,"K"),Q("mo",null,","),Q("mi",null,"V"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("mtext",null,"softmax"),Q("mo",{stretchy:"false"},"("),Q("mfrac",null,[Q("mrow",null,[Q("mi",null,"Q"),Q("msup",null,[Q("mi",null,"K"),Q("mi",null,"T")])]),Q("msqrt",null,[Q("msub",null,[Q("mi",null,"d"),Q("mi",null,"k")])])]),Q("mo",{stretchy:"false"},")"),Q("mi",null,"V")])],-1))]),Q("ul",null,[Q("li",null,[t[15]||(t[15]=T("除以")),Q("mjx-container",g,[(l(),a("svg",H,t[13]||(t[13]=[e("",1)]))),t[14]||(t[14]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msqrt",null,[Q("msub",null,[Q("mi",null,"d"),Q("mi",null,"k")])])])],-1))]),t[16]||(t[16]=T("进行缩放，")),t[17]||(t[17]=Q("strong",null,"防止梯度爆炸",-1)),t[18]||(t[18]=T(","))])])]),t[509]||(t[509]=e("",9)),Q("div",u,[t[92]||(t[92]=Q("div",{class:"custom-block-title"},"Attention 推导",-1)),t[93]||(t[93]=Q("p",null,[Q("strong",null,"符号定义")],-1)),Q("ul",null,[Q("li",null,[t[22]||(t[22]=T("假设dim=")),Q("mjx-container",L,[(l(),a("svg",w,t[20]||(t[20]=[e("",1)]))),t[21]||(t[21]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"d"),Q("mi",null,"k")])])],-1))]),t[23]||(t[23]=T("，部分公式")),t[24]||(t[24]=Q("strong",null,"省略缩放、softmax、向量转置等",-1)),t[25]||(t[25]=T("。"))]),Q("li",null,[Q("strong",null,[Q("mjx-container",c,[(l(),a("svg",x,t[26]||(t[26]=[e("",1)]))),t[27]||(t[27]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"A"),Q("mi",null,"t"),Q("mi",null,"t"),Q("msub",null,[Q("mi",null,"n"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"s"),Q("mi",null,"t"),Q("mi",null,"e"),Q("mi",null,"p"),Q("mi",null,"i")])]),Q("mo",{stretchy:"false"},"("),Q("mi",null,"Q"),Q("mo",null,","),Q("mi",null,"K"),Q("mo",null,","),Q("mi",null,"V"),Q("mo",{stretchy:"false"},")")])],-1))])]),t[28]||(t[28]=T("：")),t[29]||(t[29]=Q("strong",null,"step=i的完整Attention矩阵",-1))]),Q("li",null,[Q("strong",null,[Q("mjx-container",f,[(l(),a("svg",M,t[30]||(t[30]=[e("",1)]))),t[31]||(t[31]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"A"),Q("mi",null,"t"),Q("mi",null,"t"),Q("msub",null,[Q("mi",null,"n"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i")])]),Q("mo",{stretchy:"false"},"("),Q("mi",null,"Q"),Q("mo",null,","),Q("mi",null,"K"),Q("mo",null,","),Q("mi",null,"V"),Q("mo",{stretchy:"false"},")")])],-1))])]),t[32]||(t[32]=T("：")),t[33]||(t[33]=Q("code",null,"attention矩阵的第i行",-1))])]),t[94]||(t[94]=Q("p",null,[Q("strong",null,"Step=1，共1行")],-1)),Q("ul",null,[Q("li",null,[t[36]||(t[36]=Q("code",null,"第1行",-1)),t[37]||(t[37]=T("：")),Q("strong",null,[Q("mjx-container",V,[(l(),a("svg",y,t[34]||(t[34]=[e("",1)]))),t[35]||(t[35]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"A"),Q("mi",null,"t"),Q("mi",null,"t"),Q("msub",null,[Q("mi",null,"n"),Q("mn",null,"1")]),Q("mo",{stretchy:"false"},"("),Q("mi",null,"Q"),Q("mo",null,","),Q("mi",null,"K"),Q("mo",null,","),Q("mi",null,"V"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("mtext",null,"softmaxted"),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"Q"),Q("mn",null,"1")]),Q("msubsup",null,[Q("mi",null,"K"),Q("mn",null,"1"),Q("mi",null,"T")]),Q("mo",{stretchy:"false"},")"),Q("msub",null,[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mover",null,[Q("mi",null,"V"),Q("mo",{stretchy:"false"},"→")])]),Q("mn",null,"1")]),Q("mo",null,"="),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"Q"),Q("mn",null,"1")]),Q("msubsup",null,[Q("mi",null,"K"),Q("mn",null,"1"),Q("mi",null,"T")]),Q("mo",{stretchy:"false"},")"),Q("msub",null,[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mover",null,[Q("mi",null,"V"),Q("mo",{stretchy:"false"},"→")])]),Q("mn",null,"1")])])],-1))])])])]),Q("mjx-container",k,[(l(),a("svg",Z,t[38]||(t[38]=[e("",1)]))),t[39]||(t[39]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mstyle",{mathcolor:"blue"},[Q("mtable",{columnalign:"left left",columnspacing:"1em",rowspacing:"4pt"},[Q("mtr",null,[Q("mtd",null,[Q("mstyle",{mathcolor:"red"},[Q("mi",null,"A"),Q("mi",null,"t"),Q("mi",null,"t"),Q("msub",null,[Q("mi",null,"n"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"s"),Q("mi",null,"t"),Q("mi",null,"e"),Q("mi",null,"p"),Q("mn",null,"1")])]),Q("mo",{stretchy:"false"},"("),Q("mi",null,"Q"),Q("mo",null,","),Q("mi",null,"K"),Q("mo",null,","),Q("mi",null,"V"),Q("mo",{stretchy:"false"},")")])]),Q("mtd",null,[Q("mo",null,"="),Q("mtext",null,"softmax"),Q("mo",{stretchy:"false"},"("),Q("mfrac",null,[Q("mrow",null,[Q("msub",null,[Q("mi",null,"Q"),Q("mn",null,"1")]),Q("mi",null,"K"),Q("msup",null,[Q("mn",null,"1"),Q("mi",null,"T")])]),Q("msqrt",null,[Q("msub",null,[Q("mi",null,"d"),Q("mi",null,"k")])])]),Q("mo",{stretchy:"false"},")"),Q("msub",null,[Q("mi",null,"V"),Q("mn",null,"1")]),Q("mo",null,"="),Q("mrow",{"data-mjx-texclass":"INNER"},[Q("mo",{"data-mjx-texclass":"OPEN"},"["),Q("mtable",{columnalign:"center",columnspacing:"1em",rowspacing:"4pt"},[Q("mtr",null,[Q("mtd",null,[Q("msub",null,[Q("mi",null,"Q"),Q("mn",null,"1")])])])]),Q("mo",{"data-mjx-texclass":"CLOSE"},"]")]),Q("mo",null,"⋅"),Q("mrow",{"data-mjx-texclass":"INNER"},[Q("mo",{"data-mjx-texclass":"OPEN"},"["),Q("mtable",{columnalign:"center",columnspacing:"1em",rowspacing:"4pt"},[Q("mtr",null,[Q("mtd",null,[Q("msub",null,[Q("mi",null,"K"),Q("mn",null,"1")])])])]),Q("mo",{"data-mjx-texclass":"CLOSE"},"]")]),Q("mo",null,"⋅"),Q("mrow",{"data-mjx-texclass":"INNER"},[Q("mo",{"data-mjx-texclass":"OPEN"},"["),Q("mtable",{columnalign:"center",columnspacing:"1em",rowspacing:"4pt"},[Q("mtr",null,[Q("mtd",null,[Q("msub",null,[Q("mi",null,"V"),Q("mn",null,"1")])])])]),Q("mo",{"data-mjx-texclass":"CLOSE"},"]")])])]),Q("mtr",null,[Q("mtd"),Q("mtd",null,[Q("mo",null,"="),Q("mo",{stretchy:"false"},"["),Q("mstyle",{mathcolor:"red"},[Q("mtext",null,"softmax"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"Q"),Q("mn",null,"1")]),Q("msubsup",null,[Q("mi",null,"K"),Q("mn",null,"1"),Q("mi",null,"T")]),Q("mo",{stretchy:"false"},")")]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mover",null,[Q("msub",null,[Q("mi",null,"V"),Q("mn",null,"1")]),Q("mo",{stretchy:"false"},"→")])])]),Q("mo",{stretchy:"false"},"]")])]),Q("mtr",null,[Q("mtd"),Q("mtd",null,[Q("mo",null,"="),Q("mo",{stretchy:"false"},"["),Q("mi",null,"A"),Q("mi",null,"t"),Q("mi",null,"t"),Q("msub",null,[Q("mi",null,"n"),Q("mn",null,"1")]),Q("mo",{stretchy:"false"},"("),Q("mi",null,"Q"),Q("mo",null,","),Q("mi",null,"K"),Q("mo",null,","),Q("mi",null,"V"),Q("mo",{stretchy:"false"},")"),Q("mo",{stretchy:"false"},"]")])])])])])],-1))]),t[95]||(t[95]=Q("p",null,[Q("strong",null,"Step=2，共2行")],-1)),Q("ul",null,[Q("li",null,[t[42]||(t[42]=Q("code",null,"第1行",-1)),t[43]||(t[43]=T("：")),Q("strong",null,[Q("mjx-container",b,[(l(),a("svg",v,t[40]||(t[40]=[e("",1)]))),t[41]||(t[41]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"A"),Q("mi",null,"t"),Q("mi",null,"t"),Q("msub",null,[Q("mi",null,"n"),Q("mn",null,"1")]),Q("mo",{stretchy:"false"},"("),Q("mi",null,"Q"),Q("mo",null,","),Q("mi",null,"K"),Q("mo",null,","),Q("mi",null,"V"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"Q"),Q("mn",null,"1")]),Q("msubsup",null,[Q("mi",null,"K"),Q("mn",null,"1"),Q("mi",null,"T")]),Q("mo",{stretchy:"false"},")"),Q("msub",null,[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mover",null,[Q("mi",null,"V"),Q("mo",{stretchy:"false"},"→")])]),Q("mn",null,"1")])])],-1))])]),t[44]||(t[44]=T("，")),t[45]||(t[45]=Q("code",null,"step1已算过",-1))]),Q("li",null,[t[48]||(t[48]=Q("code",null,"第2行",-1)),t[49]||(t[49]=T("：")),Q("strong",null,[Q("mjx-container",D,[(l(),a("svg",_,t[46]||(t[46]=[e("",1)]))),t[47]||(t[47]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"A"),Q("mi",null,"t"),Q("mi",null,"t"),Q("msub",null,[Q("mi",null,"n"),Q("mn",null,"2")]),Q("mo",{stretchy:"false"},"("),Q("mi",null,"Q"),Q("mo",null,","),Q("mi",null,"K"),Q("mo",null,","),Q("mi",null,"V"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"Q"),Q("mn",null,"2")]),Q("msubsup",null,[Q("mi",null,"K"),Q("mn",null,"1"),Q("mi",null,"T")]),Q("mo",{stretchy:"false"},")"),Q("msub",null,[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mover",null,[Q("mi",null,"V"),Q("mo",{stretchy:"false"},"→")])]),Q("mn",null,"1")]),Q("mo",null,"+"),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"Q"),Q("mn",null,"2")]),Q("msubsup",null,[Q("mi",null,"K"),Q("mn",null,"2"),Q("mi",null,"T")]),Q("mo",{stretchy:"false"},")"),Q("msub",null,[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mover",null,[Q("mi",null,"V"),Q("mo",{stretchy:"false"},"→")])]),Q("mn",null,"2")])])],-1))])])])]),Q("mjx-container",j,[(l(),a("svg",A,t[50]||(t[50]=[e("",1)]))),t[51]||(t[51]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mstyle",{mathcolor:"blue"},[Q("mtable",{columnalign:"left left",columnspacing:"1em",rowspacing:"4pt"},[Q("mtr",null,[Q("mtd",null,[Q("mstyle",{mathcolor:"red"},[Q("mi",null,"A"),Q("mi",null,"t"),Q("mi",null,"t"),Q("msub",null,[Q("mi",null,"n"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"s"),Q("mi",null,"t"),Q("mi",null,"e"),Q("mi",null,"p"),Q("mn",null,"2")])]),Q("mo",{stretchy:"false"},"("),Q("mi",null,"Q"),Q("mo",null,","),Q("mi",null,"K"),Q("mo",null,","),Q("mi",null,"V"),Q("mo",{stretchy:"false"},")")])]),Q("mtd",null,[Q("mo",null,"="),Q("mrow",{"data-mjx-texclass":"INNER"},[Q("mo",{"data-mjx-texclass":"OPEN"},"["),Q("mtable",{columnalign:"center",columnspacing:"1em",rowspacing:"4pt"},[Q("mtr",null,[Q("mtd",null,[Q("msub",null,[Q("mi",null,"Q"),Q("mn",null,"1")])])]),Q("mtr",null,[Q("mtd",null,[Q("msub",null,[Q("mi",null,"Q"),Q("mn",null,"2")])])])]),Q("mo",{"data-mjx-texclass":"CLOSE"},"]")]),Q("mo",null,"⋅"),Q("mrow",{"data-mjx-texclass":"INNER"},[Q("mo",{"data-mjx-texclass":"OPEN"},"["),Q("mtable",{columnalign:"center",columnspacing:"1em",rowspacing:"4pt"},[Q("mtr",null,[Q("mtd",null,[Q("msub",null,[Q("mi",null,"K"),Q("mn",null,"1")])]),Q("mtd",null,[Q("msub",null,[Q("mi",null,"K"),Q("mn",null,"2")])])])]),Q("mo",{"data-mjx-texclass":"CLOSE"},"]")]),Q("mo",null,"⋅"),Q("mrow",{"data-mjx-texclass":"INNER"},[Q("mo",{"data-mjx-texclass":"OPEN"},"["),Q("mtable",{columnalign:"center",columnspacing:"1em",rowspacing:"4pt"},[Q("mtr",null,[Q("mtd",null,[Q("msub",null,[Q("mi",null,"V"),Q("mn",null,"1")])])]),Q("mtr",null,[Q("mtd",null,[Q("msub",null,[Q("mi",null,"V"),Q("mn",null,"2")])])])]),Q("mo",{"data-mjx-texclass":"CLOSE"},"]")])])]),Q("mtr",null,[Q("mtd"),Q("mtd",null,[Q("mo",null,"="),Q("mrow",{"data-mjx-texclass":"INNER"},[Q("mo",{"data-mjx-texclass":"OPEN"},"["),Q("mtable",{columnalign:"center",columnspacing:"1em",rowspacing:"4pt"},[Q("mtr",null,[Q("mtd",null,[Q("msub",null,[Q("mi",null,"Q"),Q("mn",null,"1")]),Q("msubsup",null,[Q("mi",null,"K"),Q("mn",null,"1"),Q("mi",null,"T")])]),Q("mtd",null,[Q("mstyle",{mathcolor:"red"},[Q("munder",null,[Q("mrow",{"data-mjx-texclass":"OP"},[Q("munder",null,[Q("mrow",null,[Q("msub",null,[Q("mi",null,"Q"),Q("mn",null,"1")]),Q("msubsup",null,[Q("mi",null,"K"),Q("mn",null,"2"),Q("mi",null,"T")])]),Q("mo",null,"⏟")])]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"Q"),Q("mn",null,"1"),Q("mi",{mathvariant:"normal"},"不"),Q("mi",{mathvariant:"normal"},"能"),Q("mi",{mathvariant:"normal"},"看"),Q("mi",{mathvariant:"normal"},"见"),Q("mi",null,"K"),Q("mn",null,"2")])])])])]),Q("mtr",null,[Q("mtd",null,[Q("msub",null,[Q("mi",null,"Q"),Q("mn",null,"2")]),Q("msubsup",null,[Q("mi",null,"K"),Q("mn",null,"1"),Q("mi",null,"T")])]),Q("mtd",null,[Q("msub",null,[Q("mi",null,"Q"),Q("mn",null,"2")]),Q("msubsup",null,[Q("mi",null,"K"),Q("mn",null,"2"),Q("mi",null,"T")])])])]),Q("mo",{"data-mjx-texclass":"CLOSE"},"]")]),Q("mo",null,"⋅"),Q("mrow",{"data-mjx-texclass":"INNER"},[Q("mo",{"data-mjx-texclass":"OPEN"},"["),Q("mtable",{columnalign:"center",columnspacing:"1em",rowspacing:"4pt"},[Q("mtr",null,[Q("mtd",null,[Q("msub",null,[Q("mi",null,"V"),Q("mn",null,"1")])])]),Q("mtr",null,[Q("mtd",null,[Q("msub",null,[Q("mi",null,"V"),Q("mn",null,"2")])])])]),Q("mo",{"data-mjx-texclass":"CLOSE"},"]")]),Q("mo",null,"="),Q("munder",null,[Q("mrow",{"data-mjx-texclass":"OP"},[Q("munder",null,[Q("mrow",{"data-mjx-texclass":"INNER"},[Q("mo",{"data-mjx-texclass":"OPEN"},"["),Q("mtable",{columnalign:"center",columnspacing:"1em",rowspacing:"4pt"},[Q("mtr",null,[Q("mtd",null,[Q("msub",null,[Q("mi",null,"Q"),Q("mn",null,"1")]),Q("msubsup",null,[Q("mi",null,"K"),Q("mn",null,"1"),Q("mi",null,"T")])]),Q("mtd",null,[Q("mstyle",{mathcolor:"red"},[Q("mo",null,"−"),Q("mi",{mathvariant:"normal"},"∞")])])]),Q("mtr",null,[Q("mtd",null,[Q("msub",null,[Q("mi",null,"Q"),Q("mn",null,"2")]),Q("msubsup",null,[Q("mi",null,"K"),Q("mn",null,"1"),Q("mi",null,"T")])]),Q("mtd",null,[Q("msub",null,[Q("mi",null,"Q"),Q("mn",null,"2")]),Q("msubsup",null,[Q("mi",null,"K"),Q("mn",null,"2"),Q("mi",null,"T")])])])]),Q("mo",{"data-mjx-texclass":"CLOSE"},"]")]),Q("mo",null,"⏟")])]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mstyle",{mathcolor:"red"},[Q("mi",{mathvariant:"normal"},"被"),Q("mi",null,"m"),Q("mi",null,"a"),Q("mi",null,"s"),Q("mi",null,"k"),Q("mi",{mathvariant:"normal"},"掉"),Q("mi",null,"，"),Q("mi",null,"s"),Q("mi",null,"o"),Q("mi",null,"f"),Q("mi",null,"t"),Q("mi",null,"m"),Q("mi",null,"a"),Q("mi",null,"x"),Q("mi",{mathvariant:"normal"},"为"),Q("mi",{mathvariant:"normal"},"负"),Q("mi",{mathvariant:"normal"},"无"),Q("mi",{mathvariant:"normal"},"穷")])])]),Q("mo",null,"⋅"),Q("mrow",{"data-mjx-texclass":"INNER"},[Q("mo",{"data-mjx-texclass":"OPEN"},"["),Q("mtable",{columnalign:"center",columnspacing:"1em",rowspacing:"4pt"},[Q("mtr",null,[Q("mtd",null,[Q("msub",null,[Q("mi",null,"V"),Q("mn",null,"1")])])]),Q("mtr",null,[Q("mtd",null,[Q("msub",null,[Q("mi",null,"V"),Q("mn",null,"2")])])])]),Q("mo",{"data-mjx-texclass":"CLOSE"},"]")])])]),Q("mtr",null,[Q("mtd"),Q("mtd",null,[Q("mo",null,"="),Q("mstyle",{mathcolor:"red"},[Q("munder",null,[Q("mrow",{"data-mjx-texclass":"OP"},[Q("munder",null,[Q("mrow",{"data-mjx-texclass":"INNER"},[Q("mo",{"data-mjx-texclass":"OPEN"},"["),Q("mtable",{columnalign:"center",columnspacing:"1em",rowspacing:"4pt"},[Q("mtr",null,[Q("mtd",null,[Q("msub",null,[Q("mi",null,"Q"),Q("mn",null,"1")]),Q("msub",null,[Q("mi",null,"K"),Q("mn",null,"1")])]),Q("mtd",null,[Q("mstyle",null,[Q("mn",null,"0")])])]),Q("mtr",null,[Q("mtd",null,[Q("msub",null,[Q("mi",null,"Q"),Q("mn",null,"2")]),Q("msub",null,[Q("mi",null,"K"),Q("mn",null,"1")])]),Q("mtd",null,[Q("msub",null,[Q("mi",null,"Q"),Q("mn",null,"2")]),Q("msub",null,[Q("mi",null,"K"),Q("mn",null,"2")])])])]),Q("mo",{"data-mjx-texclass":"CLOSE"},"]")]),Q("mo",null,"⏟")])]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{mathvariant:"normal"},"过"),Q("mi",{mathvariant:"normal"},"了"),Q("mi",null,"s"),Q("mi",null,"o"),Q("mi",null,"f"),Q("mi",null,"t"),Q("mi",null,"m"),Q("mi",null,"a"),Q("mi",null,"x"),Q("mi",{mathvariant:"normal"},"和"),Q("mi",{mathvariant:"normal"},"缩"),Q("mi",{mathvariant:"normal"},"放"),Q("mi",null,"，"),Q("mi",{mathvariant:"normal"},"简"),Q("mi",{mathvariant:"normal"},"写")])])]),Q("mo",null,"⋅"),Q("mrow",{"data-mjx-texclass":"INNER"},[Q("mo",{"data-mjx-texclass":"OPEN"},"["),Q("mtable",{columnalign:"center",columnspacing:"1em",rowspacing:"4pt"},[Q("mtr",null,[Q("mtd",null,[Q("msub",null,[Q("mi",null,"V"),Q("mn",null,"1")])])]),Q("mtr",null,[Q("mtd",null,[Q("msub",null,[Q("mi",null,"V"),Q("mn",null,"2")])])])]),Q("mo",{"data-mjx-texclass":"CLOSE"},"]")])])]),Q("mtr",null,[Q("mtd"),Q("mtd",null,[Q("mo",null,"="),Q("mrow",{"data-mjx-texclass":"INNER"},[Q("mo",{"data-mjx-texclass":"OPEN"},"["),Q("mtable",{columnalign:"center",columnspacing:"1em",rowspacing:"4pt"},[Q("mtr",null,[Q("mtd",null,[Q("mstyle",{mathcolor:"red"},[Q("msub",null,[Q("mi",null,"Q"),Q("mn",null,"1")]),Q("msubsup",null,[Q("mi",null,"K"),Q("mn",null,"1"),Q("mi",null,"T")]),Q("msub",null,[Q("mi",null,"V"),Q("mn",null,"1")])])])]),Q("mtr",null,[Q("mtd",null,[Q("msub",null,[Q("mi",null,"Q"),Q("mn",null,"2")]),Q("msub",null,[Q("mi",null,"K"),Q("mn",null,"1")]),Q("msub",null,[Q("mi",null,"V"),Q("mn",null,"1")]),Q("mo",null,"+"),Q("msub",null,[Q("mi",null,"Q"),Q("mn",null,"2")]),Q("msub",null,[Q("mi",null,"K"),Q("mn",null,"2")]),Q("msub",null,[Q("mi",null,"V"),Q("mn",null,"2")])])])]),Q("mo",{"data-mjx-texclass":"CLOSE"},"]")]),Q("mo",null,"="),Q("mrow",{"data-mjx-texclass":"INNER"},[Q("mo",{"data-mjx-texclass":"OPEN"},"["),Q("mtable",{columnalign:"center",columnspacing:"1em",rowspacing:"4pt"},[Q("mtr",null,[Q("mtd",null,[Q("mstyle",{mathcolor:"red"},[Q("mi",null,"A"),Q("mi",null,"t"),Q("mi",null,"t"),Q("msub",null,[Q("mi",null,"n"),Q("mn",null,"1")]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mo",{stretchy:"false"},"("),Q("mi",null,"Q"),Q("mo",null,","),Q("mi",null,"K"),Q("mo",null,","),Q("mi",null,"V"),Q("mo",{stretchy:"false"},")")])])])]),Q("mtr",null,[Q("mtd",null,[Q("msub",null,[Q("mi",null,"Q"),Q("mn",null,"2")]),Q("msub",null,[Q("mi",null,"K"),Q("mn",null,"1")]),Q("msub",null,[Q("mi",null,"V"),Q("mn",null,"1")]),Q("mo",null,"+"),Q("msub",null,[Q("mi",null,"Q"),Q("mn",null,"2")]),Q("msub",null,[Q("mi",null,"K"),Q("mn",null,"2")]),Q("msub",null,[Q("mi",null,"V"),Q("mn",null,"2")])])])]),Q("mo",{"data-mjx-texclass":"CLOSE"},"]")])])])])])])],-1))]),t[96]||(t[96]=Q("p",null,[Q("strong",null,"Step=3, 共3行")],-1)),Q("ul",null,[Q("li",null,[t[54]||(t[54]=Q("code",null,"第1行",-1)),t[55]||(t[55]=T("：")),Q("strong",null,[Q("mjx-container",C,[(l(),a("svg",E,t[52]||(t[52]=[e("",1)]))),t[53]||(t[53]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"A"),Q("mi",null,"t"),Q("mi",null,"t"),Q("msub",null,[Q("mi",null,"n"),Q("mn",null,"1")]),Q("mo",{stretchy:"false"},"("),Q("mi",null,"Q"),Q("mo",null,","),Q("mi",null,"K"),Q("mo",null,","),Q("mi",null,"V"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"Q"),Q("mn",null,"1")]),Q("msubsup",null,[Q("mi",null,"K"),Q("mn",null,"1"),Q("mi",null,"T")]),Q("mo",{stretchy:"false"},")"),Q("msub",null,[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mover",null,[Q("mi",null,"V"),Q("mo",{stretchy:"false"},"→")])]),Q("mn",null,"1")])])],-1))])]),t[56]||(t[56]=T("，")),t[57]||(t[57]=Q("code",null,"step1已算过",-1))]),Q("li",null,[t[60]||(t[60]=Q("code",null,"第2行",-1)),t[61]||(t[61]=T("：")),Q("strong",null,[Q("mjx-container",S,[(l(),a("svg",R,t[58]||(t[58]=[e("",1)]))),t[59]||(t[59]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"A"),Q("mi",null,"t"),Q("mi",null,"t"),Q("msub",null,[Q("mi",null,"n"),Q("mn",null,"2")]),Q("mo",{stretchy:"false"},"("),Q("mi",null,"Q"),Q("mo",null,","),Q("mi",null,"K"),Q("mo",null,","),Q("mi",null,"V"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"Q"),Q("mn",null,"2")]),Q("msubsup",null,[Q("mi",null,"K"),Q("mn",null,"1"),Q("mi",null,"T")]),Q("mo",{stretchy:"false"},")"),Q("msub",null,[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mover",null,[Q("mi",null,"V"),Q("mo",{stretchy:"false"},"→")])]),Q("mn",null,"1")]),Q("mo",null,"+"),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"Q"),Q("mn",null,"2")]),Q("msubsup",null,[Q("mi",null,"K"),Q("mn",null,"2"),Q("mi",null,"T")]),Q("mo",{stretchy:"false"},")"),Q("msub",null,[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mover",null,[Q("mi",null,"V"),Q("mo",{stretchy:"false"},"→")])]),Q("mn",null,"2")])])],-1))])]),t[62]||(t[62]=T("，")),t[63]||(t[63]=Q("code",null,"step2已算过",-1))]),Q("li",null,[t[66]||(t[66]=Q("code",null,"第3行",-1)),t[67]||(t[67]=T("：")),Q("strong",null,[Q("mjx-container",P,[(l(),a("svg",B,t[64]||(t[64]=[e("",1)]))),t[65]||(t[65]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"A"),Q("mi",null,"t"),Q("mi",null,"t"),Q("msub",null,[Q("mi",null,"n"),Q("mn",null,"3")]),Q("mo",{stretchy:"false"},"("),Q("mi",null,"Q"),Q("mo",null,","),Q("mi",null,"K"),Q("mo",null,","),Q("mi",null,"V"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"Q"),Q("mn",null,"3")]),Q("msubsup",null,[Q("mi",null,"K"),Q("mn",null,"1"),Q("mi",null,"T")]),Q("mo",{stretchy:"false"},")"),Q("msub",null,[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mover",null,[Q("mi",null,"V"),Q("mo",{stretchy:"false"},"→")])]),Q("mn",null,"1")]),Q("mo",null,"+"),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"Q"),Q("mn",null,"3")]),Q("msubsup",null,[Q("mi",null,"K"),Q("mn",null,"2"),Q("mi",null,"T")]),Q("mo",{stretchy:"false"},")"),Q("msub",null,[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mover",null,[Q("mi",null,"V"),Q("mo",{stretchy:"false"},"→")])]),Q("mn",null,"2")]),Q("mo",null,"+"),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"Q"),Q("mn",null,"3")]),Q("msubsup",null,[Q("mi",null,"K"),Q("mn",null,"3"),Q("mi",null,"T")]),Q("mo",{stretchy:"false"},")"),Q("msub",null,[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mover",null,[Q("mi",null,"V"),Q("mo",{stretchy:"false"},"→")])]),Q("mn",null,"3")])])],-1))])])])]),t[97]||(t[97]=Q("p",null,[Q("strong",null,"结论")],-1)),Q("ul",null,[t[91]||(t[91]=Q("li",null,[T("每一步都计算存在大量冗余，"),Q("code",null,"前i-1行都已经计算过")],-1)),Q("li",null,[Q("strong",null,[Q("mjx-container",N,[(l(),a("svg",I,t[68]||(t[68]=[e("",1)]))),t[69]||(t[69]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"A"),Q("mi",null,"t"),Q("mi",null,"t"),Q("msub",null,[Q("mi",null,"n"),Q("mi",null,"k")])])],-1))]),t[74]||(t[74]=T("只和")),Q("mjx-container",O,[(l(),a("svg",z,t[70]||(t[70]=[e("",1)]))),t[71]||(t[71]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"Q"),Q("mi",null,"k")])])],-1))]),t[75]||(t[75]=T("有关系，和其余的")),Q("mjx-container",q,[(l(),a("svg",G,t[72]||(t[72]=[Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D444",d:"M399 -80Q399 -47 400 -30T402 -11V-7L387 -11Q341 -22 303 -22Q208 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435Q740 255 592 107Q529 47 461 16L444 8V3Q444 2 449 -24T470 -66T516 -82Q551 -82 583 -60T625 -3Q631 11 638 11Q647 11 649 2Q649 -6 639 -34T611 -100T557 -165T481 -194Q399 -194 399 -87V-80ZM636 468Q636 523 621 564T580 625T530 655T477 665Q429 665 379 640Q277 591 215 464T153 216Q153 110 207 59Q231 38 236 38V46Q236 86 269 120T347 155Q372 155 390 144T417 114T429 82T435 55L448 64Q512 108 557 185T619 334T636 468ZM314 18Q362 18 404 39L403 49Q399 104 366 115Q354 117 347 117Q344 117 341 117T337 118Q317 118 296 98T274 52Q274 18 314 18Z",style:{"stroke-width":"3"}})])])],-1)]))),t[73]||(t[73]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"Q")])],-1))]),t[76]||(t[76]=T("无关"))]),t[81]||(t[81]=T("⭐，")),Q("mjx-container",J,[(l(),a("svg",X,t[77]||(t[77]=[e("",1)]))),t[78]||(t[78]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"Q"),Q("mi",null,"k")])])],-1))]),t[82]||(t[82]=T("会和前面的每一对")),Q("mjx-container",K,[(l(),a("svg",F,t[79]||(t[79]=[e("",1)]))),t[80]||(t[80]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"K"),Q("mi",null,"i")]),Q("mo",null,","),Q("msub",null,[Q("mi",null,"V"),Q("mi",null,"i")])])],-1))]),t[83]||(t[83]=T("做attention计算，来计算当前行。"))]),Q("li",null,[t[88]||(t[88]=T("解码")),Q("mjx-container",W,[(l(),a("svg",U,t[84]||(t[84]=[e("",1)]))),t[85]||(t[85]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"x"),Q("mi",null,"k")])])],-1))]),t[89]||(t[89]=T("，只需输入字符")),Q("mjx-container",$,[(l(),a("svg",Y,t[86]||(t[86]=[e("",1)]))),t[87]||(t[87]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"x"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"k"),Q("mo",null,"−"),Q("mn",null,"1")])])])],-1))]),t[90]||(t[90]=T("即可。"))])])]),t[510]||(t[510]=Q("h3",{id:"几个重点思考-降维-dk等",tabindex:"-1"},[Q("strong",null,"几个重点思考(降维/dk等)"),T(),Q("a",{class:"header-anchor",href:"#几个重点思考-降维-dk等","aria-label":'Permalink to "**几个重点思考(降维/dk等)**"'},"​")],-1)),Q("div",Q1,[t[169]||(t[169]=Q("div",{class:"custom-block-title"},"重要思考",-1)),t[170]||(t[170]=Q("p",null,[Q("strong",null,"1、Self-Attention Padding 做 Mask")],-1)),Q("ul",null,[Q("li",null,[Q("mjx-container",t1,[(l(),a("svg",T1,t[98]||(t[98]=[e("",1)]))),t[99]||(t[99]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"Q"),Q("mo",null,"⋅"),Q("mi",null,"K")])],-1))]),t[102]||(t[102]=T(" ，需要对padding部分置为")),Q("mjx-container",a1,[(l(),a("svg",l1,t[100]||(t[100]=[e("",1)]))),t[101]||(t[101]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mo",null,"−"),Q("mi",{mathvariant:"normal"},"∞")])],-1))]),t[103]||(t[103]=T("负无穷，再过Softmax才会为0。"))])]),t[171]||(t[171]=Q("p",null,[Q("strong",null,"2、Transformer Multi-Head Attention 要对head 进行降维")],-1)),Q("ul",null,[Q("li",null,[t[108]||(t[108]=T("输入向量维度为")),Q("mjx-container",e1,[(l(),a("svg",s1,t[104]||(t[104]=[Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D451",d:"M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z",style:{"stroke-width":"3"}})])])],-1)]))),t[105]||(t[105]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"d")])],-1))]),t[109]||(t[109]=T("，需要降维到 ")),Q("mjx-container",m1,[(l(),a("svg",n1,t[106]||(t[106]=[e("",1)]))),t[107]||(t[107]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msup",null,[Q("mi",null,"d"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{"data-mjx-alternate":"1"},"′")])])])],-1))]),t[110]||(t[110]=T("（远小于d），主要是为了")),t[111]||(t[111]=Q("mark",null,"降低计算复杂度",-1))]),Q("li",null,[t[114]||(t[114]=T("时间复杂度：")),Q("mjx-container",o1,[(l(),a("svg",d1,t[112]||(t[112]=[e("",1)]))),t[113]||(t[113]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"o"),Q("mo",{stretchy:"false"},"("),Q("msup",null,[Q("mi",null,"d"),Q("mn",null,"2")]),Q("mo",{stretchy:"false"},")"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mo",null,"、")]),Q("mi",null,"o"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"h"),Q("msup",null,[Q("mi",null,"d"),Q("mn",null,"2")]),Q("mo",{stretchy:"false"},")"),Q("mstyle",{scriptlevel:"0"},[Q("mspace",{width:"1em"})]),Q("mo",{stretchy:"false"},"→"),Q("mstyle",{scriptlevel:"0"},[Q("mspace",{width:"1em"})]),Q("mi",null,"o"),Q("mo",{stretchy:"false"},"("),Q("msup",null,[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("msup",null,[Q("mi",null,"d"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{"data-mjx-alternate":"1"},"′")])])]),Q("mn",null,"2")]),Q("mo",{stretchy:"false"},")"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mo",null,"、")]),Q("mi",null,"o"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"h"),Q("msup",null,[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("msup",null,[Q("mi",null,"d"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{"data-mjx-alternate":"1"},"′")])])]),Q("mn",null,"2")]),Q("mo",{stretchy:"false"},")")])],-1))])])]),t[172]||(t[172]=Q("p",null,[Q("strong",null,"3、维度和点击的关系")],-1)),Q("ul",null,[Q("li",null,[Q("p",null,[Q("mjx-container",r1,[(l(),a("svg",i1,t[115]||(t[115]=[e("",1)]))),t[116]||(t[116]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"q"),Q("mo",null,","),Q("mi",null,"k")])],-1))]),t[121]||(t[121]=T("向量 维度d越大，点积值")),Q("mjx-container",h1,[(l(),a("svg",p1,t[117]||(t[117]=[e("",1)]))),t[118]||(t[118]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"q"),Q("mo",null,"⋅"),Q("mi",null,"k")])],-1))]),t[122]||(t[122]=T("越大，点积属于均值0、方差")),Q("mjx-container",g1,[(l(),a("svg",H1,t[119]||(t[119]=[Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D451",d:"M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z",style:{"stroke-width":"3"}})])])],-1)]))),t[120]||(t[120]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"d")])],-1))]),t[123]||(t[123]=T("的正态分布。"))]),Q("mjx-container",u1,[(l(),a("svg",L1,t[124]||(t[124]=[e("",1)]))),t[125]||(t[125]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mi",null,"E"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"q"),Q("mo",null,"⋅"),Q("mi",null,"k"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("mn",null,"0"),Q("mo",null,","),Q("mstyle",{scriptlevel:"0"},[Q("mspace",{width:"1em"})]),Q("mi",null,"D"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"q"),Q("mo",null,"⋅"),Q("mi",null,"k"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("mi",null,"d")])],-1))])]),Q("li",null,[t[128]||(t[128]=Q("p",null,"方差的性质",-1)),Q("mjx-container",w1,[(l(),a("svg",c1,t[126]||(t[126]=[e("",1)]))),t[127]||(t[127]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mi",null,"D"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"c"),Q("mi",null,"x"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("msup",null,[Q("mi",null,"c"),Q("mn",null,"2")]),Q("mi",null,"D"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"x"),Q("mo",{stretchy:"false"},")"),Q("mo",null,","),Q("mstyle",{scriptlevel:"0"},[Q("mspace",{width:"1em"})]),Q("mi",null,"D"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"c"),Q("mo",null,"+"),Q("mi",null,"x"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("mi",null,"D"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"x"),Q("mo",{stretchy:"false"},")"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mo",null,"。")]),Q("mstyle",{scriptlevel:"0"},[Q("mspace",{width:"1em"})]),Q("mi",null,"c"),Q("mi",{mathvariant:"normal"},"为"),Q("mi",{mathvariant:"normal"},"常"),Q("mi",{mathvariant:"normal"},"数")])],-1))])])]),Q("p",null,[Q("strong",null,[t[131]||(t[131]=T("3、深入理解")),Q("mjx-container",x1,[(l(),a("svg",f1,t[129]||(t[129]=[e("",1)]))),t[130]||(t[130]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msqrt",null,[Q("msub",null,[Q("mi",null,"d"),Q("mi",null,"k")])])])],-1))]),t[132]||(t[132]=T("缓解梯度爆炸问题"))])]),Q("ul",null,[Q("li",null,[Q("p",null,[t[137]||(t[137]=T("Attention计算过程：内积")),Q("mjx-container",M1,[(l(),a("svg",V1,t[133]||(t[133]=[e("",1)]))),t[134]||(t[134]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"Q"),Q("mi",null,"K")])],-1))]),t[138]||(t[138]=T("后 -> softmax。softmax主要入参是")),Q("mjx-container",y1,[(l(),a("svg",k1,t[135]||(t[135]=[e("",1)]))),t[136]||(t[136]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msup",null,[Q("mi",null,"e"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"q"),Q("mi",null,"k")])])])],-1))]),t[139]||(t[139]=T("。"))])]),Q("li",null,[Q("p",null,[t[142]||(t[142]=Q("strong",null,"如果不进行缩放",-1)),t[143]||(t[143]=T("，softmax参数在")),Q("mjx-container",Z1,[(l(),a("svg",b1,t[140]||(t[140]=[e("",1)]))),t[141]||(t[141]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mo",{stretchy:"false"},"["),Q("msup",null,[Q("mi",null,"e"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mo",null,"−"),Q("mn",null,"3"),Q("msqrt",null,[Q("mi",null,"d")])])]),Q("mo",null,","),Q("mstyle",{scriptlevel:"0"},[Q("mspace",{width:"0.278em"})]),Q("msup",null,[Q("mi",null,"e"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mn",null,"3"),Q("msqrt",null,[Q("mi",null,"d")])])]),Q("mo",{stretchy:"false"},"]")])],-1))]),t[144]||(t[144]=T("之间， ")),t[145]||(t[145]=Q("mark",null,"参数会很大或很小，导致attention接近one-hot分布",-1)),t[146]||(t[146]=T("。"))]),t[147]||(t[147]=Q("ul",null,[Q("li",null,[Q("strong",null,"饱和区梯度消失"),T("："),Q("mark",null,"x值继续变大，y几乎不变")])],-1))]),Q("li",null,[Q("p",null,[t[154]||(t[154]=T("因此，QK后才除以")),Q("mjx-container",v1,[(l(),a("svg",D1,t[148]||(t[148]=[e("",1)]))),t[149]||(t[149]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msqrt",null,[Q("msub",null,[Q("mi",null,"d"),Q("mi",null,"k")])])])],-1))]),t[155]||(t[155]=T(" ，")),Q("mark",null,[t[152]||(t[152]=T("使得softmax入参在")),Q("mjx-container",_1,[(l(),a("svg",j1,t[150]||(t[150]=[e("",1)]))),t[151]||(t[151]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mo",{stretchy:"false"},"["),Q("msup",null,[Q("mi",null,"e"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mo",null,"−"),Q("mn",null,"3")])]),Q("mo",null,","),Q("msup",null,[Q("mi",null,"e"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mn",null,"3")])]),Q("mo",{stretchy:"false"},"]")])],-1))]),t[153]||(t[153]=T("之间，不大也不小"))]),t[156]||(t[156]=T("。"))])]),Q("li",null,[t[167]||(t[167]=Q("p",null,"数学思路",-1)),Q("ul",null,[Q("li",null,[Q("mjx-container",A1,[(l(),a("svg",C1,t[157]||(t[157]=[e("",1)]))),t[158]||(t[158]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"q"),Q("mo",null,"⋅"),Q("mi",null,"k")])],-1))]),t[161]||(t[161]=T(" 除以")),Q("mjx-container",E1,[(l(),a("svg",S1,t[159]||(t[159]=[e("",1)]))),t[160]||(t[160]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msqrt",null,[Q("mi",null,"d")])])],-1))]),t[162]||(t[162]=T("，抵消掉，由0-d正态分布，")),t[163]||(t[163]=Q("strong",null,"又回到0-1正态分布",-1)),t[164]||(t[164]=T("。"))])]),Q("mjx-container",R1,[(l(),a("svg",P1,t[165]||(t[165]=[e("",1)]))),t[166]||(t[166]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mi",null,"E"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"q"),Q("mo",null,"⋅"),Q("mi",null,"k"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("mn",null,"0"),Q("mo",null,","),Q("mstyle",{scriptlevel:"0"},[Q("mspace",{width:"1em"})]),Q("mi",null,"D"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"q"),Q("mo",null,"⋅"),Q("mi",null,"k"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("mi",null,"d"),Q("mstyle",{scriptlevel:"0"},[Q("mspace",{width:"1em"})]),Q("mo",{stretchy:"false"},"⇒"),Q("mstyle",{scriptlevel:"0"},[Q("mspace",{width:"1em"})]),Q("mi",null,"D"),Q("mo",{stretchy:"false"},"("),Q("mfrac",null,[Q("mrow",null,[Q("mi",null,"q"),Q("mo",null,"⋅"),Q("mi",null,"k")]),Q("msqrt",null,[Q("mi",null,"d")])]),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("mfrac",null,[Q("mrow",null,[Q("mi",null,"q"),Q("mo",null,"⋅"),Q("mi",null,"k")]),Q("mrow",null,[Q("mo",{stretchy:"false"},"("),Q("msqrt",null,[Q("mi",null,"d")]),Q("msup",null,[Q("mo",{stretchy:"false"},")"),Q("mn",null,"2")])])]),Q("mo",null,"="),Q("mn",null,"1")])],-1))]),t[168]||(t[168]=Q("ul",null,[Q("li",null,"方差为1，有效控制点积结果发散，应对了梯度消失问题。")],-1))])])]),t[511]||(t[511]=e("",9)),Q("div",B1,[t[187]||(t[187]=Q("div",{class:"custom-block-title"},"Softmax Tiling",-1)),t[188]||(t[188]=Q("p",null,[T("参考文章："),Q("a",{href:"https://zhuanlan.zhihu.com/p/683191121",target:"_blank",rel:"noreferrer"},"FlashAttention中的softmax快分块计算详解")],-1)),Q("ul",null,[Q("li",null,[t[184]||(t[184]=Q("strong",null,"数值稳定",-1)),t[185]||(t[185]=T("：")),Q("mark",null,[t[177]||(t[177]=T("避免数值")),Q("mjx-container",N1,[(l(),a("svg",I1,t[173]||(t[173]=[e("",1)]))),t[174]||(t[174]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msup",null,[Q("mi",null,"e"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("msub",null,[Q("mi",null,"x"),Q("mi",null,"i")])])])])],-1))]),t[178]||(t[178]=T("过大溢出，每个元素都减去最大值得")),Q("mjx-container",O1,[(l(),a("svg",z1,t[175]||(t[175]=[e("",1)]))),t[176]||(t[176]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msup",null,[Q("mi",null,"e"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("msub",null,[Q("mi",null,"x"),Q("mi",null,"i")]),Q("mo",null,"−"),Q("mi",null,"m"),Q("mi",null,"a"),Q("mi",null,"x"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"x"),Q("mo",{stretchy:"false"},")")])])])],-1))])]),Q("ul",null,[Q("li",null,[Q("strong",null,[t[181]||(t[181]=T("改进后")),Q("mjx-container",q1,[(l(),a("svg",G1,t[179]||(t[179]=[e("",1)]))),t[180]||(t[180]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msup",null,[Q("mi",null,"e"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("msub",null,[Q("mi",null,"x"),Q("mi",null,"i")]),Q("mo",null,"−"),Q("mi",null,"m"),Q("mi",null,"a"),Q("mi",null,"x"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"x"),Q("mo",{stretchy:"false"},")")])])])],-1))]),t[182]||(t[182]=T("落在[0,1]区间"))]),t[183]||(t[183]=T("。softmax结果和原softmax一致"))])])]),t[186]||(t[186]=e("",1))])]),t[512]||(t[512]=Q("p",null,[Q("strong",null,"3、Flash Attention 算法")],-1)),Q("div",J1,[t[200]||(t[200]=Q("div",{class:"custom-block-title"},"Flash Attention 算法",-1)),Q("ul",null,[t[197]||(t[197]=Q("li",null,"主要目标：避免从GPU-HBM中读取和写入注意力矩阵。",-1)),t[198]||(t[198]=Q("li",null,[Q("strong",null,"计算softmax不需要全局信息"),Q("ul",null,[Q("li",null,[T("把输入分块，以分块增量方式计算softmax，即 "),Q("code",null,"softmax tiling"),T("算法。")])])],-1)),Q("li",null,[Q("strong",null,[t[191]||(t[191]=T("反向传播不存储中间attention矩阵(")),Q("mjx-container",X1,[(l(),a("svg",K1,t[189]||(t[189]=[e("",1)]))),t[190]||(t[190]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msup",null,[Q("mi",null,"N"),Q("mn",null,"2")])])],-1))]),t[192]||(t[192]=T(")"))]),t[193]||(t[193]=T("，")),t[194]||(t[194]=Q("strong",null,"只存储softmax归一化系数",-1)),t[195]||(t[195]=T("。 ")),t[196]||(t[196]=Q("ul",null,[Q("li",null,"标准Attention：需要把过程中的S、P写入HBM中，矩阵大小和输入序列长度有关，非常大"),Q("li",null,[Q("strong",null,"FlashAttention"),T("："),Q("strong",null,"不使用中间注意力矩阵"),T("，"),Q("mark",null,"通过存储归一化因子来减少HBM内存的消耗"),T("。")])],-1))]),t[199]||(t[199]=Q("li",null,[T("算法流程，具体见论文。 "),Q("ul",null,[Q("li",null,"简单讲：每次只计算一个block的只，通过多轮双for循环完成注意力计算。")])],-1))])]),t[513]||(t[513]=e("",6)),Q("div",F1,[t[213]||(t[213]=Q("div",{class:"custom-block-title"},"Batch Normalization",-1)),t[214]||(t[214]=Q("p",null,[Q("strong",null,"BN定义")],-1)),Q("ul",null,[t[209]||(t[209]=Q("li",null,[T("范围："),Q("strong",null,"对一个Batch的样本"),T("，"),Q("strong",null,"为每个通道数据做归一化")],-1)),t[210]||(t[210]=Q("li",null,[Q("strong",null,"求均值、方差"),T("，"),Q("mark",null,"让数据标准化到(0, 1)正态分布"),T("，避免发生梯度消失")],-1)),Q("li",null,[Q("strong",null,[t[205]||(t[205]=T("加入缩放")),Q("mjx-container",W1,[(l(),a("svg",U1,t[201]||(t[201]=[Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D6FE",d:"M31 249Q11 249 11 258Q11 275 26 304T66 365T129 418T206 441Q233 441 239 440Q287 429 318 386T371 255Q385 195 385 170Q385 166 386 166L398 193Q418 244 443 300T486 391T508 430Q510 431 524 431H537Q543 425 543 422Q543 418 522 378T463 251T391 71Q385 55 378 6T357 -100Q341 -165 330 -190T303 -216Q286 -216 286 -188Q286 -138 340 32L346 51L347 69Q348 79 348 100Q348 257 291 317Q251 355 196 355Q148 355 108 329T51 260Q49 251 47 251Q45 249 31 249Z",style:{"stroke-width":"3"}})])])],-1)]))),t[202]||(t[202]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"γ")])],-1))]),t[206]||(t[206]=T("和平移变量")),Q("mjx-container",$1,[(l(),a("svg",Y1,t[203]||(t[203]=[Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D6FD",d:"M29 -194Q23 -188 23 -186Q23 -183 102 134T186 465Q208 533 243 584T309 658Q365 705 429 705H431Q493 705 533 667T573 570Q573 465 469 396L482 383Q533 332 533 252Q533 139 448 65T257 -10Q227 -10 203 -2T165 17T143 40T131 59T126 65L62 -188Q60 -194 42 -194H29ZM353 431Q392 431 427 419L432 422Q436 426 439 429T449 439T461 453T472 471T484 495T493 524T501 560Q503 569 503 593Q503 611 502 616Q487 667 426 667Q384 667 347 643T286 582T247 514T224 455Q219 439 186 308T152 168Q151 163 151 147Q151 99 173 68Q204 26 260 26Q302 26 349 51T425 137Q441 171 449 214T457 279Q457 337 422 372Q380 358 347 358H337Q258 358 258 389Q258 396 261 403Q275 431 353 431Z",style:{"stroke-width":"3"}})])])],-1)]))),t[204]||(t[204]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"β")])],-1))])]),t[207]||(t[207]=T("：使数据在归一化后")),t[208]||(t[208]=Q("mark",null,"保留原有学习来的特征",-1))])]),Q("mjx-container",Q2,[(l(),a("svg",t2,t[211]||(t[211]=[e("",1)]))),t[212]||(t[212]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mi",null,"y"),Q("mo",null,"="),Q("mi",null,"γ"),Q("mo",null,"⋅"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mover",null,[Q("mi",null,"x"),Q("mo",{stretchy:"false"},"^")])]),Q("mo",null,"+"),Q("mi",null,"β"),Q("mo",null,","),Q("mstyle",{scriptlevel:"0"},[Q("mspace",{width:"1em"})]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mover",null,[Q("mi",null,"x"),Q("mo",{stretchy:"false"},"^")])]),Q("mo",null,"="),Q("mfrac",null,[Q("mrow",null,[Q("mi",null,"x"),Q("mo",null,"−"),Q("mi",null,"E"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"x"),Q("mo",{stretchy:"false"},")")]),Q("msqrt",null,[Q("mi",null,"V"),Q("mi",null,"a"),Q("mi",null,"r"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"x"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"+"),Q("mi",null,"ϵ")])])])],-1))]),t[215]||(t[215]=e("",4))]),t[514]||(t[514]=e("",8)),Q("div",T2,[t[225]||(t[225]=Q("div",{class:"custom-block-title"},"Deep Norm",-1)),t[226]||(t[226]=Q("p",null,[Q("strong",null,"定义")],-1)),Q("ul",null,[t[224]||(t[224]=Q("li",null,[T("范围：对Post-Layer Norm的改进。 "),Q("ul",null,[Q("li",null,"Post-LN问题：不稳定性来自梯度消失以及太大模型更新。")])],-1)),Q("li",null,[t[223]||(t[223]=T("算法： ")),Q("ul",null,[Q("li",null,[Q("strong",null,[t[218]||(t[218]=T("在LN之前，乘以")),Q("mjx-container",a2,[(l(),a("svg",l2,t[216]||(t[216]=[Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D6FC",d:"M34 156Q34 270 120 356T309 442Q379 442 421 402T478 304Q484 275 485 237V208Q534 282 560 374Q564 388 566 390T582 393Q603 393 603 385Q603 376 594 346T558 261T497 161L486 147L487 123Q489 67 495 47T514 26Q528 28 540 37T557 60Q559 67 562 68T577 70Q597 70 597 62Q597 56 591 43Q579 19 556 5T512 -10H505Q438 -10 414 62L411 69L400 61Q390 53 370 41T325 18T267 -2T203 -11Q124 -11 79 39T34 156ZM208 26Q257 26 306 47T379 90L403 112Q401 255 396 290Q382 405 304 405Q235 405 183 332Q156 292 139 224T121 120Q121 71 146 49T208 26Z",style:{"stroke-width":"3"}})])])],-1)]))),t[217]||(t[217]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"α")])],-1))]),t[219]||(t[219]=T("扩大残差连接"))]),t[220]||(t[220]=T("。")),t[221]||(t[221]=Q("code",null,"LayerNorm(x * alpha + f(x))",-1))]),t[222]||(t[222]=Q("li",null,[T("以β减小部分参数的初始化范围，"),Q("a",{href:"https://plmsmile.github.io/posts/olds/dl/35-nerual-network-optim.html#xavier%E5%9D%87%E5%8C%80%E5%88%86%E5%B8%83%E5%88%9D%E5%A7%8B%E5%8C%96",target:"_blank",rel:"noreferrer"},"Xavier均匀分布初始化")],-1))])])]),t[227]||(t[227]=Q("p",null,[Q("strong",null,"优点")],-1)),t[228]||(t[228]=Q("ul",null,[Q("li",null,"具备Post-LN的好性能，且具有Pre-LN 的稳定训练")],-1))]),t[515]||(t[515]=Q("h3",{id:"rms-norm-2019-prms-norm",tabindex:"-1"},[T("RMS Norm(2019) & pRMS Norm "),Q("a",{class:"header-anchor",href:"#rms-norm-2019-prms-norm","aria-label":'Permalink to "RMS Norm(2019) & pRMS Norm"'},"​")],-1)),Q("div",e2,[t[239]||(t[239]=Q("div",{class:"custom-block-title"},"RMS Norm",-1)),t[240]||(t[240]=Q("p",null,[Q("strong",null,"RMS Norm")],-1)),Q("ul",null,[t[236]||(t[236]=Q("li",null,[Q("p",null,[T("针对LayerNorm改进，主要区别在于"),Q("mark",null,"去掉了减去均值的部分"),T("，采用"),Q("strong",null,"根均方"),T("。")])],-1)),Q("li",null,[Q("p",null,[t[231]||(t[231]=T("RMS 操作 (")),t[232]||(t[232]=Q("code",null,"Root Mean Squre",-1)),t[233]||(t[233]=T(")：")),Q("mjx-container",s2,[(l(),a("svg",m2,t[229]||(t[229]=[e("",1)]))),t[230]||(t[230]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"R"),Q("mi",null,"M"),Q("mi",null,"S"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"x"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("msqrt",null,[Q("mfrac",null,[Q("mn",null,"1"),Q("mi",null,"n")]),Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,"="),Q("mn",null,"1")]),Q("mi",null,"n")]),Q("msubsup",null,[Q("mi",null,"x"),Q("mi",null,"i"),Q("mn",null,"2")])])])],-1))])]),Q("mjx-container",n2,[(l(),a("svg",o2,t[234]||(t[234]=[e("",1)]))),t[235]||(t[235]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mover",null,[Q("msub",null,[Q("mi",null,"x"),Q("mi",null,"i")]),Q("mo",{stretchy:"false"},"^")])]),Q("mo",null,"="),Q("mfrac",null,[Q("msub",null,[Q("mi",null,"x"),Q("mi",null,"i")]),Q("mrow",null,[Q("mi",null,"R"),Q("mi",null,"M"),Q("mi",null,"S"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"x"),Q("mo",{stretchy:"false"},")")])]),Q("mo",null,"⋅"),Q("mi",null,"γ"),Q("mo",null,"+"),Q("mi",null,"β"),Q("mo",null,"="),Q("mfrac",null,[Q("msub",null,[Q("mi",null,"x"),Q("mi",null,"i")]),Q("msqrt",null,[Q("mfrac",null,[Q("mn",null,"1"),Q("mi",null,"n")]),Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,"="),Q("mn",null,"1")]),Q("mi",null,"n")]),Q("msubsup",null,[Q("mi",null,"x"),Q("mi",null,"i"),Q("mn",null,"2")])])]),Q("mo",null,"⋅"),Q("mi",null,"γ"),Q("mo",null,"+"),Q("mi",null,"β")])],-1))])])]),t[241]||(t[241]=Q("p",null,[Q("strong",null,"pRMS Norm")],-1)),t[242]||(t[242]=Q("ul",null,[Q("li",null,"核心思想：用部分数据，代替全部的计算，p为前p%的数据")],-1)),Q("mjx-container",d2,[(l(),a("svg",r2,t[237]||(t[237]=[e("",1)]))),t[238]||(t[238]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mi",null,"R"),Q("mi",null,"M"),Q("mi",null,"S"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"x"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("msqrt",null,[Q("mfrac",null,[Q("mn",null,"1"),Q("mi",null,"k")]),Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,"="),Q("mn",null,"1")]),Q("mi",null,"k")]),Q("msubsup",null,[Q("mi",null,"x"),Q("mi",null,"i"),Q("mn",null,"2")])])])],-1))])]),t[516]||(t[516]=e("",11)),Q("div",i2,[t[280]||(t[280]=Q("div",{class:"custom-block-title"},"绝对位置编码",-1)),Q("p",null,[t[247]||(t[247]=T("核心思想：")),Q("strong",null,[t[245]||(t[245]=T("直接为输入")),Q("mjx-container",h2,[(l(),a("svg",p2,t[243]||(t[243]=[e("",1)]))),t[244]||(t[244]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"x"),Q("mi",null,"k")])])],-1))]),t[246]||(t[246]=T("向量增加一个位置向量"))])]),Q("mjx-container",g2,[(l(),a("svg",H2,t[248]||(t[248]=[e("",1)]))),t[249]||(t[249]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mstyle",{mathcolor:"blue"},[Q("msub",null,[Q("mi",null,"x"),Q("mi",null,"k")]),Q("mo",null,"="),Q("msub",null,[Q("mi",null,"x"),Q("mi",null,"k")]),Q("mo",null,"+"),Q("msub",null,[Q("mi",null,"p"),Q("mi",null,"k")]),Q("mo",null,",")]),Q("mstyle",{scriptlevel:"0"},[Q("mspace",{width:"1em"})]),Q("msub",null,[Q("mi",null,"p"),Q("mi",null,"k")]),Q("mtext",null,"为位置编码，与位置k有关"),Q("mi",null,"，")])],-1))]),t[281]||(t[281]=Q("p",null,[Q("strong",null,"1. 可训练式")],-1)),Q("ul",null,[Q("li",null,[t[252]||(t[252]=T("定义：把位置向量作为可训练的参数，如")),Q("mjx-container",u2,[(l(),a("svg",L2,t[250]||(t[250]=[e("",1)]))),t[251]||(t[251]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"n"),Q("mo",null,"∗"),Q("mi",null,"d")])],-1))]),t[253]||(t[253]=T("维度。"))]),t[254]||(t[254]=Q("li",null,[T("缺点："),Q("strong",null,"没有外推性"),T("，难处理超过最大长度n的位置")],-1))]),t[282]||(t[282]=Q("p",null,[Q("strong",null,"2. 三角式")],-1)),Q("ul",null,[Q("li",null,[Q("p",null,[t[265]||(t[265]=T("定义：")),Q("mjx-container",w2,[(l(),a("svg",c2,t[255]||(t[255]=[e("",1)]))),t[256]||(t[256]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"p"),Q("mi",null,"k")])])],-1))]),t[266]||(t[266]=T("中")),Q("strong",null,[t[261]||(t[261]=T("第")),Q("mjx-container",x2,[(l(),a("svg",f2,t[257]||(t[257]=[e("",1)]))),t[258]||(t[258]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mn",null,"2"),Q("mi",null,"i")])],-1))]),t[262]||(t[262]=T("和")),Q("mjx-container",M2,[(l(),a("svg",V2,t[259]||(t[259]=[e("",1)]))),t[260]||(t[260]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mn",null,"2"),Q("mi",null,"i"),Q("mo",null,"+"),Q("mn",null,"1")])],-1))]),t[263]||(t[263]=Q("strong",null,"各位置的值，分别",-1)),t[264]||(t[264]=T("由sin和cos函数来定义"))]),t[267]||(t[267]=T("。"))]),Q("mjx-container",y2,[(l(),a("svg",k2,t[268]||(t[268]=[e("",1)]))),t[269]||(t[269]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mtable",{columnalign:"left left",columnspacing:"1em",rowspacing:"4pt"},[Q("mtr",null,[Q("mtd",null,[Q("msub",null,[Q("mi",null,"p"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"k"),Q("mo",null,","),Q("mn",null,"2"),Q("mi",null,"i")])])]),Q("mtd",null,[Q("mo",null,"="),Q("mi",null,"sin"),Q("mo",{"data-mjx-texclass":"NONE"},"⁡"),Q("mo",{stretchy:"false"},"("),Q("mfrac",null,[Q("mi",null,"k"),Q("msup",null,[Q("mn",null,"10000"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mn",null,"2"),Q("mi",null,"i"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mo",null,"/")]),Q("mi",null,"d")])])]),Q("mo",{stretchy:"false"},")")])]),Q("mtr",null,[Q("mtd",null,[Q("msub",null,[Q("mi",null,"p"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"k"),Q("mo",null,","),Q("mn",null,"2"),Q("mi",null,"i"),Q("mo",null,"+"),Q("mn",null,"1")])])]),Q("mtd",null,[Q("mo",null,"="),Q("mi",null,"cos"),Q("mo",{"data-mjx-texclass":"NONE"},"⁡"),Q("mo",{stretchy:"false"},"("),Q("mfrac",null,[Q("mi",null,"k"),Q("msup",null,[Q("mn",null,"10000"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mn",null,"2"),Q("mi",null,"i"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mo",null,"/")]),Q("mi",null,"d")])])]),Q("mo",{stretchy:"false"},")")])])])])],-1))])]),t[270]||(t[270]=Q("li",null,[Q("p",null,[T("优点：三角函数有"),Q("strong",null,"一定外推性"),T("，不用训练。")])],-1)),t[271]||(t[271]=Q("li",null,[Q("p",null,"缺点：但现在很少看到这种绝对位置编码的工作。")],-1))]),t[283]||(t[283]=Q("p",null,[Q("strong",null,"3. 递归式")],-1)),Q("ul",null,[Q("li",null,[t[274]||(t[274]=T("定义：通过递归计算位置编码，")),Q("mjx-container",Z2,[(l(),a("svg",b2,t[272]||(t[272]=[e("",1)]))),t[273]||(t[273]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"p"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"k"),Q("mo",null,"+"),Q("mn",null,"1")])]),Q("mo",null,"="),Q("mi",null,"f"),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"p"),Q("mi",null,"k")]),Q("mo",{stretchy:"false"},")")])],-1))]),t[275]||(t[275]=T("，示例")),t[276]||(t[276]=Q("a",{href:"https://arxiv.org/abs/2003.09229",target:"_blank",rel:"noreferrer"},"论文",-1)),t[277]||(t[277]=T("。"))]),t[278]||(t[278]=Q("li",null,"优点：具有较好外推性",-1)),t[279]||(t[279]=Q("li",null,"缺点：牺牲并行性，计算不足",-1))])]),t[517]||(t[517]=Q("h3",{id:"相对位置编码",tabindex:"-1"},[T("相对位置编码 "),Q("a",{class:"header-anchor",href:"#相对位置编码","aria-label":'Permalink to "相对位置编码"'},"​")],-1)),t[518]||(t[518]=Q("p",null,[Q("strong",null,"核心思想")],-1)),t[519]||(t[519]=Q("ul",null,[Q("li",null,[T("不建模输入位置的全局信息，"),Q("strong",null,"在计算attention时，考虑当前位置和目标位置的相对距离")]),Q("li",null,[T("NLP任务更适合"),Q("strong",null,"相对位置编码"),T("👍。")])],-1)),Q("div",v2,[t[306]||(t[306]=Q("div",{class:"custom-block-title"},"绝对位置编码Attention 公式",-1)),Q("p",null,[t[293]||(t[293]=T("💥")),Q("strong",null,[t[288]||(t[288]=T("计算")),Q("mjx-container",D2,[(l(),a("svg",_2,t[284]||(t[284]=[Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D456",d:"M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z",style:{"stroke-width":"3"}})])])],-1)]))),t[285]||(t[285]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"i")])],-1))]),t[289]||(t[289]=T("和")),Q("mjx-container",j2,[(l(),a("svg",A2,t[286]||(t[286]=[Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D457",d:"M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z",style:{"stroke-width":"3"}})])])],-1)]))),t[287]||(t[287]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"j")])],-1))]),t[290]||(t[290]=T("的attention"))]),t[294]||(t[294]=T("，其中")),Q("mjx-container",C2,[(l(),a("svg",E2,t[291]||(t[291]=[e("",1)]))),t[292]||(t[292]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"q"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mo",null,"、")]),Q("mi",null,"k"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mo",null,"、")]),Q("mi",null,"v"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mo",null,"、")]),Q("mi",null,"p")])],-1))]),t[295]||(t[295]=T("均为向量。"))]),Q("mjx-container",S2,[(l(),a("svg",R2,t[296]||(t[296]=[e("",1)]))),t[297]||(t[297]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mtable",{columnalign:"left",columnspacing:"1em",rowspacing:"4pt"},[Q("mtr",null,[Q("mtd",null,[Q("msub",null,[Q("mi",null,"q"),Q("mi",null,"i")]),Q("mo",null,"="),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"x"),Q("mi",null,"i")]),Q("mo",null,"+"),Q("msub",null,[Q("mi",null,"p"),Q("mi",null,"i")]),Q("mo",{stretchy:"false"},")"),Q("msub",null,[Q("mi",null,"W"),Q("mi",null,"Q")]),Q("mstyle",{scriptlevel:"0"},[Q("mspace",{width:"1em"})]),Q("mo",null,"="),Q("msub",null,[Q("mi",null,"f"),Q("mi",null,"q")]),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"x"),Q("mi",null,"i")]),Q("mo",null,","),Q("mi",null,"i"),Q("mo",{stretchy:"false"},")")])]),Q("mtr",null,[Q("mtd",null,[Q("msub",null,[Q("mi",null,"k"),Q("mi",null,"j")]),Q("mo",null,"="),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"x"),Q("mi",null,"j")]),Q("mo",null,"+"),Q("msub",null,[Q("mi",null,"p"),Q("mi",null,"j")]),Q("mo",{stretchy:"false"},")"),Q("msub",null,[Q("mi",null,"W"),Q("mi",null,"K")]),Q("mstyle",{scriptlevel:"0"},[Q("mspace",{width:"1em"})]),Q("mo",null,"="),Q("msub",null,[Q("mi",null,"f"),Q("mi",null,"k")]),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"x"),Q("mi",null,"j")]),Q("mo",null,","),Q("mi",null,"j"),Q("mo",{stretchy:"false"},")")])]),Q("mtr",null,[Q("mtd",null,[Q("msub",null,[Q("mi",null,"v"),Q("mi",null,"j")]),Q("mo",null,"="),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"x"),Q("mi",null,"j")]),Q("mo",null,"+"),Q("msub",null,[Q("mi",null,"p"),Q("mi",null,"j")]),Q("mo",{stretchy:"false"},")"),Q("msub",null,[Q("mi",null,"W"),Q("mi",null,"V")]),Q("mstyle",{scriptlevel:"0"},[Q("mspace",{width:"1em"})]),Q("mo",null,"="),Q("msub",null,[Q("mi",null,"f"),Q("mi",null,"v")]),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"x"),Q("mi",null,"j")]),Q("mo",null,","),Q("mi",null,"j"),Q("mo",{stretchy:"false"},")")])]),Q("mtr",null,[Q("mtd",null,[Q("msub",null,[Q("mi",null,"α"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,","),Q("mi",null,"j")])]),Q("mo",null,"="),Q("mtext",null,"softmax"),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"q"),Q("mi",null,"i")]),Q("msubsup",null,[Q("mi",null,"k"),Q("mi",null,"j"),Q("mi",null,"T")]),Q("mo",{stretchy:"false"},")")])]),Q("mtr",null,[Q("mtd",null,[Q("msub",null,[Q("mi",null,"o"),Q("mi",null,"i")]),Q("mo",null,"="),Q("munder",null,[Q("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"j")])]),Q("msub",null,[Q("mi",null,"α"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,","),Q("mi",null,"j")])]),Q("msub",null,[Q("mi",null,"v"),Q("mi",null,"j")])])])])])],-1))]),Q("p",null,[t[301]||(t[301]=T("⭐")),Q("strong",null,[Q("mjx-container",P2,[(l(),a("svg",B2,t[298]||(t[298]=[e("",1)]))),t[299]||(t[299]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"q"),Q("mi",null,"i")]),Q("msubsup",null,[Q("mi",null,"k"),Q("mi",null,"j"),Q("mi",null,"T")])])],-1))]),t[300]||(t[300]=T("展开项"))]),t[302]||(t[302]=T("，")),t[303]||(t[303]=Q("strong",null,"后续相对位置编码都是基于此修改",-1))]),Q("mjx-container",N2,[(l(),a("svg",I2,t[304]||(t[304]=[e("",1)]))),t[305]||(t[305]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mstyle",{mathcolor:"blue"},[Q("mtable",{columnalign:"left left",columnspacing:"1em",rowspacing:"4pt"},[Q("mtr",null,[Q("mtd",null,[Q("msub",null,[Q("mi",null,"q"),Q("mi",null,"i")]),Q("msubsup",null,[Q("mi",null,"k"),Q("mi",null,"j"),Q("mi",null,"T")])]),Q("mtd",null,[Q("mo",null,"="),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"x"),Q("mi",null,"i")]),Q("mo",null,"+"),Q("msub",null,[Q("mi",null,"p"),Q("mi",null,"i")]),Q("mo",{stretchy:"false"},")"),Q("msub",null,[Q("mi",null,"W"),Q("mi",null,"Q")]),Q("mo",null,"⋅"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mo",{minsize:"2.047em",maxsize:"2.047em"},"(")]),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"x"),Q("mi",null,"j")]),Q("mo",null,"+"),Q("msub",null,[Q("mi",null,"p"),Q("mi",null,"j")]),Q("mo",{stretchy:"false"},")"),Q("msub",null,[Q("mi",null,"W"),Q("mi",null,"K")]),Q("msup",null,[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mo",{minsize:"2.047em",maxsize:"2.047em"},")")]),Q("mi",null,"T")])])]),Q("mtr",null,[Q("mtd"),Q("mtd",null,[Q("mo",null,"="),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"x"),Q("mi",null,"i")]),Q("mo",null,"+"),Q("msub",null,[Q("mi",null,"p"),Q("mi",null,"i")]),Q("mo",{stretchy:"false"},")"),Q("msub",null,[Q("mi",null,"W"),Q("mi",null,"Q")]),Q("mo",null,"⋅"),Q("msubsup",null,[Q("mi",null,"W"),Q("mi",null,"K"),Q("mi",null,"T")]),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"x"),Q("mi",null,"j")]),Q("mo",null,"+"),Q("msub",null,[Q("mi",null,"p"),Q("mi",null,"j")]),Q("msup",null,[Q("mo",{stretchy:"false"},")"),Q("mi",null,"T")])])]),Q("mtr",null,[Q("mtd"),Q("mtd",null,[Q("mo",null,"="),Q("mstyle",{mathcolor:"red"},[Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"x"),Q("mi",null,"i")]),Q("msub",null,[Q("mi",null,"W"),Q("mi",null,"Q")]),Q("mo",null,"+"),Q("msub",null,[Q("mi",null,"p"),Q("mi",null,"i")]),Q("msub",null,[Q("mi",null,"W"),Q("mi",null,"Q")]),Q("mo",{stretchy:"false"},")"),Q("mo",null,"⋅"),Q("mo",{stretchy:"false"},"("),Q("msubsup",null,[Q("mi",null,"W"),Q("mi",null,"K"),Q("mi",null,"T")]),Q("msubsup",null,[Q("mi",null,"x"),Q("mi",null,"j"),Q("mi",null,"T")]),Q("mo",null,"+"),Q("msubsup",null,[Q("mi",null,"W"),Q("mi",null,"K"),Q("mi",null,"T")]),Q("msubsup",null,[Q("mi",null,"p"),Q("mi",null,"j"),Q("mi",null,"T")]),Q("mo",{stretchy:"false"},")")])])]),Q("mtr",null,[Q("mtd"),Q("mtd",null,[Q("mo",null,"="),Q("munder",null,[Q("mrow",{"data-mjx-texclass":"OP"},[Q("munder",null,[Q("mrow",null,[Q("msub",null,[Q("mi",null,"x"),Q("mi",null,"i")]),Q("msub",null,[Q("mi",null,"W"),Q("mi",null,"Q")]),Q("msubsup",null,[Q("mi",null,"W"),Q("mi",null,"K"),Q("mi",null,"T")]),Q("msubsup",null,[Q("mi",null,"x"),Q("mi",null,"j"),Q("mi",null,"T")])]),Q("mo",null,"⏟")])]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mstyle",{mathcolor:"red"},[Q("mi",{mathvariant:"normal"},"输"),Q("mi",{mathvariant:"normal"},"入"),Q("mi",null,"i"),Q("mo",null,"−"),Q("mi",{mathvariant:"normal"},"输"),Q("mi",{mathvariant:"normal"},"入"),Q("mi",null,"j")])])]),Q("mo",null,"+"),Q("munder",null,[Q("mrow",{"data-mjx-texclass":"OP"},[Q("munder",null,[Q("mrow",null,[Q("msub",null,[Q("mi",null,"x"),Q("mi",null,"i")]),Q("msub",null,[Q("mi",null,"W"),Q("mi",null,"Q")]),Q("msubsup",null,[Q("mi",null,"W"),Q("mi",null,"K"),Q("mi",null,"T")]),Q("msubsup",null,[Q("mi",null,"p"),Q("mi",null,"j"),Q("mi",null,"T")])]),Q("mo",null,"⏟")])]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mstyle",{mathcolor:"red"},[Q("mi",{mathvariant:"normal"},"输"),Q("mi",{mathvariant:"normal"},"入"),Q("mi",null,"i"),Q("mo",null,"−"),Q("mi",{mathvariant:"normal"},"位"),Q("mi",{mathvariant:"normal"},"置"),Q("mi",null,"j")])])]),Q("mo",null,"+"),Q("munder",null,[Q("mrow",{"data-mjx-texclass":"OP"},[Q("munder",null,[Q("mrow",null,[Q("msub",null,[Q("mi",null,"p"),Q("mi",null,"i")]),Q("msub",null,[Q("mi",null,"W"),Q("mi",null,"Q")]),Q("msubsup",null,[Q("mi",null,"W"),Q("mi",null,"K"),Q("mi",null,"T")]),Q("msubsup",null,[Q("mi",null,"x"),Q("mi",null,"j"),Q("mi",null,"T")])]),Q("mo",null,"⏟")])]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mstyle",{mathcolor:"red"},[Q("mi",{mathvariant:"normal"},"位"),Q("mi",{mathvariant:"normal"},"置"),Q("mi",null,"i"),Q("mo",null,"−"),Q("mi",{mathvariant:"normal"},"输"),Q("mi",{mathvariant:"normal"},"入"),Q("mi",null,"j")])])]),Q("mo",null,"+"),Q("mstyle",{mathcolor:"red"},[Q("munder",null,[Q("mrow",{"data-mjx-texclass":"OP"},[Q("munder",null,[Q("mrow",null,[Q("msub",null,[Q("mi",null,"p"),Q("mi",null,"i")]),Q("msub",null,[Q("mi",null,"W"),Q("mi",null,"Q")]),Q("msubsup",null,[Q("mi",null,"W"),Q("mi",null,"K"),Q("mi",null,"T")]),Q("msubsup",null,[Q("mi",null,"p"),Q("mi",null,"j"),Q("mi",null,"T")])]),Q("mo",null,"⏟")])]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{mathvariant:"normal"},"位"),Q("mi",{mathvariant:"normal"},"置"),Q("mi",null,"i"),Q("mo",null,"−"),Q("mi",{mathvariant:"normal"},"位"),Q("mi",{mathvariant:"normal"},"置"),Q("mi",null,"j")])])])])])])])])],-1))])]),Q("div",O2,[t[387]||(t[387]=Q("div",{class:"custom-block-title"},"相对位置编码",-1)),t[388]||(t[388]=Q("p",null,[T("🧠 ​"),Q("strong",null,"1、经典相对位置编码核心思想")],-1)),Q("ul",null,[Q("li",null,[t[316]||(t[316]=Q("p",null,[Q("strong",null,"核心")],-1)),Q("ul",null,[t[315]||(t[315]=Q("li",null,"从绝对位置attention公式出发",-1)),Q("li",null,[Q("mark",null,[t[311]||(t[311]=T("去掉")),Q("mjx-container",z2,[(l(),a("svg",q2,t[307]||(t[307]=[e("",1)]))),t[308]||(t[308]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"p"),Q("mi",null,"j")])])],-1))]),t[312]||(t[312]=T("及复杂内容, 由二元位置向量")),Q("mjx-container",G2,[(l(),a("svg",J2,t[309]||(t[309]=[e("",1)]))),t[310]||(t[310]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"R"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,","),Q("mi",null,"j")])])])],-1))]),t[313]||(t[313]=T("来代替"))]),t[314]||(t[314]=T("，主要在softmax和v加权里变换。"))])])]),Q("li",null,[Q("p",null,[t[323]||(t[323]=T("💥")),Q("strong",null,[t[319]||(t[319]=T("相对位置")),Q("mjx-container",X2,[(l(),a("svg",K2,t[317]||(t[317]=[e("",1)]))),t[318]||(t[318]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"R"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,","),Q("mi",null,"j")])])])],-1))])]),t[324]||(t[324]=T(" ：")),Q("mark",null,[t[322]||(t[322]=T("只依赖相对距离")),Q("mjx-container",F2,[(l(),a("svg",W2,t[320]||(t[320]=[e("",1)]))),t[321]||(t[321]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"i"),Q("mo",null,"−"),Q("mi",null,"j")])],-1))])]),t[325]||(t[325]=T("，再进行截断，缩小至")),t[326]||(t[326]=Q("strong",null,"有限范围",-1)),t[327]||(t[327]=T(" ❤️。"))]),Q("ul",null,[t[331]||(t[331]=Q("li",null,"Clip裁切：把相对距离缩短至有限范围。",-1)),Q("li",null,[Q("mjx-container",U2,[(l(),a("svg",$2,t[328]||(t[328]=[e("",1)]))),t[329]||(t[329]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("msub",null,[Q("mi",{mathvariant:"bold"},"p"),Q("mi",{mathvariant:"bold"},"k")]),Q("mo",{mathvariant:"bold"},","),Q("msub",null,[Q("mi",{mathvariant:"bold"},"p"),Q("mi",{mathvariant:"bold"},"v")])])])],-1))]),t[330]||(t[330]=T("：位置向量"))])])])]),Q("mjx-container",Y2,[(l(),a("svg",Q3,t[332]||(t[332]=[e("",1)]))),t[333]||(t[333]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mstyle",{mathcolor:"blue"},[Q("mtable",{columnalign:"left left",columnspacing:"1em",rowspacing:"4pt"},[Q("mtr",null,[Q("mtd",null,[Q("msubsup",null,[Q("mi",null,"R"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,","),Q("mi",null,"j")]),Q("mi",null,"K")]),Q("mo",null,"="),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("msub",null,[Q("mi",{mathvariant:"bold"},"p"),Q("mi",{mathvariant:"bold"},"k")])]),Q("mo",{stretchy:"false"},"["),Q("mtext",null,"clip"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"i"),Q("mo",null,"−"),Q("mi",null,"j"),Q("mo",null,","),Q("msub",null,[Q("mi",null,"p"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"m"),Q("mi",null,"i"),Q("mi",null,"n")])]),Q("mo",null,","),Q("msub",null,[Q("mi",null,"p"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"m"),Q("mi",null,"a"),Q("mi",null,"x")])]),Q("mo",{stretchy:"false"},")"),Q("mo",{stretchy:"false"},"]")])]),Q("mtr",null,[Q("mtd",null,[Q("msubsup",null,[Q("mi",null,"R"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,","),Q("mi",null,"j")]),Q("mi",null,"V")]),Q("mo",null,"="),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("msub",null,[Q("mi",{mathvariant:"bold"},"p"),Q("mi",{mathvariant:"bold"},"v")])]),Q("mo",{stretchy:"false"},"["),Q("mtext",null,"clip"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"i"),Q("mo",null,"−"),Q("mi",null,"j"),Q("mo",null,","),Q("msub",null,[Q("mi",null,"p"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"m"),Q("mi",null,"i"),Q("mi",null,"n")])]),Q("mo",null,","),Q("msub",null,[Q("mi",null,"p"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"m"),Q("mi",null,"a"),Q("mi",null,"x")])]),Q("mo",{stretchy:"false"},")"),Q("mo",{stretchy:"false"},"]")])])])])])],-1))]),t[389]||(t[389]=Q("ul",null,[Q("li",null,[Q("strong",null,"优点"),Q("ul",null,[Q("li",null,[Q("strong",null,"只需要有有限个位置向量，即可表示任意相对位置(因为进行了截断)"),T(" 👍")])])])],-1)),t[390]||(t[390]=Q("p",null,[Q("strong",null,"2、XLNet式相对位置编码")],-1)),Q("ul",null,[Q("li",null,[t[363]||(t[363]=Q("strong",null,"核心",-1)),Q("ul",null,[Q("li",null,[t[351]||(t[351]=T("从公式")),Q("mjx-container",t3,[(l(),a("svg",T3,t[334]||(t[334]=[e("",1)]))),t[335]||(t[335]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("msub",null,[Q("mi",{mathvariant:"bold"},"q"),Q("mi",{mathvariant:"bold"},"i")]),Q("msubsup",null,[Q("mi",{mathvariant:"bold"},"k"),Q("mi",{mathvariant:"bold"},"j"),Q("mi",{mathvariant:"bold"},"T")])])])],-1))]),t[352]||(t[352]=T("展开，")),Q("mark",null,[t[346]||(t[346]=T("把")),Q("mjx-container",a3,[(l(),a("svg",l3,t[336]||(t[336]=[e("",1)]))),t[337]||(t[337]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"p"),Q("mi",null,"j")])])],-1))]),t[347]||(t[347]=T(" 改成相对位置向量")),Q("mjx-container",e3,[(l(),a("svg",s3,t[338]||(t[338]=[e("",1)]))),t[339]||(t[339]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"R"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,"−"),Q("mi",null,"j")])])])],-1))]),t[348]||(t[348]=T("， 把2个")),Q("mjx-container",m3,[(l(),a("svg",n3,t[340]||(t[340]=[e("",1)]))),t[341]||(t[341]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"p"),Q("mi",null,"i")])])],-1))]),t[349]||(t[349]=T("替换为可训练向量")),Q("mjx-container",o3,[(l(),a("svg",d3,t[342]||(t[342]=[Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D462",d:"M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z",style:{"stroke-width":"3"}})])])],-1)]))),t[343]||(t[343]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"u")])],-1))]),t[350]||(t[350]=T("和")),Q("mjx-container",r3,[(l(),a("svg",i3,t[344]||(t[344]=[Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D463",d:"M173 380Q173 405 154 405Q130 405 104 376T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Q21 294 29 316T53 368T97 419T160 441Q202 441 225 417T249 361Q249 344 246 335Q246 329 231 291T200 202T182 113Q182 86 187 69Q200 26 250 26Q287 26 319 60T369 139T398 222T409 277Q409 300 401 317T383 343T365 361T357 383Q357 405 376 424T417 443Q436 443 451 425T467 367Q467 340 455 284T418 159T347 40T241 -11Q177 -11 139 22Q102 54 102 117Q102 148 110 181T151 298Q173 362 173 380Z",style:{"stroke-width":"3"}})])])],-1)]))),t[345]||(t[345]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"v")])],-1))])])]),Q("li",null,[Q("mjx-container",h3,[(l(),a("svg",p3,t[353]||(t[353]=[e("",1)]))),t[354]||(t[354]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"R"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,"−"),Q("mi",null,"j")])])])],-1))]),t[355]||(t[355]=T("不做截断，用了Sinusoidal式的生成方案。"))]),Q("li",null,[Q("strong",null,[Q("mjx-container",g3,[(l(),a("svg",H3,t[356]||(t[356]=[e("",1)]))),t[357]||(t[357]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"v"),Q("mi",null,"j")])])],-1))]),t[358]||(t[358]=T("加权时不再需要位置偏置"))]),t[361]||(t[361]=T("，直接是")),Q("mjx-container",u3,[(l(),a("svg",L3,t[359]||(t[359]=[e("",1)]))),t[360]||(t[360]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"o"),Q("mi",null,"i")]),Q("mo",null,"="),Q("munder",null,[Q("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),Q("mi",null,"j")]),Q("msub",null,[Q("mi",null,"α"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,","),Q("mi",null,"j")])]),Q("mtext",null," "),Q("msub",null,[Q("mi",null,"x"),Q("mi",null,"j")]),Q("mtext",null," "),Q("msub",null,[Q("mi",null,"W"),Q("mi",null,"v")])])],-1))])]),t[362]||(t[362]=Q("li",null,[Q("mark",null,"后期工作相对位置只在attention权重上计算，不在v上了"),T("。")],-1))])])]),t[391]||(t[391]=Q("p",null,[Q("strong",null,"3、T5")],-1)),Q("ul",null,[Q("li",null,[Q("p",null,[t[366]||(t[366]=Q("strong",null,"核心",-1)),t[367]||(t[367]=T("：从")),Q("mjx-container",w3,[(l(),a("svg",c3,t[364]||(t[364]=[e("",1)]))),t[365]||(t[365]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("msub",null,[Q("mi",{mathvariant:"bold"},"q"),Q("mi",{mathvariant:"bold"},"i")]),Q("msubsup",null,[Q("mi",{mathvariant:"bold"},"k"),Q("mi",{mathvariant:"bold"},"j"),Q("mi",{mathvariant:"bold"},"T")])])])],-1))]),t[368]||(t[368]=T("展开出发做简化。认为输入和位置当解耦不做交互，直接删掉很多项，增加相对位置编码可训练参数"))]),Q("mjx-container",x3,[(l(),a("svg",f3,t[369]||(t[369]=[e("",1)]))),t[370]||(t[370]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mstyle",{mathcolor:"blue"},[Q("msub",null,[Q("mi",null,"q"),Q("mi",null,"i")]),Q("msubsup",null,[Q("mi",null,"k"),Q("mi",null,"j"),Q("mi",null,"T")]),Q("mo",null,"="),Q("msub",null,[Q("mi",null,"x"),Q("mi",null,"i")]),Q("msub",null,[Q("mi",null,"W"),Q("mi",null,"Q")]),Q("msubsup",null,[Q("mi",null,"W"),Q("mi",null,"K"),Q("mi",null,"T")]),Q("msub",null,[Q("mi",null,"x"),Q("mi",null,"j")]),Q("mo",null,"+"),Q("mstyle",{mathcolor:"red"},[Q("msub",null,[Q("mi",null,"β"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,","),Q("mi",null,"j")])])])])])],-1))])]),Q("li",null,[Q("p",null,[Q("mjx-container",M3,[(l(),a("svg",V3,t[371]||(t[371]=[e("",1)]))),t[372]||(t[372]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"β"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,","),Q("mi",null,"j")])])])],-1))]),t[379]||(t[379]=T("不做")),Q("mjx-container",y3,[(l(),a("svg",k3,t[373]||(t[373]=[e("",1)]))),t[374]||(t[374]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"i"),Q("mo",null,"−"),Q("mi",null,"j")])],-1))]),t[380]||(t[380]=T("截断，做分桶处理，相对位置")),Q("mjx-container",Z3,[(l(),a("svg",b3,t[375]||(t[375]=[e("",1)]))),t[376]||(t[376]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"i"),Q("mo",null,"−"),Q("mi",null,"j")])],-1))]),t[381]||(t[381]=T("对应")),Q("mjx-container",v3,[(l(),a("svg",D3,t[377]||(t[377]=[e("",1)]))),t[378]||(t[378]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"f"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"i"),Q("mo",null,"−"),Q("mi",null,"j"),Q("mo",{stretchy:"false"},")")])],-1))]),t[382]||(t[382]=T("。近的位置使用独立精细编码，越远越共用一个位置编码。"))])])]),t[392]||(t[392]=Q("p",null,[Q("strong",null,"4、Deberta式")],-1)),Q("ul",null,[Q("li",null,[t[385]||(t[385]=T("核心：从")),Q("mjx-container",_3,[(l(),a("svg",j3,t[383]||(t[383]=[e("",1)]))),t[384]||(t[384]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"q"),Q("mi",null,"i")]),Q("msubsup",null,[Q("mi",null,"k"),Q("mi",null,"j"),Q("mi",null,"T")])])],-1))]),t[386]||(t[386]=T("出发，扔掉第4项，保留2、3项并改为相对位置编码。"))])])]),t[520]||(t[520]=e("",4)),Q("div",A3,[t[477]||(t[477]=Q("div",{class:"custom-block-title"},"RoPE",-1)),t[478]||(t[478]=Q("p",null,[T("🌟"),Q("strong",null,"核心思想")],-1)),Q("ul",null,[t[410]||(t[410]=Q("li",null,[Q("strong",null,"RoPE位置编码通过将一个向量旋转某个角度，为其赋予位置信息"),T("。")],-1)),t[411]||(t[411]=Q("li",null,[T("RoPE"),Q("strong",null,"通过绝对位置方式实现相对位置编码"),T("😍， 综合了绝对和相对的优点。")],-1)),Q("li",null,[t[405]||(t[405]=T("为")),Q("mjx-container",C3,[(l(),a("svg",E3,t[393]||(t[393]=[Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D45E",d:"M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z",style:{"stroke-width":"3"}})])])],-1)]))),t[394]||(t[394]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"q")])],-1))]),t[406]||(t[406]=T("、")),Q("mjx-container",S3,[(l(),a("svg",R3,t[395]||(t[395]=[Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D458",d:"M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z",style:{"stroke-width":"3"}})])])],-1)]))),t[396]||(t[396]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"k")])],-1))]),t[407]||(t[407]=T("向量")),Q("strong",null,[t[401]||(t[401]=T("注入绝对位置信息")),Q("mjx-container",P3,[(l(),a("svg",B3,t[397]||(t[397]=[Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D456",d:"M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z",style:{"stroke-width":"3"}})])])],-1)]))),t[398]||(t[398]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"i")])],-1))]),t[402]||(t[402]=T(",")),Q("mjx-container",N3,[(l(),a("svg",I3,t[399]||(t[399]=[Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D457",d:"M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z",style:{"stroke-width":"3"}})])])],-1)]))),t[400]||(t[400]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"j")])],-1))])]),t[408]||(t[408]=T(" (注：很多文章使用的是m和n，这里为了保持和上文一致所以使用")),Q("mjx-container",O3,[(l(),a("svg",z3,t[403]||(t[403]=[e("",1)]))),t[404]||(t[404]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"i"),Q("mo",null,","),Q("mi",null,"j")])],-1))]),t[409]||(t[409]=T(")"))])]),Q("mjx-container",q3,[(l(),a("svg",G3,t[412]||(t[412]=[e("",1)]))),t[413]||(t[413]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("msub",null,[Q("mi",null,"q"),Q("mi",null,"i")]),Q("mo",null,"="),Q("msub",null,[Q("mi",null,"f"),Q("mi",null,"q")]),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"q"),Q("mi",null,"i")]),Q("mo",null,","),Q("mi",null,"i"),Q("mo",{stretchy:"false"},")"),Q("mo",null,","),Q("mstyle",{scriptlevel:"0"},[Q("mspace",{width:"1em"})]),Q("msub",null,[Q("mi",null,"k"),Q("mi",null,"j")]),Q("mo",null,"="),Q("msub",null,[Q("mi",null,"f"),Q("mi",null,"k")]),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"k"),Q("mi",null,"j")]),Q("mo",null,","),Q("mi",null,"j"),Q("mo",{stretchy:"false"},")")])],-1))]),Q("ul",null,[Q("li",null,[Q("strong",null,[Q("mjx-container",J3,[(l(),a("svg",X3,t[414]||(t[414]=[e("",1)]))),t[415]||(t[415]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"q"),Q("mi",null,"i")])])],-1))]),t[420]||(t[420]=T(" 和 ")),Q("mjx-container",K3,[(l(),a("svg",F3,t[416]||(t[416]=[e("",1)]))),t[417]||(t[417]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"k"),Q("mi",null,"j")])])],-1))]),t[421]||(t[421]=T(" 向量内积时，带上相对位置信息")),Q("mjx-container",W3,[(l(),a("svg",U3,t[418]||(t[418]=[e("",1)]))),t[419]||(t[419]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"i"),Q("mo",null,"−"),Q("mi",null,"j")])],-1))])])])]),Q("mjx-container",$3,[(l(),a("svg",Y3,t[422]||(t[422]=[e("",1)]))),t[423]||(t[423]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mi",null,"q"),Q("mo",null,"⋅"),Q("mi",null,"k"),Q("mo",null,"="),Q("mi",null,"f"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"q"),Q("mo",null,","),Q("mi",null,"i"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"⋅"),Q("mi",null,"f"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"k"),Q("mo",null,","),Q("mi",null,"j"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("mstyle",{mathcolor:"red"},[Q("mi",null,"g"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"q"),Q("mo",null,","),Q("mi",null,"k"),Q("mo",null,","),Q("mi",null,"i"),Q("mo",null,"−"),Q("mi",null,"j"),Q("mo",{stretchy:"false"},")")])])],-1))]),t[479]||(t[479]=Q("p",null,[Q("strong",null,"推导过程")],-1)),Q("ul",null,[Q("li",null,[t[460]||(t[460]=Q("p",null,"通过复数方程找到使等式成立的g函数，最终求解得到",-1)),Q("ul",null,[Q("li",null,[t[428]||(t[428]=T("💥")),Q("mjx-container",Q4,[(l(),a("svg",t4,t[424]||(t[424]=[e("",1)]))),t[425]||(t[425]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mstyle",{mathcolor:"blue"},[Q("mi",null,"f"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"q"),Q("mo",null,","),Q("mi",null,"m"),Q("mo",{stretchy:"false"},")")])])],-1))]),t[429]||(t[429]=T("公式，")),t[430]||(t[430]=Q("strong",null,"绝对位置编码",-1)),t[431]||(t[431]=T(" (假设是q是二维向量, ")),Q("mjx-container",T4,[(l(),a("svg",a4,t[426]||(t[426]=[Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D703",d:"M35 200Q35 302 74 415T180 610T319 704Q320 704 327 704T339 705Q393 701 423 656Q462 596 462 495Q462 380 417 261T302 66T168 -10H161Q125 -10 99 10T60 63T41 130T35 200ZM383 566Q383 668 330 668Q294 668 260 623T204 521T170 421T157 371Q206 370 254 370L351 371Q352 372 359 404T375 484T383 566ZM113 132Q113 26 166 26Q181 26 198 36T239 74T287 161T335 307L340 324H145Q145 321 136 286T120 208T113 132Z",style:{"stroke-width":"3"}})])])],-1)]))),t[427]||(t[427]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"θ")])],-1))]),t[432]||(t[432]=T("是常数)"))])]),Q("mjx-container",l4,[(l(),a("svg",e4,t[433]||(t[433]=[e("",1)]))),t[434]||(t[434]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mstyle",{mathcolor:"blue"},[Q("mi",null,"f"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"q"),Q("mo",null,","),Q("mi",null,"i"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("mi",null,"f"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"q"),Q("mo",null,","),Q("mi",null,"m"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("mstyle",{mathcolor:"red"},[Q("msub",null,[Q("mi",null,"R"),Q("mi",null,"m")]),Q("mo",null,"⋅"),Q("mi",null,"q")]),Q("mo",null,"="),Q("mstyle",{mathcolor:"red"},[Q("munder",null,[Q("mrow",{"data-mjx-texclass":"OP"},[Q("munder",null,[Q("mrow",{"data-mjx-texclass":"INNER"},[Q("mo",{"data-mjx-texclass":"OPEN"},"("),Q("mtable",{columnalign:"left left",columnspacing:"1em",rowspacing:"4pt"},[Q("mtr",null,[Q("mtd",null,[Q("mi",null,"cos"),Q("mo",{"data-mjx-texclass":"NONE"},"⁡"),Q("mi",null,"m"),Q("mi",null,"θ")]),Q("mtd",null,[Q("mo",null,"−"),Q("mi",null,"sin"),Q("mo",{"data-mjx-texclass":"NONE"},"⁡"),Q("mi",null,"m"),Q("mi",null,"θ")])]),Q("mtr",null,[Q("mtd",null,[Q("mi",null,"sin"),Q("mo",{"data-mjx-texclass":"NONE"},"⁡"),Q("mi",null,"m"),Q("mi",null,"θ")]),Q("mtd",null,[Q("mo",null,"−"),Q("mi",null,"cos"),Q("mo",{"data-mjx-texclass":"NONE"},"⁡"),Q("mi",null,"m"),Q("mi",null,"θ")])])]),Q("mo",{"data-mjx-texclass":"CLOSE"},")")]),Q("mo",null,"⏟")])]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mtext",null,"旋转矩阵")])]),Q("mo",null,"⋅"),Q("munder",null,[Q("mrow",{"data-mjx-texclass":"OP"},[Q("munder",null,[Q("mrow",{"data-mjx-texclass":"INNER"},[Q("mo",{"data-mjx-texclass":"OPEN"},"("),Q("mtable",{columnalign:"left",columnspacing:"1em",rowspacing:"4pt"},[Q("mtr",null,[Q("mtd",null,[Q("msub",null,[Q("mi",null,"q"),Q("mn",null,"0")])])]),Q("mtr",null,[Q("mtd",null,[Q("msub",null,[Q("mi",null,"q"),Q("mn",null,"1")])])])]),Q("mo",{"data-mjx-texclass":"CLOSE"},")")]),Q("mo",null,"⏟")])]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"q"),Q("mi",{mathvariant:"normal"},"向"),Q("mi",{mathvariant:"normal"},"量")])])])])])],-1))]),Q("ul",null,[Q("li",null,[t[437]||(t[437]=T("💥 ")),Q("mjx-container",s4,[(l(),a("svg",m4,t[435]||(t[435]=[e("",1)]))),t[436]||(t[436]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mstyle",{mathcolor:"blue"},[Q("mi",null,"g"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"q"),Q("mo",null,","),Q("mi",null,"k"),Q("mo",null,","),Q("mi",null,"m"),Q("mo",null,"−"),Q("mi",null,"n"),Q("mo",{stretchy:"false"},")")])])],-1))]),t[438]||(t[438]=T(" 公式，")),t[439]||(t[439]=Q("strong",null,"相对位置融入",-1))])]),Q("mjx-container",n4,[(l(),a("svg",o4,t[440]||(t[440]=[e("",1)]))),t[441]||(t[441]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mstyle",{mathcolor:"blue"},[Q("mi",null,"q"),Q("mo",null,"⋅"),Q("mi",null,"k"),Q("mo",null,"="),Q("mi",null,"g"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"q"),Q("mo",null,","),Q("mi",null,"k"),Q("mo",null,","),Q("mi",null,"m"),Q("mo",null,"−"),Q("mi",null,"n"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("msub",null,[Q("mi",null,"q"),Q("mi",null,"m")]),Q("mo",null,"⋅"),Q("msubsup",null,[Q("mi",null,"k"),Q("mi",null,"n"),Q("mi",null,"T")]),Q("mo",null,"="),Q("mo",null,"⋯"),Q("mo",null,"="),Q("mstyle",{mathcolor:"red"},[Q("msup",null,[Q("mi",null,"q"),Q("mi",null,"T")]),Q("msub",null,[Q("mi",null,"R"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"m"),Q("mo",null,"−"),Q("mi",null,"n")])]),Q("mi",null,"k")])])])],-1))]),Q("ul",null,[t[459]||(t[459]=Q("li",null,"多维向量旋转：多维向量，两两一组，分别旋转，得到旋转公式。",-1)),Q("li",null,[t[456]||(t[456]=Q("strong",null,"远程衰减",-1)),t[457]||(t[457]=T("：")),Q("mjx-container",d4,[(l(),a("svg",r4,t[442]||(t[442]=[e("",1)]))),t[443]||(t[443]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"θ"),Q("mi",null,"i")]),Q("mo",null,"="),Q("msup",null,[Q("mn",null,"10000"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mo",null,"−"),Q("mn",null,"2"),Q("mi",null,"i"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mo",null,"/")]),Q("mi",null,"d")])])])],-1))]),t[458]||(t[458]=T("。 ")),Q("ul",null,[Q("li",null,[t[453]||(t[453]=T("相反，如果")),Q("mjx-container",i4,[(l(),a("svg",h4,t[444]||(t[444]=[Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D703",d:"M35 200Q35 302 74 415T180 610T319 704Q320 704 327 704T339 705Q393 701 423 656Q462 596 462 495Q462 380 417 261T302 66T168 -10H161Q125 -10 99 10T60 63T41 130T35 200ZM383 566Q383 668 330 668Q294 668 260 623T204 521T170 421T157 371Q206 370 254 370L351 371Q352 372 359 404T375 484T383 566ZM113 132Q113 26 166 26Q181 26 198 36T239 74T287 161T335 307L340 324H145Q145 321 136 286T120 208T113 132Z",style:{"stroke-width":"3"}})])])],-1)]))),t[445]||(t[445]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"θ")])],-1))]),t[454]||(t[454]=T("是1，")),Q("strong",null,[t[450]||(t[450]=T("随着")),Q("mjx-container",p4,[(l(),a("svg",g4,t[446]||(t[446]=[e("",1)]))),t[447]||(t[447]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"i"),Q("mo",null,"−"),Q("mi",null,"j")])],-1))]),t[451]||(t[451]=T("距离增加，")),Q("mjx-container",H4,[(l(),a("svg",u4,t[448]||(t[448]=[e("",1)]))),t[449]||(t[449]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"q"),Q("mi",null,"i")]),Q("mo",null,"⋅"),Q("msub",null,[Q("mi",null,"k"),Q("mi",null,"j")])])],-1))]),t[452]||(t[452]=T("内积会震荡不会远程衰减"))]),t[455]||(t[455]=T("，这就是问题。"))])])])])])]),t[480]||(t[480]=Q("p",null,[Q("strong",null,"旋转矩阵")],-1)),Q("ul",null,[Q("li",null,[t[469]||(t[469]=T("二维空间存在旋转矩阵")),Q("mjx-container",L4,[(l(),a("svg",w4,t[461]||(t[461]=[e("",1)]))),t[462]||(t[462]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"M"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"θ"),Q("mo",{stretchy:"false"},")")])],-1))]),t[470]||(t[470]=T("，二维向量左乘")),Q("mjx-container",c4,[(l(),a("svg",x4,t[463]||(t[463]=[e("",1)]))),t[464]||(t[464]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"M"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"θ"),Q("mo",{stretchy:"false"},")")])],-1))]),t[471]||(t[471]=T("，相当于")),Q("strong",null,[t[467]||(t[467]=T("逆时针旋转")),Q("mjx-container",f4,[(l(),a("svg",M4,t[465]||(t[465]=[Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D703",d:"M35 200Q35 302 74 415T180 610T319 704Q320 704 327 704T339 705Q393 701 423 656Q462 596 462 495Q462 380 417 261T302 66T168 -10H161Q125 -10 99 10T60 63T41 130T35 200ZM383 566Q383 668 330 668Q294 668 260 623T204 521T170 421T157 371Q206 370 254 370L351 371Q352 372 359 404T375 484T383 566ZM113 132Q113 26 166 26Q181 26 198 36T239 74T287 161T335 307L340 324H145Q145 321 136 286T120 208T113 132Z",style:{"stroke-width":"3"}})])])],-1)]))),t[466]||(t[466]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"θ")])],-1))]),t[468]||(t[468]=T("弧度"))]),t[472]||(t[472]=T("。")),t[473]||(t[473]=Q("code",null,"RoPE",-1)),t[474]||(t[474]=T("旋转编码名称的来源。"))])]),Q("mjx-container",V4,[(l(),a("svg",y4,t[475]||(t[475]=[e("",1)]))),t[476]||(t[476]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mi",null,"M"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"θ"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("mrow",{"data-mjx-texclass":"INNER"},[Q("mo",{"data-mjx-texclass":"OPEN"},"("),Q("mtable",{columnalign:"left left",columnspacing:"1em",rowspacing:"4pt"},[Q("mtr",null,[Q("mtd",null,[Q("mi",null,"cos"),Q("mo",{"data-mjx-texclass":"NONE"},"⁡"),Q("mi",null,"θ")]),Q("mtd",null,[Q("mo",null,"−"),Q("mi",null,"sin"),Q("mo",{"data-mjx-texclass":"NONE"},"⁡"),Q("mi",null,"θ")])]),Q("mtr",null,[Q("mtd",null,[Q("mi",null,"sin"),Q("mo",{"data-mjx-texclass":"NONE"},"⁡"),Q("mi",null,"θ")]),Q("mtd",null,[Q("mo",null,"−"),Q("mi",null,"cos"),Q("mo",{"data-mjx-texclass":"NONE"},"⁡"),Q("mi",null,"θ")])])]),Q("mo",{"data-mjx-texclass":"CLOSE"},")")])])],-1))]),t[481]||(t[481]=Q("ul",null,[Q("li",null,"只要对向量进行旋转，就能添加对应的位置信息，且具有周期性。")],-1))]),t[521]||(t[521]=Q("img",{src:"https://pic4.zhimg.com/v2-7a27119e4fe9272ce6c26450ad8070ad_1440w.jpg",style:{display:"block",margin:"auto"},width:"80%"},null,-1)),t[522]||(t[522]=Q("h3",{id:"alibi-attention-with-linear-bias",tabindex:"-1"},[T("ALiBi (Attention with Linear Bias) "),Q("a",{class:"header-anchor",href:"#alibi-attention-with-linear-bias","aria-label":'Permalink to "ALiBi (Attention with Linear Bias)"'},"​")],-1)),Q("div",k4,[t[492]||(t[492]=Q("div",{class:"custom-block-title"},"Attention with Linear Bias",-1)),t[493]||(t[493]=Q("p",null,[Q("strong",null,"核心")],-1)),Q("ul",null,[t[490]||(t[490]=Q("li",null,"目的：解决训练推理长度不一致的问题，如 训练 1024，推理 2048",-1)),Q("li",null,[t[486]||(t[486]=T("思想：")),Q("strong",null,[t[484]||(t[484]=T("在")),Q("mjx-container",Z4,[(l(),a("svg",b4,t[482]||(t[482]=[e("",1)]))),t[483]||(t[483]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"Q"),Q("msup",null,[Q("mi",null,"K"),Q("mi",null,"T")])])],-1))]),t[485]||(t[485]=T("计算时加一个阈值好的偏置"))]),t[487]||(t[487]=T("，偏置包括了Q和K的")),t[488]||(t[488]=Q("strong",null,"相对位置",-1)),t[489]||(t[489]=T("，相距越远贡献越低。不直接输入位置编码。"))]),t[491]||(t[491]=Q("li",null,"外推性会更好点。",-1))]),t[494]||(t[494]=Q("img",{src:"https://wdndev.github.io/llm_interview_note/02.%E5%A4%A7%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E6%9E%B6%E6%9E%84/3.%E4%BD%8D%E7%BD%AE%E7%BC%96%E7%A0%81/image/image_B907xoFOlR.png",style:{display:"block",margin:"auto"},width:"80%"},null,-1))]),t[523]||(t[523]=e("",6)),Q("mjx-container",v4,[(l(),a("svg",D4,t[495]||(t[495]=[e("",1)]))),t[496]||(t[496]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mi",null,"F"),Q("mi",null,"F"),Q("mi",null,"N"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"x"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("mtext",null,"Linear"),Q("mo",{stretchy:"false"},"("),Q("mtext",null,"ReLU"),Q("mo",{stretchy:"false"},"("),Q("mtext",null,"Linear"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"x"),Q("mo",{stretchy:"false"},")"),Q("mo",{stretchy:"false"},")"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("mstyle",{mathcolor:"red"},[Q("mtext",null,"ReLU"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"x"),Q("msub",null,[Q("mi",null,"W"),Q("mn",null,"1")]),Q("mo",null,"+"),Q("msub",null,[Q("mi",null,"b"),Q("mn",null,"1")]),Q("mo",{stretchy:"false"},")"),Q("mo",null,"⋅"),Q("msub",null,[Q("mi",null,"W"),Q("mn",null,"2")]),Q("mo",null,"+"),Q("msub",null,[Q("mi",null,"b"),Q("mn",null,"2")])])])],-1))]),t[524]||(t[524]=e("",4)),Q("mjx-container",_4,[(l(),a("svg",j4,t[497]||(t[497]=[e("",1)]))),t[498]||(t[498]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mtext",null,"GeLU"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"x"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("mn",null,"0.5"),Q("mo",null,"⋅"),Q("mi",null,"x"),Q("mo",null,"⋅"),Q("mrow",{"data-mjx-texclass":"INNER"},[Q("mo",{"data-mjx-texclass":"OPEN"},"("),Q("mn",null,"1"),Q("mo",null,"+"),Q("mi",null,"tanh"),Q("mo",{"data-mjx-texclass":"NONE"},"⁡"),Q("mo",{stretchy:"false"},"("),Q("msqrt",null,[Q("mfrac",null,[Q("mn",null,"2"),Q("mi",null,"π")])]),Q("mo",null,"⋅"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"x"),Q("mo",null,"+"),Q("mn",null,"0.044715"),Q("mo",null,"⋅"),Q("msup",null,[Q("mi",null,"x"),Q("mn",null,"3")]),Q("mo",{stretchy:"false"},")"),Q("mo",{stretchy:"false"},")"),Q("mo",{"data-mjx-texclass":"CLOSE"},")")])])],-1))]),t[525]||(t[525]=Q("img",{src:"https://wdndev.github.io/llm_interview_note/02.%E5%A4%A7%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E6%9E%B6%E6%9E%84/6.%E6%BF%80%E6%B4%BB%E5%87%BD%E6%95%B0/image/image_IPa0sZKGAr.png",style:{display:"block",margin:"auto"},width:"80%"},null,-1)),t[526]||(t[526]=Q("h3",{id:"swish",tabindex:"-1"},[T("Swish "),Q("a",{class:"header-anchor",href:"#swish","aria-label":'Permalink to "Swish"'},"​")],-1)),Q("ul",null,[t[503]||(t[503]=Q("li",null,"特点：接近0时，像线性函数；远离0时，具有非线性特性。",-1)),t[504]||(t[504]=Q("li",null,"优点：相比ReLU/Tanh等具有更好性能和收敛速度。",-1)),t[505]||(t[505]=Q("li",null,"缺点：计算使用sigmoid，开销大。",-1)),Q("li",null,[t[501]||(t[501]=T("公式如下，")),Q("mjx-container",A4,[(l(),a("svg",C4,t[499]||(t[499]=[Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D6FD",d:"M29 -194Q23 -188 23 -186Q23 -183 102 134T186 465Q208 533 243 584T309 658Q365 705 429 705H431Q493 705 533 667T573 570Q573 465 469 396L482 383Q533 332 533 252Q533 139 448 65T257 -10Q227 -10 203 -2T165 17T143 40T131 59T126 65L62 -188Q60 -194 42 -194H29ZM353 431Q392 431 427 419L432 422Q436 426 439 429T449 439T461 453T472 471T484 495T493 524T501 560Q503 569 503 593Q503 611 502 616Q487 667 426 667Q384 667 347 643T286 582T247 514T224 455Q219 439 186 308T152 168Q151 163 151 147Q151 99 173 68Q204 26 260 26Q302 26 349 51T425 137Q441 171 449 214T457 279Q457 337 422 372Q380 358 347 358H337Q258 358 258 389Q258 396 261 403Q275 431 353 431Z",style:{"stroke-width":"3"}})])])],-1)]))),t[500]||(t[500]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"β")])],-1))]),t[502]||(t[502]=T("是可调节参数。"))])]),Q("mjx-container",E4,[(l(),a("svg",S4,t[506]||(t[506]=[e("",1)]))),t[507]||(t[507]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mtext",null,"Swish"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"x"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("mi",null,"x"),Q("mo",null,"⋅"),Q("mtext",null,"sigmoid"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"β"),Q("mo",null,"⋅"),Q("mi",null,"x"),Q("mo",{stretchy:"false"},")")])],-1))]),t[527]||(t[527]=e("",17))])}const G4=s(m,[["render",R4]]);export{q4 as __pageData,G4 as default};

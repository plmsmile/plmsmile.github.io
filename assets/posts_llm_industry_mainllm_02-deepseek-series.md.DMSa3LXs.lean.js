import{_ as o,c as e,o as l,ah as a,j as t,a as T}from"./chunks/framework.CvbyeFFO.js";const J1=JSON.parse('{"title":"DeepSeek 系列","description":"","frontmatter":{"title":"DeepSeek 系列","date":"2025-07-16T10:46:39.000Z","create":"2025-07-16T10:46:39.000Z","categories":["deepseek"],"tags":["DeepSeek R1","R1-Zero","Native Sparse Attention"]},"headers":[],"relativePath":"posts/llm/industry/mainllm/02-deepseek-series.md","filePath":"posts/llm/industry/mainllm/02-deepseek-series.md","lastUpdated":1763995754000}'),s={name:"posts/llm/industry/mainllm/02-deepseek-series.md"},d={class:"custom-block note"},m={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},n={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.63ex",height:"2.288ex",role:"img",focusable:"false",viewBox:"0 -853.7 3372.5 1011.5","aria-hidden":"true"},r={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},i={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.355ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.803ex",height:"2.287ex",role:"img",focusable:"false",viewBox:"0 -853.7 3448.9 1010.8","aria-hidden":"true"},h={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},g={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.65ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.956ex",height:"2.195ex",role:"img",focusable:"false",viewBox:"0 -683 1306.5 970.2","aria-hidden":"true"},p={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},c={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.339ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.874ex",height:"1.885ex",role:"img",focusable:"false",viewBox:"0 -683 1270.4 833","aria-hidden":"true"},u={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},H={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.97ex"},xmlns:"http://www.w3.org/2000/svg",width:"9ex",height:"3.144ex",role:"img",focusable:"false",viewBox:"0 -961.2 3978.1 1389.8","aria-hidden":"true"},x={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},w={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.211ex",height:"1.927ex",role:"img",focusable:"false",viewBox:"0 -694 977.3 851.8","aria-hidden":"true"},L={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},f={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.575ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.173ex",height:"2.489ex",role:"img",focusable:"false",viewBox:"0 -846 960.4 1100","aria-hidden":"true"},k={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},y={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.355ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.384ex",height:"1.926ex",role:"img",focusable:"false",viewBox:"0 -694 1053.6 851.1","aria-hidden":"true"},V={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},M={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.97ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.889ex",height:"2.884ex",role:"img",focusable:"false",viewBox:"0 -846 3486.7 1274.6","aria-hidden":"true"},b={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Z={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"10.709ex",height:"2.48ex",role:"img",focusable:"false",viewBox:"0 -846 4733.2 1096","aria-hidden":"true"},D={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},v={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.65ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.956ex",height:"2.195ex",role:"img",focusable:"false",viewBox:"0 -683 1306.5 970.2","aria-hidden":"true"},A={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},j={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-3.014ex"},xmlns:"http://www.w3.org/2000/svg",width:"28.967ex",height:"6.973ex",role:"img",focusable:"false",viewBox:"0 -1750 12803.3 3082.2","aria-hidden":"true"},C={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},R={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.211ex",height:"1.927ex",role:"img",focusable:"false",viewBox:"0 -694 977.3 851.8","aria-hidden":"true"},_={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},S={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.355ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.094ex",height:"1.38ex",role:"img",focusable:"false",viewBox:"0 -453 925.6 610.1","aria-hidden":"true"},O={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},P={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.65ex"},xmlns:"http://www.w3.org/2000/svg",width:"37.266ex",height:"2.347ex",role:"img",focusable:"false",viewBox:"0 -750 16471.4 1037.2","aria-hidden":"true"},E={class:"custom-block note"},I={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},B={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.903ex",height:"1.439ex",role:"img",focusable:"false",viewBox:"0 -442 841.3 636","aria-hidden":"true"},X={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},q={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.641ex"},xmlns:"http://www.w3.org/2000/svg",width:"32.182ex",height:"4.791ex",role:"img",focusable:"false",viewBox:"0 -950 14224.6 2117.4","aria-hidden":"true"},z={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},G={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.65ex"},xmlns:"http://www.w3.org/2000/svg",width:"25.225ex",height:"2.347ex",role:"img",focusable:"false",viewBox:"0 -750 11149.3 1037.2","aria-hidden":"true"},N={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},F={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.641ex"},xmlns:"http://www.w3.org/2000/svg",width:"33.259ex",height:"4.791ex",role:"img",focusable:"false",viewBox:"0 -950 14700.7 2117.4","aria-hidden":"true"},K={class:"custom-block important"},J={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},U={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.667ex"},xmlns:"http://www.w3.org/2000/svg",width:"9.571ex",height:"1.952ex",role:"img",focusable:"false",viewBox:"0 -568 4230.5 863","aria-hidden":"true"},$={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},W={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.607ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2036.3 1000","aria-hidden":"true"},Y={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},t1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.256ex"},xmlns:"http://www.w3.org/2000/svg",width:"84.43ex",height:"5.661ex",role:"img",focusable:"false",viewBox:"0 -1505 37317.9 2502.1","aria-hidden":"true"},Q1={class:"custom-block important"},T1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},a1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.65ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.607ex",height:"3.102ex",role:"img",focusable:"false",viewBox:"0 -1084 3362.3 1371.2","aria-hidden":"true"},e1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},l1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"18.659ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 8247.3 1000","aria-hidden":"true"},o1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},s1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.023ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.005ex",height:"1.645ex",role:"img",focusable:"false",viewBox:"0 -717 444 727","aria-hidden":"true"},d1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},m1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.65ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.957ex",height:"2.195ex",role:"img",focusable:"false",viewBox:"0 -683 1748.8 970.2","aria-hidden":"true"},n1={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},r1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-3.861ex"},xmlns:"http://www.w3.org/2000/svg",width:"46.779ex",height:"8.854ex",role:"img",focusable:"false",viewBox:"0 -2206.7 20676.2 3913.3","aria-hidden":"true"},i1={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},h1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.819ex"},xmlns:"http://www.w3.org/2000/svg",width:"122.559ex",height:"7.044ex",role:"img",focusable:"false",viewBox:"0 -1867.4 54171.2 3113.3","aria-hidden":"true"},g1={class:"custom-block note"},p1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},c1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.355ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.228ex",height:"1.33ex",role:"img",focusable:"false",viewBox:"0 -431 984.6 588.1","aria-hidden":"true"},u1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},H1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.562ex",height:"1.332ex",role:"img",focusable:"false",viewBox:"0 -431 1574.4 588.8","aria-hidden":"true"},x1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},w1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.355ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.228ex",height:"1.33ex",role:"img",focusable:"false",viewBox:"0 -431 984.6 588.1","aria-hidden":"true"},L1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},f1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.355ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.228ex",height:"1.33ex",role:"img",focusable:"false",viewBox:"0 -431 984.6 588.1","aria-hidden":"true"},k1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},y1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.562ex",height:"1.332ex",role:"img",focusable:"false",viewBox:"0 -431 1574.4 588.8","aria-hidden":"true"},V1={class:"custom-block tip"},M1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},b1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.029ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.28ex",height:"1.916ex",role:"img",focusable:"false",viewBox:"0 -833.9 1007.6 846.9","aria-hidden":"true"},Z1={class:"custom-block important"},D1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},v1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.774ex",height:"1.439ex",role:"img",focusable:"false",viewBox:"0 -442 784.3 636","aria-hidden":"true"},A1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},j1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.918ex",height:"1.902ex",role:"img",focusable:"false",viewBox:"0 -683 3057.8 840.8","aria-hidden":"true"},C1={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},R1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"40.985ex",height:"2.808ex",role:"img",focusable:"false",viewBox:"0 -991 18115.3 1241","aria-hidden":"true"},_1={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},S1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.576ex"},xmlns:"http://www.w3.org/2000/svg",width:"20.577ex",height:"2.819ex",role:"img",focusable:"false",viewBox:"0 -991 9095.2 1245.8","aria-hidden":"true"},O1={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},P1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.814ex"},xmlns:"http://www.w3.org/2000/svg",width:"27.816ex",height:"5.056ex",role:"img",focusable:"false",viewBox:"0 -991 12294.5 2234.8","aria-hidden":"true"},E1={class:"custom-block important"},I1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},B1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-1.158ex"},xmlns:"http://www.w3.org/2000/svg",width:"28.189ex",height:"3.447ex",role:"img",focusable:"false",viewBox:"0 -1011.8 12459.5 1523.5","aria-hidden":"true"};function X1(q1,Q,z1,G1,N1,F1){return l(),e("div",null,[Q[242]||(Q[242]=a("",9)),t("div",d,[Q[63]||(Q[63]=t("div",{class:"custom-block-title"},"DeepSeek Sparse Attention",-1)),Q[64]||(Q[64]=t("p",null,[t("strong",null,"Lightning Indexer")],-1)),t("ul",null,[t("li",null,[Q[33]||(Q[33]=t("p",null,"符号定义",-1)),t("ul",null,[t("li",null,[t("mjx-container",m,[(l(),e("svg",n,Q[0]||(Q[0]=[a("",1)]))),Q[1]||(Q[1]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"h")]),t("mi",null,"t")])]),t("mo",null,"∈"),t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"double-struck"},"R")]),t("mi",null,"d")])])],-1))]),Q[8]||(Q[8]=T("：")),Q[9]||(Q[9]=t("code",null,"Query token",-1)),Q[10]||(Q[10]=T("；")),t("mjx-container",r,[(l(),e("svg",i,Q[2]||(Q[2]=[a("",1)]))),Q[3]||(Q[3]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"h")]),t("mi",null,"s")])]),t("mo",null,"∈"),t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"double-struck"},"R")]),t("mi",null,"d")])])],-1))]),Q[11]||(Q[11]=T("：")),Q[12]||(Q[12]=t("code",null,"前面的某token",-1)),Q[13]||(Q[13]=T("；")),t("mjx-container",h,[(l(),e("svg",g,Q[4]||(Q[4]=[a("",1)]))),Q[5]||(Q[5]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",null,"I"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,","),t("mi",null,"s")])])])])],-1))]),Q[14]||(Q[14]=T("：")),Q[15]||(Q[15]=t("code",null,"二者的索引分数",-1)),Q[16]||(Q[16]=T("，")),t("mjx-container",p,[(l(),e("svg",c,Q[6]||(Q[6]=[a("",1)]))),Q[7]||(Q[7]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",null,"H"),t("mi",null,"I")])])])],-1))]),Q[17]||(Q[17]=T("：")),Q[18]||(Q[18]=t("code",null,"索引头数量",-1))]),t("li",null,[t("mjx-container",u,[(l(),e("svg",H,Q[19]||(Q[19]=[a("",1)]))),Q[20]||(Q[20]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mstyle",{mathcolor:"red"},[t("msubsup",null,[t("mi",null,"q"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,","),t("mi",null,"j")]),t("mi",null,"I")])]),t("mo",null,"∈"),t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"double-struck"},"R")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("msup",null,[t("mi",null,"d"),t("mi",null,"I")])])])])],-1))]),Q[29]||(Q[29]=T("：来自query-token ")),t("mjx-container",x,[(l(),e("svg",w,Q[21]||(Q[21]=[a("",1)]))),Q[22]||(Q[22]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"h")]),t("mi",null,"t")])])])],-1))]),Q[30]||(Q[30]=T("；")),t("mjx-container",L,[(l(),e("svg",f,Q[23]||(Q[23]=[a("",1)]))),Q[24]||(Q[24]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mstyle",{mathcolor:"red"},[t("msubsup",null,[t("mi",null,"k"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"s")]),t("mi",null,"I")])])])],-1))]),Q[31]||(Q[31]=T("：来自前面-token ")),t("mjx-container",k,[(l(),e("svg",y,Q[25]||(Q[25]=[a("",1)]))),Q[26]||(Q[26]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"h")]),t("mi",null,"s")])])])],-1))]),Q[32]||(Q[32]=T("，")),t("mjx-container",V,[(l(),e("svg",M,Q[27]||(Q[27]=[a("",1)]))),Q[28]||(Q[28]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msubsup",null,[t("mi",null,"w"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,","),t("mi",null,"j")]),t("mi",null,"I")]),t("mo",null,"∈"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"double-struck"},"R")])])],-1))])])])]),t("li",null,[t("p",null,[Q[38]||(Q[38]=T("使用")),Q[39]||(Q[39]=t("code",null,"超轻向量",-1)),Q[40]||(Q[40]=T()),t("mjx-container",b,[(l(),e("svg",Z,Q[34]||(Q[34]=[a("",1)]))),Q[35]||(Q[35]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mo",{stretchy:"false"},"("),t("msup",null,[t("mi",null,"q"),t("mi",null,"I")]),t("mo",null,","),t("msup",null,[t("mi",null,"k"),t("mi",null,"I")]),t("mo",null,","),t("msup",null,[t("mi",null,"w"),t("mi",null,"I")]),t("mo",{stretchy:"false"},")")])],-1))]),Q[41]||(Q[41]=T(" 计算")),Q[42]||(Q[42]=t("code",null,"索引分值",-1)),Q[43]||(Q[43]=T()),t("mjx-container",D,[(l(),e("svg",v,Q[36]||(Q[36]=[a("",1)]))),Q[37]||(Q[37]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"I"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,","),t("mi",null,"s")])])])],-1))]),Q[44]||(Q[44]=T("，决定")),Q[45]||(Q[45]=t("code",null,"哪些token被选中",-1)),Q[46]||(Q[46]=T("。"))])]),t("li",null,[Q[49]||(Q[49]=t("p",null,[T("使用"),t("code",null,"FP8(吞吐量高)"),T(" + "),t("code",null,"ReLU(比softmax快)")],-1)),t("mjx-container",A,[(l(),e("svg",j,Q[47]||(Q[47]=[a("",1)]))),Q[48]||(Q[48]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",null,"I"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,","),t("mi",null,"s")])])]),t("mo",null,"="),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"j"),t("mo",null,"="),t("mn",null,"1")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("msub",null,[t("mi",null,"H"),t("mi",null,"I")])])]),t("mstyle",{mathcolor:"red"},[t("msubsup",null,[t("mi",null,"w"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,","),t("mi",null,"j")]),t("mi",null,"I")])]),t("mo",null,"⋅"),t("mstyle",{mathcolor:"blue"},[t("mtext",null,"ReLU")]),t("mo",{stretchy:"false"},"("),t("mstyle",{mathcolor:"red"},[t("msubsup",null,[t("mi",null,"q"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,","),t("mi",null,"j")]),t("mi",null,"I")])]),t("mo",null,"⋅"),t("mstyle",{mathcolor:"red"},[t("msubsup",null,[t("mi",null,"k"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"s")]),t("mi",null,"I")])]),t("mo",{stretchy:"false"},")")])],-1))])])]),Q[65]||(Q[65]=t("p",null,[t("strong",null,"细粒度Token Topk选择器")],-1)),t("ul",null,[t("li",null,[Q[56]||(Q[56]=T("对query token ")),t("mjx-container",C,[(l(),e("svg",R,Q[50]||(Q[50]=[a("",1)]))),Q[51]||(Q[51]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"h")]),t("mi",null,"t")])])])],-1))]),Q[57]||(Q[57]=T("， 仅")),Q[58]||(Q[58]=t("code",null,"稀疏选择top-k的token",-1)),Q[59]||(Q[59]=T()),t("mjx-container",_,[(l(),e("svg",S,Q[52]||(Q[52]=[a("",1)]))),Q[53]||(Q[53]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"c")]),t("mi",null,"s")])])])],-1))]),Q[60]||(Q[60]=T(" (Key-Value对)，去")),Q[61]||(Q[61]=t("code",null,"计算注意力",-1)),Q[62]||(Q[62]=T("。")),t("mjx-container",O,[(l(),e("svg",P,Q[54]||(Q[54]=[a("",1)]))),Q[55]||(Q[55]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"u")]),t("mi",null,"t")])]),t("mo",null,"="),t("mtext",null,"Attn"),t("mo",{stretchy:"false"},"("),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"h")]),t("mi",null,"t")])]),t("mo",null,","),t("mo",{fence:"false",stretchy:"false"},"{"),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"c")]),t("mi",null,"s")])]),t("mo",null,"∣"),t("msub",null,[t("mi",null,"I"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,","),t("mi",null,"s")])]),t("mo",null,"∈"),t("mstyle",{mathcolor:"red"},[t("mtext",null,"Top-k")]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"I"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,","),t("mo",null,":")])]),t("mo",{stretchy:"false"},")"),t("mo",{fence:"false",stretchy:"false"},"}"),t("mo",{stretchy:"false"},")")])],-1))])])]),Q[66]||(Q[66]=a("",2))]),Q[243]||(Q[243]=t("img",{src:"https://pic2.zhimg.com/v2-1c50af09709adc3069bfb7246ba01ce7_1440w.jpg",style:{display:"block",margin:"auto"},width:"70%"},null,-1)),Q[244]||(Q[244]=t("h4",{id:"继续预训练",tabindex:"-1"},[T("继续预训练 "),t("a",{class:"header-anchor",href:"#继续预训练","aria-label":'Permalink to "继续预训练"'},"​")],-1)),t("div",E,[Q[90]||(Q[90]=a("",4)),t("ul",null,[Q[80]||(Q[80]=t("li",null,[t("p",null,"目标：初始化Lighting Indexer，学会预测哪些token是重要的。")],-1)),Q[81]||(Q[81]=t("li",null,[t("p",null,[T("方法："),t("code",null,"冻结主模型参数"),T("，"),t("code",null,"仅训练Indexer参数"),T("。")])],-1)),t("li",null,[Q[79]||(Q[79]=t("p",null,[T("训练目标："),t("code",null,"KL Loss"),T("作为训练目标，让"),t("code",null,"indexer预测分布"),T("接近"),t("code",null,"DenseAttention分布"),T("。")],-1)),t("ul",null,[t("li",null,[Q[69]||(Q[69]=t("code",null,"Teacher",-1)),Q[70]||(Q[70]=T("：")),Q[71]||(Q[71]=t("code",null,"DenseAttention",-1)),Q[72]||(Q[72]=T(", 目标分布，")),t("mjx-container",I,[(l(),e("svg",B,Q[67]||(Q[67]=[a("",1)]))),Q[68]||(Q[68]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"p"),t("mi",null,"t")])])],-1))]),Q[73]||(Q[73]=T("；")),Q[74]||(Q[74]=t("code",null,"Student",-1)),Q[75]||(Q[75]=T("：")),Q[76]||(Q[76]=t("code",null,"SparseAttention",-1))])]),t("mjx-container",X,[(l(),e("svg",q,Q[77]||(Q[77]=[a("",1)]))),Q[78]||(Q[78]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{"data-mjx-variant":"-tex-calligraphic",mathvariant:"script"},"L")]),t("mi",null,"I")]),t("mo",null,"="),t("munder",null,[t("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t")])]),t("msub",null,[t("mi",null,"D"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"K"),t("mi",null,"L")])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"p"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,","),t("mo",null,":")])]),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("mtext",null,"Softmax"),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"I"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,","),t("mo",null,":")])]),t("mo",{stretchy:"false"},")"),t("mo",{stretchy:"false"},")")])],-1))])]),Q[82]||(Q[82]=t("li",null,[t("p",null,[T("共训"),t("code",null,"2.1B tokens"),T("。lr=1e-3，1000步，每步16个序列，每序列128k token，")])],-1))]),Q[91]||(Q[91]=t("p",null,[t("strong",null,"Sparse 训练阶段")],-1)),t("ul",null,[Q[88]||(Q[88]=t("li",null,[t("p",null,[T("正式训练稀疏注意力，同时"),t("code",null,"训练主模型"),T("和"),t("code",null,"indexer"),T("，")])],-1)),t("li",null,[Q[87]||(Q[87]=t("p",null,[T("每个query token，"),t("code",null,"不看所有128k token"),T("，而是"),t("code",null,"仅看2048个token"),T("，执行"),t("code",null,"Top-k选择"),T("。")],-1)),t("mjx-container",z,[(l(),e("svg",G,Q[83]||(Q[83]=[a("",1)]))),Q[84]||(Q[84]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("msub",null,[t("mi",null,"S"),t("mi",null,"t")]),t("mo",null,"="),t("mo",{fence:"false",stretchy:"false"},"{"),t("mi",null,"s"),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("msub",null,[t("mi",null,"I"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,","),t("mi",null,"s")])]),t("mo",null,"∈"),t("mtext",null,"Top-k"),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"I"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,","),t("mo",null,":")])]),t("mo",{stretchy:"false"},")"),t("mo",{fence:"false",stretchy:"false"},"}")])],-1))]),t("mjx-container",N,[(l(),e("svg",F,Q[85]||(Q[85]=[a("",1)]))),Q[86]||(Q[86]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{"data-mjx-variant":"-tex-calligraphic",mathvariant:"script"},"L")]),t("mi",null,"I")]),t("mo",null,"="),t("munder",null,[t("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t")])]),t("msub",null,[t("mi",null,"D"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"K"),t("mi",null,"L")])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"p"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,","),t("mo",null,":")])]),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("mtext",null,"Softmax"),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"I"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,","),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mi",null,"S"),t("mi",null,"t")])])])]),t("mo",{stretchy:"false"},")"),t("mo",{stretchy:"false"},")")])],-1))])]),Q[89]||(Q[89]=t("li",null,[t("p",null,[T("共训 "),t("code",null,"943B tokens"),T("。lr=7.3e-6，训练1.5w步，每步480序列，每序列128k。")])],-1))])]),Q[245]||(Q[245]=a("",7)),t("div",K,[Q[109]||(Q[109]=t("div",{class:"custom-block-title"},"用IS权重优化KL-3估计",-1)),t("p",null,[t("strong",null,[Q[94]||(Q[94]=T("问题：当")),t("mjx-container",J,[(l(),e("svg",U,Q[92]||(Q[92]=[a("",1)]))),Q[93]||(Q[93]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])]),t("mo",null,"≪"),t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"r"),t("mi",null,"e"),t("mi",null,"f")])])])],-1))]),Q[95]||(Q[95]=T("时"))])]),Q[110]||(Q[110]=a("",2)),t("ul",null,[Q[106]||(Q[106]=t("li",null,[t("p",null,[T("核心："),t("code",null,"重要性采样比例"),T(" * "),t("code",null,"原始K3估计"),T("。")])],-1)),t("li",null,[t("p",null,[Q[98]||(Q[98]=T("乘以 ")),t("strong",null,[t("mjx-container",$,[(l(),e("svg",W,Q[96]||(Q[96]=[a("",1)]))),Q[97]||(Q[97]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"r"),t("mi",null,"t")]),t("mo",{stretchy:"false"},"("),t("mi",null,"θ"),t("mo",{stretchy:"false"},")")])],-1))])]),Q[99]||(Q[99]=T("，无论采样如何，梯度")),Q[100]||(Q[100]=t("code",null,"期望值都是准确",-1)),Q[101]||(Q[101]=T("的，")),Q[102]||(Q[102]=t("code",null,"消除了系统误差",-1)),Q[103]||(Q[103]=T("，")),Q[104]||(Q[104]=t("code",null,"梯度变无偏估计",-1)),Q[105]||(Q[105]=T("。"))])])]),t("mjx-container",Y,[(l(),e("svg",t1,Q[107]||(Q[107]=[a("",1)]))),Q[108]||(Q[108]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("msub",null,[t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mi",null,"D"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"K"),t("mi",null,"L")])])]),t("mstyle",{mathcolor:"blue"},[t("mi",null,"t")])]),t("mo",{stretchy:"false"},"("),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])])]),t("mo",null,","),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("msub",null,[t("mi",null,"θ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"r"),t("mi",null,"e"),t("mi",null,"f")])])])])]),t("mo",{stretchy:"false"},")"),t("mo",null,"="),t("mfrac",null,[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])]),t("mo",null,"∣"),t("mi",null,"q"),t("mo",null,","),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mo",null,"<"),t("mi",null,"t")])]),t("mo",{stretchy:"false"},")")]),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"o"),t("mi",null,"l"),t("mi",null,"d")])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])]),t("mo",null,"∣"),t("mi",null,"q"),t("mo",null,","),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mo",null,"<"),t("mi",null,"t")])]),t("mo",{stretchy:"false"},")")])]),t("mo",null,"⋅"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"2.047em",maxsize:"2.047em"},"(")]),t("mfrac",null,[t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"r"),t("mi",null,"e"),t("mi",null,"f")])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])]),t("mo",null,"∣"),t("mi",null,"q"),t("mo",null,","),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mo",null,"<"),t("mi",null,"t")])]),t("mo",{stretchy:"false"},")")]),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])]),t("mo",null,"∣"),t("mi",null,"q"),t("mo",null,","),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mo",null,"<"),t("mi",null,"t")])]),t("mo",{stretchy:"false"},")")])]),t("mstyle",{mathcolor:"red"},[t("mo",null,"−"),t("mi",null,"log")]),t("mfrac",null,[t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"r"),t("mi",null,"e"),t("mi",null,"f")])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])]),t("mo",null,"∣"),t("mi",null,"q"),t("mo",null,","),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mo",null,"<"),t("mi",null,"t")])]),t("mo",{stretchy:"false"},")")]),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])]),t("mo",null,"∣"),t("mi",null,"q"),t("mo",null,","),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mo",null,"<"),t("mi",null,"t")])]),t("mo",{stretchy:"false"},")")])]),t("mo",null,"−"),t("mn",null,"1"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"2.047em",maxsize:"2.047em"},")")])])],-1))]),Q[111]||(Q[111]=a("",3))]),Q[246]||(Q[246]=t("h4",{id:"mask-异策略负样本",tabindex:"-1"},[T("Mask 异策略负样本 "),t("a",{class:"header-anchor",href:"#mask-异策略负样本","aria-label":'Permalink to "Mask 异策略负样本"'},"​")],-1)),t("div",Q1,[Q[156]||(Q[156]=a("",4)),t("ul",null,[t("li",null,[Q[130]||(Q[130]=t("p",null,[t("code",null,"Mask不好的序列，不学它"),T("，差序列定义如下：")],-1)),t("ul",null,[t("li",null,[Q[114]||(Q[114]=t("strong",null,"结果不好",-1)),Q[115]||(Q[115]=T("：")),t("mjx-container",T1,[(l(),e("svg",a1,Q[112]||(Q[112]=[a("",1)]))),Q[113]||(Q[113]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"A"),t("mo",{stretchy:"false"},"^")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])]),t("mo",null,"<"),t("mn",null,"0")])])],-1))]),Q[116]||(Q[116]=T("，")),Q[117]||(Q[117]=t("code",null,"优势为负",-1))]),t("li",null,[Q[120]||(Q[120]=t("strong",null,"偏差大",-1)),Q[121]||(Q[121]=T("：")),t("mjx-container",e1,[(l(),e("svg",l1,Q[118]||(Q[118]=[a("",1)]))),Q[119]||(Q[119]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mi",null,"D"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"K"),t("mi",null,"L")])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"o"),t("mi",null,"l"),t("mi",null,"d")])]),t("mo",null,"∣∣"),t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])]),t("mo",{stretchy:"false"},")"),t("mo",null,">"),t("mi",null,"δ")])])],-1))]),Q[122]||(Q[122]=T("，")),Q[123]||(Q[123]=t("code",null,"KL差异大",-1)),Q[124]||(Q[124]=T("，")),Q[125]||(Q[125]=t("code",null,"rollout模型",-1)),Q[126]||(Q[126]=T("和")),Q[127]||(Q[127]=t("code",null,"当前模型",-1)),Q[128]||(Q[128]=T()),Q[129]||(Q[129]=t("code",null,"差异大",-1))])])]),t("li",null,[Q[152]||(Q[152]=t("p",null,"系数计算公式",-1)),t("ul",null,[t("li",null,[Q[133]||(Q[133]=t("code",null,"序列级KL散度",-1)),Q[134]||(Q[134]=T("：序列内")),Q[135]||(Q[135]=t("code",null,"所有token的KL值做平均",-1)),Q[136]||(Q[136]=T("，作为")),Q[137]||(Q[137]=t("code",null,"序列级KL散度",-1)),Q[138]||(Q[138]=T("，设定")),Q[139]||(Q[139]=t("code",null,"最小阈值",-1)),t("mjx-container",o1,[(l(),e("svg",s1,Q[131]||(Q[131]=[a("",1)]))),Q[132]||(Q[132]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mstyle",{mathcolor:"red"},[t("mi",null,"δ")])])],-1))])]),t("li",null,[Q[142]||(Q[142]=t("code",null,"Token级系数",-1)),Q[143]||(Q[143]=T()),t("mjx-container",d1,[(l(),e("svg",m1,Q[140]||(Q[140]=[a("",1)]))),Q[141]||(Q[141]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",null,"M"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])])])])],-1))]),Q[144]||(Q[144]=T("，")),Q[145]||(Q[145]=t("code",null,"优势为负",-1)),Q[146]||(Q[146]=T("且")),Q[147]||(Q[147]=t("code",null,"KL差异较大",-1)),Q[148]||(Q[148]=T("时，")),Q[149]||(Q[149]=t("code",null,"设为0",-1))])]),t("mjx-container",n1,[(l(),e("svg",r1,Q[150]||(Q[150]=[a("",1)]))),Q[151]||(Q[151]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",null,"M"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])])]),t("mo",null,"="),t("mrow",{"data-mjx-texclass":"INNER"},[t("mo",{"data-mjx-texclass":"OPEN"},"{"),t("mtable",{columnalign:"left left",columnspacing:"1em",rowspacing:".2em"},[t("mtr",null,[t("mtd",null,[t("mstyle",{mathcolor:"red"},[t("mn",null,"0")]),t("mo",null,",")]),t("mtd",null,[t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"A"),t("mo",{stretchy:"false"},"^")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])]),t("mo",null,"<"),t("mn",null,"0")]),t("mo",null,","),t("mstyle",{mathcolor:"blue"},[t("mfrac",null,[t("mn",null,"1"),t("mrow",null,[t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("msub",null,[t("mi",null,"o"),t("mi",null,"i")]),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|")])]),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"="),t("mn",null,"1")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("msub",null,[t("mi",null,"o"),t("mi",null,"i")]),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|")])])]),t("mstyle",{mathcolor:"red"},[t("mi",null,"log")]),t("mfrac",null,[t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"o"),t("mi",null,"l"),t("mi",null,"d")])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])]),t("mo",null,"∣"),t("mi",null,"q"),t("mo",null,","),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mo",null,"<"),t("mi",null,"t")])]),t("mo",{stretchy:"false"},")")]),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])]),t("mo",null,"∣"),t("mi",null,"q"),t("mo",null,","),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mo",null,"<"),t("mi",null,"t")])]),t("mo",{stretchy:"false"},")")])]),t("mstyle",{mathcolor:"red"},[t("mo",null,">"),t("mi",null,"δ")])])]),t("mtr",null,[t("mtd",null,[t("mn",null,"1"),t("mo",null,",")]),t("mtd",null,[t("mtext",null,"otherwise")])])]),t("mo",{"data-mjx-texclass":"CLOSE",fence:"true",stretchy:"true",symmetric:"true"})])])],-1))])]),t("li",null,[Q[155]||(Q[155]=t("p",null,"目标",-1)),t("mjx-container",i1,[(l(),e("svg",h1,Q[153]||(Q[153]=[a("",1)]))),Q[154]||(Q[154]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{"data-mjx-variant":"-tex-calligraphic",mathvariant:"script"},"J")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"GRPO")])]),t("mo",{stretchy:"false"},"("),t("mi",null,"θ"),t("mo",{stretchy:"false"},")")]),t("mo",null,"="),t("msub",null,[t("mi",null,"E"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"q"),t("mo",null,","),t("mo",{fence:"false",stretchy:"false"},"{"),t("msub",null,[t("mi",null,"o"),t("mi",null,"i")]),t("msubsup",null,[t("mo",{fence:"false",stretchy:"false"},"}"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,"="),t("mn",null,"1")]),t("mi",null,"G")]),t("mo",null,"∼"),t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"o"),t("mi",null,"l"),t("mi",null,"d")])])])]),t("mstyle",{mathcolor:"blue"},[t("mfrac",null,[t("mn",null,"1"),t("mi",null,"G")]),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,"="),t("mn",null,"1")]),t("mi",null,"G")])]),t("mstyle",{mathcolor:"red"},[t("mfrac",null,[t("mn",null,"1"),t("mrow",null,[t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("msub",null,[t("mi",null,"o"),t("mi",null,"i")]),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|")])]),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"="),t("mn",null,"1")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("msub",null,[t("mi",null,"o"),t("mi",null,"i")]),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|")])])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"2.047em",maxsize:"2.047em"},"[")]),t("mstyle",{mathcolor:"blue"},[t("mo",{"data-mjx-texclass":"OP",movablelimits:"true"},"min")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"2.047em",maxsize:"2.047em"},"(")]),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mi",null,"r"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])]),t("mo",{stretchy:"false"},"("),t("mi",null,"θ"),t("mo",{stretchy:"false"},")"),t("mo",null,"⋅"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"A"),t("mo",{stretchy:"false"},"^")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])])]),t("mo",null,","),t("mstyle",{mathcolor:"blue"},[t("mtext",null,"clip"),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"r"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])]),t("mo",{stretchy:"false"},"("),t("mi",null,"θ"),t("mo",{stretchy:"false"},")"),t("mo",null,","),t("mn",null,"1"),t("mo",null,"−"),t("mi",null,"ϵ"),t("mo",null,","),t("mn",null,"1"),t("mo",null,"+"),t("mi",null,"ϵ"),t("mo",{stretchy:"false"},")"),t("mo",null,"⋅"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"A"),t("mo",{stretchy:"false"},"^")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"2.047em",maxsize:"2.047em"},")")]),t("mstyle",{mathcolor:"red"},[t("mo",null,"⋅"),t("msub",null,[t("mi",null,"M"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])])]),t("mo",null,"−"),t("mi",null,"β"),t("msub",null,[t("mi",null,"D"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"K"),t("mi",null,"L")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"1.2em",maxsize:"1.2em"},"(")]),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])]),t("mo",{stretchy:"false"},")")]),t("mo",null,"∣∣"),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"r"),t("mi",null,"e"),t("mi",null,"f")])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])]),t("mo",{stretchy:"false"},")")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"1.2em",maxsize:"1.2em"},")")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"2.047em",maxsize:"2.047em"},"]")])])],-1))])])])]),Q[247]||(Q[247]=t("h4",{id:"保持路由和采样mask-消除训推不一致",tabindex:"-1"},[T("保持路由和采样Mask 消除训推不一致 "),t("a",{class:"header-anchor",href:"#保持路由和采样mask-消除训推不一致","aria-label":'Permalink to "保持路由和采样Mask 消除训推不一致"'},"​")],-1)),t("div",g1,[Q[182]||(Q[182]=a("",6)),t("ul",null,[t("li",null,[Q[166]||(Q[166]=T("问题： ")),t("ul",null,[Q[165]||(Q[165]=t("li",null,[T("推理时，通常使用top-p, top-k来提高回复质量，"),t("code",null,"低概率token概率为0"),T("，相当于"),t("code",null,"词表截断"),T("。")],-1)),t("li",null,[Q[161]||(Q[161]=T("训练时，计算IS权重，则")),t("mjx-container",p1,[(l(),e("svg",c1,Q[157]||(Q[157]=[a("",1)]))),Q[158]||(Q[158]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])])])],-1))]),Q[162]||(Q[162]=T("和")),t("mjx-container",u1,[(l(),e("svg",H1,Q[159]||(Q[159]=[a("",1)]))),Q[160]||(Q[160]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"o"),t("mi",null,"l"),t("mi",null,"d")])])])],-1))]),Q[163]||(Q[163]=t("code",null,"动作空间/定义域 不一样",-1)),Q[164]||(Q[164]=T("，导致计算失效。"))])])]),t("li",null,[Q[181]||(Q[181]=T("方法 ")),t("ul",null,[t("li",null,[Q[176]||(Q[176]=t("code",null,"保留采样Mask",-1)),Q[177]||(Q[177]=T("，")),Q[178]||(Q[178]=t("code",null,"在训练时应用到",-1)),t("mjx-container",x1,[(l(),e("svg",w1,Q[167]||(Q[167]=[a("",1)]))),Q[168]||(Q[168]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])])])],-1))]),Q[179]||(Q[179]=T("，该部分概率为0。")),t("strong",null,[Q[173]||(Q[173]=T("保证")),t("mjx-container",L1,[(l(),e("svg",f1,Q[169]||(Q[169]=[a("",1)]))),Q[170]||(Q[170]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])])])],-1))]),Q[174]||(Q[174]=T("和")),t("mjx-container",k1,[(l(),e("svg",y1,Q[171]||(Q[171]=[a("",1)]))),Q[172]||(Q[172]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"o"),t("mi",null,"l"),t("mi",null,"d")])])])],-1))]),Q[175]||(Q[175]=T("词表一致"))]),Q[180]||(Q[180]=T("。"))])])])])]),Q[248]||(Q[248]=a("",18)),t("div",V1,[Q[191]||(Q[191]=a("",6)),t("ul",null,[Q[188]||(Q[188]=t("li",null,[t("strong",null,"通用"),T("：MMLU-Pro, GPQA Diamond.")],-1)),Q[189]||(Q[189]=t("li",null,[t("strong",null,"数学"),T("：AIME 2025, HMMT 2025, IMO 2025.")],-1)),Q[190]||(Q[190]=t("li",null,[t("strong",null,"代码"),T("：Codeforces, LiveCodeBench, SWE-bench Verified.")],-1)),t("li",null,[Q[185]||(Q[185]=t("strong",null,"Agent",-1)),Q[186]||(Q[186]=T("：BrowseComp, ")),t("mjx-container",M1,[(l(),e("svg",b1,Q[183]||(Q[183]=[a("",1)]))),Q[184]||(Q[184]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msup",null,[t("mi",null,"τ"),t("mn",null,"2")])])],-1))]),Q[187]||(Q[187]=T("-Bench, Terminal Bench 2.0."))])]),Q[192]||(Q[192]=t("p",null,[t("strong",null,"算法/策略")],-1)),Q[193]||(Q[193]=t("ul",null,[t("li",null,"Scaling GRPO")],-1)),Q[194]||(Q[194]=t("p",null,[t("strong",null,"超参")],-1)),Q[195]||(Q[195]=t("ul",null,[t("li",null,"长度：128k"),t("li",null,"RL训练：混合思考和直出2种模式")],-1))]),Q[249]||(Q[249]=a("",26)),t("div",Z1,[Q[230]||(Q[230]=t("div",{class:"custom-block-title"},"核心方法",-1)),Q[231]||(Q[231]=t("p",null,[t("strong",null,"核心思想")],-1)),t("ul",null,[t("li",null,[Q[198]||(Q[198]=T("对每个")),t("mjx-container",D1,[(l(),e("svg",v1,Q[196]||(Q[196]=[a("",1)]))),Q[197]||(Q[197]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"q"),t("mi",null,"t")])])],-1))]),Q[199]||(Q[199]=T("，")),Q[200]||(Q[200]=t("code",null,"不使用原始完整的KV",-1)),Q[201]||(Q[201]=T("，使用通过q和上下文kv")),Q[202]||(Q[202]=t("code",null,"动态计算出来的",-1)),Q[203]||(Q[203]=T("、")),Q[204]||(Q[204]=t("code",null,"更紧凑的KV",-1))]),t("li",null,[Q[207]||(Q[207]=t("code",null,"重新映射的KV总数",-1)),Q[208]||(Q[208]=T("，")),Q[209]||(Q[209]=t("code",null,"远小于原始总数",-1)),Q[210]||(Q[210]=T("，维持")),Q[211]||(Q[211]=t("code",null,"高稀疏性",-1)),Q[212]||(Q[212]=T("。")),t("mjx-container",A1,[(l(),e("svg",j1,Q[205]||(Q[205]=[a("",1)]))),Q[206]||(Q[206]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"N"),t("mi",null,"t")]),t("mo",null,"≪"),t("mi",null,"t")])],-1))])])]),t("mjx-container",C1,[(l(),e("svg",R1,Q[213]||(Q[213]=[a("",1)]))),Q[214]||(Q[214]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"K"),t("mo",{stretchy:"false"},"~")])]),t("mi",null,"t")])]),t("mo",null,"="),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mi",null,"f"),t("mi",null,"K")])]),t("mo",{stretchy:"false"},"("),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",{mathvariant:"bold-italic"},"q"),t("mstyle",{mathcolor:"red"},[t("mi",null,"t")])])]),t("mo",null,","),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",{mathvariant:"bold-italic"},"k"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,":"),t("mi",null,"t")])])]),t("mo",null,","),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mi",{mathvariant:"bold-italic"},"v"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,":"),t("mi",null,"t")])])]),t("mo",{stretchy:"false"},")"),t("mo",null,","),t("mstyle",{scriptlevel:"0"},[t("mspace",{width:"1em"})]),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"V"),t("mo",{stretchy:"false"},"~")])]),t("mi",null,"t")])]),t("mo",null,"="),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mi",null,"f"),t("mi",null,"V")])]),t("mo",{stretchy:"false"},"("),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",{mathvariant:"bold-italic"},"q"),t("mstyle",{mathcolor:"red"},[t("mi",null,"t")])])]),t("mo",null,","),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",{mathvariant:"bold-italic"},"k"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,":"),t("mi",null,"t")])])]),t("mo",null,","),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mi",{mathvariant:"bold-italic"},"v"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,":"),t("mi",null,"t")])])]),t("mo",{stretchy:"false"},")")])],-1))]),t("mjx-container",_1,[(l(),e("svg",S1,Q[215]||(Q[215]=[a("",1)]))),Q[216]||(Q[216]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"red"},[t("msubsup",null,[t("mi",{mathvariant:"bold-italic"},"o"),t("mi",null,"t"),t("mo",null,"∗")])]),t("mo",null,"="),t("mstyle",{mathcolor:"blue"},[t("mtext",null,"Attn")]),t("mo",{stretchy:"false"},"("),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",{mathvariant:"bold-italic"},"q"),t("mstyle",{mathcolor:"red"},[t("mi",null,"t")])])]),t("mo",null,","),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"K"),t("mo",{stretchy:"false"},"~")])]),t("mi",null,"t")])]),t("mo",null,","),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"V"),t("mo",{stretchy:"false"},"~")])]),t("mi",null,"t")])]),t("mo",{stretchy:"false"},")")])],-1))]),t("ul",null,[t("li",null,[Q[219]||(Q[219]=T("同时有")),Q[220]||(Q[220]=t("code",null,"压缩",-1)),Q[221]||(Q[221]=T("、")),Q[222]||(Q[222]=t("code",null,"选择",-1)),Q[223]||(Q[223]=T("、")),Q[224]||(Q[224]=t("code",null,"滑动",-1)),Q[225]||(Q[225]=T("3种策略")),Q[226]||(Q[226]=t("code",null,"进行加权",-1)),Q[227]||(Q[227]=T("，权重由")),Q[228]||(Q[228]=t("code",null,"门控网络",-1)),Q[229]||(Q[229]=T("计算出来。")),t("mjx-container",O1,[(l(),e("svg",P1,Q[217]||(Q[217]=[a("",1)]))),Q[218]||(Q[218]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"red"},[t("msubsup",null,[t("mi",{mathvariant:"bold-italic"},"o"),t("mi",null,"t"),t("mo",null,"∗")])]),t("mo",null,"="),t("munder",null,[t("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"c"),t("mo",null,"∈"),t("mi",null,"C")])]),t("mstyle",{mathcolor:"blue"},[t("msubsup",null,[t("mi",null,"g"),t("mi",null,"t"),t("mi",null,"c")])]),t("mo",null,"⋅"),t("mstyle",{mathcolor:"blue"},[t("mtext",null,"Attn")]),t("mo",{stretchy:"false"},"("),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",{mathvariant:"bold-italic"},"q"),t("mstyle",{mathcolor:"red"},[t("mi",null,"t")])])]),t("mo",null,","),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"K"),t("mo",{stretchy:"false"},"~")])]),t("mi",null,"t")])]),t("mo",null,","),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"V"),t("mo",{stretchy:"false"},"~")])]),t("mi",null,"t")])]),t("mo",{stretchy:"false"},")")])],-1))])])])]),Q[250]||(Q[250]=a("",32)),t("div",E1,[Q[240]||(Q[240]=a("",6)),t("ul",null,[Q[238]||(Q[238]=t("li",null,[T("目的："),t("code",null,"专注于推理任务做大规模强化学习，解决语言一致性问题")],-1)),Q[239]||(Q[239]=t("li",null,[T("方法：在冷启动模型上，使用"),t("code",null,"代码/数学/科学/逻辑推理"),T("等数据(具有明确答案)做RL")],-1)),t("li",null,[Q[237]||(Q[237]=T("奖励设置 ")),t("ul",null,[t("li",null,[Q[234]||(Q[234]=t("strong",null,"语言一致性",-1)),Q[235]||(Q[235]=T("：计算目标语言在CoT中的比例。")),t("mjx-container",I1,[(l(),e("svg",B1,Q[232]||(Q[232]=[a("",1)]))),Q[233]||(Q[233]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"r"),t("mi",null,"e"),t("mi",null,"a"),t("mi",null,"r"),t("mi",null,"d"),t("mo",null,"="),t("mfrac",null,[t("mtext",null,"CoT中目标语言的Token数"),t("mtext",null,"CoT总Token数")])])],-1))])]),Q[236]||(Q[236]=t("li",null,[t("strong",null,"答案正确性"),T("：正确答案。")],-1))])])]),Q[241]||(Q[241]=a("",4))]),Q[251]||(Q[251]=a("",12))])}const U1=o(s,[["render",X1]]);export{J1 as __pageData,U1 as default};

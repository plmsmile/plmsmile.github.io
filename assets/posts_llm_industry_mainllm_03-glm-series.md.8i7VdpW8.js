import{_ as c,c as t,o as d,ah as i,j as o,a as l}from"./chunks/framework.CvbyeFFO.js";const f=JSON.parse('{"title":"GLM 系列","description":"","frontmatter":{"title":"GLM 系列","date":"2025-09-24T10:17:22.000Z","create":"2025-09-24T10:17:22.000Z","categories":["mainllm"],"tags":["glm4.5","moe","pretrain","midtrain","posttrain","agentic sft","reasoning rl","Agentic RL","WebSearcj","SWE RL","GeneralRL","HolisticRL","InstructionFollowing RL","FunctionCall RL","Pathology RL"]},"headers":[],"relativePath":"posts/llm/industry/mainllm/03-glm-series.md","filePath":"posts/llm/industry/mainllm/03-glm-series.md","lastUpdated":1761231250000}'),s={name:"posts/llm/industry/mainllm/03-glm-series.md"},a={class:"custom-block note"},n={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},r={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.489ex"},xmlns:"http://www.w3.org/2000/svg",width:"8.404ex",height:"1.995ex",role:"img",focusable:"false",viewBox:"0 -666 3714.6 882","aria-hidden":"true"},g={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},u={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.186ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.228ex",height:"1.756ex",role:"img",focusable:"false",viewBox:"0 -694 3194.6 776","aria-hidden":"true"},p={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},m={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.186ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.228ex",height:"1.756ex",role:"img",focusable:"false",viewBox:"0 -694 3194.6 776","aria-hidden":"true"};function h(T,e,Q,b,k,v){return d(),t("div",null,[e[15]||(e[15]=i('<h2 id="_2512-glm-4-7" tabindex="-1">(2512) GLM-4.7 <a class="header-anchor" href="#_2512-glm-4-7" aria-label="Permalink to &quot;(2512) GLM-4.7&quot;">​</a></h2><h2 id="_2512-glm-4-6v" tabindex="-1">(2512) GLM-4.6V <a class="header-anchor" href="#_2512-glm-4-6v" aria-label="Permalink to &quot;(2512) GLM-4.6V&quot;">​</a></h2><h2 id="_2508-glm-4-5" tabindex="-1">(2508) GLM-4.5 <a class="header-anchor" href="#_2508-glm-4-5" aria-label="Permalink to &quot;(2508) GLM-4.5&quot;">​</a></h2><p><strong>🌺 论文摘要</strong></p><div class="custom-block danger"><div class="custom-block-title">论文摘要</div><ul><li><a href="https://www.alphaxiv.org/abs/2508.06471" target="_blank" rel="noreferrer">paper</a>, <a href="https://zhuanlan.zhihu.com/p/1955721176954443417" target="_blank" rel="noreferrer">技术报告</a></li><li>MoE架构，深而窄。<code>2阶段预训练</code>+<code>Mid-Training</code>。</li><li>PostTraining <ul><li>SFT：2阶段SFT，<code>自动AgenticSFT数据构造</code>。</li><li>Reasoning RL (数学+代码+科学)：<code>2阶段难度课程学习</code>，<code>动态采样温度</code>等。</li><li>Agentic RL (WebSearch + SWE RL)：<code>数据收集</code>，<code>自蒸馏迭代优化</code>。</li><li>General RL (综合+指令跟随+函数调用+问题RL)：<code>Rule+RLHF+RLAIF</code> 3种反馈信号。</li></ul></li></ul></div><h3 id="问题背景" tabindex="-1">问题背景 <a class="header-anchor" href="#问题背景" aria-label="Permalink to &quot;问题背景&quot;">​</a></h3><p><strong>❓问题背景</strong></p><div class="custom-block warning"><div class="custom-block-title">问题背景</div><ul><li>LLM变化：<code>通用问答</code> -&gt; <code>问题解决者</code></li><li>闭源模型在数学和代码修复领域有效果，开源模型有差距，难以解决复杂真实问题。</li><li>缺乏在<code>Agentic</code>(使用<code>外部工具和世界交互</code>), <code>Reasoning</code>(<code>多步推理</code>), <code>Coding</code>(<code>真实软件工程</code>) 同时优秀的开源模型。</li></ul></div><h3 id="模型架构" tabindex="-1">模型架构 <a class="header-anchor" href="#模型架构" aria-label="Permalink to &quot;模型架构&quot;">​</a></h3><div class="custom-block info"><div class="custom-block-title">模型架构</div><ul><li><strong>MoE 架构</strong><ul><li><code>loss-free balance routing</code>：无需<a href="http://plmsmile.github.io/posts/llm/basic/04-llm-architecture.html#%E4%B8%93%E5%AE%B6%E5%B9%B3%E8%A1%A1%E9%97%AE%E9%A2%98" target="_blank" rel="noreferrer">辅助loss</a>，来平衡路由。</li><li><code>sigmoid gates</code>：sigmoid决定token给哪些专家，传统是<a href="https://plmsmile.github.io/posts/llm/basic/04-llm-architecture.html#%E9%97%A8%E6%8E%A7-topk%E7%AD%96%E7%95%A5" target="_blank" rel="noreferrer">Softmax Topk</a></li></ul></li><li><strong>更深而窄</strong>：<code>层数变多</code>、<code>hidden_dim变小</code>。 <ul><li>实验发现：<code>深度</code>对<code>推理能力很重要</code>。</li><li>对比DeepSeek-V3, Kimi-K2：<code>由宽变窄</code>、<code>由浅变深</code></li></ul></li><li><strong>GQA</strong> + partial <a href="https://plmsmile.github.io/posts/llm/basic/08-llm-position-embedding.html#%E6%97%8B%E8%BD%AC%E4%BD%8D%E7%BD%AE%E7%BC%96%E7%A0%81" target="_blank" rel="noreferrer">RoPE</a>.</li><li><strong>注意力头更多</strong>： 5120隐藏层维度 + 96个head，一般是64个 <ul><li>没降低训练loss，但提升了MMLU和BBH的分数</li></ul></li><li>稳定性：采用<code>QK-Norm</code>来<code>稳定attention logits的数值范围</code>，<code>防止训练不稳定</code>。</li><li>参数：355B-A32B, 106B-A12B</li></ul></div><img src="https://picx.zhimg.com/v2-f882eb29ab3d146180933302068bec67_r.jpg" style="display:block;margin:auto;" width="70%"><h3 id="预训练" tabindex="-1">预训练 <a class="header-anchor" href="#预训练" aria-label="Permalink to &quot;预训练&quot;">​</a></h3><p><strong>📕核心方法</strong></p><img src="https://pic4.zhimg.com/v2-bd099ff613fa6dbb627ff8a6dab8c685_r.jpg" style="display:block;margin:auto;" width="70%"><h4 id="预训练数据" tabindex="-1">预训练数据 <a class="header-anchor" href="#预训练数据" aria-label="Permalink to &quot;预训练数据&quot;">​</a></h4><div class="custom-block info"><div class="custom-block-title">预训练数据</div><ul><li><strong>Web数据</strong>：<code>中英文web网页</code>(爬取的)。 <ul><li>同Nemotron-CC，对网页<code>按质量打分</code>，<code>分桶</code>。</li><li><code>丢弃低质量</code>。<code>上采样高质量buckets</code>，贡献3.2个epoch训练，<code>覆盖推理高频知识</code>。</li><li>使用SemDedup去掉自动模板生成的网页。</li></ul></li><li><strong>多语言</strong>：爬取网页、Fineweb-2。做质量分类，对高质量进行上采样。</li><li><strong>代码</strong>： <ul><li><strong>Github+各种代码平台数据</strong>。 <ul><li>初步<code>规则过滤</code>，<code>按语言做质量分类</code>：高质、中等、低质量。</li><li><code>上采样高质量</code>、<code>去掉低质量代码</code>。<strong>所有源码数据</strong>应用<code>FIM任务</code>。</li></ul></li><li><strong>Code相关 Web数据</strong><ul><li>stage1：<code>HTML Code标签</code>，<code>FastText检索代码内容</code></li><li>stage2：做<code>质量评估</code>(高、中、低)，同源代码一样采样过滤。</li><li>stage3：使用<code>细粒度解析器</code>，重新解析选择的网页，<code>更好保留代码格式内容</code>。</li></ul></li></ul></li><li><strong>数学和科学</strong><ul><li>来源：web、书籍、论文等。</li><li>使用LLM，根据<code>数学和科学内容比例</code>，<code>对文档进行评分</code>，并训练<code>小分类器</code>来预测分数。</li><li><code>上采样高分数据</code></li></ul></li></ul></div><div class="custom-block info"><div class="custom-block-title">2阶段预训练</div><ul><li>阶段1：<code>通用数据</code>，做训练</li><li>阶段2：<code>上采样代码/数学/科学</code>等数据，做训练</li></ul></div><h4 id="mid-training" tabindex="-1">Mid-Training <a class="header-anchor" href="#mid-training" aria-label="Permalink to &quot;Mid-Training&quot;">​</a></h4><div class="custom-block note"><div class="custom-block-title">Mid-Training</div><p><strong>背景</strong></p><ul><li><code>增强特定领域能力</code>：使用<code>特定领域数据</code>(包括指令数据)，量少但质量高，注入<code>结构化知识</code>和<code>长逻辑</code>。</li><li>为后续SFT和RL打下基础。</li></ul><p><strong>Repo-Level Code训练</strong></p><ul><li><code>学习跨文件依赖关系</code>：<code>拼接</code>多个代码文件，</li><li><code>提高SWE能力</code>：学习代码如何被修改的。<code>学习diff</code>，<code>上下文(Issue+PR+Code)</code></li><li>4k -&gt; 32k</li></ul><p><strong>合成推理数据 训练</strong></p><ul><li>使用<code>强推理模型</code>，合成<code>数学/科学/代码推理过程</code>。</li><li>32k, 500B</li></ul><p><strong>长上下文和agent 训练</strong></p><ul><li><code>上采样长文档</code>、<code>大规模合成agent轨迹</code>。 <ul><li>尽量把完整文档塞进一个Batch，避免截断关键逻辑。<code>Best-fit Packing</code>。</li></ul></li><li>32k -&gt; <code>128k</code>, 100B</li></ul></div><h4 id="超参" tabindex="-1">超参 <a class="header-anchor" href="#超参" aria-label="Permalink to &quot;超参&quot;">​</a></h4>',20)),o("div",a,[e[12]||(e[12]=o("div",{class:"custom-block-title"},"预训练超参",-1)),e[13]||(e[13]=o("p",null,[o("strong",null,"Muon 优化器")],-1)),o("ul",null,[e[4]||(e[4]=o("li",null,[l("特点：基于Newton-Schulz迭代，具有二阶优化器的特性 "),o("ul",null,[o("li",null,[o("code",null,"收敛快"),l("：比AdamW更快降低loss；"),o("code",null,"大batch友好"),l("：承受极大batchsize，64M tokens。")])])],-1)),e[5]||(e[5]=o("li",null,[l("优化embedding, bias 和RMSNorm"),o("code",null,"之外的所有参数"),l("。")],-1)),o("li",null,[e[2]||(e[2]=l("超参：迭代步数N=5，动量")),o("mjx-container",n,[(d(),t("svg",r,e[0]||(e[0]=[i('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D707" d="M58 -216Q44 -216 34 -208T23 -186Q23 -176 96 116T173 414Q186 442 219 442Q231 441 239 435T249 423T251 413Q251 401 220 279T187 142Q185 131 185 107V99Q185 26 252 26Q261 26 270 27T287 31T302 38T315 45T327 55T338 65T348 77T356 88T365 100L372 110L408 253Q444 395 448 404Q461 431 491 431Q504 431 512 424T523 412T525 402L449 84Q448 79 448 68Q448 43 455 35T476 26Q485 27 496 35Q517 55 537 131Q543 151 547 152Q549 153 557 153H561Q580 153 580 144Q580 138 575 117T555 63T523 13Q510 0 491 -8Q483 -10 467 -10Q446 -10 429 -4T402 11T385 29T376 44T374 51L368 45Q362 39 350 30T324 12T288 -4T246 -11Q199 -11 153 12L129 -85Q108 -167 104 -180T92 -202Q76 -216 58 -216Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(880.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(1936.6,0)"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" style="stroke-width:3;"></path><path data-c="2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z" transform="translate(500,0)" style="stroke-width:3;"></path><path data-c="39" d="M352 287Q304 211 232 211Q154 211 104 270T44 396Q42 412 42 436V444Q42 537 111 606Q171 666 243 666Q245 666 249 666T257 665H261Q273 665 286 663T323 651T370 619T413 560Q456 472 456 334Q456 194 396 97Q361 41 312 10T208 -22Q147 -22 108 7T68 93T121 149Q143 149 158 135T173 96Q173 78 164 65T148 49T135 44L131 43Q131 41 138 37T164 27T206 22H212Q272 22 313 86Q352 142 352 280V287ZM244 248Q292 248 321 297T351 430Q351 508 343 542Q341 552 337 562T323 588T293 615T246 625Q208 625 181 598Q160 576 154 546T147 441Q147 358 152 329T172 282Q197 248 244 248Z" transform="translate(778,0)" style="stroke-width:3;"></path><path data-c="35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z" transform="translate(1278,0)" style="stroke-width:3;"></path></g></g></g>',1)]))),e[1]||(e[1]=o("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[o("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[o("mi",null,"μ"),o("mo",null,"="),o("mn",null,"0.95")])],-1))]),e[3]||(e[3]=l("，缩放的rms=0.2"))])]),e[14]||(e[14]=i("<p><strong>学习率</strong></p><ul><li><p>放弃Warmup-Stable-Decay，回归Cosine Decay</p></li><li><p>学习率：0，预热到2.5e-4，衰减到2.5e-5，直到mid-train结束</p></li></ul><p><strong>Batch Size</strong></p><ul><li>前500B token，16M token，后期 64M token 保持不变。</li></ul><p><strong>序列长度</strong></p><ul><li>序列长度：<code>最初 4k</code>，mid-train <code>32k</code> -&gt; <code>128k</code></li><li>RoPE：base 由1w -&gt; 100w，<code>扩展上下文</code>。</li></ul><p><strong>MoE 路由</strong></p><ul><li>loss-free balance routing <ul><li>前15T token，有偏置更新，偏差更新率设为0.0001，强制负载均衡。</li><li>其余：设为0。模型专家分工形成后，停止人为干预偏置。</li></ul></li><li>辅助的序列级loss：极小权重0.0001，保底防止极端情况的负载崩塌</li></ul><p><strong>MTP loss</strong></p>",9)),o("ul",null,[o("li",null,[e[10]||(e[10]=l("前15T token，")),o("mjx-container",g,[(d(),t("svg",u,e[6]||(e[6]=[i('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D706" d="M166 673Q166 685 183 694H202Q292 691 316 644Q322 629 373 486T474 207T524 67Q531 47 537 34T546 15T551 6T555 2T556 -2T550 -11H482Q457 3 450 18T399 152L354 277L340 262Q327 246 293 207T236 141Q211 112 174 69Q123 9 111 -1T83 -12Q47 -12 47 20Q47 37 61 52T199 187Q229 216 266 252T321 306L338 322Q338 323 288 462T234 612Q214 657 183 657Q166 657 166 673Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(860.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(1916.6,0)"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" style="stroke-width:3;"></path><path data-c="2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z" transform="translate(500,0)" style="stroke-width:3;"></path><path data-c="33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z" transform="translate(778,0)" style="stroke-width:3;"></path></g></g></g>',1)]))),e[7]||(e[7]=o("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[o("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[o("mi",null,"λ"),o("mo",null,"="),o("mn",null,"0.3")])],-1))]),e[11]||(e[11]=l("，其余token ")),o("mjx-container",p,[(d(),t("svg",m,e[8]||(e[8]=[i('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D706" d="M166 673Q166 685 183 694H202Q292 691 316 644Q322 629 373 486T474 207T524 67Q531 47 537 34T546 15T551 6T555 2T556 -2T550 -11H482Q457 3 450 18T399 152L354 277L340 262Q327 246 293 207T236 141Q211 112 174 69Q123 9 111 -1T83 -12Q47 -12 47 20Q47 37 61 52T199 187Q229 216 266 252T321 306L338 322Q338 323 288 462T234 612Q214 657 183 657Q166 657 166 673Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(860.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(1916.6,0)"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" style="stroke-width:3;"></path><path data-c="2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z" transform="translate(500,0)" style="stroke-width:3;"></path><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" transform="translate(778,0)" style="stroke-width:3;"></path></g></g></g>',1)]))),e[9]||(e[9]=o("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[o("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[o("mi",null,"λ"),o("mo",null,"="),o("mn",null,"0.1")])],-1))])])])]),e[16]||(e[16]=i('<h3 id="posttraining" tabindex="-1">PostTraining <a class="header-anchor" href="#posttraining" aria-label="Permalink to &quot;PostTraining&quot;">​</a></h3><div class="custom-block tip"><div class="custom-block-title">PostTraining</div><ul><li><strong>阶段1</strong> ：<code>Expert Training</code>, 构建<code>3个领域专家模型</code>，<code>推理</code>、<code>agent</code>、<code>通用聊天</code></li><li><strong>阶段2</strong>：<code>统一训练</code>，采取<code>自蒸馏技术</code> <code>整合多个专家</code>，最终交付<code>一个综合模型</code>。</li></ul></div><h4 id="sft-多阶段-自动数据构造等" tabindex="-1">SFT (多阶段/自动数据构造等) <a class="header-anchor" href="#sft-多阶段-自动数据构造等" aria-label="Permalink to &quot;SFT (多阶段/自动数据构造等)&quot;">​</a></h4><div class="custom-block tip"><div class="custom-block-title">SFT</div><p><strong>SFT 目的</strong></p><ul><li>阶段1(专家训练)：<code>冷启动</code>，后期被RL进一步提升。</li><li>阶段2(统一训练)：<code>蒸馏各专家模型</code>，到一个混合通用模型。</li></ul><p><strong>冷启动SFT</strong></p><ul><li><code>少量CoT数据</code>做SFT，确保每个专家<code>在RL之前</code> <code>有足够的基础能力</code>。</li></ul><p><strong>综合SFT</strong></p><ul><li>数据：推理任务、通用聊天、agent任务、长上下文理解任务。答案从<code>各专家模型蒸馏</code>而来。</li><li>模型：base model，长度：128k</li><li><strong>混合推理模式</strong>：混合<code>思考</code>和<code>直接回答</code>的两种数据。<code>难题做思考</code>，<code>简单任务直接回答</code>。</li></ul></div><div class="custom-block danger"><div class="custom-block-title">一些关键点</div><p><strong>XML 工具调用模板</strong></p><ul><li>由json改成XLM，避免太多转义字符，降低模型负担，更好支持agentic能力。</li></ul><p><strong>拒绝采样</strong></p><ul><li>从专家模型采样，采取<code>多阶段过滤机制</code><ul><li>过滤重复、超短、截断、不符合推理格式的。</li><li>客观验证：过滤数学/代码 答案不正确的。</li><li>主观过滤：使用RM过滤主观低分答案的样本。</li><li>工具过滤：工具调用要格式正确、真正解决问题。</li></ul></li></ul><p><strong>Prompt选择和ResponseScaling</strong></p><ul><li><code>过滤困难prompt</code> +<code> 过滤滤回复长度太短的prompt</code>，约<code>过滤50%</code></li><li>仅用50%数据训练，但在数学和科学任务山给提升2%-4%</li></ul><p><strong>自动 Agentic SFT 数据构造</strong></p><ul><li>Agent框架和收集工具 <ul><li>收集一套<code>agent框架</code>、<code>真实API</code>和<code>MCP Server</code>，以及使用<code>LLM 自动构建工具</code></li></ul></li><li><strong>合成任务</strong>：基于框架和工具，来合成<code>单步或多步任务</code><ul><li>对于成熟框架：使用LLM理解功能，自动生成query或任务。</li><li>对于零散工具：选择一个工具子集，使用LLM构建关于该子集的任务。</li></ul></li><li><strong>轨迹生成</strong>：对每个合成任务 <ul><li>使用<code>LLM生成工具调用轨迹</code>，<code>LLM模拟用户</code>。</li><li>使用<code>多个judge-agent</code> 来<code>评估任务是否完成</code>，<code>仅保留成功轨迹</code>。</li></ul></li></ul></div><h4 id="reasoning-rl-数学-代码-科学" tabindex="-1">Reasoning RL (数学+代码+科学) <a class="header-anchor" href="#reasoning-rl-数学-代码-科学" aria-label="Permalink to &quot;Reasoning RL (数学+代码+科学)&quot;">​</a></h4><div class="custom-block note"><div class="custom-block-title">Reasoning RL</div><p><strong>背景</strong></p><ul><li>专注于数学/代码/科学等领域，<code>有明确奖励信号</code>。</li><li>算法：GRPO + 去掉KL Loss。</li><li>核心解决：训练效率、样本多样性和数据质量等问题。</li></ul><p><strong>基于难度的2阶段课程学习</strong></p><ul><li>背景：太简单或太难，会导致梯度为0，无优势。</li><li>阶段1：<code>中等难度数据</code>，<code>rollout=16</code>。</li><li>阶段2：<code>高难度数据</code>，<code>rollout=512</code>，严格具有正确答案的样本。 <ul><li>AIME24：81.8 -&gt; 83.4</li></ul></li></ul><p><strong>直接使用最大长度64K</strong></p><ul><li><code>不用多阶段扩展长度</code>，因为SFT已经学过长输出了，限制逐渐扩展反而效果不好。</li></ul><p><strong>动态采样温度</strong></p><ul><li>温度低：缺乏探索；温度高：引入低质量噪声样本，影响训练效率。</li><li><code>动态调整温度</code>：<code>维持探索和利用平衡</code>。 <ul><li><code>平均奖励稳定</code>：<code>提升采样温度鼓励探索</code>。</li><li>基于质量选择高温：在性能不下降1%的情况下，所能选的最大温度。</li></ul></li></ul><p><strong>代码RL</strong></p><ul><li><code>Token-level Loss</code>：梯度信号更稳定，收敛更快，解决长度偏差问题。</li></ul><p><strong>科学RL</strong></p><ul><li><code>数据质量和类型很重要</code>：仅使用专家验证的多选题训练，效果比混合质量数据好。</li></ul></div><h4 id="agentic-rl-websearch-swe-rl" tabindex="-1">Agentic RL (WebSearch + SWE RL) <a class="header-anchor" href="#agentic-rl-websearch-swe-rl" aria-label="Permalink to &quot;Agentic RL (WebSearch + SWE RL)&quot;">​</a></h4><div class="custom-block danger"><div class="custom-block-title">AgenticRL</div><p><strong>任务</strong></p><ul><li><code>web-search</code>, <code>代码生成 </code>，答案可验证。</li></ul><p><strong>数据收集合成</strong></p><ul><li><strong>web搜索</strong>：需要搜索零散信息，<code>数据合成pipeline</code><ul><li>知识图谱法(多条推理)：利用知识图谱，找到较远的实体，生成问A和D关系的问题，必须A-&gt;B-&gt;C-&gt;D</li><li>捉迷藏方法：人工选择网页，<code>把关键信息抹掉</code>，模型<code>必须依赖这些信息</code>才能<code>回答问题</code>。</li></ul></li><li><strong>软件工程</strong><ul><li>收集Github <code>PR</code> + <code>Issue</code>，构建<code>prompt</code> + <code>单元测试</code></li><li><code>加固沙箱</code>：不会搞坏宿主机</li></ul></li></ul><p><strong>算法优化</strong></p><ul><li>GRPO：LLM-response才计算，环境返回被mask掉。</li><li><strong>奖励信号</strong>： <ul><li>搜索-<code>最终结果ACC</code>；SWE-<code>单元测试通过率</code>。</li><li>过程格式惩罚：在轨迹生成过程中，<code>只要工具格式错误</code>，就<code>立即停止</code>，<code>并给0分</code>。</li></ul></li><li><strong>自蒸馏迭代优化</strong>：SFT -&gt; RL -&gt; SFT -&gt; RL ... <ul><li>使用RL模型预测结果，<code>替换冷启动数据</code>，得到<code>更强SFT模型</code>，<code>再进行RL</code>，如此迭代。</li></ul></li><li>效果 <ul><li><code>搜索</code> + <code>SWE</code> RL提升，会使其他<code>工具调用</code>/<code>Terminal-Bench</code>也提升。</li><li>环境交互次数增加，效果也会增加</li></ul></li></ul></div><h4 id="general-rl-综合-指令跟随-函数调用-问题rl" tabindex="-1">General RL (综合+指令跟随+函数调用+问题RL) <a class="header-anchor" href="#general-rl-综合-指令跟随-函数调用-问题rl" aria-label="Permalink to &quot;General RL (综合+指令跟随+函数调用+问题RL)&quot;">​</a></h4><div class="custom-block caution"><div class="custom-block-title">General RL</div><p><strong>背景</strong></p><ul><li>提升模型整体性能，修复一些问题，加强关键能力。</li><li><strong>3种反馈信号</strong>：<code>Rule-based</code>, <code>RLHF</code>, <code>RLAIF</code>。 <ul><li>更鲁棒的训练信号，更好使用每一种数据。</li></ul></li></ul></div><div class="custom-block danger"><div class="custom-block-title">Holistic RL</div><p><strong>Holistic RL</strong></p><ul><li>目标：<code>泛领域效果提升</code>。</li><li>数据集：<code>5000prompt</code>，覆盖7个一级、33个二级、139个三级分类。</li><li><code>2种反馈信号</code>：更可靠效果更好 <ul><li><strong>人类反馈信号</strong>：在<code>偏好数据</code>训练<code>RewardModel</code>，基于<code>指令遵循</code>、<code>安全性</code>、<code>事实正确性</code>等多维度评估。</li><li><strong>AI反馈信号</strong>：设计<code>评分准则</code>。</li></ul></li></ul></div><div class="custom-block danger"><div class="custom-block-title">Instruction Following RL</div><p><strong>指令跟随 RL</strong></p><ul><li>目标：复杂指令。</li><li>数据集：专门构建的有挑战数据集，覆盖7类和151个细分类别。</li><li><code>3种反馈信号</code>：非常鲁棒，避免RewardHacking，带来效果提升。 <ul><li><code>规则验证</code>：</li><li><code>奖励模型</code>：</li><li><code>Critic模型</code>：</li></ul></li></ul></div><div class="custom-block danger"><div class="custom-block-title">Function Calling RL</div><p><strong>Step-Wise Rule RL</strong></p><ul><li>对<code>固定流程任务</code>，标注<code>每一轮的GT工具调用</code>。</li><li>奖励信号：<code>完全匹配GT结果</code>，才得1；其余为0。</li></ul><p><strong>端到端 多轮 RL</strong></p><ul><li><code>开放性任务</code><ul><li><code>单轮多步任务</code>：多步工具调用。 <ul><li>数据：<code>基于MCP合成的数据</code>+ <code>有运行环境的开源agent数据</code> (AgentGym等)</li></ul></li><li><code>多轮多步任务</code>： <ul><li><code>多步工具执行</code> + <code>多轮用户交互</code>。<code>LLM模拟用户</code></li></ul></li></ul></li><li>奖励信号：<code>格式正确</code>且<code>任务完成</code>，才为1；其余为0.</li></ul></div><div class="custom-block danger"><div class="custom-block-title">Pathology RL</div><p><strong>背景</strong></p><ul><li>后期存在<code>语言混合</code>、<code>过度重复</code>、<code>格式错误</code>等问题。</li><li>通用RL难以解决：<code>发生概率&lt;1%</code>，样本效率低</li></ul><p><strong>方法</strong></p><ul><li><code>识别高危prompt</code>，<code>构建专有数据集</code></li><li>再跑一轮RL，使用<code>极大负奖励做惩罚</code>，降低错误。</li></ul></div><h3 id="算法实验" tabindex="-1">算法实验 <a class="header-anchor" href="#算法实验" aria-label="Permalink to &quot;算法实验&quot;">​</a></h3><h4 id="实验设置" tabindex="-1">实验设置 <a class="header-anchor" href="#实验设置" aria-label="Permalink to &quot;实验设置&quot;">​</a></h4><p><strong>✍️实验设置</strong></p><div class="custom-block tip"><div class="custom-block-title">实验设置</div><p><strong>基础模型</strong></p><ul><li>GLM-4.5 (355B Total / 32B Active)</li><li>GLM-4.5-Air (106B Total / 12B Active)</li></ul><p><strong>训练任务/数据</strong></p><ul><li>预训练：23T tokens，包含网页、书籍、论文、GitHub 代码。</li><li>Mid训练：32K 到 128K 上下文扩展，Repo 级代码，合成推理数据。</li><li>后训练：SFT（冷启动+专家蒸馏），RL（GRPO 算法，针对推理、Agent、通用任务的不同策略）。</li></ul><p><strong>评测任务/数据</strong></p><ul><li><strong>ARC 基准 (12个)</strong>：Agentic (TAU-Bench, BFCL V3, BrowseComp), Reasoning (MMLU-Pro, AIME 24, MATH-500, SciCode, GPQA, HLE, LCB), Coding (SWE-Bench Verified, Terminal-Bench)。</li><li><strong>通用基准</strong>：MMLU, SimpleQA, IFEval, SysBench。</li><li><strong>人工评测</strong>：SafetyBench, CC-Bench (基于 Claude Code 的编码 Agent 评测), 翻译能力评测。</li></ul><p><strong>算法/策略</strong></p><ul><li><code>2阶段预训练</code>：<code>通用数据</code> + <code>上采样高质量数据</code>训练</li><li><code>MidTrain</code>：<code>仓库级</code> + <code>合成推理数据</code> +<code> 长上下文</code>，上采样+<code>逐步扩展长度</code></li><li><code>多阶段SFT</code>：<code>冷启动</code>+<code>统一训练</code>，混合推理模式。</li><li><code>多种RL训练</code>：ReasonRL <code>难度课程学习</code>；Agentic RL：<code>自蒸馏迭代优化</code>；General RL：<code>3种反馈信号</code>。</li></ul><p><strong>超参</strong></p><ul><li>优化器：Muon</li><li>学习率调度：Cosine decay (而非 WSD)</li><li>最大序列长度：128K (Post-training)</li></ul></div><h4 id="关键结果" tabindex="-1">关键结果 <a class="header-anchor" href="#关键结果" aria-label="Permalink to &quot;关键结果&quot;">​</a></h4><p><strong>🍑关键结果</strong></p><div class="custom-block important"><div class="custom-block-title">关键结果</div><ul><li><strong>总体排名</strong>：在 ARC 任务上，GLM-4.5 总体排名第 3，GLM-4.5-Air 排名第 6。GLM-4.5 在 Agentic 任务上排名第 2（仅次于 OpenAI o3），在 Coding 任务上排名第 3（接近 Claude Sonnet 4）。</li><li><strong>参数效率</strong>：GLM-4.5 在 SWE-bench Verified 上位于帕累托前沿，以 DeepSeek-R1 一半的参数量实现了与之相当甚至更好的性能。</li><li><strong>Agent 能力</strong>：在 TAU-Bench 上得分 70.1%，在 BFCL v3 上得分 77.8%，与 Claude Sonnet 4 持平。在 Web 浏览任务 BrowseComp 上明显优于 Claude Opus 4。</li><li><strong>推理能力</strong>：AIME 24 得分 91.0%（优于 o3），MATH-500 得分 98.2%。</li><li><strong>编码能力</strong>：SWE-bench Verified 得分 64.2%，Terminal-Bench 得分 37.5%，优于 GPT-4.1 和 Gemini-2.5-Pro。</li><li><strong>工具调用可靠性</strong>：在 CC-Bench 实测中，工具调用成功率高达 90.6%，高于 Claude Sonnet 4 (89.5%) 和 Kimi K2 (86.2%)。</li></ul></div><p>预训练评估</p><img src="https://pic4.zhimg.com/v2-b5060fc4610d95812b6195a3503512cd_r.jpg" style="display:block;margin:auto;" width="70%"><p>后训练评估</p><img src="https://pic2.zhimg.com/v2-8997436a909d380869b9fbe623e774d9_1440w.jpg" style="display:block;margin:auto;" width="70%"><p>Agent 评估</p><img src="https://pica.zhimg.com/v2-e1afbbee1184bcdcc06ab851080414d0_1440w.jpg" style="display:block;margin:auto;" width="70%"><p>SWE 评估</p><img src="https://pic4.zhimg.com/v2-d9c3064de8d1d3303e7c6839597071e5_1440w.jpg" style="display:block;margin:auto;" width="70%"><p>安全评估</p><img src="https://pic4.zhimg.com/v2-1435bf38e5819625b649bee76ed5cc1f_1440w.jpg" style="display:block;margin:auto;" width="70%"><h3 id="未来方向" tabindex="-1">未来方向 <a class="header-anchor" href="#未来方向" aria-label="Permalink to &quot;未来方向&quot;">​</a></h3><p><strong>⛳ 未来方向</strong></p><div class="custom-block info"><div class="custom-block-title">未来方向</div><ul><li><strong>解决偏见</strong>：虽然安全性得分高（Ethics, Safety），但<code>不公平与偏见</code>（Unfairness &amp; Bias）仍有改进空间。</li><li><strong>统一能力的深化</strong>：把Agent+Reasoning+Coding能力更深层次地融合到一个统一模型，不依赖分离的专家。</li><li><strong>开源生态</strong>：释放模型权重和 <code>glm-simple-evals</code> 评测工具，推动复杂推理和Agent方面的研究。</li></ul></div>',35))])}const w=c(s,[["render",h]]);export{f as __pageData,w as default};

import{_ as s,c as l,o as e,ah as T,j as t,a as Q}from"./chunks/framework.CvbyeFFO.js";const J1=JSON.parse('{"title":"MiniMax 系列","description":"","frontmatter":{"title":"MiniMax 系列","date":"2025-11-07T22:29:56.000Z","create":"2025-11-07T22:29:56.000Z","categories":["mainllm"],"tags":["MiniMax-Text-01","MiniMax-VL-01","MiniMax-M1","Linear attention","Lightning Attention","Hybrid Attention","预训练数据","数据有效性实验","多阶段训练策略","Reward Model","GenRM","Offline-DPO","Online-GRPO","安全对齐","长上下文","VL模型","CiSPO算法","可验证数据","不可验证数据","SynLogic合成数据","GenRM长度偏差问题","长思考Scaling"]},"headers":[],"relativePath":"posts/llm/industry/mainllm/04-minimax-series.md","filePath":"posts/llm/industry/mainllm/04-minimax-series.md","lastUpdated":1763995754000}'),o={name:"posts/llm/industry/mainllm/04-minimax-series.md"},n={class:"custom-block warning"},d={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},i={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.203ex",height:"2.452ex",role:"img",focusable:"false",viewBox:"0 -833.9 2299.6 1083.9","aria-hidden":"true"},r={class:"custom-block note"},m={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},h={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.669ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.13ex",height:"1.644ex",role:"img",focusable:"false",viewBox:"0 -431 1825.4 726.7","aria-hidden":"true"},p={class:"custom-block warning"},g={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},c={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.832ex",height:"2.452ex",role:"img",focusable:"false",viewBox:"0 -833.9 2577.6 1083.9","aria-hidden":"true"},u={class:"custom-block tip"},H={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},k={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.139ex",height:"1.361ex",role:"img",focusable:"false",viewBox:"0 -444 945.3 601.8","aria-hidden":"true"},L={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},x={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.211ex",height:"1.927ex",role:"img",focusable:"false",viewBox:"0 -694 977.3 851.8","aria-hidden":"true"},w={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},V={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.667ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.641ex",height:"2.219ex",role:"img",focusable:"false",viewBox:"0 -686 1609.3 981","aria-hidden":"true"},y={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},f={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.391ex",height:"1.902ex",role:"img",focusable:"false",viewBox:"0 -683 2383 840.8","aria-hidden":"true"},b={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},M={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.819ex"},xmlns:"http://www.w3.org/2000/svg",width:"46.05ex",height:"7.044ex",role:"img",focusable:"false",viewBox:"0 -1867.4 20354.1 3113.3","aria-hidden":"true"},Z={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},v={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.464ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.848ex",height:"2.059ex",role:"img",focusable:"false",viewBox:"0 -705 817 910","aria-hidden":"true"},D={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},_={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.726ex",height:"1.357ex",role:"img",focusable:"false",viewBox:"0 -442 1205 599.8","aria-hidden":"true"},A={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},B={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.819ex"},xmlns:"http://www.w3.org/2000/svg",width:"26.038ex",height:"6.735ex",role:"img",focusable:"false",viewBox:"0 -1730.8 11508.8 2976.7","aria-hidden":"true"},C={class:"custom-block tip"},S={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},j={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.008ex",height:"2.452ex",role:"img",focusable:"false",viewBox:"0 -833.9 3097.6 1083.9","aria-hidden":"true"},E={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},R={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"21.241ex",height:"2.569ex",role:"img",focusable:"false",viewBox:"0 -885.3 9388.7 1135.3","aria-hidden":"true"},P={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},O={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.008ex",height:"2.452ex",role:"img",focusable:"false",viewBox:"0 -833.9 3097.6 1083.9","aria-hidden":"true"},q={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},F={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.791ex"},xmlns:"http://www.w3.org/2000/svg",width:"22.132ex",height:"2.794ex",role:"img",focusable:"false",viewBox:"0 -885.3 9782.3 1234.8","aria-hidden":"true"},I={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},z={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.576ex"},xmlns:"http://www.w3.org/2000/svg",width:"32.302ex",height:"2.579ex",role:"img",focusable:"false",viewBox:"0 -885.3 14277.6 1140.1","aria-hidden":"true"},N={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},X={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-3.014ex"},xmlns:"http://www.w3.org/2000/svg",width:"23.681ex",height:"6.844ex",role:"img",focusable:"false",viewBox:"0 -1692.6 10467 3024.8","aria-hidden":"true"},G={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},J={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.576ex"},xmlns:"http://www.w3.org/2000/svg",width:"45.771ex",height:"2.579ex",role:"img",focusable:"false",viewBox:"0 -885.3 20230.8 1140.1","aria-hidden":"true"},K={class:"custom-block tip"},U={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},W={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"11.217ex",height:"2.029ex",role:"img",focusable:"false",viewBox:"0 -703 4958.1 897","aria-hidden":"true"},$={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Y={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"11.217ex",height:"2.029ex",role:"img",focusable:"false",viewBox:"0 -703 4958.1 897","aria-hidden":"true"},t1={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},a1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.149ex"},xmlns:"http://www.w3.org/2000/svg",width:"43.691ex",height:"5.43ex",role:"img",focusable:"false",viewBox:"0 -1450 19311.5 2400","aria-hidden":"true"},Q1={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},T1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-4.092ex"},xmlns:"http://www.w3.org/2000/svg",width:"34.844ex",height:"6.095ex",role:"img",focusable:"false",viewBox:"0 -885.3 15401.1 2694.1","aria-hidden":"true"},l1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},e1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.375ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.318ex",height:"1.92ex",role:"img",focusable:"false",viewBox:"0 -683 1908.6 848.6","aria-hidden":"true"},s1={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},o1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.559ex"},xmlns:"http://www.w3.org/2000/svg",width:"22.775ex",height:"2.603ex",role:"img",focusable:"false",viewBox:"0 -903.7 10066.5 1150.7","aria-hidden":"true"},n1={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},d1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-4.092ex"},xmlns:"http://www.w3.org/2000/svg",width:"34.844ex",height:"6.095ex",role:"img",focusable:"false",viewBox:"0 -885.3 15401.1 2694.1","aria-hidden":"true"},i1={class:"custom-block tip"},r1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},m1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.034ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1783 1000","aria-hidden":"true"},h1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},p1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"9.829ex",height:"2.288ex",role:"img",focusable:"false",viewBox:"0 -853.7 4344.3 1011.5","aria-hidden":"true"},g1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},c1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.456ex",height:"2.452ex",role:"img",focusable:"false",viewBox:"0 -833.9 3295.6 1083.9","aria-hidden":"true"},u1={class:"custom-block note"},H1={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},k1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.912ex"},xmlns:"http://www.w3.org/2000/svg",width:"58.684ex",height:"6.955ex",role:"img",focusable:"false",viewBox:"0 -1787.2 25938.3 3074.3","aria-hidden":"true"},L1={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},x1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.576ex"},xmlns:"http://www.w3.org/2000/svg",width:"43.943ex",height:"2.639ex",role:"img",focusable:"false",viewBox:"0 -911.5 19423 1166.3","aria-hidden":"true"},w1={class:"custom-block info"},V1={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},y1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.8ex"},xmlns:"http://www.w3.org/2000/svg",width:"44.345ex",height:"2.722ex",role:"img",focusable:"false",viewBox:"0 -849.5 19600.6 1203","aria-hidden":"true"},f1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},b1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.592ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.618ex",height:"2.309ex",role:"img",focusable:"false",viewBox:"0 -759 2041 1020.7","aria-hidden":"true"},M1={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},Z1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.576ex"},xmlns:"http://www.w3.org/2000/svg",width:"21.352ex",height:"2.407ex",role:"img",focusable:"false",viewBox:"0 -809 9437.5 1063.8","aria-hidden":"true"},v1={class:"custom-block tip"},D1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},_1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.466ex"},xmlns:"http://www.w3.org/2000/svg",width:"38.1ex",height:"2.061ex",role:"img",focusable:"false",viewBox:"0 -705 16840.1 911","aria-hidden":"true"},A1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},B1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"8.392ex",height:"2.022ex",role:"img",focusable:"false",viewBox:"0 -871.8 3709.1 893.8","aria-hidden":"true"},C1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},S1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"10.152ex",height:"2.022ex",role:"img",focusable:"false",viewBox:"0 -871.8 4487.1 893.8","aria-hidden":"true"},j1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},E1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"8.392ex",height:"2.005ex",role:"img",focusable:"false",viewBox:"0 -864 3709.1 886","aria-hidden":"true"},R1={class:"custom-block danger"},P1={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},O1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.148ex"},xmlns:"http://www.w3.org/2000/svg",width:"56.09ex",height:"5.428ex",role:"img",focusable:"false",viewBox:"0 -1449.5 24791.8 2399","aria-hidden":"true"};function q1(F1,a,I1,z1,N1,X1){return e(),l("div",null,[a[216]||(a[216]=T("",32)),t("div",n,[a[7]||(a[7]=t("div",{class:"custom-block-title"},"问题背景",-1)),a[8]||(a[8]=t("p",null,[t("strong",null,"MiniMax-Text-01")],-1)),a[9]||(a[9]=t("ul",null,[t("li",null,[t("code",null,"Hybrid Lightning Attention"),Q(" + "),t("code",null,"MoE")])],-1)),a[10]||(a[10]=t("p",null,[t("strong",null,"LRM")],-1)),t("ul",null,[t("li",null,[a[2]||(a[2]=Q("LRM很好，但")),a[3]||(a[3]=t("code",null,"扩充长度受限",-1)),a[4]||(a[4]=Q("于softmax ")),t("mjx-container",d,[(e(),l("svg",i,a[0]||(a[0]=[T("",1)]))),a[1]||(a[1]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"o"),t("mo",{stretchy:"false"},"("),t("msup",null,[t("mi",null,"n"),t("mn",null,"2")]),t("mo",{stretchy:"false"},")")])],-1))]),a[5]||(a[5]=Q("限制。"))]),a[6]||(a[6]=t("li",null,[Q("有些解决方法，但都"),t("code",null,"没在LRM上大规模应用"),Q("。")],-1))])]),a[217]||(a[217]=T("",17)),t("div",r,[a[21]||(a[21]=T("",8)),t("ul",null,[a[20]||(a[20]=T("",3)),t("li",null,[a[19]||(a[19]=Q("解决方法 ")),t("ul",null,[a[17]||(a[17]=t("li",null,[t("strong",null,"熔断机制"),Q("：检测到重复生成无意义内容，"),t("code",null,"提前终止生成")],-1)),a[18]||(a[18]=t("li",null,[t("strong",null,"平衡计分"),Q("：采用"),t("code",null,"seq-loss和token-loss的归一化组合"),Q("，避免超多负样本token影响")],-1)),t("li",null,[a[13]||(a[13]=t("strong",null,"控制更新幅度",-1)),a[14]||(a[14]=Q("：")),a[15]||(a[15]=t("strong",null,"降低",-1)),a[16]||(a[16]=Q("梯度裁剪阈值和")),t("mjx-container",m,[(e(),l("svg",h,a[11]||(a[11]=[T("",1)]))),a[12]||(a[12]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"ϵ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"high")])])])],-1))])])])])])]),a[218]||(a[218]=T("",18)),t("div",p,[a[32]||(a[32]=t("div",{class:"custom-block-title"},"问题背景",-1)),t("ul",null,[a[30]||(a[30]=t("li",null,[Q("当前模型大都在"),t("code",null,"32k-256k"),Q("，但对专业书籍、代码项目等"),t("code",null,"真实场景还远远不够"),Q("。")],-1)),t("li",null,[a[24]||(a[24]=t("code",null,"长度扩展受限",-1)),a[25]||(a[25]=Q("于Transformer ")),t("strong",null,[t("mjx-container",g,[(e(),l("svg",c,a[22]||(a[22]=[T("",1)]))),a[23]||(a[23]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"O"),t("mo",{stretchy:"false"},"("),t("msup",null,[t("mi",null,"n"),t("mn",null,"2")]),t("mo",{stretchy:"false"},")")])],-1))])]),a[26]||(a[26]=Q()),a[27]||(a[27]=t("code",null,"计算复杂度",-1)),a[28]||(a[28]=Q("。学术界处理方法： ")),a[29]||(a[29]=t("ul",null,[t("li",null,"Sparse Attention, Linear Attention, 长卷积, State Space模型(Mamba系列)、linear RNN等。"),t("li",null,[t("code",null,"Linear Attention"),Q(" 没有在工业界真正大规模scale过。")])],-1))]),a[31]||(a[31]=t("li",null,[t("strong",null,"MiniMax-01目标"),Q("："),t("code",null,"效果好"),Q(" + "),t("code",null,"超长上下文"),Q("。")],-1))])]),a[219]||(a[219]=T("",7)),t("div",u,[a[69]||(a[69]=t("div",{class:"custom-block-title"},"MiniMax-01 MoE",-1)),a[70]||(a[70]=t("p",null,[t("strong",null,"MoE")],-1)),t("ul",null,[t("li",null,[t("p",null,[a[37]||(a[37]=t("strong",null,"输入token",-1)),a[38]||(a[38]=Q("：")),t("mjx-container",H,[(e(),l("svg",k,a[33]||(a[33]=[T("",1)]))),a[34]||(a[34]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"x")]),t("mi",null,"t")])])])],-1))]),a[39]||(a[39]=Q("，")),a[40]||(a[40]=t("strong",null,"输出隐向量",-1)),a[41]||(a[41]=Q("： ")),t("mjx-container",L,[(e(),l("svg",x,a[35]||(a[35]=[T("",1)]))),a[36]||(a[36]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"h")]),t("mi",null,"t")])])])],-1))])])]),t("li",null,[t("p",null,[a[46]||(a[46]=t("strong",null,"Gate网络权重",-1)),a[47]||(a[47]=Q("：")),t("mjx-container",w,[(e(),l("svg",V,a[42]||(a[42]=[T("",1)]))),a[43]||(a[43]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"W")]),t("mi",null,"g")])])])],-1))]),a[48]||(a[48]=Q("，")),a[49]||(a[49]=t("strong",null,"专家",-1)),a[50]||(a[50]=Q("：")),t("mjx-container",y,[(e(),l("svg",f,a[44]||(a[44]=[T("",1)]))),a[45]||(a[45]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mtext",null,"FFN"),t("mi",null,"i")])])])],-1))])])]),t("li",null,[a[53]||(a[53]=t("p",null,[Q("对"),t("code",null,"前k个专家"),Q("的输出进行"),t("code",null,"加权求和")],-1)),t("mjx-container",b,[(e(),l("svg",M,a[51]||(a[51]=[T("",1)]))),a[52]||(a[52]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"h")]),t("mi",null,"t")])]),t("mo",null,"="),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,"="),t("mn",null,"1")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("mi",null,"E"),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|")])]),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mtext",null,"Softmax"),t("mi",null,"i")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"1.2em",maxsize:"1.2em"},"(")]),t("mstyle",{mathcolor:"red"},[t("mtext",null,"TopK")]),t("mo",{stretchy:"false"},"("),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"x")]),t("mi",null,"t")])]),t("mo",null,"⋅"),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"W")]),t("mi",null,"g")]),t("mo",{stretchy:"false"},")")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"1.2em",maxsize:"1.2em"},")")]),t("mo",null,"⋅"),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mtext",null,"FFN"),t("mi",null,"i")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"1.2em",maxsize:"1.2em"},"(")]),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"x")]),t("mi",null,"t")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"1.2em",maxsize:"1.2em"},")")])])],-1))])])]),a[71]||(a[71]=t("p",null,[t("strong",null,"解决路由坍塌/专家平衡问题：辅助loss")],-1)),t("ul",null,[a[68]||(a[68]=t("li",null,[t("p",null,[Q("问题：大部分token都发送给少数机构专家，出现"),t("code",null,"赢者通吃现象")])],-1)),t("li",null,[a[67]||(a[67]=t("p",null,[Q("方法："),t("a",{href:"https://plmsmile.github.io/posts/llm/basic/04-llm-architecture.html#%E6%89%B9%E9%87%8F%E5%87%8F%E5%B0%8F%E5%8F%8A%E4%B8%93%E5%AE%B6%E5%B9%B3%E8%A1%A1%E9%97%AE%E9%A2%98",target:"_blank",rel:"noreferrer"},"辅助loss")],-1)),t("ul",null,[t("li",null,[t("mjx-container",Z,[(e(),l("svg",v,a[54]||(a[54]=[T("",1)]))),a[55]||(a[55]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mi",null,"f"),t("mi",null,"i")])])])],-1))]),a[56]||(a[56]=Q("：")),a[57]||(a[57]=t("code",null,"专家i的实际负载",-1)),a[58]||(a[58]=Q("，分配的token数量占总token数量的比例"))]),t("li",null,[t("mjx-container",D,[(e(),l("svg",_,a[59]||(a[59]=[T("",1)]))),a[60]||(a[60]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mi",null,"m"),t("mi",null,"i")])])])],-1))]),a[61]||(a[61]=Q("：")),a[62]||(a[62]=t("code",null,"专家i的平均路由得分",-1)),a[63]||(a[63]=Q("。"))]),a[64]||(a[64]=T("",1))]),t("mjx-container",A,[(e(),l("svg",B,a[65]||(a[65]=[T("",1)]))),a[66]||(a[66]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",null,"L"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"aux")])])]),t("mo",null,"="),t("msub",null,[t("mi",null,"α"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"aux")])]),t("mo",null,"⋅"),t("mstyle",{mathcolor:"blue"},[t("mfrac",null,[t("mn",null,"1"),t("mi",null,"E")]),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,"="),t("mn",null,"1")]),t("mi",null,"E")])]),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mi",null,"f"),t("mi",null,"i")])]),t("mo",null,"⋅"),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mi",null,"m"),t("mi",null,"i")])])])],-1))])])]),a[72]||(a[72]=T("",2))]),a[220]||(a[220]=t("h4",{id:"lightning-attention",tabindex:"-1"},[Q("Lightning Attention "),t("a",{class:"header-anchor",href:"#lightning-attention","aria-label":'Permalink to "Lightning Attention"'},"​")],-1)),t("div",C,[a[96]||(a[96]=t("div",{class:"custom-block-title"},"Lighting Attention 问题背景",-1)),a[97]||(a[97]=t("p",null,[t("strong",null,"问题背景")],-1)),t("ul",null,[t("li",null,[t("p",null,[a[75]||(a[75]=t("a",{href:"https://plmsmile.github.io/posts/llm/basic/02-llm-components.html#%E6%A0%87%E5%87%86softmax-attention",target:"_blank",rel:"noreferrer"},"传统SoftmaxAttention",-1)),a[76]||(a[76]=Q(" 时间复杂度为")),t("mjx-container",S,[(e(),l("svg",j,a[73]||(a[73]=[T("",1)]))),a[74]||(a[74]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"O"),t("mo",{stretchy:"false"},"("),t("mstyle",{mathcolor:"red"},[t("mi",null,"d"),t("msup",null,[t("mi",null,"n"),t("mn",null,"2")])]),t("mo",{stretchy:"false"},")")])],-1))]),a[77]||(a[77]=Q("，太慢"))]),t("mjx-container",E,[(e(),l("svg",R,a[78]||(a[78]=[T("",1)]))),a[79]||(a[79]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("mi",{mathvariant:"bold-italic"},"O")]),t("mo",null,"="),t("mo",{stretchy:"false"},"["),t("mo",{stretchy:"false"},"("),t("mstyle",{mathcolor:"red"},[t("mi",{mathvariant:"bold-italic"},"Q"),t("msup",null,[t("mi",{mathvariant:"bold-italic"},"K"),t("mi",{mathvariant:"normal"},"⊤")])]),t("mo",{stretchy:"false"},")"),t("mo",null,"⊙"),t("mstyle",{mathcolor:"blue"},[t("mi",{mathvariant:"bold-italic"},"M")]),t("mo",{stretchy:"false"},"]"),t("mstyle",{mathcolor:"blue"},[t("mi",{mathvariant:"bold-italic"},"V")])])],-1))])]),t("li",null,[t("p",null,[a[82]||(a[82]=t("a",{href:"http://plmsmile.github.io/posts/llm/basic/02-llm-components.html#%E7%BA%BF%E6%80%A7%E6%B3%A8%E6%84%8F%E5%8A%9B",target:"_blank",rel:"noreferrer"},"Linear Attention",-1)),a[83]||(a[83]=Q(" 时间复杂度为")),t("mjx-container",P,[(e(),l("svg",O,a[80]||(a[80]=[T("",1)]))),a[81]||(a[81]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"O"),t("mo",{stretchy:"false"},"("),t("mstyle",{mathcolor:"red"},[t("mi",null,"n"),t("msup",null,[t("mi",null,"d"),t("mn",null,"2")])]),t("mo",{stretchy:"false"},")")])],-1))]),a[84]||(a[84]=Q("，")),a[85]||(a[85]=t("code",null,"线性依赖于n",-1))]),a[95]||(a[95]=t("ul",null,[t("li",null,[Q("但"),t("code",null,"cusum操作严格顺序执行太慢"),Q("，"),t("code",null,"无法真正并行计算"),Q("，阻碍GPU大规模并行计算。")])],-1)),t("mjx-container",q,[(e(),l("svg",F,a[86]||(a[86]=[T("",1)]))),a[87]||(a[87]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("mi",{mathvariant:"bold-italic"},"O")]),t("mo",null,"="),t("mtext",null,"Norm"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"1.2em",maxsize:"1.2em"},"(")]),t("mstyle",{mathcolor:"blue"},[t("mi",{mathvariant:"bold-italic"},"Q")]),t("mo",{stretchy:"false"},"("),t("mstyle",{mathcolor:"red"},[t("msup",null,[t("mi",{mathvariant:"bold-italic"},"K"),t("mi",{mathvariant:"normal"},"⊤")]),t("mi",{mathvariant:"bold-italic"},"V")]),t("mo",{stretchy:"false"},")"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"1.2em",maxsize:"1.2em"},")")])])],-1))]),t("mjx-container",I,[(e(),l("svg",z,a[88]||(a[88]=[T("",1)]))),a[89]||(a[89]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mi",{mathvariant:"bold-italic"},"o"),t("mi",null,"t")])]),t("mo",null,"="),t("msub",null,[t("mstyle",{mathcolor:"blue"},[t("mi",{mathvariant:"bold-italic"},"S")]),t("mstyle",{mathcolor:"red"},[t("mi",null,"t")])]),t("msub",null,[t("mstyle",{mathcolor:"blue"},[t("mi",{mathvariant:"bold-italic"},"q")]),t("mstyle",{mathcolor:"red"},[t("mi",null,"t")])]),t("mo",null,","),t("mstyle",{scriptlevel:"0"},[t("mspace",{width:"1em"})]),t("mstyle",{scriptlevel:"0"},[t("mspace",{width:"1em"})]),t("msub",null,[t("mstyle",{mathcolor:"blue"},[t("mi",{mathvariant:"bold-italic"},"S")]),t("mstyle",{mathcolor:"red"},[t("mi",null,"t")])]),t("mo",null,"="),t("msub",null,[t("mstyle",{mathcolor:"blue"},[t("mi",{mathvariant:"bold-italic"},"S")]),t("mstyle",{mathcolor:"red"},[t("mi",null,"t"),t("mo",null,"−"),t("mn",null,"1")])]),t("mo",null,"+"),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mi",{mathvariant:"bold-italic"},"v"),t("mi",null,"t")])]),t("mstyle",{mathcolor:"blue"},[t("msubsup",null,[t("mi",{mathvariant:"bold-italic"},"k"),t("mi",null,"t"),t("mi",{mathvariant:"normal"},"⊤")])])])],-1))]),t("mjx-container",N,[(e(),l("svg",X,a[90]||(a[90]=[T("",1)]))),a[91]||(a[91]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("msub",null,[t("mstyle",{mathcolor:"blue"},[t("mi",{mathvariant:"bold-italic"},"S")]),t("mstyle",{mathcolor:"red"},[t("mi",null,"t")])]),t("mo",null,"="),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"j"),t("mo",null,"="),t("mn",null,"1")]),t("mstyle",{mathcolor:"red"},[t("mi",null,"t")])]),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mi",{mathvariant:"bold-italic"},"v"),t("mi",null,"j")])]),t("mstyle",{mathcolor:"blue"},[t("msubsup",null,[t("mi",{mathvariant:"bold-italic"},"k"),t("mi",null,"j"),t("mi",{mathvariant:"normal"},"⊤")])]),t("mstyle",{scriptlevel:"0"},[t("mspace",{width:"1em"})]),t("mo",null,"∈"),t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"double-struck"},"R")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mstyle",{mathcolor:"red"},[t("mi",null,"d"),t("mo",null,"×"),t("mi",null,"d")])])])])],-1))]),t("ul",null,[t("li",null,[a[94]||(a[94]=t("strong",null,"Minimax-01 递归写法",-1)),t("mjx-container",G,[(e(),l("svg",J,a[92]||(a[92]=[T("",1)]))),a[93]||(a[93]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("mi",{mathvariant:"bold-italic"},"k"),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"v"),t("mn",null,"0")])]),t("mo",null,"="),t("mn",{mathvariant:"bold"},"0"),t("mo",null,","),t("mstyle",{scriptlevel:"0"},[t("mspace",{width:"1em"})]),t("mstyle",{mathcolor:"blue"},[t("mi",{mathvariant:"bold-italic"},"k"),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"v"),t("mi",null,"t")])]),t("mo",null,"="),t("mstyle",{mathcolor:"blue"},[t("mi",{mathvariant:"bold-italic"},"k"),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"v"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"−"),t("mn",null,"1")])])]),t("mo",null,"+"),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mi",{mathvariant:"bold-italic"},"k"),t("mi",null,"t")]),t("msubsup",null,[t("mi",{mathvariant:"bold-italic"},"v"),t("mi",null,"t"),t("mi",{mathvariant:"normal"},"⊤")])]),t("mo",null,","),t("mstyle",{scriptlevel:"0"},[t("mspace",{width:"1em"})]),t("mstyle",{mathcolor:"red"},[t("msubsup",null,[t("mi",{mathvariant:"bold-italic"},"o"),t("mi",null,"t"),t("mi",{mathvariant:"normal"},"⊤")])]),t("mo",null,"="),t("mstyle",{mathcolor:"red"},[t("msubsup",null,[t("mi",null,"q"),t("mi",null,"t"),t("mi",{mathvariant:"normal"},"⊤")])]),t("mstyle",{mathcolor:"blue"},[t("mi",{mathvariant:"bold-italic"},"k"),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"v"),t("mi",null,"t")])])])],-1))])])])])])]),t("div",K,[a[130]||(a[130]=t("div",{class:"custom-block-title"},"Lightning Attention 核心思想",-1)),a[131]||(a[131]=t("p",null,[t("strong",null,"Lightning Attention 核心思想")],-1)),t("ul",null,[a[111]||(a[111]=t("li",null,[t("p",null,[Q("利用"),t("strong",null,"分块技术来计算注意力"),Q("，")]),t("ul",null,[t("li",null,[Q("把"),t("code",null,"无法并行的大问题"),Q("，分解成"),t("code",null,"大量可并行的小问题"),Q(" +"),t("code",null," 少量不可并行的衔接"),Q("。")])])],-1)),t("li",null,[a[110]||(a[110]=t("p",null,[t("strong",null,"把序列分成2块")],-1)),t("ul",null,[t("li",null,[a[102]||(a[102]=Q("第一块包含")),a[103]||(a[103]=t("code",null,"m个token",-1)),a[104]||(a[104]=Q()),t("mjx-container",U,[(e(),l("svg",W,a[98]||(a[98]=[T("",1)]))),a[99]||(a[99]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",{mathvariant:"bold-italic"},"Q"),t("mn",{mathvariant:"bold"},"1")]),t("mo",{mathvariant:"bold"},","),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"K"),t("mn",{mathvariant:"bold"},"1")]),t("mo",{mathvariant:"bold"},","),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"V"),t("mn",{mathvariant:"bold"},"1")])])])],-1))]),a[105]||(a[105]=Q("，第二块包含")),a[106]||(a[106]=t("code",null,"剩下的token",-1)),a[107]||(a[107]=Q()),t("mjx-container",$,[(e(),l("svg",Y,a[100]||(a[100]=[T("",1)]))),a[101]||(a[101]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",{mathvariant:"bold-italic"},"Q"),t("mn",{mathvariant:"bold"},"2")]),t("mo",{mathvariant:"bold"},","),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"K"),t("mn",{mathvariant:"bold"},"2")]),t("mo",{mathvariant:"bold"},","),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"V"),t("mn",{mathvariant:"bold"},"2")])])])],-1))])])]),t("mjx-container",t1,[(e(),l("svg",a1,a[108]||(a[108]=[T("",1)]))),a[109]||(a[109]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("mi",{mathvariant:"bold-italic"},"X")]),t("mo",null,"="),t("mrow",{"data-mjx-texclass":"INNER"},[t("mo",{"data-mjx-texclass":"OPEN"},"["),t("mtable",{columnspacing:"1em",rowspacing:"4pt"},[t("mtr",null,[t("mtd",null,[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",{mathvariant:"bold-italic"},"X"),t("mn",null,"1")])])])]),t("mtr",null,[t("mtd",null,[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",{mathvariant:"bold-italic"},"X"),t("mn",null,"2")])])])])]),t("mo",{"data-mjx-texclass":"CLOSE"},"]")]),t("mo",null,","),t("mstyle",{scriptlevel:"0"},[t("mspace",{width:"1em"})]),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",{mathvariant:"bold-italic"},"X"),t("mn",null,"1")])]),t("mo",null,"∈"),t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"double-struck"},"R")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mstyle",{mathcolor:"red"},[t("mi",null,"m"),t("mo",null,"×"),t("mi",null,"d")])])]),t("mo",null,","),t("mstyle",{scriptlevel:"0"},[t("mspace",{width:"1em"})]),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",{mathvariant:"bold-italic"},"X"),t("mn",null,"2")])]),t("mo",null,"∈"),t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"double-struck"},"R")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mstyle",{mathcolor:"red"},[t("mo",{stretchy:"false"},"("),t("mi",null,"n"),t("mo",null,"−"),t("mi",null,"m"),t("mo",{stretchy:"false"},")"),t("mo",null,"×"),t("mi",null,"d")])])]),t("mo",null,",")])],-1))])]),a[112]||(a[112]=t("li",null,[t("p",null,"每块分为"),t("ul",null,[t("li",null,[t("code",null,"块内计算(传统softmax 并行计算)"),Q("、"),t("code",null,"块间计算(线性注意力高效计算)"),Q("。")]),t("li",null,"大部分并行、小部分串行。")])],-1))]),a[132]||(a[132]=t("p",null,[t("strong",null,"第一块计算")],-1)),t("ul",null,[t("li",null,[a[115]||(a[115]=t("p",null,[Q("分解成2部分，"),t("code",null,"块内计算 + 块间计算")],-1)),t("mjx-container",Q1,[(e(),l("svg",T1,a[113]||(a[113]=[T("",1)]))),a[114]||(a[114]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",{mathvariant:"bold-italic"},"O"),t("mn",{mathvariant:"bold"},"1")])]),t("mo",null,"="),t("munder",null,[t("mrow",{"data-mjx-texclass":"OP"},[t("munder",null,[t("mrow",null,[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",{mathvariant:"bold-italic"},"Q"),t("mn",{mathvariant:"bold"},"1")])]),t("mstyle",{mathcolor:"red"},[t("mi",{mathvariant:"bold-italic"},"K")]),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",{mathvariant:"bold-italic"},"V"),t("mn",{mathvariant:"bold"},"0")])])]),t("mo",null,"⏟")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mstyle",{mathcolor:"red"},[t("mi",{mathvariant:"normal"},"块"),t("mi",{mathvariant:"normal"},"间")])])]),t("mo",null,"+"),t("munder",null,[t("mrow",{"data-mjx-texclass":"OP"},[t("munder",null,[t("mrow",null,[t("mo",{stretchy:"false"},"["),t("mo",{stretchy:"false"},"("),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",{mathvariant:"bold-italic"},"Q"),t("mn",{mathvariant:"bold"},"1")]),t("msubsup",null,[t("mi",{mathvariant:"bold-italic"},"K"),t("mn",{mathvariant:"bold"},"1"),t("mi",{mathvariant:"normal"},"⊤")])]),t("mo",{stretchy:"false"},")"),t("mo",null,"⊙"),t("mstyle",{mathcolor:"blue"},[t("mi",{mathvariant:"bold-italic"},"M")]),t("mo",{stretchy:"false"},"]"),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",{mathvariant:"bold-italic"},"V"),t("mn",{mathvariant:"bold"},"1")])])]),t("mo",null,"⏟")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mstyle",{mathcolor:"red"},[t("mi",{mathvariant:"normal"},"块"),t("mi",{mathvariant:"normal"},"内")])])])])],-1))])]),a[122]||(a[122]=T("",1)),t("li",null,[a[121]||(a[121]=t("p",null,[t("strong",null,"块间部分")],-1)),t("ul",null,[a[119]||(a[119]=t("li",null,"代表了第一块中每个token对它之前所有历史信息的注意力",-1)),t("li",null,[t("mjx-container",l1,[(e(),l("svg",e1,a[116]||(a[116]=[T("",1)]))),a[117]||(a[117]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mstyle",{mathcolor:"red"},[t("mi",null,"K")]),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",null,"V"),t("mn",null,"0")])])])],-1))]),a[118]||(a[118]=Q("：从第0个块传递来的状态矩阵"))]),a[120]||(a[120]=t("li",null,[Q("采用"),t("code",null,"线性注意力"),Q("、"),t("code",null,"右乘"),Q("形式，非常"),t("code",null,"高效"),Q("。")],-1))])])]),a[133]||(a[133]=t("p",null,[t("strong",null,"状态更新")],-1)),t("ul",null,[t("li",null,[a[125]||(a[125]=Q("第一块计算完成后，更新状态。把第一块的信息累计到状态矩阵中。")),t("mjx-container",s1,[(e(),l("svg",o1,a[123]||(a[123]=[T("",1)]))),a[124]||(a[124]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"red"},[t("mi",{mathvariant:"bold-italic"},"K"),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"V"),t("mn",{mathvariant:"bold"},"1")])]),t("mo",{mathvariant:"bold"},"="),t("mstyle",{mathcolor:"blue"},[t("mi",{mathvariant:"bold-italic"},"K"),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"V"),t("mn",{mathvariant:"bold"},"0")])]),t("mo",{mathvariant:"bold"},"+"),t("mstyle",{mathcolor:"blue"},[t("msubsup",null,[t("mi",{mathvariant:"bold-italic"},"K"),t("mn",{mathvariant:"bold"},"1"),t("mi",{mathvariant:"bold"},"⊤")]),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"V"),t("mn",{mathvariant:"bold"},"1")])])])],-1))])])]),a[134]||(a[134]=t("p",null,[t("strong",null,"第二块更新")],-1)),t("ul",null,[t("li",null,[a[128]||(a[128]=t("p",null,"分解成2部分，块间计算 + 块内计算",-1)),t("mjx-container",n1,[(e(),l("svg",d1,a[126]||(a[126]=[T("",1)]))),a[127]||(a[127]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",{mathvariant:"bold-italic"},"O"),t("mn",{mathvariant:"bold"},"2")])]),t("mo",null,"="),t("munder",null,[t("mrow",{"data-mjx-texclass":"OP"},[t("munder",null,[t("mrow",null,[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",{mathvariant:"bold-italic"},"Q"),t("mn",{mathvariant:"bold"},"2")])]),t("mstyle",{mathcolor:"red"},[t("mi",{mathvariant:"bold-italic"},"K")]),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",{mathvariant:"bold-italic"},"V"),t("mn",{mathvariant:"bold"},"1")])])]),t("mo",null,"⏟")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mstyle",{mathcolor:"red"},[t("mi",{mathvariant:"normal"},"块"),t("mi",{mathvariant:"normal"},"间")])])]),t("mo",null,"+"),t("munder",null,[t("mrow",{"data-mjx-texclass":"OP"},[t("munder",null,[t("mrow",null,[t("mo",{stretchy:"false"},"["),t("mo",{stretchy:"false"},"("),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",{mathvariant:"bold-italic"},"Q"),t("mn",{mathvariant:"bold"},"2")]),t("msubsup",null,[t("mi",{mathvariant:"bold-italic"},"K"),t("mn",{mathvariant:"bold"},"2"),t("mi",{mathvariant:"normal"},"⊤")])]),t("mo",{stretchy:"false"},")"),t("mo",null,"⊙"),t("mstyle",{mathcolor:"blue"},[t("mi",{mathvariant:"bold-italic"},"M")]),t("mo",{stretchy:"false"},"]"),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",{mathvariant:"bold-italic"},"V"),t("mn",{mathvariant:"bold"},"2")])])]),t("mo",null,"⏟")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mstyle",{mathcolor:"red"},[t("mi",{mathvariant:"normal"},"块"),t("mi",{mathvariant:"normal"},"内")])])])])],-1))])]),a[129]||(a[129]=t("li",null,[t("p",null,"计算同第一块。")],-1))])]),a[221]||(a[221]=t("h4",{id:"hybrid-lighting-attention",tabindex:"-1"},[Q("Hybrid Lighting Attention "),t("a",{class:"header-anchor",href:"#hybrid-lighting-attention","aria-label":'Permalink to "Hybrid Lighting Attention"'},"​")],-1)),t("div",i1,[a[162]||(a[162]=T("",4)),t("ul",null,[t("li",null,[a[144]||(a[144]=t("strong",null,"Softmax 注意力",-1)),t("ul",null,[a[142]||(a[142]=t("li",null,[Q("通读书籍，"),t("code",null,"处理第t个词时"),Q("，"),t("code",null,"会把之前的所有词都过一遍"),Q("。")],-1)),a[143]||(a[143]=t("li",null,[Q("优点：记忆力好，检索能力强；缺点："),t("code",null,"计算量大"),Q("。")],-1)),t("li",null,[a[137]||(a[137]=t("code",null,"容量",-1)),a[138]||(a[138]=Q("：草稿纸大小 ")),t("strong",null,[t("mjx-container",r1,[(e(),l("svg",m1,a[135]||(a[135]=[T("",1)]))),a[136]||(a[136]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"o"),t("mo",{stretchy:"false"},"("),t("mi",null,"d"),t("mo",{stretchy:"false"},")")])],-1))])]),a[139]||(a[139]=Q("，")),a[140]||(a[140]=t("code",null,"128",-1)),a[141]||(a[141]=Q("。"))])])]),t("li",null,[a[160]||(a[160]=t("strong",null,"线性注意力",-1)),t("ul",null,[a[159]||(a[159]=t("li",null,"直觉上：无法有效检索。",-1)),t("li",null,[a[147]||(a[147]=Q("但")),a[148]||(a[148]=t("code",null,"通过容量来记录压缩历史信息",-1)),a[149]||(a[149]=Q("：")),a[150]||(a[150]=t("code",null,"循环更新的状态矩阵大小",-1)),a[151]||(a[151]=Q("，")),t("mjx-container",h1,[(e(),l("svg",p1,a[145]||(a[145]=[T("",1)]))),a[146]||(a[146]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",{mathvariant:"bold-italic"},"S"),t("mi",null,"t")])]),t("mo",null,"∈"),t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"double-struck"},"R")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mstyle",{mathcolor:"red"},[t("mi",null,"d"),t("mo",null,"×"),t("mi",null,"d")])])])])],-1))]),a[152]||(a[152]=Q("，"))]),t("li",null,[a[155]||(a[155]=t("code",null,"容量",-1)),a[156]||(a[156]=Q("：草稿纸大小 ")),t("strong",null,[t("mjx-container",g1,[(e(),l("svg",c1,a[153]||(a[153]=[T("",1)]))),a[154]||(a[154]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"o"),t("mo",{stretchy:"false"},"("),t("msup",null,[t("mi",null,"d"),t("mn",null,"2")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"/")]),t("mi",null,"h"),t("mo",{stretchy:"false"},")")])],-1))])]),a[157]||(a[157]=Q("，")),a[158]||(a[158]=t("code",null,"128*128/64=256",-1))])])]),a[161]||(a[161]=t("li",null,"但在容量上，线性注意力更大",-1))])]),a[222]||(a[222]=T("",2)),t("div",u1,[a[171]||(a[171]=T("",4)),t("ul",null,[a[169]||(a[169]=t("li",null,[t("p",null,[Q("像Chinchilla这样著名的scaling law"),t("code",null,"不适用当前架构"),Q("，"),t("code",null,"需定制化scaling law")])],-1)),t("li",null,[a[165]||(a[165]=t("p",null,"模型规格",-1)),t("mjx-container",H1,[(e(),l("svg",k1,a[163]||(a[163]=[T("",1)]))),a[164]||(a[164]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mtable",{columnalign:"left",columnspacing:"1em",rowspacing:"4pt"},[t("mtr",null,[t("mtd"),t("mtd",null,[t("mstyle",{mathcolor:"red"},[t("munder",null,[t("mo",{"data-mjx-texclass":"OP"},"min"),t("mrow",{"data-mjx-texclass":"ORD"},[t("msub",null,[t("mi",null,"P"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"all")])]),t("mo",null,","),t("msub",null,[t("mi",null,"P"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"act")])])])])]),t("mstyle",{mathcolor:"blue"},[t("mi",null,"L"),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"P"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"all")])]),t("mo",null,","),t("msub",null,[t("mi",null,"P"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"act")])]),t("mo",null,","),t("mi",null,"T"),t("mo",{stretchy:"false"},")")])])]),t("mtr",null,[t("mtd"),t("mtd",null,[t("mtext",null,"subject to"),t("mstyle",{scriptlevel:"0"},[t("mspace",{width:"1em"})]),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",null,"C"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"compute")])])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"P"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"all")])]),t("mo",null,","),t("msub",null,[t("mi",null,"P"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"act")])]),t("mo",null,","),t("mi",null,"T"),t("mo",{stretchy:"false"},")"),t("mo",null,"<"),t("mi",null,"C"),t("mstyle",{scriptlevel:"0"},[t("mspace",{width:"1em"})]),t("mtext",null,"and"),t("mstyle",{scriptlevel:"0"},[t("mspace",{width:"1em"})]),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",null,"P"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"all")])])]),t("mo",null,"<"),t("mn",null,"500"),t("mi",null,"B")])])])])],-1))])]),t("li",null,[a[168]||(a[168]=T("",2)),t("mjx-container",L1,[(e(),l("svg",x1,a[166]||(a[166]=[T("",1)]))),a[167]||(a[167]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("mi",null,"L"),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"P"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"act")])]),t("mo",null,","),t("mi",null,"T"),t("mo",null,"∣"),t("mi",null,"E"),t("mo",{stretchy:"false"},")")]),t("mo",null,"="),t("mi",null,"d"),t("mo",null,"+"),t("mi",null,"α"),t("msubsup",null,[t("mi",null,"P"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"act")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"α")])]),t("mo",null,"+"),t("mi",null,"b"),t("msup",null,[t("mi",null,"T"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"β")])]),t("mo",null,"+"),t("mi",null,"c"),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"P"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"act")])]),t("mi",null,"T"),t("msup",null,[t("mo",{stretchy:"false"},")"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"γ")])])])],-1))])]),a[170]||(a[170]=t("li",null,[t("p",null,[t("strong",null,"最终确定"),Q("："),t("code",null,"456B总参数"),Q("、"),t("code",null,"46B激活参数")])],-1))])]),a[223]||(a[223]=T("",4)),t("div",w1,[a[180]||(a[180]=T("",4)),t("ul",null,[t("li",null,[a[174]||(a[174]=t("p",null,[t("code",null,"多选Benchmark"),Q("，但"),t("code",null,"去掉选项索引"),Q("，评估模型"),t("code",null,"生成正确答案"),Q("的"),t("code",null,"对数归一化准确率")],-1)),t("mjx-container",V1,[(e(),l("svg",y1,a[172]||(a[172]=[T("",1)]))),a[173]||(a[173]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mi",null,"log"),t("mo",{"data-mjx-texclass":"NONE"},"⁡"),t("msub",null,[t("mtext",null,"acc"),t("mrow",{"data-mjx-texclass":"ORD"},[t("msup",null,[t("mtext",null,"norm"),t("mn",null,"2")])])]),t("mo",{stretchy:"false"},"("),t("mi",null,"x"),t("mo",{stretchy:"false"},")"),t("mo",null,"="),t("mi",null,"log"),t("mo",{"data-mjx-texclass":"NONE"},"⁡"),t("msub",null,[t("mtext",null,"softmax"),t("mrow",{"data-mjx-texclass":"ORD"},[t("msup",null,[t("mi",null,"p"),t("mi",{"data-mjx-alternate":"1"},"′")]),t("mo",{stretchy:"false"},"("),t("mi",null,"c"),t("mo",null,"∈"),t("msub",null,[t("mi",null,"C"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"x")])]),t("mo",{stretchy:"false"},")")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"1.2em",maxsize:"1.2em"},"{")]),t("mo",{stretchy:"false"},"("),t("msup",null,[t("mi",null,"p"),t("mi",{"data-mjx-alternate":"1"},"′")]),t("mo",{stretchy:"false"},"("),t("msup",null,[t("mi",null,"c"),t("mo",null,"∗")]),t("mo",{stretchy:"false"},")"),t("mo",{stretchy:"false"},")"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"1.2em",maxsize:"1.2em"},"}")])])],-1))])]),t("li",null,[t("p",null,[t("mjx-container",f1,[(e(),l("svg",b1,a[175]||(a[175]=[T("",1)]))),a[176]||(a[176]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msubsup",null,[t("mi",null,"p"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{"data-mjx-alternate":"1"},"′")])]),t("mo",{stretchy:"false"},"("),t("mi",null,"c"),t("mo",{stretchy:"false"},")")])],-1))]),a[177]||(a[177]=Q("：样本i、选项c的字节归一化概率"))]),t("mjx-container",M1,[(e(),l("svg",Z1,a[178]||(a[178]=[T("",1)]))),a[179]||(a[179]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("msubsup",null,[t("mi",null,"p"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{"data-mjx-alternate":"1"},"′")])]),t("mo",{stretchy:"false"},"("),t("mi",null,"c"),t("mo",{stretchy:"false"},")"),t("mo",null,"="),t("msub",null,[t("mi",null,"p"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i")])]),t("mo",{stretchy:"false"},"("),t("mi",null,"c"),t("mo",{stretchy:"false"},")"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"/")]),t("mtext",null,"bytes"),t("mo",{stretchy:"false"},"("),t("mi",null,"c"),t("mo",{stretchy:"false"},")")])],-1))])])]),a[181]||(a[181]=T("",4))]),a[224]||(a[224]=t("h4",{id:"训练策略-1",tabindex:"-1"},[Q("训练策略 "),t("a",{class:"header-anchor",href:"#训练策略-1","aria-label":'Permalink to "训练策略"'},"​")],-1)),t("div",v1,[a[205]||(a[205]=t("div",{class:"custom-block-title"},"训练策略",-1)),a[206]||(a[206]=t("p",null,[t("strong",null,"参数")],-1)),t("ul",null,[a[202]||(a[202]=t("li",null,[t("a",{href:"https://plmsmile.github.io/posts/olds/dl/35-nerual-network-optim.html#xavier%E5%9D%87%E5%8C%80%E5%88%86%E5%B8%83%E5%88%9D%E5%A7%8B%E5%8C%96",target:"_blank",rel:"noreferrer"},"Xavier 均匀分布初始化策略")],-1)),t("li",null,[a[184]||(a[184]=t("a",{href:"https://plmsmile.github.io/posts/olds/dl/35-nerual-network-optim.html#adam",target:"_blank",rel:"noreferrer"},"Adam 优化器",-1)),a[185]||(a[185]=Q("，")),t("mjx-container",D1,[(e(),l("svg",_1,a[182]||(a[182]=[T("",1)]))),a[183]||(a[183]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"β"),t("mn",null,"1")]),t("mo",null,"="),t("mn",null,"0.9"),t("mo",null,","),t("msub",null,[t("mi",null,"β"),t("mn",null,"2")]),t("mo",null,"="),t("mn",null,"0.95"),t("mo",null,","),t("mtext",null,"weight decay"),t("mo",null,"="),t("mn",null,"0.1")])],-1))])]),a[203]||(a[203]=T("",1)),t("li",null,[a[201]||(a[201]=t("strong",null,"学习率",-1)),t("ul",null,[t("li",null,[a[188]||(a[188]=Q("warm up：500次迭代，达峰值 ")),t("strong",null,[t("mjx-container",A1,[(e(),l("svg",B1,a[186]||(a[186]=[T("",1)]))),a[187]||(a[187]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mn",null,"2"),t("mo",null,"×"),t("msup",null,[t("mn",null,"10"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"−"),t("mn",null,"4")])])])],-1))])]),a[189]||(a[189]=Q("，")),a[190]||(a[190]=t("strong",null,"保持稳定直到7.2T tokens",-1)),a[191]||(a[191]=Q("。 ")),a[192]||(a[192]=t("ul",null,[t("li",null,"发现gradient norm过高异常，可能是学习率过大。")],-1))]),t("li",null,[a[195]||(a[195]=t("strong",null,"剩余3.2T tokens",-1)),a[196]||(a[196]=Q("：学习率调整为 ")),t("strong",null,[t("mjx-container",C1,[(e(),l("svg",S1,a[193]||(a[193]=[T("",1)]))),a[194]||(a[194]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mn",null,"1.3"),t("mo",null,"×"),t("msup",null,[t("mn",null,"10"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"−"),t("mn",null,"4")])])])],-1))])])]),t("li",null,[a[199]||(a[199]=t("strong",null,"快速衰减阶段 1T Tokens",-1)),a[200]||(a[200]=Q("：学习率指数及衰减至 ")),t("strong",null,[t("mjx-container",j1,[(e(),l("svg",E1,a[197]||(a[197]=[T("",1)]))),a[198]||(a[198]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mn",null,"3"),t("mo",null,"×"),t("msup",null,[t("mn",null,"10"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"−"),t("mn",null,"5")])])])],-1))])])])])]),a[204]||(a[204]=t("li",null,"MoE 辅助loss系数：0.01",-1))]),a[207]||(a[207]=T("",4))]),a[225]||(a[225]=T("",11)),t("div",R1,[a[215]||(a[215]=T("",6)),t("ul",null,[a[213]||(a[213]=t("li",null,[t("p",null,"IS权重 CLIP 优化"),t("ul",null,[t("li",null,"传统GRPO问题：在IS大+负优势值时，容易导致梯度不稳定。"),t("li",null,"改进：额外clip，直接丢弃这种case，减轻了噪声传播")])],-1)),t("li",null,[a[212]||(a[212]=t("p",null,[t("a",{href:"https://plmsmile.github.io/posts/llm/basic/01-lm-define-information-theory.html#kl%E6%95%A3%E5%BA%A6-%E7%9B%B8%E5%AF%B9%E7%86%B5",target:"_blank",rel:"noreferrer"},"KL 散度"),Q("优化：")],-1)),t("ul",null,[t("li",null,[a[210]||(a[210]=Q("进一步稳定梯度，")),a[211]||(a[211]=t("code",null,"重新构建KL项",-1)),t("mjx-container",P1,[(e(),l("svg",O1,a[208]||(a[208]=[T("",1)]))),a[209]||(a[209]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("msub",null,[t("mi",null,"D"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"K"),t("mi",null,"L")])]),t("mo",{stretchy:"false"},"("),t("mi",null,"θ"),t("mo",{stretchy:"false"},")"),t("mo",null,"="),t("msub",null,[t("mi",null,"E"),t("mi",null,"t")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"2.047em",maxsize:"2.047em"},"[")]),t("mtext",null,"SG"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"1.2em",maxsize:"1.2em"},"(")]),t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"a"),t("mi",null,"t")]),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("msub",null,[t("mi",null,"s"),t("mi",null,"t")]),t("mo",{stretchy:"false"},")"),t("mo",null,"−"),t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("msub",null,[t("mi",null,"θ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"o"),t("mi",null,"l"),t("mi",null,"d")])])])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"a"),t("mi",null,"t")]),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("msub",null,[t("mi",null,"s"),t("mi",null,"t")]),t("mo",{stretchy:"false"},")"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"1.2em",maxsize:"1.2em"},")")]),t("mo",null,"⋅"),t("mi",null,"log"),t("mo",{"data-mjx-texclass":"NONE"},"⁡"),t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"a"),t("mi",null,"t")]),t("mo",null,"∣"),t("msub",null,[t("mi",null,"s"),t("mi",null,"t")]),t("mo",{stretchy:"false"},")"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"2.047em",maxsize:"2.047em"},"]")])])],-1))])])])]),a[214]||(a[214]=T("",1))])]),a[226]||(a[226]=T("",29))])}const K1=s(o,[["render",q1]]);export{J1 as __pageData,K1 as default};

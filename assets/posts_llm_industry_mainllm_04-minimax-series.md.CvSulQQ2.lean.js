import{_ as e,c as l,o as s,ah as T,j as t,a}from"./chunks/framework.CvbyeFFO.js";const R1=JSON.parse('{"title":"MiniMax 系列","description":"","frontmatter":{"title":"MiniMax 系列","date":"2025-11-07T22:29:56.000Z","create":"2025-11-07T22:29:56.000Z","categories":["mainllm"],"tags":["minimax","minimax-01","minimax-m1"]},"headers":[],"relativePath":"posts/llm/industry/mainllm/04-minimax-series.md","filePath":"posts/llm/industry/mainllm/04-minimax-series.md","lastUpdated":null}'),n={name:"posts/llm/industry/mainllm/04-minimax-series.md"},o={class:"custom-block warning"},m={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},d={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.832ex",height:"2.452ex",role:"img",focusable:"false",viewBox:"0 -833.9 2577.6 1083.9","aria-hidden":"true"},r={class:"custom-block tip"},i={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},h={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.139ex",height:"1.361ex",role:"img",focusable:"false",viewBox:"0 -444 945.3 601.8","aria-hidden":"true"},p={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},g={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.211ex",height:"1.927ex",role:"img",focusable:"false",viewBox:"0 -694 977.3 851.8","aria-hidden":"true"},H={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},u={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.667ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.641ex",height:"2.219ex",role:"img",focusable:"false",viewBox:"0 -686 1609.3 981","aria-hidden":"true"},c={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},k={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.391ex",height:"1.902ex",role:"img",focusable:"false",viewBox:"0 -683 2383 840.8","aria-hidden":"true"},L={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},V={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.819ex"},xmlns:"http://www.w3.org/2000/svg",width:"46.05ex",height:"7.044ex",role:"img",focusable:"false",viewBox:"0 -1867.4 20354.1 3113.3","aria-hidden":"true"},x={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},w={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.464ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.848ex",height:"2.059ex",role:"img",focusable:"false",viewBox:"0 -705 817 910","aria-hidden":"true"},y={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},f={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.726ex",height:"1.357ex",role:"img",focusable:"false",viewBox:"0 -442 1205 599.8","aria-hidden":"true"},M={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},b={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.819ex"},xmlns:"http://www.w3.org/2000/svg",width:"26.038ex",height:"6.735ex",role:"img",focusable:"false",viewBox:"0 -1730.8 11508.8 2976.7","aria-hidden":"true"},Z={class:"custom-block tip"},v={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},D={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.008ex",height:"2.452ex",role:"img",focusable:"false",viewBox:"0 -833.9 3097.6 1083.9","aria-hidden":"true"},A={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},_={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"21.241ex",height:"2.569ex",role:"img",focusable:"false",viewBox:"0 -885.3 9388.7 1135.3","aria-hidden":"true"},B={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},C={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.008ex",height:"2.452ex",role:"img",focusable:"false",viewBox:"0 -833.9 3097.6 1083.9","aria-hidden":"true"},j={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},E={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.791ex"},xmlns:"http://www.w3.org/2000/svg",width:"22.132ex",height:"2.794ex",role:"img",focusable:"false",viewBox:"0 -885.3 9782.3 1234.8","aria-hidden":"true"},S={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},R={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.576ex"},xmlns:"http://www.w3.org/2000/svg",width:"32.302ex",height:"2.579ex",role:"img",focusable:"false",viewBox:"0 -885.3 14277.6 1140.1","aria-hidden":"true"},F={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},O={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-3.014ex"},xmlns:"http://www.w3.org/2000/svg",width:"23.681ex",height:"6.844ex",role:"img",focusable:"false",viewBox:"0 -1692.6 10467 3024.8","aria-hidden":"true"},P={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},q={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.576ex"},xmlns:"http://www.w3.org/2000/svg",width:"45.771ex",height:"2.579ex",role:"img",focusable:"false",viewBox:"0 -885.3 20230.8 1140.1","aria-hidden":"true"},I={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},z={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"11.217ex",height:"2.029ex",role:"img",focusable:"false",viewBox:"0 -703 4958.1 897","aria-hidden":"true"},X={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},N={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"11.217ex",height:"2.029ex",role:"img",focusable:"false",viewBox:"0 -703 4958.1 897","aria-hidden":"true"},G={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},J={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.149ex"},xmlns:"http://www.w3.org/2000/svg",width:"43.691ex",height:"5.43ex",role:"img",focusable:"false",viewBox:"0 -1450 19311.5 2400","aria-hidden":"true"},K={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},U={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-4.092ex"},xmlns:"http://www.w3.org/2000/svg",width:"34.844ex",height:"6.095ex",role:"img",focusable:"false",viewBox:"0 -885.3 15401.1 2694.1","aria-hidden":"true"},$={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},W={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.375ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.318ex",height:"1.92ex",role:"img",focusable:"false",viewBox:"0 -683 1908.6 848.6","aria-hidden":"true"},Y={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},t1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.559ex"},xmlns:"http://www.w3.org/2000/svg",width:"22.775ex",height:"2.603ex",role:"img",focusable:"false",viewBox:"0 -903.7 10066.5 1150.7","aria-hidden":"true"},Q1={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},a1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-4.092ex"},xmlns:"http://www.w3.org/2000/svg",width:"34.844ex",height:"6.095ex",role:"img",focusable:"false",viewBox:"0 -885.3 15401.1 2694.1","aria-hidden":"true"},T1={class:"custom-block tip"},l1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},s1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.034ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1783 1000","aria-hidden":"true"},e1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},n1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"9.829ex",height:"2.288ex",role:"img",focusable:"false",viewBox:"0 -853.7 4344.3 1011.5","aria-hidden":"true"},o1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},m1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.456ex",height:"2.452ex",role:"img",focusable:"false",viewBox:"0 -833.9 3295.6 1083.9","aria-hidden":"true"},d1={class:"custom-block tip"},r1={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},i1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.007ex"},xmlns:"http://www.w3.org/2000/svg",width:"78.536ex",height:"3.704ex",role:"img",focusable:"false",viewBox:"0 -750 34712.9 1637.1","aria-hidden":"true"},h1={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},p1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.576ex"},xmlns:"http://www.w3.org/2000/svg",width:"43.943ex",height:"2.639ex",role:"img",focusable:"false",viewBox:"0 -911.5 19423 1166.3","aria-hidden":"true"},g1={class:"custom-block tip"},H1={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},u1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.8ex"},xmlns:"http://www.w3.org/2000/svg",width:"44.345ex",height:"2.722ex",role:"img",focusable:"false",viewBox:"0 -849.5 19600.6 1203","aria-hidden":"true"},c1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},k1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.592ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.618ex",height:"2.309ex",role:"img",focusable:"false",viewBox:"0 -759 2041 1020.7","aria-hidden":"true"},L1={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},V1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.576ex"},xmlns:"http://www.w3.org/2000/svg",width:"21.352ex",height:"2.407ex",role:"img",focusable:"false",viewBox:"0 -809 9437.5 1063.8","aria-hidden":"true"},x1={class:"custom-block tip"},w1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},y1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.466ex"},xmlns:"http://www.w3.org/2000/svg",width:"38.1ex",height:"2.061ex",role:"img",focusable:"false",viewBox:"0 -705 16840.1 911","aria-hidden":"true"},f1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},M1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"8.392ex",height:"2.022ex",role:"img",focusable:"false",viewBox:"0 -871.8 3709.1 893.8","aria-hidden":"true"},b1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Z1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"10.152ex",height:"2.022ex",role:"img",focusable:"false",viewBox:"0 -871.8 4487.1 893.8","aria-hidden":"true"},v1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},D1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"8.392ex",height:"2.005ex",role:"img",focusable:"false",viewBox:"0 -864 3709.1 886","aria-hidden":"true"};function A1(_1,Q,B1,C1,j1,E1){return s(),l("div",null,[Q[169]||(Q[169]=T("",5)),t("div",o,[Q[7]||(Q[7]=t("div",{class:"custom-block-title"},"问题背景",-1)),t("ul",null,[Q[5]||(Q[5]=t("li",null,"当前模型大都在32k-256k，但对专业书籍、代码项目等真实场景还远远不够。",-1)),t("li",null,[Q[2]||(Q[2]=a("长度扩展受限于Transformer ")),t("mjx-container",m,[(s(),l("svg",d,Q[0]||(Q[0]=[T("",1)]))),Q[1]||(Q[1]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"O"),t("mo",{stretchy:"false"},"("),t("msup",null,[t("mi",null,"n"),t("mn",null,"2")]),t("mo",{stretchy:"false"},")")])],-1))]),Q[3]||(Q[3]=a("计算复杂度。学术界处理方法： ")),Q[4]||(Q[4]=t("ul",null,[t("li",null,"Sparse Attention, Linear Attention, 长卷积, State Space模型(Mamba系列)、linear RNN等。"),t("li",null,"Linear Attention 没有在工业界真正大规模scale过。")],-1))]),Q[6]||(Q[6]=t("li",null,"MiniMax-01目标：效果好+超长上下文。",-1))])]),Q[170]||(Q[170]=T("",9)),t("div",r,[Q[44]||(Q[44]=t("div",{class:"custom-block-title"},"MiniMax-01 MoE",-1)),Q[45]||(Q[45]=t("p",null,[t("strong",null,"MoE")],-1)),t("ul",null,[t("li",null,[t("p",null,[Q[12]||(Q[12]=t("strong",null,"输入token",-1)),Q[13]||(Q[13]=a("：")),t("mjx-container",i,[(s(),l("svg",h,Q[8]||(Q[8]=[T("",1)]))),Q[9]||(Q[9]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"x")]),t("mi",null,"t")])])],-1))]),Q[14]||(Q[14]=a("，")),Q[15]||(Q[15]=t("strong",null,"输出隐向量",-1)),Q[16]||(Q[16]=a("： ")),t("mjx-container",p,[(s(),l("svg",g,Q[10]||(Q[10]=[T("",1)]))),Q[11]||(Q[11]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"h")]),t("mi",null,"t")])])],-1))])])]),t("li",null,[t("p",null,[Q[21]||(Q[21]=t("strong",null,"Gate网络权重",-1)),Q[22]||(Q[22]=a("：")),t("mjx-container",H,[(s(),l("svg",u,Q[17]||(Q[17]=[T("",1)]))),Q[18]||(Q[18]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"W")]),t("mi",null,"g")])])],-1))]),Q[23]||(Q[23]=a("，")),Q[24]||(Q[24]=t("strong",null,"专家",-1)),Q[25]||(Q[25]=a("：")),t("mjx-container",c,[(s(),l("svg",k,Q[19]||(Q[19]=[T("",1)]))),Q[20]||(Q[20]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mtext",null,"FFN"),t("mi",null,"i")])])],-1))])]),Q[28]||(Q[28]=t("ul",null,[t("li",null,"对前k个专家的输出进行加权求和")],-1)),t("mjx-container",L,[(s(),l("svg",V,Q[26]||(Q[26]=[T("",1)]))),Q[27]||(Q[27]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"h")]),t("mi",null,"t")])]),t("mo",null,"="),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,"="),t("mn",null,"1")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("mi",null,"E"),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|")])]),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mtext",null,"Softmax"),t("mi",null,"i")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"1.2em",maxsize:"1.2em"},"(")]),t("mstyle",{mathcolor:"red"},[t("mtext",null,"TopK")]),t("mo",{stretchy:"false"},"("),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"x")]),t("mi",null,"t")])]),t("mo",null,"⋅"),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"W")]),t("mi",null,"g")]),t("mo",{stretchy:"false"},")")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"1.2em",maxsize:"1.2em"},")")]),t("mo",null,"⋅"),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mtext",null,"FFN"),t("mi",null,"i")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"1.2em",maxsize:"1.2em"},"(")]),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"x")]),t("mi",null,"t")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"1.2em",maxsize:"1.2em"},")")])])],-1))])])]),Q[46]||(Q[46]=t("p",null,[t("strong",null,"解决路由坍塌/专家平衡问题：辅助loss")],-1)),t("ul",null,[Q[43]||(Q[43]=t("li",null,[t("p",null,"问题：大部分token都发送给少数机构专家，出现赢者通吃现象")],-1)),t("li",null,[Q[42]||(Q[42]=t("p",null,[a("方法："),t("a",{href:"https://plmsmile.github.io/posts/llm/basic/04-llm-architecture.html#%E6%89%B9%E9%87%8F%E5%87%8F%E5%B0%8F%E5%8F%8A%E4%B8%93%E5%AE%B6%E5%B9%B3%E8%A1%A1%E9%97%AE%E9%A2%98",target:"_blank",rel:"noreferrer"},"辅助loss")],-1)),t("ul",null,[t("li",null,[t("mjx-container",x,[(s(),l("svg",w,Q[29]||(Q[29]=[T("",1)]))),Q[30]||(Q[30]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"f"),t("mi",null,"i")])])],-1))]),Q[31]||(Q[31]=a("：")),Q[32]||(Q[32]=t("code",null,"专家i的实际负载",-1)),Q[33]||(Q[33]=a("，分配的token数量占总token数量的比例"))]),t("li",null,[t("mjx-container",y,[(s(),l("svg",f,Q[34]||(Q[34]=[T("",1)]))),Q[35]||(Q[35]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"m"),t("mi",null,"i")])])],-1))]),Q[36]||(Q[36]=a("：")),Q[37]||(Q[37]=t("code",null,"专家i的平均路由得分",-1)),Q[38]||(Q[38]=a("。"))]),Q[39]||(Q[39]=t("li",null,[a("负载和得分的乘积加权求平均，"),t("code",null,"该值越小，说明越均衡"),a("。比如 "),t("ul",null,[t("li",null,[t("code",null,"极度不均衡"),a("(负载比例1和0，路由概率0.99和0.01)，"),t("code",null,"loss=0.495")]),t("li",null,[t("code",null,"非常均衡"),a("(负载比例0.5和0.5，路由概率0.5和0.5)，"),t("code",null,"loss=0.25")])])],-1))]),t("mjx-container",M,[(s(),l("svg",b,Q[40]||(Q[40]=[T("",1)]))),Q[41]||(Q[41]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",null,"L"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"aux")])])]),t("mo",null,"="),t("msub",null,[t("mi",null,"α"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"aux")])]),t("mo",null,"⋅"),t("mstyle",{mathcolor:"blue"},[t("mfrac",null,[t("mn",null,"1"),t("mi",null,"E")]),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,"="),t("mn",null,"1")]),t("mi",null,"E")])]),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mi",null,"f"),t("mi",null,"i")])]),t("mo",null,"⋅"),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mi",null,"m"),t("mi",null,"i")])])])],-1))])])]),Q[47]||(Q[47]=t("p",null,[t("strong",null,"解决负载不均衡问题：Global Router")],-1)),Q[48]||(Q[48]=t("ul",null,[t("li",null,"由于分布式，数据在不同GPU组上是随机的，导致某些GPU组的某个专家恰好收到远超其容量的token。"),t("li",null,"使用全局路由器，在把token发给够足专家之前，所有GPU组先通过allgather，全局路由掌握全局信息化后，进行调度，避免有些组累死、闲死的情况。")],-1))]),Q[171]||(Q[171]=t("h4",{id:"lightning-attention",tabindex:"-1"},[a("Lightning Attention "),t("a",{class:"header-anchor",href:"#lightning-attention","aria-label":'Permalink to "Lightning Attention"'},"​")],-1)),t("div",Z,[Q[97]||(Q[97]=t("div",{class:"custom-block-title"},"Lighting Attention",-1)),Q[98]||(Q[98]=t("p",null,[t("strong",null,"问题背景")],-1)),t("ul",null,[t("li",null,[t("p",null,[Q[51]||(Q[51]=a("传统SoftmaxAttention 时间复杂度为")),t("mjx-container",v,[(s(),l("svg",D,Q[49]||(Q[49]=[T("",1)]))),Q[50]||(Q[50]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"O"),t("mo",{stretchy:"false"},"("),t("mi",null,"d"),t("msup",null,[t("mi",null,"n"),t("mn",null,"2")]),t("mo",{stretchy:"false"},")")])],-1))]),Q[52]||(Q[52]=a("，太慢"))]),t("mjx-container",A,[(s(),l("svg",_,Q[53]||(Q[53]=[T("",1)]))),Q[54]||(Q[54]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("mi",{mathvariant:"bold-italic"},"O")]),t("mo",null,"="),t("mo",{stretchy:"false"},"["),t("mo",{stretchy:"false"},"("),t("mstyle",{mathcolor:"red"},[t("mi",{mathvariant:"bold-italic"},"Q"),t("msup",null,[t("mi",{mathvariant:"bold-italic"},"K"),t("mi",{mathvariant:"normal"},"⊤")])]),t("mo",{stretchy:"false"},")"),t("mo",null,"⊙"),t("mstyle",{mathcolor:"blue"},[t("mi",{mathvariant:"bold-italic"},"M")]),t("mo",{stretchy:"false"},"]"),t("mstyle",{mathcolor:"blue"},[t("mi",{mathvariant:"bold-italic"},"V")])])],-1))])]),t("li",null,[t("p",null,[Q[57]||(Q[57]=t("a",{href:"http://plmsmile.github.io/posts/llm/basic/02-llm-components.html#%E7%BA%BF%E6%80%A7%E6%B3%A8%E6%84%8F%E5%8A%9B",target:"_blank",rel:"noreferrer"},"Linear Attention",-1)),Q[58]||(Q[58]=a("，时间复杂度为")),t("mjx-container",B,[(s(),l("svg",C,Q[55]||(Q[55]=[T("",1)]))),Q[56]||(Q[56]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"O"),t("mo",{stretchy:"false"},"("),t("mi",null,"n"),t("msup",null,[t("mi",null,"d"),t("mn",null,"2")]),t("mo",{stretchy:"false"},")")])],-1))]),Q[59]||(Q[59]=a("，线性依赖于n"))]),Q[69]||(Q[69]=t("ul",null,[t("li",null,[a("但"),t("code",null,"cusum操作严格顺序执行太慢"),a("，"),t("code",null,"无法真正并行计算"),a("，阻碍GPU大规模并行计算。")])],-1)),t("mjx-container",j,[(s(),l("svg",E,Q[60]||(Q[60]=[T("",1)]))),Q[61]||(Q[61]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("mi",{mathvariant:"bold-italic"},"O")]),t("mo",null,"="),t("mtext",null,"Norm"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"1.2em",maxsize:"1.2em"},"(")]),t("mstyle",{mathcolor:"blue"},[t("mi",{mathvariant:"bold-italic"},"Q")]),t("mo",{stretchy:"false"},"("),t("mstyle",{mathcolor:"red"},[t("msup",null,[t("mi",{mathvariant:"bold-italic"},"K"),t("mi",{mathvariant:"normal"},"⊤")]),t("mi",{mathvariant:"bold-italic"},"V")]),t("mo",{stretchy:"false"},")"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"1.2em",maxsize:"1.2em"},")")])])],-1))]),t("mjx-container",S,[(s(),l("svg",R,Q[62]||(Q[62]=[T("",1)]))),Q[63]||(Q[63]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mi",{mathvariant:"bold-italic"},"o"),t("mi",null,"t")])]),t("mo",null,"="),t("msub",null,[t("mstyle",{mathcolor:"blue"},[t("mi",{mathvariant:"bold-italic"},"S")]),t("mstyle",{mathcolor:"red"},[t("mi",null,"t")])]),t("msub",null,[t("mstyle",{mathcolor:"blue"},[t("mi",{mathvariant:"bold-italic"},"q")]),t("mstyle",{mathcolor:"red"},[t("mi",null,"t")])]),t("mo",null,","),t("mstyle",{scriptlevel:"0"},[t("mspace",{width:"1em"})]),t("mstyle",{scriptlevel:"0"},[t("mspace",{width:"1em"})]),t("msub",null,[t("mstyle",{mathcolor:"blue"},[t("mi",{mathvariant:"bold-italic"},"S")]),t("mstyle",{mathcolor:"red"},[t("mi",null,"t")])]),t("mo",null,"="),t("msub",null,[t("mstyle",{mathcolor:"blue"},[t("mi",{mathvariant:"bold-italic"},"S")]),t("mstyle",{mathcolor:"red"},[t("mi",null,"t"),t("mo",null,"−"),t("mn",null,"1")])]),t("mo",null,"+"),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mi",{mathvariant:"bold-italic"},"v"),t("mi",null,"t")])]),t("mstyle",{mathcolor:"blue"},[t("msubsup",null,[t("mi",{mathvariant:"bold-italic"},"k"),t("mi",null,"t"),t("mi",{mathvariant:"normal"},"⊤")])])])],-1))]),t("mjx-container",F,[(s(),l("svg",O,Q[64]||(Q[64]=[T("",1)]))),Q[65]||(Q[65]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("msub",null,[t("mstyle",{mathcolor:"blue"},[t("mi",{mathvariant:"bold-italic"},"S")]),t("mstyle",{mathcolor:"red"},[t("mi",null,"t")])]),t("mo",null,"="),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"j"),t("mo",null,"="),t("mn",null,"1")]),t("mstyle",{mathcolor:"red"},[t("mi",null,"t")])]),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mi",{mathvariant:"bold-italic"},"v"),t("mi",null,"j")])]),t("mstyle",{mathcolor:"blue"},[t("msubsup",null,[t("mi",{mathvariant:"bold-italic"},"k"),t("mi",null,"j"),t("mi",{mathvariant:"normal"},"⊤")])]),t("mstyle",{scriptlevel:"0"},[t("mspace",{width:"1em"})]),t("mo",null,"∈"),t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"double-struck"},"R")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mstyle",{mathcolor:"red"},[t("mi",null,"d"),t("mo",null,"×"),t("mi",null,"d")])])])])],-1))]),t("ul",null,[t("li",null,[Q[68]||(Q[68]=a("Minimax-01 递归写法")),t("mjx-container",P,[(s(),l("svg",q,Q[66]||(Q[66]=[T("",1)]))),Q[67]||(Q[67]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mi",{mathvariant:"bold-italic"},"k"),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"v"),t("mn",null,"0")]),t("mo",null,"="),t("mn",{mathvariant:"bold"},"0"),t("mo",null,","),t("mstyle",{scriptlevel:"0"},[t("mspace",{width:"1em"})]),t("mi",{mathvariant:"bold-italic"},"k"),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"v"),t("mi",null,"t")]),t("mo",null,"="),t("mi",{mathvariant:"bold-italic"},"k"),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"v"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"−"),t("mn",null,"1")])]),t("mo",null,"+"),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"k"),t("mi",null,"t")]),t("msubsup",null,[t("mi",{mathvariant:"bold-italic"},"v"),t("mi",null,"t"),t("mi",{mathvariant:"normal"},"⊤")]),t("mo",null,","),t("mstyle",{scriptlevel:"0"},[t("mspace",{width:"1em"})]),t("msubsup",null,[t("mi",{mathvariant:"bold-italic"},"o"),t("mi",null,"t"),t("mi",{mathvariant:"normal"},"⊤")]),t("mo",null,"="),t("msubsup",null,[t("mi",null,"q"),t("mi",null,"t"),t("mi",{mathvariant:"normal"},"⊤")]),t("mi",{mathvariant:"bold-italic"},"k"),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"v"),t("mi",null,"t")])])],-1))])])])])]),Q[99]||(Q[99]=t("p",null,[t("strong",null,"Lightning Attention 核心思想")],-1)),t("ul",null,[Q[78]||(Q[78]=t("li",null,[t("p",null,[a("利用"),t("strong",null,"分块技术来计算注意力"),a("，")]),t("ul",null,[t("li",null,[a("把无法并行的大问题，分解成"),t("code",null,"大量可并行的小问题"),a(" +"),t("code",null," 少量不可并行的衔接"),a("。")])])],-1)),t("li",null,[t("p",null,[Q[74]||(Q[74]=a("把序列分成2块：第一块包含m个token ")),t("mjx-container",I,[(s(),l("svg",z,Q[70]||(Q[70]=[T("",1)]))),Q[71]||(Q[71]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",{mathvariant:"bold-italic"},"Q"),t("mn",{mathvariant:"bold"},"1")]),t("mo",{mathvariant:"bold"},","),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"K"),t("mn",{mathvariant:"bold"},"1")]),t("mo",{mathvariant:"bold"},","),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"V"),t("mn",{mathvariant:"bold"},"1")])])])],-1))]),Q[75]||(Q[75]=a("，第二块包含剩下的token ")),t("mjx-container",X,[(s(),l("svg",N,Q[72]||(Q[72]=[T("",1)]))),Q[73]||(Q[73]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",{mathvariant:"bold-italic"},"Q"),t("mn",{mathvariant:"bold"},"2")]),t("mo",{mathvariant:"bold"},","),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"K"),t("mn",{mathvariant:"bold"},"2")]),t("mo",{mathvariant:"bold"},","),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"V"),t("mn",{mathvariant:"bold"},"2")])])])],-1))])]),t("mjx-container",G,[(s(),l("svg",J,Q[76]||(Q[76]=[T("",1)]))),Q[77]||(Q[77]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("mi",{mathvariant:"bold-italic"},"X")]),t("mo",null,"="),t("mrow",{"data-mjx-texclass":"INNER"},[t("mo",{"data-mjx-texclass":"OPEN"},"["),t("mtable",{columnspacing:"1em",rowspacing:"4pt"},[t("mtr",null,[t("mtd",null,[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",{mathvariant:"bold-italic"},"X"),t("mn",null,"1")])])])]),t("mtr",null,[t("mtd",null,[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",{mathvariant:"bold-italic"},"X"),t("mn",null,"2")])])])])]),t("mo",{"data-mjx-texclass":"CLOSE"},"]")]),t("mo",null,","),t("mstyle",{scriptlevel:"0"},[t("mspace",{width:"1em"})]),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",{mathvariant:"bold-italic"},"X"),t("mn",null,"1")])]),t("mo",null,"∈"),t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"double-struck"},"R")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mstyle",{mathcolor:"red"},[t("mi",null,"m"),t("mo",null,"×"),t("mi",null,"d")])])]),t("mo",null,","),t("mstyle",{scriptlevel:"0"},[t("mspace",{width:"1em"})]),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",{mathvariant:"bold-italic"},"X"),t("mn",null,"2")])]),t("mo",null,"∈"),t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"double-struck"},"R")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mstyle",{mathcolor:"red"},[t("mo",{stretchy:"false"},"("),t("mi",null,"n"),t("mo",null,"−"),t("mi",null,"m"),t("mo",{stretchy:"false"},")"),t("mo",null,"×"),t("mi",null,"d")])])]),t("mo",null,",")])],-1))])]),Q[79]||(Q[79]=t("li",null,[t("p",null,[a("每块分为："),t("code",null,"块内计算(传统softmax 并行计算)"),a("、"),t("code",null,"块间计算(线性注意力高效计算)"),a("。")]),t("ul",null,[t("li",null,"大部分并行、小部分串行。")])],-1))]),Q[100]||(Q[100]=t("p",null,[t("strong",null,"第一块计算")],-1)),t("ul",null,[t("li",null,[Q[82]||(Q[82]=t("p",null,"分解成2部分，块间计算 + 块内计算",-1)),t("mjx-container",K,[(s(),l("svg",U,Q[80]||(Q[80]=[T("",1)]))),Q[81]||(Q[81]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",{mathvariant:"bold-italic"},"O"),t("mn",{mathvariant:"bold"},"1")])]),t("mo",null,"="),t("munder",null,[t("mrow",{"data-mjx-texclass":"OP"},[t("munder",null,[t("mrow",null,[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",{mathvariant:"bold-italic"},"Q"),t("mn",{mathvariant:"bold"},"1")])]),t("mstyle",{mathcolor:"red"},[t("mi",{mathvariant:"bold-italic"},"K")]),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",{mathvariant:"bold-italic"},"V"),t("mn",{mathvariant:"bold"},"0")])])]),t("mo",null,"⏟")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mstyle",{mathcolor:"red"},[t("mi",{mathvariant:"normal"},"块"),t("mi",{mathvariant:"normal"},"间")])])]),t("mo",null,"+"),t("munder",null,[t("mrow",{"data-mjx-texclass":"OP"},[t("munder",null,[t("mrow",null,[t("mo",{stretchy:"false"},"["),t("mo",{stretchy:"false"},"("),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",{mathvariant:"bold-italic"},"Q"),t("mn",{mathvariant:"bold"},"1")]),t("msubsup",null,[t("mi",{mathvariant:"bold-italic"},"K"),t("mn",{mathvariant:"bold"},"1"),t("mi",{mathvariant:"normal"},"⊤")])]),t("mo",{stretchy:"false"},")"),t("mo",null,"⊙"),t("mstyle",{mathcolor:"blue"},[t("mi",{mathvariant:"bold-italic"},"M")]),t("mo",{stretchy:"false"},"]"),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",{mathvariant:"bold-italic"},"V"),t("mn",{mathvariant:"bold"},"1")])])]),t("mo",null,"⏟")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mstyle",{mathcolor:"red"},[t("mi",{mathvariant:"normal"},"块"),t("mi",{mathvariant:"normal"},"内")])])])])],-1))])]),Q[89]||(Q[89]=t("li",null,[t("p",null,"块内部分："),t("ul",null,[t("li",null,"块内部的自我注意力。"),t("li",null,"采用softmax注意力、左乘形式，因为m比较小。完全并行计算。")])],-1)),t("li",null,[Q[88]||(Q[88]=t("p",null,"块间部分",-1)),t("ul",null,[Q[86]||(Q[86]=t("li",null,"代表了第一块中每个token对它之前所有历史信息的注意力",-1)),t("li",null,[t("mjx-container",$,[(s(),l("svg",W,Q[83]||(Q[83]=[T("",1)]))),Q[84]||(Q[84]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mstyle",{mathcolor:"red"},[t("mi",null,"K")]),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",null,"V"),t("mn",null,"0")])])])],-1))]),Q[85]||(Q[85]=a("：从第0个块传递来的状态矩阵"))]),Q[87]||(Q[87]=t("li",null,"采用线性注意力、右乘形式，非常高效。",-1))])])]),Q[101]||(Q[101]=t("p",null,[t("strong",null,"状态更新")],-1)),t("ul",null,[t("li",null,[Q[92]||(Q[92]=a("第一块计算完成后，更新状态。把第一块的信息累计到状态矩阵中。")),t("mjx-container",Y,[(s(),l("svg",t1,Q[90]||(Q[90]=[T("",1)]))),Q[91]||(Q[91]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"red"},[t("mi",{mathvariant:"bold-italic"},"K"),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"V"),t("mn",{mathvariant:"bold"},"1")])]),t("mo",{mathvariant:"bold"},"="),t("mstyle",{mathcolor:"blue"},[t("mi",{mathvariant:"bold-italic"},"K"),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"V"),t("mn",{mathvariant:"bold"},"0")])]),t("mo",{mathvariant:"bold"},"+"),t("mstyle",{mathcolor:"blue"},[t("msubsup",null,[t("mi",{mathvariant:"bold-italic"},"K"),t("mn",{mathvariant:"bold"},"1"),t("mi",{mathvariant:"bold"},"⊤")]),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"V"),t("mn",{mathvariant:"bold"},"1")])])])],-1))])])]),Q[102]||(Q[102]=t("p",null,[t("strong",null,"第二块更新")],-1)),t("ul",null,[t("li",null,[Q[95]||(Q[95]=t("p",null,"分解成2部分，块间计算 + 块内计算",-1)),t("mjx-container",Q1,[(s(),l("svg",a1,Q[93]||(Q[93]=[T("",1)]))),Q[94]||(Q[94]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",{mathvariant:"bold-italic"},"O"),t("mn",{mathvariant:"bold"},"2")])]),t("mo",null,"="),t("munder",null,[t("mrow",{"data-mjx-texclass":"OP"},[t("munder",null,[t("mrow",null,[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",{mathvariant:"bold-italic"},"Q"),t("mn",{mathvariant:"bold"},"2")])]),t("mstyle",{mathcolor:"red"},[t("mi",{mathvariant:"bold-italic"},"K")]),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",{mathvariant:"bold-italic"},"V"),t("mn",{mathvariant:"bold"},"1")])])]),t("mo",null,"⏟")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mstyle",{mathcolor:"red"},[t("mi",{mathvariant:"normal"},"块"),t("mi",{mathvariant:"normal"},"间")])])]),t("mo",null,"+"),t("munder",null,[t("mrow",{"data-mjx-texclass":"OP"},[t("munder",null,[t("mrow",null,[t("mo",{stretchy:"false"},"["),t("mo",{stretchy:"false"},"("),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",{mathvariant:"bold-italic"},"Q"),t("mn",{mathvariant:"bold"},"2")]),t("msubsup",null,[t("mi",{mathvariant:"bold-italic"},"K"),t("mn",{mathvariant:"bold"},"2"),t("mi",{mathvariant:"normal"},"⊤")])]),t("mo",{stretchy:"false"},")"),t("mo",null,"⊙"),t("mstyle",{mathcolor:"blue"},[t("mi",{mathvariant:"bold-italic"},"M")]),t("mo",{stretchy:"false"},"]"),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",{mathvariant:"bold-italic"},"V"),t("mn",{mathvariant:"bold"},"2")])])]),t("mo",null,"⏟")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mstyle",{mathcolor:"red"},[t("mi",{mathvariant:"normal"},"块"),t("mi",{mathvariant:"normal"},"内")])])])])],-1))])]),Q[96]||(Q[96]=t("li",null,[t("p",null,"计算同第一块。")],-1))])]),Q[172]||(Q[172]=t("h4",{id:"hybrid-lighting-attention",tabindex:"-1"},[a("Hybrid Lighting Attention "),t("a",{class:"header-anchor",href:"#hybrid-lighting-attention","aria-label":'Permalink to "Hybrid Lighting Attention"'},"​")],-1)),t("div",T1,[Q[121]||(Q[121]=t("div",{class:"custom-block-title"},"Hybrid Lighting Attention",-1)),Q[122]||(Q[122]=t("p",null,[t("strong",null,"Hybrid Lighting Attention")],-1)),Q[123]||(Q[123]=t("ul",null,[t("li",null,"结合lightning和softmax attention，7:1模式，每7个lighting就插入1个softmax")],-1)),Q[124]||(Q[124]=t("p",null,[t("strong",null,"Softmax vs 线性注意力")],-1)),t("ul",null,[t("li",null,[Q[109]||(Q[109]=a("Softmax 注意力： ")),t("ul",null,[Q[107]||(Q[107]=t("li",null,"通读书籍，处理第t个词时，会把之前的所有词都过一遍。",-1)),Q[108]||(Q[108]=t("li",null,"优点：记忆力好，检索能力强；缺点：计算量大。",-1)),t("li",null,[Q[105]||(Q[105]=a("容量：草稿纸大小")),t("mjx-container",l1,[(s(),l("svg",s1,Q[103]||(Q[103]=[T("",1)]))),Q[104]||(Q[104]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"o"),t("mo",{stretchy:"false"},"("),t("mi",null,"d"),t("mo",{stretchy:"false"},")")])],-1))]),Q[106]||(Q[106]=a("，128。"))])])]),t("li",null,[Q[119]||(Q[119]=a("线性注意力： ")),t("ul",null,[Q[118]||(Q[118]=t("li",null,"直觉上：无法有效检索。",-1)),t("li",null,[Q[112]||(Q[112]=a("但通过容量来记录压缩历史信息：循环更新的状态矩阵大小，")),t("mjx-container",e1,[(s(),l("svg",n1,Q[110]||(Q[110]=[T("",1)]))),Q[111]||(Q[111]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",{mathvariant:"bold-italic"},"S"),t("mi",null,"t")])]),t("mo",null,"∈"),t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"double-struck"},"R")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mstyle",{mathcolor:"red"},[t("mi",null,"d"),t("mo",null,"×"),t("mi",null,"d")])])])])],-1))]),Q[113]||(Q[113]=a("，"))]),t("li",null,[Q[116]||(Q[116]=a("草稿纸大小")),t("mjx-container",o1,[(s(),l("svg",m1,Q[114]||(Q[114]=[T("",1)]))),Q[115]||(Q[115]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"o"),t("mo",{stretchy:"false"},"("),t("msup",null,[t("mi",null,"d"),t("mn",null,"2")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"/")]),t("mi",null,"h"),t("mo",{stretchy:"false"},")")])],-1))]),Q[117]||(Q[117]=a("，128*128/64=256"))])])]),Q[120]||(Q[120]=t("li",null,"但在容量上，线性注意力更大",-1))])]),Q[173]||(Q[173]=T("",2)),t("div",d1,[Q[133]||(Q[133]=T("",4)),t("ul",null,[Q[131]||(Q[131]=t("li",null,[t("p",null,[a("像Chinchilla这样行业著名的scaling law"),t("code",null,"不适用 当前架构"),a("，"),t("code",null,"需定制化scaling law"),a(" 公式")])],-1)),t("li",null,[Q[127]||(Q[127]=t("p",null,"模型规格",-1)),t("mjx-container",r1,[(s(),l("svg",i1,Q[125]||(Q[125]=[T("",1)]))),Q[126]||(Q[126]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("munder",null,[t("mo",{"data-mjx-texclass":"OP"},"min"),t("mrow",{"data-mjx-texclass":"ORD"},[t("msub",null,[t("mi",null,"P"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"all")])]),t("mo",null,","),t("msub",null,[t("mi",null,"P"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"act")])])])]),t("mi",null,"L"),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"P"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"all")])]),t("mo",null,","),t("msub",null,[t("mi",null,"P"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"act")])]),t("mo",null,","),t("mi",null,"T"),t("mo",{stretchy:"false"},")"),t("mspace",{linebreak:"newline"}),t("mstyle",{scriptlevel:"0"},[t("mspace",{width:"1em"})]),t("mtext",null,"subject to"),t("mstyle",{scriptlevel:"0"},[t("mspace",{width:"1em"})]),t("msub",null,[t("mi",null,"C"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"compute")])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"P"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"all")])]),t("mo",null,","),t("msub",null,[t("mi",null,"P"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"act")])]),t("mo",null,","),t("mi",null,"T"),t("mo",{stretchy:"false"},")"),t("mo",null,"<"),t("mi",null,"C"),t("mstyle",{scriptlevel:"0"},[t("mspace",{width:"1em"})]),t("mtext",null,"and"),t("mstyle",{scriptlevel:"0"},[t("mspace",{width:"1em"})]),t("msub",null,[t("mi",null,"P"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"all")])]),t("mo",null,"<"),t("mn",null,"500"),t("mi",null,"B")])],-1))])]),t("li",null,[Q[130]||(Q[130]=t("p",null,[a("Loss，给定激活参数、Token数量、专家数量E条件下，由"),t("code",null,"激活参数数量"),a("和"),t("code",null,"训练token数T"),a("决定，其余是需拟合的参数")],-1)),t("mjx-container",h1,[(s(),l("svg",p1,Q[128]||(Q[128]=[T("",1)]))),Q[129]||(Q[129]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mi",null,"L"),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"P"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"act")])]),t("mo",null,","),t("mi",null,"T"),t("mo",null,"∣"),t("mi",null,"E"),t("mo",{stretchy:"false"},")"),t("mo",null,"="),t("mi",null,"d"),t("mo",null,"+"),t("mi",null,"α"),t("msubsup",null,[t("mi",null,"P"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"act")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"α")])]),t("mo",null,"+"),t("mi",null,"b"),t("msup",null,[t("mi",null,"T"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"β")])]),t("mo",null,"+"),t("mi",null,"c"),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"P"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"act")])]),t("mi",null,"T"),t("msup",null,[t("mo",{stretchy:"false"},")"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"γ")])])])],-1))])]),Q[132]||(Q[132]=t("li",null,[t("p",null,"最终确定：456B总参数、46B激活参数")],-1))])]),Q[174]||(Q[174]=T("",5)),t("div",g1,[Q[142]||(Q[142]=t("div",{class:"custom-block-title"},"数据实验",-1)),Q[143]||(Q[143]=t("p",null,[t("strong",null,"实验目的")],-1)),Q[144]||(Q[144]=t("ul",null,[t("li",null,"使用特征不同但数量大小相同的数据，训练多个不同的小型MoE模型，来评估单个数据的影响。"),t("li",null,"不是靠人盲猜哪些数据有用。")],-1)),Q[145]||(Q[145]=t("p",null,[t("strong",null,"衡量指标")],-1)),t("ul",null,[t("li",null,[Q[136]||(Q[136]=t("p",null,[t("code",null,"多选Benchmark"),a("，但"),t("code",null,"去掉选项索引"),a("，评估模型"),t("code",null,"生成正确答案"),a("的"),t("code",null,"对数归一化准确率")],-1)),t("mjx-container",H1,[(s(),l("svg",u1,Q[134]||(Q[134]=[T("",1)]))),Q[135]||(Q[135]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mi",null,"log"),t("mo",{"data-mjx-texclass":"NONE"},"⁡"),t("msub",null,[t("mtext",null,"acc"),t("mrow",{"data-mjx-texclass":"ORD"},[t("msup",null,[t("mtext",null,"norm"),t("mn",null,"2")])])]),t("mo",{stretchy:"false"},"("),t("mi",null,"x"),t("mo",{stretchy:"false"},")"),t("mo",null,"="),t("mi",null,"log"),t("mo",{"data-mjx-texclass":"NONE"},"⁡"),t("msub",null,[t("mtext",null,"softmax"),t("mrow",{"data-mjx-texclass":"ORD"},[t("msup",null,[t("mi",null,"p"),t("mi",{"data-mjx-alternate":"1"},"′")]),t("mo",{stretchy:"false"},"("),t("mi",null,"c"),t("mo",null,"∈"),t("msub",null,[t("mi",null,"C"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"x")])]),t("mo",{stretchy:"false"},")")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"1.2em",maxsize:"1.2em"},"{")]),t("mo",{stretchy:"false"},"("),t("msup",null,[t("mi",null,"p"),t("mi",{"data-mjx-alternate":"1"},"′")]),t("mo",{stretchy:"false"},"("),t("msup",null,[t("mi",null,"c"),t("mo",null,"∗")]),t("mo",{stretchy:"false"},")"),t("mo",{stretchy:"false"},")"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"1.2em",maxsize:"1.2em"},"}")])])],-1))])]),t("li",null,[t("p",null,[t("mjx-container",c1,[(s(),l("svg",k1,Q[137]||(Q[137]=[T("",1)]))),Q[138]||(Q[138]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msubsup",null,[t("mi",null,"p"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{"data-mjx-alternate":"1"},"′")])]),t("mo",{stretchy:"false"},"("),t("mi",null,"c"),t("mo",{stretchy:"false"},")")])],-1))]),Q[139]||(Q[139]=a("：样本i、选项c的字节归一化概率"))]),t("mjx-container",L1,[(s(),l("svg",V1,Q[140]||(Q[140]=[T("",1)]))),Q[141]||(Q[141]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("msubsup",null,[t("mi",null,"p"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{"data-mjx-alternate":"1"},"′")])]),t("mo",{stretchy:"false"},"("),t("mi",null,"c"),t("mo",{stretchy:"false"},")"),t("mo",null,"="),t("msub",null,[t("mi",null,"p"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i")])]),t("mo",{stretchy:"false"},"("),t("mi",null,"c"),t("mo",{stretchy:"false"},")"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"/")]),t("mtext",null,"bytes"),t("mo",{stretchy:"false"},"("),t("mi",null,"c"),t("mo",{stretchy:"false"},")")])],-1))])])]),Q[146]||(Q[146]=T("",4))]),Q[175]||(Q[175]=t("h4",{id:"训练策略",tabindex:"-1"},[a("训练策略 "),t("a",{class:"header-anchor",href:"#训练策略","aria-label":'Permalink to "训练策略"'},"​")],-1)),t("div",x1,[Q[166]||(Q[166]=t("div",{class:"custom-block-title"},"提示",-1)),Q[167]||(Q[167]=t("p",null,[t("strong",null,"参数")],-1)),t("ul",null,[Q[163]||(Q[163]=t("li",null,[t("a",{href:"https://plmsmile.github.io/posts/olds/dl/35-nerual-network-optim.html#xavier%E5%9D%87%E5%8C%80%E5%88%86%E5%B8%83%E5%88%9D%E5%A7%8B%E5%8C%96",target:"_blank",rel:"noreferrer"},"Xavier 均匀分布初始化策略")],-1)),t("li",null,[Q[149]||(Q[149]=t("a",{href:"https://plmsmile.github.io/posts/olds/dl/35-nerual-network-optim.html#adam",target:"_blank",rel:"noreferrer"},"Adam 优化器",-1)),Q[150]||(Q[150]=a("，")),t("mjx-container",w1,[(s(),l("svg",y1,Q[147]||(Q[147]=[T("",1)]))),Q[148]||(Q[148]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"β"),t("mn",null,"1")]),t("mo",null,"="),t("mn",null,"0.9"),t("mo",null,","),t("msub",null,[t("mi",null,"β"),t("mn",null,"2")]),t("mo",null,"="),t("mn",null,"0.95"),t("mo",null,","),t("mtext",null,"weight decay"),t("mo",null,"="),t("mn",null,"0.1")])],-1))])]),Q[164]||(Q[164]=T("",1)),t("li",null,[Q[162]||(Q[162]=t("strong",null,"学习率",-1)),t("ul",null,[t("li",null,[Q[153]||(Q[153]=a("warm up：500次迭代，达峰值")),t("mjx-container",f1,[(s(),l("svg",M1,Q[151]||(Q[151]=[T("",1)]))),Q[152]||(Q[152]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mn",null,"2"),t("mo",null,"×"),t("msup",null,[t("mn",null,"10"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"−"),t("mn",null,"4")])])])],-1))]),Q[154]||(Q[154]=a("，保持稳定直到7.2T tokens。"))]),Q[161]||(Q[161]=t("li",null,"发现gradient norm过高异常，可能是学习率过大。",-1)),t("li",null,[Q[157]||(Q[157]=a("剩余3.2T tokens：学习率调整为 ")),t("mjx-container",b1,[(s(),l("svg",Z1,Q[155]||(Q[155]=[T("",1)]))),Q[156]||(Q[156]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mn",null,"1.3"),t("mo",null,"×"),t("msup",null,[t("mn",null,"10"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"−"),t("mn",null,"4")])])])],-1))])]),t("li",null,[Q[160]||(Q[160]=a("快速衰减阶段 1T Tokens：学习率指数及衰减至 ")),t("mjx-container",v1,[(s(),l("svg",D1,Q[158]||(Q[158]=[T("",1)]))),Q[159]||(Q[159]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mn",null,"3"),t("mo",null,"×"),t("msup",null,[t("mn",null,"10"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"−"),t("mn",null,"5")])])])],-1))])])])]),Q[165]||(Q[165]=t("li",null,"MoE 辅助loss系数：0.01",-1))]),Q[168]||(Q[168]=T("",4))]),Q[176]||(Q[176]=T("",13))])}const F1=e(n,[["render",A1]]);export{R1 as __pageData,F1 as default};

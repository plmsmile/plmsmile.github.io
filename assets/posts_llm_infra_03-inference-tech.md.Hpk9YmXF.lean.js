import{_ as s,c as l,o as e,ah as a,j as Q,a as T}from"./chunks/framework.CvbyeFFO.js";const X=JSON.parse('{"title":"推理优化技术","description":"","frontmatter":{"title":"推理优化技术","date":"2025-07-25T14:47:28.000Z","create":"2025-07-25T14:47:28.000Z","categories":["llm-inference"],"tags":["prefix caching","kv cache","attention优化","MLA","flash attention","PagedAttention","Copy-On-Write","动态批处理"]},"headers":[],"relativePath":"posts/llm/infra/03-inference-tech.md","filePath":"posts/llm/infra/03-inference-tech.md","lastUpdated":1763995754000}'),o={name:"posts/llm/infra/03-inference-tech.md"},n={class:"custom-block info"},i={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},r={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.379ex",height:"2.452ex",role:"img",focusable:"false",viewBox:"0 -833.9 2819.6 1083.9","aria-hidden":"true"},d={class:"custom-block important"},m={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},h={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.65ex"},xmlns:"http://www.w3.org/2000/svg",width:"8.587ex",height:"2.27ex",role:"img",focusable:"false",viewBox:"0 -716 3795.5 1003.2","aria-hidden":"true"},p={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},g={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.709ex",height:"1.977ex",role:"img",focusable:"false",viewBox:"0 -716 2523.4 873.8","aria-hidden":"true"},u={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},c={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.811ex",height:"2.032ex",role:"img",focusable:"false",viewBox:"0 -704 1242.4 898","aria-hidden":"true"},x={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},w={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.725ex",height:"1.984ex",role:"img",focusable:"false",viewBox:"0 -683 2530.6 877","aria-hidden":"true"},L={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},k={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.79ex",height:"2.032ex",role:"img",focusable:"false",viewBox:"0 -704 791 898","aria-hidden":"true"},f={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},b={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.452ex"},xmlns:"http://www.w3.org/2000/svg",width:"14.672ex",height:"2.149ex",role:"img",focusable:"false",viewBox:"0 -750 6484.9 950","aria-hidden":"true"},H={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},M={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.709ex",height:"1.977ex",role:"img",focusable:"false",viewBox:"0 -716 2523.4 873.8","aria-hidden":"true"},y={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},v={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.811ex",height:"2.032ex",role:"img",focusable:"false",viewBox:"0 -704 1242.4 898","aria-hidden":"true"},Z={class:"custom-block note"},_={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},D={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.667ex"},xmlns:"http://www.w3.org/2000/svg",width:"27.32ex",height:"2.237ex",role:"img",focusable:"false",viewBox:"0 -694 12075.3 989","aria-hidden":"true"},A={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},V={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.89ex",height:"1.357ex",role:"img",focusable:"false",viewBox:"0 -442 2161.6 599.8","aria-hidden":"true"},E={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},C={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.667ex"},xmlns:"http://www.w3.org/2000/svg",width:"23.56ex",height:"2.237ex",role:"img",focusable:"false",viewBox:"0 -694 10413.7 989","aria-hidden":"true"},j={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},P={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.778ex",height:"1.645ex",role:"img",focusable:"false",viewBox:"0 -705 786 727","aria-hidden":"true"},S={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},B={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.667ex"},xmlns:"http://www.w3.org/2000/svg",width:"24.207ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -705 10699.7 1000","aria-hidden":"true"},R={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},O={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.667ex"},xmlns:"http://www.w3.org/2000/svg",width:"33.38ex",height:"2.237ex",role:"img",focusable:"false",viewBox:"0 -694 14754.2 989","aria-hidden":"true"};function q(I,t,K,z,G,N){return e(),l("div",null,[t[73]||(t[73]=a("",8)),Q("div",n,[t[9]||(t[9]=Q("div",{class:"custom-block-title"},"注意力结构优化",-1)),t[10]||(t[10]=Q("p",null,[Q("strong",null,"Multi-Query Attention"),T(", "),Q("a",{href:"http://plmsmile.github.io/posts/llm/basic/06-llm-attention.html#multi-query-attention-2019",target:"_blank",rel:"noreferrer"},"MQA")],-1)),Q("ul",null,[Q("li",null,[t[2]||(t[2]=Q("code",null,"所有Query共享一对K和V",-1)),t[3]||(t[3]=T("，")),t[4]||(t[4]=Q("code",null,"减少KV参数",-1)),t[5]||(t[5]=T("，提升")),t[6]||(t[6]=Q("code",null,"推理速度",-1)),t[7]||(t[7]=T("，优化")),Q("mjx-container",i,[(e(),l("svg",r,t[0]||(t[0]=[a("",1)]))),t[1]||(t[1]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"o"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"d"),Q("msup",null,[Q("mi",null,"n"),Q("mn",null,"2")]),Q("mo",{stretchy:"false"},")")])],-1))]),t[8]||(t[8]=T("问题。"))])]),t[11]||(t[11]=a("",4))]),t[74]||(t[74]=a("",5)),Q("div",d,[t[42]||(t[42]=Q("div",{class:"custom-block-title"},"KV Cache",-1)),t[43]||(t[43]=Q("p",null,[Q("strong",null,"背景")],-1)),Q("ul",null,[Q("li",null,[t[29]||(t[29]=T("每一步的Attention计算存在大量冗余，通过推导公式可知，第k步的完整")),Q("mjx-container",m,[(e(),l("svg",h,t[12]||(t[12]=[a("",1)]))),t[13]||(t[13]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"A"),Q("mi",null,"t"),Q("mi",null,"t"),Q("msub",null,[Q("mi",null,"n"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"s"),Q("mi",null,"t"),Q("mi",null,"e"),Q("mi",null,"p"),Q("mi",null,"k")])])])],-1))]),t[30]||(t[30]=T("矩阵： ")),Q("ul",null,[t[27]||(t[27]=Q("li",null,[T("前k-1行：已由前面的"),Q("code",null,"[1, k-1]步骤计算过")],-1)),Q("li",null,[t[26]||(t[26]=T("第k行：")),Q("strong",null,[Q("mjx-container",p,[(e(),l("svg",g,t[14]||(t[14]=[a("",1)]))),t[15]||(t[15]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"A"),Q("mi",null,"t"),Q("mi",null,"t"),Q("msub",null,[Q("mi",null,"n"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"k")])])])],-1))]),t[22]||(t[22]=T("只和")),Q("mjx-container",u,[(e(),l("svg",c,t[16]||(t[16]=[a("",1)]))),t[17]||(t[17]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"Q"),Q("mi",null,"k")])])],-1))]),t[23]||(t[23]=T("、前面的每一对")),Q("mjx-container",x,[(e(),l("svg",w,t[18]||(t[18]=[a("",1)]))),t[19]||(t[19]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"K"),Q("mi",null,"i")]),Q("mo",null,","),Q("msub",null,[Q("mi",null,"V"),Q("mi",null,"i")])])],-1))]),t[24]||(t[24]=T("有关，与其余")),Q("mjx-container",L,[(e(),l("svg",k,t[20]||(t[20]=[Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D444",d:"M399 -80Q399 -47 400 -30T402 -11V-7L387 -11Q341 -22 303 -22Q208 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435Q740 255 592 107Q529 47 461 16L444 8V3Q444 2 449 -24T470 -66T516 -82Q551 -82 583 -60T625 -3Q631 11 638 11Q647 11 649 2Q649 -6 639 -34T611 -100T557 -165T481 -194Q399 -194 399 -87V-80ZM636 468Q636 523 621 564T580 625T530 655T477 665Q429 665 379 640Q277 591 215 464T153 216Q153 110 207 59Q231 38 236 38V46Q236 86 269 120T347 155Q372 155 390 144T417 114T429 82T435 55L448 64Q512 108 557 185T619 334T636 468ZM314 18Q362 18 404 39L403 49Q399 104 366 115Q354 117 347 117Q344 117 341 117T337 118Q317 118 296 98T274 52Q274 18 314 18Z",style:{"stroke-width":"3"}})])])],-1)]))),t[21]||(t[21]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"Q")])],-1))]),t[25]||(t[25]=T("均无关"))])]),t[28]||(t[28]=Q("li",null,[Q("strong",null,"每一行，只和对应步骤的Q有关")],-1))])])]),t[44]||(t[44]=Q("p",null,[Q("strong",null,"方法")],-1)),Q("ul",null,[Q("li",null,[t[34]||(t[34]=T("解码新token时，")),Q("strong",null,[t[33]||(t[33]=T("缓存前面每一步的")),Q("mjx-container",f,[(e(),l("svg",b,t[31]||(t[31]=[a("",1)]))),t[32]||(t[32]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"K"),Q("mi",null,"i")]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mo",null,"、")]),Q("msub",null,[Q("mi",null,"V"),Q("mi",null,"i")]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mo",null,"、")]),Q("mi",null,"A"),Q("mi",null,"t"),Q("mi",null,"t"),Q("msub",null,[Q("mi",null,"n"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i")])])])],-1))])]),t[35]||(t[35]=T(" 结果"))]),Q("li",null,[t[39]||(t[39]=T("只需")),Q("strong",null,[t[38]||(t[38]=T("用当前Q和前面每一步的K、V来计算")),Q("mjx-container",H,[(e(),l("svg",M,t[36]||(t[36]=[a("",1)]))),t[37]||(t[37]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"A"),Q("mi",null,"t"),Q("mi",null,"t"),Q("msub",null,[Q("mi",null,"n"),Q("mi",null,"k")])])],-1))])]),t[40]||(t[40]=T(" 即可，属于")),t[41]||(t[41]=Q("code",null,"增量QKV计算",-1))])]),t[45]||(t[45]=a("",4))]),Q("p",null,[t[48]||(t[48]=T("对比示意图，一目了然，每次只用当前Q和前的KV做计算即可，因为前面的行和")),Q("mjx-container",y,[(e(),l("svg",v,t[46]||(t[46]=[a("",1)]))),t[47]||(t[47]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"Q"),Q("mi",null,"k")])])],-1))]),t[49]||(t[49]=T("无关，对应行只和对应步骤的Q有关。"))]),t[75]||(t[75]=Q("img",{src:"https://pic2.zhimg.com/v2-655b95ebfb7808563bead28bc89bb459_r.jpg",style:{display:"block",margin:"auto"},width:"80%"},null,-1)),t[76]||(t[76]=Q("img",{src:"https://picx.zhimg.com/v2-1744613b5484191ee005d923d69f801b_1440w.jpg",style:{display:"block",margin:"auto"},width:"80%"},null,-1)),t[77]||(t[77]=Q("h3",{id:"kv-cache-显存分析",tabindex:"-1"},[T("KV Cache 显存分析 "),Q("a",{class:"header-anchor",href:"#kv-cache-显存分析","aria-label":'Permalink to "KV Cache 显存分析"'},"​")],-1)),Q("div",Z,[t[71]||(t[71]=a("",5)),Q("mjx-container",_,[(e(),l("svg",D,t[50]||(t[50]=[a("",1)]))),t[51]||(t[51]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mn",null,"2"),Q("mo",null,"∗"),Q("msub",null,[Q("mi",null,"n"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"l"),Q("mi",null,"a"),Q("mi",null,"y"),Q("mi",null,"e"),Q("mi",null,"r"),Q("mi",null,"s")])]),Q("mo",null,"∗"),Q("msub",null,[Q("mi",null,"n"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"h"),Q("mi",null,"e"),Q("mi",null,"a"),Q("mi",null,"d")])]),Q("mo",null,"∗"),Q("msub",null,[Q("mi",null,"d"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"h"),Q("mi",null,"e"),Q("mi",null,"a"),Q("mi",null,"d")])]),Q("mo",null,"∗"),Q("msub",null,[Q("mi",null,"p"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"a")])])])],-1))]),Q("ul",null,[Q("li",null,[t[55]||(t[55]=Q("strong",null,"MQA",-1)),t[56]||(t[56]=T("：所有query共用1个head，")),Q("strong",null,[t[54]||(t[54]=T("减少了注意力头数")),Q("mjx-container",A,[(e(),l("svg",V,t[52]||(t[52]=[a("",1)]))),t[53]||(t[53]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"n"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"h"),Q("mi",null,"e"),Q("mi",null,"a"),Q("mi",null,"d")])])])],-1))])]),t[57]||(t[57]=Q("ul",null,[Q("li",null,"效果不行，无法做到有效多卡并行")],-1))])]),Q("mjx-container",E,[(e(),l("svg",C,t[58]||(t[58]=[a("",1)]))),t[59]||(t[59]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mn",null,"2"),Q("mo",null,"∗"),Q("msub",null,[Q("mi",null,"n"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"l"),Q("mi",null,"a"),Q("mi",null,"y"),Q("mi",null,"e"),Q("mi",null,"r"),Q("mi",null,"s")])]),Q("mo",null,"∗"),Q("mn",null,"1"),Q("mo",null,"∗"),Q("msub",null,[Q("mi",null,"d"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"h"),Q("mi",null,"e"),Q("mi",null,"a"),Q("mi",null,"d")])]),Q("mo",null,"∗"),Q("msub",null,[Q("mi",null,"p"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"a")])])])],-1))]),Q("ul",null,[Q("li",null,[t[64]||(t[64]=Q("strong",null,"GQA",-1)),t[65]||(t[65]=T("：")),Q("strong",null,[t[62]||(t[62]=T("query分为")),Q("mjx-container",j,[(e(),l("svg",P,t[60]||(t[60]=[Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D43A",d:"M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q492 659 471 656T418 643T357 615T294 567T236 496T189 394T158 260Q156 242 156 221Q156 173 170 136T206 79T256 45T308 28T353 24Q407 24 452 47T514 106Q517 114 529 161T541 214Q541 222 528 224T468 227H431Q425 233 425 235T427 254Q431 267 437 273H454Q494 271 594 271Q634 271 659 271T695 272T707 272Q721 272 721 263Q721 261 719 249Q714 230 709 228Q706 227 694 227Q674 227 653 224Q646 221 643 215T629 164Q620 131 614 108Q589 6 586 3Q584 1 581 1Q571 1 553 21T530 52Q530 53 528 52T522 47Q448 -22 322 -22Q201 -22 126 55T50 252Z",style:{"stroke-width":"3"}})])])],-1)]))),t[61]||(t[61]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"G")])],-1))]),t[63]||(t[63]=T("组"))]),t[66]||(t[66]=T("，每组共用1个head"))])]),Q("mjx-container",S,[(e(),l("svg",B,t[67]||(t[67]=[a("",1)]))),t[68]||(t[68]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mn",null,"2"),Q("mo",null,"∗"),Q("msub",null,[Q("mi",null,"n"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"l"),Q("mi",null,"a"),Q("mi",null,"y"),Q("mi",null,"e"),Q("mi",null,"r"),Q("mi",null,"s")])]),Q("mo",null,"∗"),Q("mi",null,"G"),Q("mo",null,"∗"),Q("msub",null,[Q("mi",null,"d"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"h"),Q("mi",null,"e"),Q("mi",null,"a"),Q("mi",null,"d")])]),Q("mo",null,"∗"),Q("msub",null,[Q("mi",null,"p"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"a")])])])],-1))]),t[72]||(t[72]=Q("p",null,[Q("strong",null,"KV Cache大小 (整个batch) MHA")],-1)),Q("mjx-container",R,[(e(),l("svg",O,t[69]||(t[69]=[a("",1)]))),t[70]||(t[70]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mi",null,"b"),Q("mo",null,"∗"),Q("mi",null,"t"),Q("mo",null,"∗"),Q("mn",null,"2"),Q("mo",null,"∗"),Q("msub",null,[Q("mi",null,"n"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"l"),Q("mi",null,"a"),Q("mi",null,"y"),Q("mi",null,"e"),Q("mi",null,"r"),Q("mi",null,"s")])]),Q("mo",null,"∗"),Q("msub",null,[Q("mi",null,"n"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"h"),Q("mi",null,"e"),Q("mi",null,"a"),Q("mi",null,"d")])]),Q("mo",null,"∗"),Q("msub",null,[Q("mi",null,"d"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"h"),Q("mi",null,"e"),Q("mi",null,"a"),Q("mi",null,"d")])]),Q("mo",null,"∗"),Q("msub",null,[Q("mi",null,"p"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"a")])])])],-1))])]),t[78]||(t[78]=a("",29))])}const J=s(o,[["render",q]]);export{X as __pageData,J as default};

import{_ as s,c as l,o as e,j as t,ah as Q,a}from"./chunks/framework.CvbyeFFO.js";const V1=JSON.parse('{"title":"确定性策略梯度","description":"","frontmatter":{"title":"确定性策略梯度","date":"2025-09-01T10:16:11.000Z","create":"2025-09-01T10:16:11.000Z","categories":["rl-theory"],"tags":["连续动作","确定性策略","随机性策略","DPG","DDPG","TD3","Actor-Critic","Q_估计","Q_target","目标网络","经验回放","OU噪声","TD3","双Q网络","Actor 延迟更新","Critic 噪声正则化"]},"headers":[],"relativePath":"posts/llm/rl/theory/08-deterministic-policy-gradient.md","filePath":"posts/llm/rl/theory/08-deterministic-policy-gradient.md","lastUpdated":null}'),o={name:"posts/llm/rl/theory/08-deterministic-policy-gradient.md"},m={class:"custom-block tip"},n={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},d={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"9.662ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 4270.7 1000","aria-hidden":"true"},r={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},i={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.889ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2602.9 1000","aria-hidden":"true"},h={class:"custom-block warning"},g={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},p={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"8.399ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 3712.6 1000","aria-hidden":"true"},u={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},x={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.814ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 3011.7 1000","aria-hidden":"true"},w={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},c={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"8.147ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 3601 1000","aria-hidden":"true"},H={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},f={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.024ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2220.7 1000","aria-hidden":"true"},y={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},L={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.124ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2264.6 1000","aria-hidden":"true"},M={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},k={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.489ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.302ex",height:"1.489ex",role:"img",focusable:"false",viewBox:"0 -442 1017.6 658","aria-hidden":"true"},V={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Z={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"10.876ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 4807.3 1000","aria-hidden":"true"},b={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},D={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.489ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.302ex",height:"1.489ex",role:"img",focusable:"false",viewBox:"0 -442 1017.6 658","aria-hidden":"true"},v={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},j={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"13.563ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 5994.9 1000","aria-hidden":"true"},A={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},C={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.023ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.061ex",height:"1.618ex",role:"img",focusable:"false",viewBox:"0 -705 469 715","aria-hidden":"true"},_={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},R={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-4.092ex"},xmlns:"http://www.w3.org/2000/svg",width:"31.683ex",height:"6.014ex",role:"img",focusable:"false",viewBox:"0 -849.5 14004 2658.3","aria-hidden":"true"},O={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},E={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-4.326ex"},xmlns:"http://www.w3.org/2000/svg",width:"45.799ex",height:"7.606ex",role:"img",focusable:"false",viewBox:"0 -1449.5 20243.3 3361.8","aria-hidden":"true"},S={class:"custom-block warning"},P={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},B={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"14.381ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 6356.3 1000","aria-hidden":"true"},X={class:"custom-block tip"},I={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},z={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.123ex",height:"2.032ex",role:"img",focusable:"false",viewBox:"0 -704 1380.3 898","aria-hidden":"true"},G={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},N={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.489ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.302ex",height:"1.489ex",role:"img",focusable:"false",viewBox:"0 -442 1017.6 658","aria-hidden":"true"},J={class:"custom-block tip"},q={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},F={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-4.326ex"},xmlns:"http://www.w3.org/2000/svg",width:"45.799ex",height:"7.606ex",role:"img",focusable:"false",viewBox:"0 -1449.5 20243.3 3361.8","aria-hidden":"true"},U={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},$={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.02ex",height:"1.025ex",role:"img",focusable:"false",viewBox:"0 -442 451 453","aria-hidden":"true"},W={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},K={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"10.251ex",height:"2.283ex",role:"img",focusable:"false",viewBox:"0 -759 4531.1 1009","aria-hidden":"true"},Y={class:"custom-block tip"},t1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},T1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.985ex",height:"2.156ex",role:"img",focusable:"false",viewBox:"0 -759 3529.5 953","aria-hidden":"true"},a1={class:"custom-block tip"},Q1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},l1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.023ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.061ex",height:"1.618ex",role:"img",focusable:"false",viewBox:"0 -705 469 715","aria-hidden":"true"},e1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},s1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.489ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.662ex",height:"1.489ex",role:"img",focusable:"false",viewBox:"0 -442 1618.7 658","aria-hidden":"true"},o1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},m1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.078ex",height:"1.927ex",role:"img",focusable:"false",viewBox:"0 -694 1802.3 851.8","aria-hidden":"true"},n1={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},d1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"25.636ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 11331.2 1000","aria-hidden":"true"},r1={class:"custom-block note"},i1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},h1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.579ex"},xmlns:"http://www.w3.org/2000/svg",width:"10.006ex",height:"2.276ex",role:"img",focusable:"false",viewBox:"0 -750 4422.8 1006.1","aria-hidden":"true"},g1={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},p1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-1.98ex"},xmlns:"http://www.w3.org/2000/svg",width:"35.527ex",height:"3.677ex",role:"img",focusable:"false",viewBox:"0 -750 15703 1625.1","aria-hidden":"true"},u1={class:"custom-block note"},x1={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},w1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"55.474ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 24519.4 1000","aria-hidden":"true"};function c1(H1,T,f1,y1,L1,M1){return e(),l("div",null,[T[161]||(T[161]=t("h2",{id:"背景",tabindex:"-1"},[a("背景 "),t("a",{class:"header-anchor",href:"#背景","aria-label":'Permalink to "背景"'},"​")],-1)),T[162]||(T[162]=t("h3",{id:"离散和连续动作",tabindex:"-1"},[a("离散和连续动作 "),t("a",{class:"header-anchor",href:"#离散和连续动作","aria-label":'Permalink to "离散和连续动作"'},"​")],-1)),t("div",m,[T[10]||(T[10]=t("div",{class:"custom-block-title"},"离散连续动作处理方法",-1)),T[11]||(T[11]=t("p",null,[t("strong",null,"随机 vs 确定")],-1)),t("ul",null,[t("li",null,[T[2]||(T[2]=t("code",null,"随机性策略",-1)),T[3]||(T[3]=a("：")),t("mjx-container",n,[(e(),l("svg",d,T[0]||(T[0]=[Q("",1)]))),T[1]||(T[1]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"a"),t("mi",null,"t")]),t("mo",null,"∣"),t("msub",null,[t("mi",null,"s"),t("mi",null,"t")]),t("mo",{stretchy:"false"},")")])],-1))]),T[4]||(T[4]=a("，输出概率分布，依概率采样动作，输出有随机性"))]),t("li",null,[T[7]||(T[7]=t("code",null,"确定性策略",-1)),T[8]||(T[8]=a("：")),t("mjx-container",r,[(e(),l("svg",i,T[5]||(T[5]=[Q("",1)]))),T[6]||(T[6]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"μ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"s"),t("mi",null,"t")]),t("mo",{stretchy:"false"},")")])],-1))]),T[9]||(T[9]=a("，输出具体动作，不受概率影响，输入相同，输出也相同"))])]),T[12]||(T[12]=t("p",null,[t("strong",null,"离散 vs 连续")],-1)),T[13]||(T[13]=t("ul",null,[t("li",null,[t("code",null,"离散动作"),a("：输出加softmax，使概率和为1，依概率选择即可")]),t("li",null,[t("code",null,"连续动作"),a("：输出值做缩放到目标区间即可，比如tanh -> [-1, 1], 扩展至小车速度[-2,2]，乘以2即可")])],-1))]),T[163]||(T[163]=Q("",9)),t("div",h,[T[72]||(T[72]=t("div",{class:"custom-block-title"},"Deterministic Policy Gradient",-1)),T[73]||(T[73]=t("p",null,[t("strong",null,"问题&背景")],-1)),t("ul",null,[T[25]||(T[25]=t("li",null,[t("strong",null,"DQN 不支持连续动作"),a("：动作通过Q函数做"),t("code",null,"贪心"),a("或"),t("code",null,"argmax"),a("间接得到")],-1)),T[26]||(T[26]=t("li",null,[t("strong",null,"动作空间是连续的"),a("，"),t("strong",null,"无法通过遍历"),a("得到最好动作。")],-1)),t("li",null,[T[21]||(T[21]=t("code",null,"目标",-1)),T[22]||(T[22]=a("：")),t("strong",null,[T[18]||(T[18]=a("用策略")),t("mjx-container",g,[(e(),l("svg",p,T[14]||(T[14]=[Q("",1)]))),T[15]||(T[15]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"a"),t("mo",null,"="),t("mi",null,"μ"),t("mo",{stretchy:"false"},"("),t("mi",null,"s"),t("mo",{stretchy:"false"},")")])],-1))]),T[19]||(T[19]=a("找到使")),t("mjx-container",u,[(e(),l("svg",x,T[16]||(T[16]=[Q("",1)]))),T[17]||(T[17]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"Q"),t("mo",{stretchy:"false"},"("),t("mi",null,"s"),t("mo",null,","),t("mi",null,"a"),t("mo",{stretchy:"false"},")")])],-1))]),T[20]||(T[20]=a("值最大的动作a"))]),T[23]||(T[23]=a("，输出")),T[24]||(T[24]=t("code",null,"确定性动作",-1))])]),T[74]||(T[74]=t("p",null,[t("strong",null,"核心思想")],-1)),t("ul",null,[t("li",null,[T[41]||(T[41]=t("a",{href:"http://plmsmile.github.io/posts/llm/rl/theory/07-actor-critic.html#actor-critic-%E6%9E%B6%E6%9E%84",target:"_blank",rel:"noreferrer"},"Critic-Actor 架构",-1)),t("ul",null,[t("li",null,[T[31]||(T[31]=t("strong",null,"Critic",-1)),T[32]||(T[32]=a("：")),t("strong",null,[t("mjx-container",w,[(e(),l("svg",c,T[27]||(T[27]=[Q("",1)]))),T[28]||(T[28]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"Q"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"w")])]),t("mo",{stretchy:"false"},"("),t("mi",null,"s"),t("mo",null,","),t("mi",null,"a"),t("mo",{stretchy:"false"},")")])],-1))])]),T[33]||(T[33]=a("，评估")),t("mjx-container",H,[(e(),l("svg",f,T[29]||(T[29]=[Q("",1)]))),T[30]||(T[30]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mo",{stretchy:"false"},"("),t("mi",null,"s"),t("mo",null,","),t("mi",null,"a"),t("mo",{stretchy:"false"},")")])],-1))]),T[34]||(T[34]=a("的价值；"))]),t("li",null,[T[37]||(T[37]=t("strong",null,"Actor",-1)),T[38]||(T[38]=a("：")),t("mjx-container",y,[(e(),l("svg",L,T[35]||(T[35]=[Q("",1)]))),T[36]||(T[36]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"μ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])]),t("mo",{stretchy:"false"},"("),t("mi",null,"s"),t("mo",{stretchy:"false"},")")])],-1))]),T[39]||(T[39]=a("，")),T[40]||(T[40]=t("code",null,"适配连续动作",-1))])])]),t("li",null,[t("strong",null,[T[44]||(T[44]=a("求解")),t("mjx-container",M,[(e(),l("svg",k,T[42]||(T[42]=[Q("",1)]))),T[43]||(T[43]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"μ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])])])],-1))])]),T[67]||(T[67]=a(": ")),t("ul",null,[t("li",null,[T[49]||(T[49]=a("目标：")),t("strong",null,[T[47]||(T[47]=a("使")),t("mjx-container",V,[(e(),l("svg",Z,T[45]||(T[45]=[Q("",1)]))),T[46]||(T[46]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"Q"),t("mo",{stretchy:"false"},"("),t("mi",null,"s"),t("mo",null,","),t("msub",null,[t("mi",null,"μ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])]),t("mo",{stretchy:"false"},"("),t("mi",null,"a"),t("mo",{stretchy:"false"},")"),t("mo",{stretchy:"false"},")")])],-1))]),T[48]||(T[48]=a("最大"))])]),t("li",null,[T[65]||(T[65]=a("求导：")),t("strong",null,[T[54]||(T[54]=a("用Q 对 ")),t("mjx-container",b,[(e(),l("svg",D,T[50]||(T[50]=[Q("",1)]))),T[51]||(T[51]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"μ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])])])],-1))]),T[55]||(T[55]=a(" 求导： ")),t("mjx-container",v,[(e(),l("svg",j,T[52]||(T[52]=[Q("",1)]))),T[53]||(T[53]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",{mathvariant:"normal"},"∇"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])]),t("mi",null,"Q"),t("mo",{stretchy:"false"},"("),t("mi",null,"s"),t("mo",null,","),t("msub",null,[t("mi",null,"μ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])]),t("mo",{stretchy:"false"},"("),t("mi",null,"s"),t("mo",{stretchy:"false"},")"),t("mo",{stretchy:"false"},")")])],-1))])]),t("ul",null,[t("li",null,[T[60]||(T[60]=t("code",null,"梯度链式法则",-1)),T[61]||(T[61]=a("，")),T[62]||(T[62]=t("strong",null,"先对a求导",-1)),T[63]||(T[63]=a("，")),t("strong",null,[T[58]||(T[58]=a("再对")),t("mjx-container",A,[(e(),l("svg",C,T[56]||(T[56]=[t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math"},[t("g",{"data-mml-node":"mi"},[t("path",{"data-c":"1D703",d:"M35 200Q35 302 74 415T180 610T319 704Q320 704 327 704T339 705Q393 701 423 656Q462 596 462 495Q462 380 417 261T302 66T168 -10H161Q125 -10 99 10T60 63T41 130T35 200ZM383 566Q383 668 330 668Q294 668 260 623T204 521T170 421T157 371Q206 370 254 370L351 371Q352 372 359 404T375 484T383 566ZM113 132Q113 26 166 26Q181 26 198 36T239 74T287 161T335 307L340 324H145Q145 321 136 286T120 208T113 132Z",style:{"stroke-width":"3"}})])])],-1)]))),T[57]||(T[57]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"θ")])],-1))]),T[59]||(T[59]=a("求导"))]),T[64]||(T[64]=a("。"))])])]),T[66]||(T[66]=t("li",null,[a("再利用"),t("code",null,"梯度上升法"),a("来"),t("code",null,"最大化函数Q"),a("，得到Q值最大的动作")],-1))])])]),t("mjx-container",_,[(e(),l("svg",R,T[68]||(T[68]=[Q("",1)]))),T[69]||(T[69]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",{mathvariant:"normal"},"∇"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])]),t("mi",null,"J"),t("mo",{stretchy:"false"},"("),t("mi",null,"θ"),t("mo",{stretchy:"false"},")")]),t("mo",null,"="),t("msub",null,[t("mi",null,"E"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"s"),t("mo",null,"∼"),t("msup",null,[t("mi",null,"v"),t("mrow",{"data-mjx-texclass":"ORD"},[t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"β")])])])])])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"1.2em",maxsize:"1.2em"},"[")]),t("mstyle",{mathcolor:"red"},[t("munder",null,[t("mrow",{"data-mjx-texclass":"OP"},[t("munder",null,[t("mrow",null,[t("msub",null,[t("mi",{mathvariant:"normal"},"∇"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])]),t("mi",null,"Q"),t("mo",{stretchy:"false"},"("),t("mi",null,"s"),t("mo",null,","),t("msub",null,[t("mi",null,"μ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])]),t("mo",{stretchy:"false"},"("),t("mi",null,"s"),t("mo",{stretchy:"false"},")"),t("mo",{stretchy:"false"},")")]),t("mo",null,"⏟")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"normal"},"对"),t("mi",null,"θ"),t("mi",{mathvariant:"normal"},"求"),t("mi",{mathvariant:"normal"},"导")])])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"1.2em",maxsize:"1.2em"},"]")])])],-1))]),t("mjx-container",O,[(e(),l("svg",E,T[70]||(T[70]=[Q("",1)]))),T[71]||(T[71]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",{mathvariant:"normal"},"∇"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])]),t("mi",null,"J"),t("mo",{stretchy:"false"},"("),t("mi",null,"θ"),t("mo",{stretchy:"false"},")")]),t("mo",null,"="),t("msub",null,[t("mi",null,"E"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"s"),t("mo",null,"∼"),t("msup",null,[t("mi",null,"v"),t("mrow",{"data-mjx-texclass":"ORD"},[t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"β")])])])])])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"2.047em",maxsize:"2.047em"},"[")]),t("mstyle",{mathcolor:"red"},[t("munder",null,[t("mrow",{"data-mjx-texclass":"OP"},[t("munder",null,[t("mrow",null,[t("msub",null,[t("mi",{mathvariant:"normal"},"∇"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"a")])]),t("msubsup",null,[t("mi",null,"Q"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"w")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"μ")])]),t("mo",{stretchy:"false"},"("),t("mi",null,"s"),t("mo",null,","),t("mi",null,"a"),t("mo",{stretchy:"false"},")"),t("msub",null,[t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"a"),t("mo",null,"="),t("msub",null,[t("mi",null,"μ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])]),t("mo",{stretchy:"false"},"("),t("mi",null,"s"),t("mo",{stretchy:"false"},")")])])]),t("mo",null,"⏟")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"normal"},"对"),t("mi",null,"a"),t("mi",{mathvariant:"normal"},"求"),t("mi",{mathvariant:"normal"},"导")])])]),t("mo",null,"⋅"),t("mstyle",{mathcolor:"blue"},[t("munder",null,[t("mrow",{"data-mjx-texclass":"OP"},[t("munder",null,[t("mrow",null,[t("msub",null,[t("mi",{mathvariant:"normal"},"∇"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])]),t("msub",null,[t("mi",null,"μ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])]),t("mo",{stretchy:"false"},"("),t("mi",null,"s"),t("mo",{stretchy:"false"},")")]),t("mo",null,"⏟")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"normal"},"对"),t("mi",null,"θ"),t("mi",{mathvariant:"normal"},"求"),t("mi",{mathvariant:"normal"},"导")])])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"2.047em",maxsize:"2.047em"},"]")])])],-1))]),T[75]||(T[75]=t("ul",null,[t("li",null,[a("本质："),t("code",null,"DPG沿用DQN思想"),a("，"),t("code",null,"寻找最大Q值动作"),a("，没做真正意义上的梯度更新")])],-1))]),T[164]||(T[164]=t("p",null,"Actor的任务是找到最大Q的a值。",-1)),T[165]||(T[165]=t("img",{src:"https://datawhalechina.github.io/joyrl-book/figs/ch11/ddpg_actor.png",style:{display:"block",margin:"auto"},width:"70%"},null,-1)),T[166]||(T[166]=t("p",null,"网络结构",-1)),T[167]||(T[167]=t("img",{src:"https://datawhalechina.github.io/joyrl-book/figs/ch11/ddpg.png",style:{display:"block",margin:"auto"},width:"60%"},null,-1)),t("div",S,[T[86]||(T[86]=t("div",{class:"custom-block-title"},"DPG vs DQN",-1)),t("ul",null,[T[84]||(T[84]=t("li",null,[t("strong",null,"DQN"),a("：给定状态，通过2步求解动作，"),t("code",null,"估计Q函数"),a(" 和"),t("code",null,"贪心选择动作")],-1)),t("li",null,[T[78]||(T[78]=t("strong",null,"DPG",-1)),T[79]||(T[79]=a("：给定状态，通过")),T[80]||(T[80]=t("code",null,"1步求解动作",-1)),T[81]||(T[81]=a("： ")),t("strong",null,[t("mjx-container",P,[(e(),l("svg",B,T[76]||(T[76]=[Q("",1)]))),T[77]||(T[77]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"normal"},"A"),t("mi",{mathvariant:"normal"},"c"),t("mi",{mathvariant:"normal"},"t"),t("mi",{mathvariant:"normal"},"o"),t("mi",{mathvariant:"normal"},"r")]),t("mo",null,"="),t("msub",null,[t("mi",null,"μ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",{mathvariant:"normal"},"s"),t("mi",{mathvariant:"normal"},"t")]),t("mo",{stretchy:"false"},")")])],-1))])]),T[82]||(T[82]=a()),T[83]||(T[83]=t("code",null,"直接输出动作值",-1))]),T[85]||(T[85]=t("li",null,[t("a",{href:"https://plmsmile.github.io/posts/llm/rl/theory/05-dqn.html#%E8%AF%84%E8%AE%BA%E5%91%98q%E5%87%BD%E6%95%B0",target:"_blank",rel:"noreferrer"},"DQN的Q函数"),a(" 相当于 DPG中的"),t("code",null,"Critic")],-1))])]),T[168]||(T[168]=t("h3",{id:"ddpg",tabindex:"-1"},[a("DDPG "),t("a",{class:"header-anchor",href:"#ddpg","aria-label":'Permalink to "DDPG"'},"​")],-1)),T[169]||(T[169]=t("h4",{id:"核心思想",tabindex:"-1"},[a("核心思想 "),t("a",{class:"header-anchor",href:"#核心思想","aria-label":'Permalink to "核心思想"'},"​")],-1)),t("div",X,[T[101]||(T[101]=Q("",4)),t("ul",null,[t("li",null,[T[99]||(T[99]=t("strong",null,"DQN技巧",-1)),t("ul",null,[t("li",null,[T[94]||(T[94]=t("a",{href:"https://plmsmile.github.io/posts/llm/rl/theory/05-dqn.html#%E7%9B%AE%E6%A0%87%E7%BD%91%E7%BB%9C",target:"_blank",rel:"noreferrer"},"目标网络",-1)),T[95]||(T[95]=a("：")),T[96]||(T[96]=t("code",null,"Actor-Critic结构",-1)),T[97]||(T[97]=a("，")),t("strong",null,[T[91]||(T[91]=a("同时学习")),t("mjx-container",I,[(e(),l("svg",z,T[87]||(T[87]=[Q("",1)]))),T[88]||(T[88]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"Q"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"w")])])])],-1))]),T[92]||(T[92]=a("和策略网络")),t("mjx-container",G,[(e(),l("svg",N,T[89]||(T[89]=[Q("",1)]))),T[90]||(T[90]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"μ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])])])],-1))]),T[93]||(T[93]=a("。"))])]),T[98]||(T[98]=t("li",null,[t("a",{href:"https://plmsmile.github.io/posts/llm/rl/theory/05-dqn.html#%E7%BB%8F%E9%AA%8C%E5%9B%9E%E6%94%BE-%E7%BB%8F%E9%AA%8C%E6%B1%A0",target:"_blank",rel:"noreferrer"},"经验回放"),a("：同DQN")],-1))])]),T[100]||(T[100]=t("li",null,[a("其他技巧 "),t("ul",null,[t("li",null,[t("strong",null,"引入噪声增加策略探索")])])],-1))])]),T[170]||(T[170]=Q("",4)),t("div",J,[T[116]||(T[116]=t("div",{class:"custom-block-title"},"DDPG 优化目标",-1)),T[117]||(T[117]=t("p",null,[t("strong",null,"两个网络优化")],-1)),T[118]||(T[118]=t("ul",null,[t("li",null,[t("strong",null,"策略网络"),a("：策略梯度")])],-1)),t("mjx-container",q,[(e(),l("svg",F,T[102]||(T[102]=[Q("",1)]))),T[103]||(T[103]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",{mathvariant:"normal"},"∇"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])]),t("mi",null,"J"),t("mo",{stretchy:"false"},"("),t("mi",null,"θ"),t("mo",{stretchy:"false"},")")]),t("mo",null,"="),t("msub",null,[t("mi",null,"E"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"s"),t("mo",null,"∼"),t("msup",null,[t("mi",null,"v"),t("mrow",{"data-mjx-texclass":"ORD"},[t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"β")])])])])])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"2.047em",maxsize:"2.047em"},"[")]),t("mstyle",{mathcolor:"red"},[t("munder",null,[t("mrow",{"data-mjx-texclass":"OP"},[t("munder",null,[t("mrow",null,[t("msub",null,[t("mi",{mathvariant:"normal"},"∇"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"a")])]),t("msubsup",null,[t("mi",null,"Q"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"w")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"μ")])]),t("mo",{stretchy:"false"},"("),t("mi",null,"s"),t("mo",null,","),t("mi",null,"a"),t("mo",{stretchy:"false"},")"),t("msub",null,[t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"a"),t("mo",null,"="),t("msub",null,[t("mi",null,"μ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])]),t("mo",{stretchy:"false"},"("),t("mi",null,"s"),t("mo",{stretchy:"false"},")")])])]),t("mo",null,"⏟")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"normal"},"对"),t("mi",null,"a"),t("mi",{mathvariant:"normal"},"求"),t("mi",{mathvariant:"normal"},"导")])])]),t("mo",null,"⋅"),t("mstyle",{mathcolor:"blue"},[t("munder",null,[t("mrow",{"data-mjx-texclass":"OP"},[t("munder",null,[t("mrow",null,[t("msub",null,[t("mi",{mathvariant:"normal"},"∇"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])]),t("msub",null,[t("mi",null,"μ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])]),t("mo",{stretchy:"false"},"("),t("mi",null,"s"),t("mo",{stretchy:"false"},")")]),t("mo",null,"⏟")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"normal"},"对"),t("mi",null,"θ"),t("mi",{mathvariant:"normal"},"求"),t("mi",{mathvariant:"normal"},"导")])])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"2.047em",maxsize:"2.047em"},"]")])])],-1))]),t("ul",null,[t("li",null,[T[114]||(T[114]=t("strong",null,"Q网络",-1)),T[115]||(T[115]=a("： ")),t("ul",null,[t("li",null,[T[108]||(T[108]=t("strong",null,"Q_target",-1)),T[109]||(T[109]=a("：用真实奖励")),t("mjx-container",U,[(e(),l("svg",$,T[104]||(T[104]=[t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math"},[t("g",{"data-mml-node":"mi"},[t("path",{"data-c":"1D45F",d:"M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z",style:{"stroke-width":"3"}})])])],-1)]))),T[105]||(T[105]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"r")])],-1))]),T[110]||(T[110]=a("和下一步的")),t("mjx-container",W,[(e(),l("svg",K,T[106]||(T[106]=[Q("",1)]))),T[107]||(T[107]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"Q"),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"s"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"+"),t("mn",null,"1")])]),t("mo",null,","),t("msup",null,[t("mi",null,"a"),t("mi",{"data-mjx-alternate":"1"},"′")]),t("mo",{stretchy:"false"},")")])],-1))]),T[111]||(T[111]=a("来你和未来奖励Q_target"))]),T[112]||(T[112]=t("li",null,[t("strong",null,"Q_估计"),a("：当前Q网络输出")],-1)),T[113]||(T[113]=t("li",null,[a("让"),t("code",null,"Q_估计"),a(" 去逼近"),t("code",null,"Q_target"),a("，"),t("code",null,"MSEloss")],-1))])])])]),T[171]||(T[171]=t("img",{src:"https://datawhalechina.github.io/easy-rl/img/ch12/12.5.png",style:{display:"block",margin:"auto"},width:"70%"},null,-1)),T[172]||(T[172]=t("img",{src:"https://datawhalechina.github.io/easy-rl/img/ch12/12.7.png",style:{display:"block",margin:"auto"},width:"70%"},null,-1)),T[173]||(T[173]=t("h4",{id:"关键技巧",tabindex:"-1"},[a("关键技巧 "),t("a",{class:"header-anchor",href:"#关键技巧","aria-label":'Permalink to "关键技巧"'},"​")],-1)),t("div",Y,[T[124]||(T[124]=t("div",{class:"custom-block-title"},"关键技巧",-1)),T[125]||(T[125]=t("p",null,[t("strong",null,"1. 目标网络")],-1)),T[126]||(T[126]=t("ul",null,[t("li",null,"策略网络(actor)和Q网络(actor)均各有1个目标网络，一共4个网络，来稳定训练"),t("li",null,"固定目标网络，隔一段时间再更新")],-1)),T[127]||(T[127]=t("p",null,[t("strong",null,"2. 经验回放")],-1)),t("ul",null,[t("li",null,[T[121]||(T[121]=a("数据是")),t("mjx-container",t1,[(e(),l("svg",T1,T[119]||(T[119]=[Q("",1)]))),T[120]||(T[120]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"s"),t("mo",null,","),t("mi",null,"a"),t("mo",null,","),t("mi",null,"r"),t("mo",null,","),t("msup",null,[t("mi",null,"s"),t("mi",{"data-mjx-alternate":"1"},"′")])])],-1))]),T[122]||(T[122]=a("，存到缓冲区，")),T[123]||(T[123]=t("code",null,"异策略算法",-1))])]),T[128]||(T[128]=t("p",null,[t("strong",null,"3. OU噪声/高斯噪声")],-1)),T[129]||(T[129]=t("ul",null,[t("li",null,[t("p",null,"核心思想：策略是直接输出动作，则在输出值上加一个噪声")]),t("li",null,[t("p",null,"高斯噪声：不相关、均值为0，简单、效果更好。")]),t("li",null,[t("p",null,"OU噪声：自回归随机过程，相比高斯有优点：")])],-1))]),T[174]||(T[174]=t("img",{src:"https://datawhalechina.github.io/easy-rl/img/ch12/12.8.png",style:{display:"block",margin:"auto"},width:"70%"},null,-1)),t("div",a1,[T[142]||(T[142]=t("div",{class:"custom-block-title"},"OU噪声",-1)),T[143]||(T[143]=t("p",null,[t("strong",null,"定义")],-1)),t("ul",null,[t("li",null,[T[139]||(T[139]=a("自回归随机过程，高斯噪声+回归项。 ")),t("ul",null,[t("li",null,[t("mjx-container",Q1,[(e(),l("svg",l1,T[130]||(T[130]=[t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math"},[t("g",{"data-mml-node":"mi"},[t("path",{"data-c":"1D703",d:"M35 200Q35 302 74 415T180 610T319 704Q320 704 327 704T339 705Q393 701 423 656Q462 596 462 495Q462 380 417 261T302 66T168 -10H161Q125 -10 99 10T60 63T41 130T35 200ZM383 566Q383 668 330 668Q294 668 260 623T204 521T170 421T157 371Q206 370 254 370L351 371Q352 372 359 404T375 484T383 566ZM113 132Q113 26 166 26Q181 26 198 36T239 74T287 161T335 307L340 324H145Q145 321 136 286T120 208T113 132Z",style:{"stroke-width":"3"}})])])],-1)]))),T[131]||(T[131]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"θ")])],-1))]),T[136]||(T[136]=a(" 通常是固定的，调整")),t("mjx-container",e1,[(e(),l("svg",s1,T[132]||(T[132]=[Q("",1)]))),T[133]||(T[133]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"μ"),t("mo",null,","),t("mi",null,"σ")])],-1))]),T[137]||(T[137]=a("即可；")),t("mjx-container",o1,[(e(),l("svg",m1,T[134]||(T[134]=[Q("",1)]))),T[135]||(T[135]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"d"),t("msub",null,[t("mi",null,"W"),t("mi",null,"t")])])],-1))]),T[138]||(T[138]=a("是随机项，布朗运动等。"))])])])]),t("mjx-container",n1,[(e(),l("svg",d1,T[140]||(T[140]=[Q("",1)]))),T[141]||(T[141]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"normal"},"d")]),t("msub",null,[t("mi",null,"x"),t("mi",null,"t")]),t("mo",null,"="),t("mi",null,"θ"),t("mo",{stretchy:"false"},"("),t("mi",null,"μ"),t("mo",null,"−"),t("msub",null,[t("mi",null,"x"),t("mi",null,"t")]),t("mo",{stretchy:"false"},")"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"normal"},"d")]),t("mi",null,"t"),t("mo",null,"+"),t("mi",null,"σ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"normal"},"d")]),t("msub",null,[t("mi",null,"W"),t("mi",null,"t")])])],-1))]),T[144]||(T[144]=t("ul",null,[t("li",null,"在复杂环境才能体现出优点。")],-1)),T[145]||(T[145]=t("p",null,[t("strong",null,"相比高斯噪声的优点")],-1)),T[146]||(T[146]=t("ul",null,[t("li",null,"探索性：具有持续、自相关的特性，更加平滑，有助于探索广泛空间"),t("li",null,"稳定性：平滑特性，让训练更稳定"),t("li",null,[a("控制幅度：通过调整参数控制幅度，可以平衡探索和利用 "),t("ul",null,[t("li",null,"高方差：增强探索；小方差：增强利用性")])]),t("li",null,"可控性：逐渐回归到均值，可以逐渐减少探索性")],-1))]),T[175]||(T[175]=Q("",4)),t("div",r1,[T[153]||(T[153]=t("div",{class:"custom-block-title"},"双Q网络",-1)),T[154]||(T[154]=t("p",null,[t("strong",null,"核心思想")],-1)),t("ul",null,[t("li",null,[T[149]||(T[149]=a("使用2个Critic网络，")),t("mjx-container",i1,[(e(),l("svg",h1,T[147]||(T[147]=[Q("",1)]))),T[148]||(T[148]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"Q"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"w"),t("mn",null,"1")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"、")]),t("msub",null,[t("mi",null,"Q"),t("mrow",{"data-mjx-texclass":"ORD"},[t("msub",null,[t("mi",null,"w"),t("mn",null,"2")])])])])],-1))]),T[150]||(T[150]=a("，计算TD误差时，取两个Q值中较小的那个。"))])]),t("mjx-container",g1,[(e(),l("svg",p1,T[151]||(T[151]=[Q("",1)]))),T[152]||(T[152]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("msub",null,[t("mi",null,"y"),t("mi",null,"t")]),t("mo",null,"="),t("msub",null,[t("mi",null,"r"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"+"),t("mn",null,"1")])]),t("mo",null,"+"),t("mi",null,"γ"),t("munder",null,[t("mo",{"data-mjx-texclass":"OP"},"min"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,"="),t("mn",null,"1"),t("mo",null,","),t("mn",null,"2")])]),t("msub",null,[t("mi",null,"Q"),t("mrow",{"data-mjx-texclass":"ORD"},[t("msub",null,[t("mi",null,"w"),t("mi",null,"i")])])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"s"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"+"),t("mn",null,"1")])]),t("mo",null,","),t("msub",null,[t("mi",null,"μ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"s"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"+"),t("mn",null,"1")])]),t("mo",{stretchy:"false"},")"),t("mo",{stretchy:"false"},")")])],-1))]),T[155]||(T[155]=t("ul",null,[t("li",null,[a("目的：减少"),t("a",{href:"https://plmsmile.github.io/posts/llm/rl/theory/05-dqn.html#q%E5%80%BC%E8%BF%87%E4%BC%B0%E8%AE%A1",target:"_blank",rel:"noreferrer"},"Q值过估计"),a("，提高算法稳定性和收敛性。")])],-1)),T[156]||(T[156]=t("p",null,[t("strong",null,"双Q网络 vs DoubleDQN")],-1)),T[157]||(T[157]=t("ul",null,[t("li",null,[t("a",{href:"https://plmsmile.github.io/posts/llm/rl/theory/05-dqn.html#double-dqn-%E5%8F%8C",target:"_blank",rel:"noreferrer"},"DoubleDQN"),a("：两个Q网络交替来选动作和做评估")]),t("li",null,[t("strong",null,"Twin Q"),a("：只在在Critic上做文章，选最小的")])],-1))]),T[176]||(T[176]=Q("",3)),t("div",u1,[T[160]||(T[160]=Q("",5)),t("mjx-container",x1,[(e(),l("svg",w1,T[158]||(T[158]=[Q("",1)]))),T[159]||(T[159]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mi",null,"y"),t("mo",null,"="),t("msub",null,[t("mi",null,"r"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"+"),t("mn",null,"1")])]),t("mo",null,"+"),t("mi",null,"γ"),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",null,"Q"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"w")])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"s"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"+"),t("mn",null,"1")])]),t("mo",null,","),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mi",null,"μ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"s"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"+"),t("mn",null,"1")])]),t("mo",{stretchy:"false"},")"),t("mo",null,"+"),t("mi",null,"ϵ")]),t("mo",{stretchy:"false"},")")]),t("mspace",{linebreak:"newline"}),t("mi",null,"ϵ"),t("mo",null,"∼"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{"data-mjx-auto-op":"false"},"clip")]),t("mo",{stretchy:"false"},"("),t("mi",null,"N"),t("mo",{stretchy:"false"},"("),t("mn",null,"0"),t("mo",null,","),t("mi",null,"σ"),t("mo",{stretchy:"false"},")"),t("mo",null,","),t("mo",null,"−"),t("mi",null,"c"),t("mo",null,","),t("mi",null,"c"),t("mo",{stretchy:"false"},")")])],-1))])])])}const Z1=s(o,[["render",c1]]);export{V1 as __pageData,Z1 as default};

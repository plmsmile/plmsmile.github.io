import{_ as s,c as l,o as e,ah as T,j as t,a as Q}from"./chunks/framework.CvbyeFFO.js";const i2=JSON.parse('{"title":"PPO 改进系列","description":"","frontmatter":{"title":"PPO 改进系列","date":"2025-09-22T19:37:35.000Z","create":"2025-09-22T19:37:35.000Z","categories":["ppo"],"tags":["ppo","vc-ppo","vapo","价值偏差","长度不一","奖励稀疏","GAE奖励信号衰减","价值预训练","Decoupled-GAE","长度自适应GAE","Token-level Policy","Clip-Higher","正样本LM Loss","分组采样"]},"headers":[],"relativePath":"posts/llm/rl/theory/10-ppo-series.md","filePath":"posts/llm/rl/theory/10-ppo-series.md","lastUpdated":1761231250000}'),m={name:"posts/llm/rl/theory/10-ppo-series.md"},o={class:"custom-block warning"},d={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},n={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.027ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.455ex",height:"1.931ex",role:"img",focusable:"false",viewBox:"0 -841.7 1969.2 853.7","aria-hidden":"true"},r={class:"custom-block tip"},i={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},h={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.22ex",height:"1.332ex",role:"img",focusable:"false",viewBox:"0 -431 1423 588.8","aria-hidden":"true"},g={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},p={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.186ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.467ex",height:"1.756ex",role:"img",focusable:"false",viewBox:"0 -694 2416.6 776","aria-hidden":"true"},H={class:"custom-block tip"},c={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},u={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.186ex"},xmlns:"http://www.w3.org/2000/svg",width:"16.541ex",height:"2.14ex",role:"img",focusable:"false",viewBox:"0 -864 7311.2 946","aria-hidden":"true"},x={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},L={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.819ex"},xmlns:"http://www.w3.org/2000/svg",width:"46.63ex",height:"6.354ex",role:"img",focusable:"false",viewBox:"0 -1562.5 20610.4 2808.5","aria-hidden":"true"},w={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},f={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.819ex"},xmlns:"http://www.w3.org/2000/svg",width:"29.609ex",height:"6.354ex",role:"img",focusable:"false",viewBox:"0 -1562.5 13087 2808.5","aria-hidden":"true"},V={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},y={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.027ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.319ex",height:"1.597ex",role:"img",focusable:"false",viewBox:"0 -694 583 706","aria-hidden":"true"},k={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},M={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-1.577ex"},xmlns:"http://www.w3.org/2000/svg",width:"17.307ex",height:"4.613ex",role:"img",focusable:"false",viewBox:"0 -1342 7649.6 2039","aria-hidden":"true"},Z={class:"custom-block tip"},b={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},D={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-6.345ex"},xmlns:"http://www.w3.org/2000/svg",width:"98.049ex",height:"10.57ex",role:"img",focusable:"false",viewBox:"0 -1867.4 43337.7 4672.1","aria-hidden":"true"},v={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},A={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-6.42ex"},xmlns:"http://www.w3.org/2000/svg",width:"102.895ex",height:"10.645ex",role:"img",focusable:"false",viewBox:"0 -1867.4 45479.7 4705.1","aria-hidden":"true"},j={class:"custom-block tip"},_={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},C={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"11.895ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 5257.6 1000","aria-hidden":"true"},O={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},R={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.186ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.815ex",height:"1.692ex",role:"img",focusable:"false",viewBox:"0 -666 2128.4 748","aria-hidden":"true"},E={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},P={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.667ex"},xmlns:"http://www.w3.org/2000/svg",width:"17.827ex",height:"2.364ex",role:"img",focusable:"false",viewBox:"0 -750 7879.3 1045","aria-hidden":"true"},S={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},B={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.669ex"},xmlns:"http://www.w3.org/2000/svg",width:"11.17ex",height:"2.176ex",role:"img",focusable:"false",viewBox:"0 -666 4937 961.7","aria-hidden":"true"},X={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},z={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"9.415ex",height:"1.864ex",role:"img",focusable:"false",viewBox:"0 -666 4161.2 823.8","aria-hidden":"true"},I={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},F={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.506ex",height:"1.332ex",role:"img",focusable:"false",viewBox:"0 -431 1549.7 588.8","aria-hidden":"true"},G={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},N={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-6.42ex"},xmlns:"http://www.w3.org/2000/svg",width:"84.93ex",height:"10.645ex",role:"img",focusable:"false",viewBox:"0 -1867.4 37538.8 4705.1","aria-hidden":"true"},q={class:"custom-block tip"},J={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},$={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.65ex"},xmlns:"http://www.w3.org/2000/svg",width:"28.083ex",height:"2.347ex",role:"img",focusable:"false",viewBox:"0 -750 12412.5 1037.2","aria-hidden":"true"},Y={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},K={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-4.215ex"},xmlns:"http://www.w3.org/2000/svg",width:"44.617ex",height:"8.44ex",role:"img",focusable:"false",viewBox:"0 -1867.4 19720.7 3730.5","aria-hidden":"true"},W={class:"custom-block tip"},U={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},t1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.489ex"},xmlns:"http://www.w3.org/2000/svg",width:"15.371ex",height:"2.059ex",role:"img",focusable:"false",viewBox:"0 -694 6793.8 910","aria-hidden":"true"},a1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Q1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.186ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.827ex",height:"1.692ex",role:"img",focusable:"false",viewBox:"0 -666 3017.6 748","aria-hidden":"true"},T1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},l1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"10.975ex",height:"1.927ex",role:"img",focusable:"false",viewBox:"0 -694 4850.9 851.8","aria-hidden":"true"},e1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},s1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.798ex"},xmlns:"http://www.w3.org/2000/svg",width:"15.051ex",height:"2.755ex",role:"img",focusable:"false",viewBox:"0 -864.9 6652.4 1217.7","aria-hidden":"true"},m1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},o1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.186ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.356ex",height:"1.692ex",role:"img",focusable:"false",viewBox:"0 -666 3251.6 748","aria-hidden":"true"},d1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},n1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.669ex"},xmlns:"http://www.w3.org/2000/svg",width:"11.17ex",height:"2.176ex",role:"img",focusable:"false",viewBox:"0 -666 4937 961.7","aria-hidden":"true"},r1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},i1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"9.415ex",height:"1.864ex",role:"img",focusable:"false",viewBox:"0 -666 4161.2 823.8","aria-hidden":"true"},h1={class:"custom-block warning"},g1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},p1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.561ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2016 1000","aria-hidden":"true"},H1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},c1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.561ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2016 1000","aria-hidden":"true"},u1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},x1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"14.949ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 6607.5 1000","aria-hidden":"true"},L1={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},w1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-4.092ex"},xmlns:"http://www.w3.org/2000/svg",width:"66.168ex",height:"8.003ex",role:"img",focusable:"false",viewBox:"0 -1728.7 29246.1 3537.5","aria-hidden":"true"},f1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},V1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.462ex",height:"1.977ex",role:"img",focusable:"false",viewBox:"0 -716 1088.3 873.8","aria-hidden":"true"},y1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},k1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.462ex",height:"2.809ex",role:"img",focusable:"false",viewBox:"0 -1084 1088.3 1241.8","aria-hidden":"true"},M1={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},Z1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.471ex"},xmlns:"http://www.w3.org/2000/svg",width:"17.475ex",height:"2.923ex",role:"img",focusable:"false",viewBox:"0 -1084 7723.9 1292","aria-hidden":"true"},b1={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},D1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.471ex"},xmlns:"http://www.w3.org/2000/svg",width:"22.377ex",height:"2.923ex",role:"img",focusable:"false",viewBox:"0 -1084 9890.6 1292","aria-hidden":"true"},v1={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},A1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.471ex"},xmlns:"http://www.w3.org/2000/svg",width:"51.207ex",height:"2.923ex",role:"img",focusable:"false",viewBox:"0 -1084 22633.4 1292","aria-hidden":"true"},j1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},_1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"9.915ex",height:"1.979ex",role:"img",focusable:"false",viewBox:"0 -717 4382.4 874.8","aria-hidden":"true"},C1={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},O1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.864ex"},xmlns:"http://www.w3.org/2000/svg",width:"42.653ex",height:"6.775ex",role:"img",focusable:"false",viewBox:"0 -1728.7 18852.7 2994.4","aria-hidden":"true"},R1={class:"custom-block warning"},E1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},P1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.339ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.334ex",height:"1.339ex",role:"img",focusable:"false",viewBox:"0 -442 1031.8 592","aria-hidden":"true"},S1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},B1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.339ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.334ex",height:"1.339ex",role:"img",focusable:"false",viewBox:"0 -442 1031.8 592","aria-hidden":"true"},X1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},z1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"14.665ex",height:"2.47ex",role:"img",focusable:"false",viewBox:"0 -841.7 6482.1 1091.7","aria-hidden":"true"},I1={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},F1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-4.092ex"},xmlns:"http://www.w3.org/2000/svg",width:"40.182ex",height:"6.545ex",role:"img",focusable:"false",viewBox:"0 -1084 17760.3 2892.8","aria-hidden":"true"},G1={class:"custom-block tip"},N1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},q1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.186ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.467ex",height:"1.756ex",role:"img",focusable:"false",viewBox:"0 -694 2416.6 776","aria-hidden":"true"},J1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},$1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.22ex",height:"1.332ex",role:"img",focusable:"false",viewBox:"0 -431 1423 588.8","aria-hidden":"true"},Y1={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},K1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.274ex"},xmlns:"http://www.w3.org/2000/svg",width:"57.014ex",height:"5.679ex",role:"img",focusable:"false",viewBox:"0 -1505 25200.1 2509.9","aria-hidden":"true"},W1={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},U1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.452ex"},xmlns:"http://www.w3.org/2000/svg",width:"45.376ex",height:"2.149ex",role:"img",focusable:"false",viewBox:"0 -750 20056 950","aria-hidden":"true"},t2={class:"custom-block tip"},a2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Q2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"9.443ex",height:"1.927ex",role:"img",focusable:"false",viewBox:"0 -694 4174 851.8","aria-hidden":"true"},T2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},l2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"12.16ex",height:"1.927ex",role:"img",focusable:"false",viewBox:"0 -694 5374.9 851.8","aria-hidden":"true"};function e2(s2,a,m2,o2,d2,n2){return e(),l("div",null,[a[253]||(a[253]=T("",6)),t("div",o,[a[8]||(a[8]=t("div",{class:"custom-block-title"},"价值模型偏差问题",-1)),a[9]||(a[9]=t("p",null,[t("strong",null,"1. 价值模型偏差")],-1)),t("ul",null,[a[7]||(a[7]=T("",1)),t("li",null,[a[6]||(a[6]=t("strong",null,"GAE λ<1时 奖励信号衰减，加剧价值学习难度",-1)),t("ul",null,[t("li",null,[a[2]||(a[2]=Q("最终环境奖励，传播到第t个token时，衰减因子为")),t("mjx-container",d,[(e(),l("svg",n,a[0]||(a[0]=[T("",1)]))),a[1]||(a[1]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msup",null,[t("mi",null,"λ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"T"),t("mo",null,"−"),t("mi",null,"t")])])])],-1))]),a[3]||(a[3]=Q("，"))]),a[4]||(a[4]=t("li",null,"T-t很大时，衰减因子几乎为0，无奖励信号",-1)),a[5]||(a[5]=t("li",null,"价值模型更新完全依赖自举，难以作为基线，使得训练过程非常不稳定。",-1))])])])]),a[254]||(a[254]=T("",10)),t("div",r,[a[20]||(a[20]=T("",6)),t("ul",null,[t("li",null,[a[14]||(a[14]=Q("使用固定策略")),t("mjx-container",i,[(e(),l("svg",h,a[10]||(a[10]=[T("",1)]))),a[11]||(a[11]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"sft")])])])],-1))]),a[15]||(a[15]=Q("，生成大量数据；GAE使用")),t("mjx-container",g,[(e(),l("svg",p,a[12]||(a[12]=[T("",1)]))),a[13]||(a[13]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"λ"),t("mo",null,"="),t("mn",null,"1")])],-1))]),a[16]||(a[16]=Q("变成无偏MC回报。"))]),a[17]||(a[17]=t("li",null,"使用生成数据+MC回报，来训练价值模型。直到收敛，看Value Loss和Explained Variance。",-1)),a[18]||(a[18]=t("li",null,"后续PPO使用Value预训练过的模型。",-1)),a[19]||(a[19]=t("li",null,[Q("具体见 "),t("a",{href:"http://plmsmile.github.io/posts/llm/rl/theory/10-ppo-series.html#valuepretrain-%E4%BB%B7%E5%80%BC%E9%A2%84%E8%AE%AD%E7%BB%83",target:"_blank",rel:"noreferrer"},"VC-PPO 价值预训练")],-1))])]),a[255]||(a[255]=T("",4)),t("div",H,[a[42]||(a[42]=t("div",{class:"custom-block-title"},"Length-Adaptive GAE",-1)),a[43]||(a[43]=t("p",null,[t("strong",null,"目的")],-1)),t("ul",null,[a[28]||(a[28]=t("li",null,[t("code",null,"动态调整GAE的λ参数"),Q("，"),t("code",null,"适应不同长度"),Q("。")],-1)),t("li",null,[a[25]||(a[25]=Q("如果λ=0.95固定，则存在")),a[26]||(a[26]=t("strong",null,"奖励衰减问题",-1)),a[27]||(a[27]=Q("。 ")),t("ul",null,[t("li",null,[a[23]||(a[23]=Q("当步数很长l=100时，")),t("mjx-container",c,[(e(),l("svg",u,a[21]||(a[21]=[T("",1)]))),a[22]||(a[22]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msup",null,[t("mn",null,"0.95"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mn",null,"100")])]),t("mo",null,"≈="),t("mn",null,"0.006")])],-1))]),a[24]||(a[24]=Q("，奖励信号权重接近0。"))])])])]),a[44]||(a[44]=t("p",null,[t("strong",null,"核心思想")],-1)),t("ul",null,[a[33]||(a[33]=T("",3)),t("li",null,[a[31]||(a[31]=t("p",null,"GAE 权重系数总和",-1)),a[32]||(a[32]=t("ul",null,[t("li",null,[t("strong",null,"未来所有奖励信号"),Q(),t("code",null,"对当前决策的总影响力"),Q("，"),t("a",{href:"https://plmsmile.github.io/posts/llm/rl/theory/04-model-free-prediction-control.html#%CE%BB-%E5%9B%9E%E6%8A%A5",target:"_blank",rel:"noreferrer"},"TD(λ) 权重理解")])],-1)),t("mjx-container",x,[(e(),l("svg",L,a[29]||(a[29]=[T("",1)]))),a[30]||(a[30]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("munderover",null,[t("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"="),t("mn",null,"0")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"normal"},"∞")])]),t("msubsup",null,[t("mi",null,"λ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"policy")]),t("mi",null,"t")])]),t("mo",null,"="),t("mn",null,"1"),t("mo",null,"+"),t("mi",null,"λ"),t("mo",null,"+"),t("msup",null,[t("mi",null,"λ"),t("mn",null,"2")]),t("mo",null,"+"),t("msup",null,[t("mi",null,"λ"),t("mn",null,"3")]),t("mo",null,"+"),t("mo",null,"⋯"),t("mo",null,"="),t("mfrac",null,[t("mn",null,"1"),t("mstyle",{mathcolor:"blue"},[t("mn",null,"1"),t("mo",null,"−"),t("msub",null,[t("mi",null,"λ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"policy")])])])])])],-1))])])]),a[45]||(a[45]=t("p",null,[t("strong",null,"具体做法")],-1)),t("ul",null,[t("li",null,[a[36]||(a[36]=t("p",null,[t("code",null,"总影响力"),Q("应该"),t("code",null,"与序列长度l成正比")],-1)),t("mjx-container",w,[(e(),l("svg",f,a[34]||(a[34]=[T("",1)]))),a[35]||(a[35]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("munderover",null,[t("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"="),t("mn",null,"0")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"normal"},"∞")])]),t("msubsup",null,[t("mi",null,"λ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"policy")]),t("mi",null,"t")])]),t("mo",null,"="),t("mfrac",null,[t("mn",null,"1"),t("mstyle",{mathcolor:"blue"},[t("mn",null,"1"),t("mo",null,"−"),t("msub",null,[t("mi",null,"λ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"policy")])])])]),t("mo",null,"="),t("mstyle",{mathcolor:"blue"},[t("mi",null,"α")]),t("mo",null,"⋅"),t("mstyle",{mathcolor:"red"},[t("mi",null,"l")])])],-1))])]),t("li",null,[t("p",null,[t("strong",null,[a[39]||(a[39]=Q("长度自适应")),t("mjx-container",V,[(e(),l("svg",y,a[37]||(a[37]=[t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math"},[t("g",{"data-mml-node":"mi"},[t("path",{"data-c":"1D706",d:"M166 673Q166 685 183 694H202Q292 691 316 644Q322 629 373 486T474 207T524 67Q531 47 537 34T546 15T551 6T555 2T556 -2T550 -11H482Q457 3 450 18T399 152L354 277L340 262Q327 246 293 207T236 141Q211 112 174 69Q123 9 111 -1T83 -12Q47 -12 47 20Q47 37 61 52T199 187Q229 216 266 252T321 306L338 322Q338 323 288 462T234 612Q214 657 183 657Q166 657 166 673Z",style:{"stroke-width":"3"}})])])],-1)]))),a[38]||(a[38]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"λ")])],-1))])])]),t("mjx-container",k,[(e(),l("svg",M,a[40]||(a[40]=[T("",1)]))),a[41]||(a[41]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mi",null,"λ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"policy")])])]),t("mo",null,"="),t("mn",null,"1"),t("mo",null,"−"),t("mfrac",null,[t("mn",null,"1"),t("mrow",null,[t("mstyle",{mathcolor:"blue"},[t("mi",null,"α")]),t("mo",null,"⋅"),t("mstyle",{mathcolor:"red"},[t("mi",null,"l")])])])])],-1))])])])]),t("div",Z,[a[55]||(a[55]=T("",3)),t("mjx-container",b,[(e(),l("svg",D,a[46]||(a[46]=[T("",1)]))),a[47]||(a[47]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{"data-mjx-variant":"-tex-calligraphic",mathvariant:"script"},"L")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"ppo")])]),t("mo",{stretchy:"false"},"("),t("mi",null,"θ"),t("mo",{stretchy:"false"},")")]),t("mo",null,"="),t("mstyle",{mathcolor:"blue"},[t("munder",null,[t("mrow",{"data-mjx-texclass":"OP"},[t("munder",null,[t("mrow",null,[t("mfrac",null,[t("mn",null,"1"),t("mi",null,"G")]),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,"="),t("mn",null,"1")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"G")])])]),t("mo",null,"⏟")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"normal"},"样"),t("mi",{mathvariant:"normal"},"本"),t("mi",{mathvariant:"normal"},"间"),t("mi",{mathvariant:"normal"},"平"),t("mi",{mathvariant:"normal"},"均")])])]),t("mstyle",{mathcolor:"red"},[t("munder",null,[t("mrow",{"data-mjx-texclass":"OP"},[t("munder",null,[t("mrow",null,[t("mfrac",null,[t("mn",null,"1"),t("mrow",null,[t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("msub",null,[t("mi",null,"o"),t("mi",null,"i")]),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|")])]),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"="),t("mn",null,"1")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("msub",null,[t("mi",null,"o"),t("mi",null,"t")]),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|")])])]),t("mo",null,"⏟")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"序列内平均")])])]),t("mstyle",{mathcolor:"blue"},[t("mo",{"data-mjx-texclass":"OP",movablelimits:"true"},"min")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"2.047em",maxsize:"2.047em"},"(")]),t("mfrac",null,[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])]),t("mo",null,"∣"),t("mi",null,"q"),t("mo",null,","),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mo",null,"<"),t("mi",null,"t")])]),t("mo",{stretchy:"false"},")")]),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("msub",null,[t("mi",null,"θ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"o"),t("mi",null,"l"),t("mi",null,"d")])])])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])]),t("mo",null,"∣"),t("mi",null,"q"),t("mo",null,","),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mo",null,"<"),t("mi",null,"t")])]),t("mo",{stretchy:"false"},")")])]),t("mo",null,"⋅"),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"A"),t("mo",{stretchy:"false"},"^")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])])]),t("mo",null,","),t("mstyle",{scriptlevel:"0"},[t("mspace",{width:"0.278em"})]),t("mstyle",{mathcolor:"red"},[t("mtext",null,"clip")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"1.2em",maxsize:"1.2em"},"(")]),t("mfrac",null,[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])]),t("mo",null,"∣"),t("mi",null,"q"),t("mo",null,","),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mo",null,"<"),t("mi",null,"t")])]),t("mo",{stretchy:"false"},")")]),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("msub",null,[t("mi",null,"θ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"o"),t("mi",null,"l"),t("mi",null,"d")])])])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])]),t("mo",null,"∣"),t("mi",null,"q"),t("mo",null,","),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mo",null,"<"),t("mi",null,"t")])]),t("mo",{stretchy:"false"},")")])]),t("mo",null,","),t("mstyle",{mathcolor:"blue"},[t("mn",null,"1"),t("mo",null,"−"),t("mi",null,"ϵ")]),t("mo",null,","),t("mstyle",{mathcolor:"blue"},[t("mn",null,"1"),t("mo",null,"+"),t("mi",null,"ϵ")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"1.2em",maxsize:"1.2em"},")")]),t("mo",null,"⋅"),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"A"),t("mo",{stretchy:"false"},"^")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"2.047em",maxsize:"2.047em"},")")])])],-1))]),a[56]||(a[56]=t("p",null,[t("strong",null,"VAPO Token-Level Loss")],-1)),t("ul",null,[t("li",null,[a[50]||(a[50]=Q("不做序列内平均，")),a[51]||(a[51]=t("code",null,"直接对所有token做平均",-1)),a[52]||(a[52]=Q("，")),a[53]||(a[53]=t("code",null,"每个token权重相同",-1)),a[54]||(a[54]=Q("，不论它来自短序列或长序列。")),t("mjx-container",v,[(e(),l("svg",A,a[48]||(a[48]=[T("",1)]))),a[49]||(a[49]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{"data-mjx-variant":"-tex-calligraphic",mathvariant:"script"},"L")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"VAPO")])]),t("mo",{stretchy:"false"},"("),t("mi",null,"θ"),t("mo",{stretchy:"false"},")")]),t("mo",null,"="),t("mo",null,"−"),t("munder",null,[t("mrow",{"data-mjx-texclass":"OP"},[t("munder",null,[t("mrow",null,[t("mstyle",{mathcolor:"red"},[t("mfrac",null,[t("mn",null,"1"),t("mrow",null,[t("munderover",null,[t("mo",{"data-mjx-texclass":"OP"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,"="),t("mn",null,"1")]),t("mi",null,"G")]),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("msub",null,[t("mi",null,"o"),t("mi",null,"i")]),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|")])])]),t("mstyle",{mathcolor:"blue"},[t("munderover",null,[t("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,"="),t("mn",null,"1")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"G")])])]),t("mstyle",{mathcolor:"red"},[t("munderover",null,[t("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"="),t("mn",null,"1")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("msub",null,[t("mi",null,"o"),t("mi",null,"t")]),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|")])])])]),t("mo",null,"⏟")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mstyle",{mathcolor:"blue"},[t("mtext",null,"所有Token直接做平均")])])]),t("mstyle",{mathcolor:"blue"},[t("mo",{"data-mjx-texclass":"OP",movablelimits:"true"},"min")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"2.047em",maxsize:"2.047em"},"(")]),t("mfrac",null,[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])]),t("mo",null,"∣"),t("mi",null,"q"),t("mo",null,","),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mo",null,"<"),t("mi",null,"t")])]),t("mo",{stretchy:"false"},")")]),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("msub",null,[t("mi",null,"θ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"o"),t("mi",null,"l"),t("mi",null,"d")])])])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])]),t("mo",null,"∣"),t("mi",null,"q"),t("mo",null,","),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mo",null,"<"),t("mi",null,"t")])]),t("mo",{stretchy:"false"},")")])]),t("mo",null,"⋅"),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"A"),t("mo",{stretchy:"false"},"^")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])])]),t("mo",null,","),t("mstyle",{scriptlevel:"0"},[t("mspace",{width:"0.278em"})]),t("mstyle",{mathcolor:"red"},[t("mtext",null,"clip")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"1.2em",maxsize:"1.2em"},"(")]),t("mfrac",null,[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])]),t("mo",null,"∣"),t("mi",null,"q"),t("mo",null,","),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mo",null,"<"),t("mi",null,"t")])]),t("mo",{stretchy:"false"},")")]),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("msub",null,[t("mi",null,"θ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"o"),t("mi",null,"l"),t("mi",null,"d")])])])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])]),t("mo",null,"∣"),t("mi",null,"q"),t("mo",null,","),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mo",null,"<"),t("mi",null,"t")])]),t("mo",{stretchy:"false"},")")])]),t("mo",null,","),t("mstyle",{mathcolor:"blue"},[t("mn",null,"1"),t("mo",null,"−"),t("mi",null,"ϵ")]),t("mo",null,","),t("mstyle",{mathcolor:"blue"},[t("mn",null,"1"),t("mo",null,"+"),t("mi",null,"ϵ")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"1.2em",maxsize:"1.2em"},")")]),t("mo",null,"⋅"),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"A"),t("mo",{stretchy:"false"},"^")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"2.047em",maxsize:"2.047em"},")")])])],-1))])])])]),a[256]||(a[256]=t("h4",{id:"解决奖励稀疏问题-clip-higher-正样本lm-loss-分组采样",tabindex:"-1"},[Q("解决奖励稀疏问题(Clip-Higher,正样本LM-Loss,分组采样) "),t("a",{class:"header-anchor",href:"#解决奖励稀疏问题-clip-higher-正样本lm-loss-分组采样","aria-label":'Permalink to "解决奖励稀疏问题(Clip-Higher,正样本LM-Loss,分组采样)"'},"​")],-1)),t("div",j,[a[89]||(a[89]=t("div",{class:"custom-block-title"},"Clip-Higher",-1)),a[90]||(a[90]=t("p",null,[t("strong",null,"标准PPO-Clip问题")],-1)),t("ul",null,[t("li",null,[a[59]||(a[59]=Q("防止训练一步走太大而崩溃，把")),a[60]||(a[60]=t("strong",null,"变化范围",-1)),a[61]||(a[61]=Q("限制在")),t("mjx-container",_,[(e(),l("svg",C,a[57]||(a[57]=[T("",1)]))),a[58]||(a[58]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mo",{stretchy:"false"},"["),t("mstyle",{mathcolor:"red"},[t("mn",null,"1"),t("mo",null,"−"),t("mi",null,"ϵ"),t("mo",null,","),t("mn",null,"1"),t("mo",null,"+"),t("mi",null,"ϵ")]),t("mo",{stretchy:"false"},"]")])],-1))])]),t("li",null,[t("strong",null,[t("mjx-container",O,[(e(),l("svg",R,a[62]||(a[62]=[T("",1)]))),a[63]||(a[63]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mn",null,"1"),t("mo",null,"+"),t("mi",null,"ϵ")])],-1))]),a[64]||(a[64]=Q("成为探索天花板，太低不利于探索"))]),a[65]||(a[65]=T("",1))])]),a[91]||(a[91]=t("p",null,[t("strong",null,"Clip-Higher：奖要重奖、罚要慎罚")],-1)),t("ul",null,[t("li",null,[t("p",null,[a[68]||(a[68]=Q("把上下界解耦为非对称 ")),t("mjx-container",E,[(e(),l("svg",P,a[66]||(a[66]=[T("",1)]))),a[67]||(a[67]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mo",{stretchy:"false"},"["),t("mstyle",{mathcolor:"blue"},[t("mn",null,"1"),t("mo",null,"−"),t("msub",null,[t("mi",null,"ϵ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"l"),t("mi",null,"o"),t("mi",null,"w")])])]),t("mo",null,","),t("mstyle",{mathcolor:"red"},[t("mn",null,"1"),t("mo",null,"+"),t("msub",null,[t("mi",null,"ϵ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"h"),t("mi",null,"i"),t("mi",null,"g"),t("mi",null,"h")])])]),t("mo",{stretchy:"false"},"]")])],-1))])])]),t("li",null,[t("p",null,[t("strong",null,[a[71]||(a[71]=Q("提高上界")),t("mjx-container",S,[(e(),l("svg",B,a[69]||(a[69]=[T("",1)]))),a[70]||(a[70]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"ϵ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"high")])]),t("mo",null,"="),t("mn",null,"0.28")])],-1))]),a[72]||(a[72]=Q("：奖要重奖"))])]),a[73]||(a[73]=t("ul",null,[t("li",null,[Q("如0.2->0.28。"),t("code",null,"为奖励信号打开更高天花板"),Q("；当"),t("strong",null,"探索到好路径"),Q("时，"),t("strong",null,"策略"),Q("可以进行"),t("code",null,"大幅度更新"),Q("。")]),t("li",null,"为惊喜提供更大奖励空间。")],-1))]),t("li",null,[t("p",null,[t("strong",null,[a[76]||(a[76]=Q("保持下界")),t("mjx-container",X,[(e(),l("svg",z,a[74]||(a[74]=[T("",1)]))),a[75]||(a[75]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"ϵ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"low")])]),t("mo",null,"="),t("mn",null,"0.2")])],-1))]),a[77]||(a[77]=Q("不变或较小：罚要慎罚"))])]),t("ul",null,[t("li",null,[t("strong",null,[a[80]||(a[80]=Q("如果")),t("mjx-container",I,[(e(),l("svg",F,a[78]||(a[78]=[T("",1)]))),a[79]||(a[79]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"ϵ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"low")])])])],-1))]),a[81]||(a[81]=Q("太大"))]),a[82]||(a[82]=Q("，模型在")),a[83]||(a[83]=t("code",null,"惩罚错误路径",-1)),a[84]||(a[84]=Q("时可能")),a[85]||(a[85]=t("code",null,"过于激进",-1))]),a[86]||(a[86]=t("li",null,[Q("直接"),t("code",null,"把概率压到0"),Q("，这样会"),t("code",null,"扼杀多样性"),Q("，导致"),t("code",null,"熵崩溃"),Q("。")],-1))]),t("mjx-container",G,[(e(),l("svg",N,a[87]||(a[87]=[T("",1)]))),a[88]||(a[88]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{"data-mjx-variant":"-tex-calligraphic",mathvariant:"script"},"L")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"VAPO")])]),t("mo",{stretchy:"false"},"("),t("mi",null,"θ"),t("mo",{stretchy:"false"},")")]),t("mo",null,"="),t("mo",null,"−"),t("munder",null,[t("mrow",{"data-mjx-texclass":"OP"},[t("munder",null,[t("mrow",null,[t("mstyle",{mathcolor:"red"},[t("mfrac",null,[t("mn",null,"1"),t("mrow",null,[t("munderover",null,[t("mo",{"data-mjx-texclass":"OP"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,"="),t("mn",null,"1")]),t("mi",null,"G")]),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("msub",null,[t("mi",null,"o"),t("mi",null,"i")]),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|")])])]),t("mstyle",{mathcolor:"blue"},[t("munderover",null,[t("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,"="),t("mn",null,"1")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"G")])])]),t("mstyle",{mathcolor:"red"},[t("munderover",null,[t("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"="),t("mn",null,"1")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("msub",null,[t("mi",null,"o"),t("mi",null,"t")]),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|")])])])]),t("mo",null,"⏟")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mstyle",{mathcolor:"blue"},[t("mtext",null,"所有Token直接做平均")])])]),t("mstyle",{mathcolor:"blue"},[t("mo",{"data-mjx-texclass":"OP",movablelimits:"true"},"min")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"2.047em",maxsize:"2.047em"},"(")]),t("msub",null,[t("mi",null,"r"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])]),t("mo",{stretchy:"false"},"("),t("mi",null,"θ"),t("mo",{stretchy:"false"},")"),t("mo",null,"⋅"),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"A"),t("mo",{stretchy:"false"},"^")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])])]),t("mo",null,","),t("mstyle",{scriptlevel:"0"},[t("mspace",{width:"0.278em"})]),t("mstyle",{mathcolor:"red"},[t("mtext",null,"clip")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"1.2em",maxsize:"1.2em"},"(")]),t("msub",null,[t("mi",null,"r"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])]),t("mo",{stretchy:"false"},"("),t("mi",null,"θ"),t("mo",{stretchy:"false"},")"),t("mo",null,","),t("mstyle",{mathcolor:"blue"},[t("mn",null,"1"),t("mo",null,"−"),t("msub",null,[t("mi",null,"ϵ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"low")])])]),t("mo",null,","),t("mstyle",{mathcolor:"red"},[t("mn",null,"1"),t("mo",null,"+"),t("msub",null,[t("mi",null,"ϵ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"high")])])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"1.2em",maxsize:"1.2em"},")")]),t("mo",null,"⋅"),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"A"),t("mo",{stretchy:"false"},"^")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"2.047em",maxsize:"2.047em"},")")])])],-1))])])])]),t("div",q,[a[96]||(a[96]=T("",7)),t("mjx-container",J,[(e(),l("svg",$,a[92]||(a[92]=[T("",1)]))),a[93]||(a[93]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{"data-mjx-variant":"-tex-calligraphic",mathvariant:"script"},"L")]),t("mo",{stretchy:"false"},"("),t("mi",null,"θ"),t("mo",{stretchy:"false"},")")]),t("mo",null,"="),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{"data-mjx-variant":"-tex-calligraphic",mathvariant:"script"},"L")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"ppo")])]),t("mo",{stretchy:"false"},"("),t("mi",null,"θ"),t("mo",{stretchy:"false"},")")]),t("mo",null,"+"),t("mstyle",{mathcolor:"red"},[t("mi",null,"μ"),t("mo",null,"⋅"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{"data-mjx-variant":"-tex-calligraphic",mathvariant:"script"},"L")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"NLL")])]),t("mo",{stretchy:"false"},"("),t("mi",null,"θ"),t("mo",{stretchy:"false"},")")])])],-1))]),a[97]||(a[97]=t("ul",null,[t("li",null,[t("strong",null,"NLL Loss"),Q("："),t("code",null,"最大化正样本的生成概率"),Q("。")]),t("li",null,[Q("压榨正样本，不仅告知模型做对，"),t("code",null,"且手把手教学如何做对的"),Q("，"),t("code",null,"记住这个过程"),Q("。")])],-1)),t("mjx-container",Y,[(e(),l("svg",K,a[94]||(a[94]=[T("",1)]))),a[95]||(a[95]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{"data-mjx-variant":"-tex-calligraphic",mathvariant:"script"},"L")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"NLL")])]),t("mo",{stretchy:"false"},"("),t("mi",null,"θ"),t("mo",{stretchy:"false"},")")]),t("mo",null,"="),t("mo",null,"−"),t("mstyle",{mathcolor:"red"},[t("mfrac",null,[t("mn",null,"1"),t("mrow",null,[t("munder",null,[t("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("msub",null,[t("mi",null,"o"),t("mi",null,"i")]),t("mo",null,"∈"),t("msub",null,[t("mi",null,"τ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"positive")])])])]),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("msub",null,[t("mi",null,"o"),t("mi",null,"i")]),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|")])])]),t("munder",null,[t("mo",{"data-mjx-texclass":"OP"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",null,"o"),t("mi",null,"i")]),t("mo",null,"∈"),t("mi",null,"τ")])])]),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mstyle",{mathcolor:"blue"},[t("mi",null,"t"),t("mo",null,"="),t("mn",null,"1")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mstyle",{mathcolor:"blue"},[t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("msub",null,[t("mi",null,"o"),t("mi",null,"i")]),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|")])])]),t("mstyle",{mathcolor:"red"},[t("mi",null,"log"),t("mo",{"data-mjx-texclass":"NONE"},"⁡"),t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"a"),t("mi",null,"t")]),t("mo",null,"∣"),t("msub",null,[t("mi",null,"s"),t("mi",null,"t")]),t("mo",{stretchy:"false"},")")])])],-1))])]),a[257]||(a[257]=T("",4)),t("div",W,[a[127]||(a[127]=T("",8)),t("ul",null,[a[104]||(a[104]=t("li",null,[Q("Policy 学习率1e-6，"),t("code",null,"Critic 学习率 2e-6"),Q("。 "),t("ul",null,[t("li",null,"Critic 必须跟上 Actor的速率，才能提供准确的优势估计。"),t("li",null,"如果更新太慢，提供的就是过时的估计。")])],-1)),a[105]||(a[105]=t("li",null,"Batch Size：8192个prompt，每个prompt采样1次",-1)),a[106]||(a[106]=t("li",null,"Mini-Batch Size：512",-1)),a[107]||(a[107]=t("li",null,"Critic Model：由RM初始化。",-1)),t("li",null,[a[100]||(a[100]=Q("GAE：")),t("mjx-container",U,[(e(),l("svg",t1,a[98]||(a[98]=[T("",1)]))),a[99]||(a[99]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"λ"),t("mo",null,"="),t("mn",null,"0.95"),t("mo",null,","),t("mstyle",{scriptlevel:"0"},[t("mspace",{width:"0.278em"})]),t("mi",null,"γ"),t("mo",null,"="),t("mn",null,"1")])],-1))])]),t("li",null,[a[103]||(a[103]=Q("Clip：")),t("mjx-container",a1,[(e(),l("svg",Q1,a[101]||(a[101]=[T("",1)]))),a[102]||(a[102]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"ϵ"),t("mo",null,"="),t("mn",null,"0.2")])],-1))])]),a[108]||(a[108]=t("li",null,"使用Sample-Loss",-1))]),a[128]||(a[128]=t("p",null,[t("strong",null,"VAPO 设置")],-1)),t("ul",null,[a[123]||(a[123]=t("li",null,"Critic：使用RM去做ValuePretrain，50个step。",-1)),t("li",null,[a[116]||(a[116]=Q("Decoupled-GAE： ")),t("ul",null,[t("li",null,[t("mjx-container",T1,[(e(),l("svg",l1,a[109]||(a[109]=[T("",1)]))),a[110]||(a[110]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"λ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"critic")])]),t("mo",null,"="),t("mn",null,"1.0")])],-1))])]),t("li",null,[t("mjx-container",e1,[(e(),l("svg",s1,a[111]||(a[111]=[T("",1)]))),a[112]||(a[112]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"λ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"policy")])]),t("mo",null,"="),t("mn",null,"1"),t("mo",null,"−"),t("mfrac",null,[t("mn",null,"1"),t("mrow",null,[t("mi",null,"α"),t("mi",null,"l")])])])],-1))]),a[115]||(a[115]=Q("，")),t("mjx-container",m1,[(e(),l("svg",o1,a[113]||(a[113]=[T("",1)]))),a[114]||(a[114]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"α"),t("mo",null,"="),t("mn",null,"0.5")])],-1))])])])]),t("li",null,[a[121]||(a[121]=Q("Clip-Higher：")),t("mjx-container",d1,[(e(),l("svg",n1,a[117]||(a[117]=[T("",1)]))),a[118]||(a[118]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"ϵ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"high")])]),t("mo",null,"="),t("mn",null,"0.28")])],-1))]),a[122]||(a[122]=Q("，")),t("mjx-container",r1,[(e(),l("svg",i1,a[119]||(a[119]=[T("",1)]))),a[120]||(a[120]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"ϵ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"low")])]),t("mo",null,"="),t("mn",null,"0.2")])],-1))])]),a[124]||(a[124]=t("li",null,"Token-Level Loss",-1)),a[125]||(a[125]=t("li",null,"正样本 LM Loss",-1)),a[126]||(a[126]=t("li",null,"bs=512个prompt，rollout 16次，mini-bs=512",-1))])]),a[258]||(a[258]=T("",19)),t("div",h1,[a[178]||(a[178]=T("",6)),t("ul",null,[t("li",null,[a[150]||(a[150]=t("p",null,[t("strong",null,"打分偏差")],-1)),t("ul",null,[t("li",null,[a[131]||(a[131]=Q("对")),a[132]||(a[132]=t("code",null,"靠前的、更不完整的句子",-1)),a[133]||(a[133]=Q("状态，")),t("mjx-container",g1,[(e(),l("svg",p1,a[129]||(a[129]=[T("",1)]))),a[130]||(a[130]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"V"),t("mo",{stretchy:"false"},"("),t("mi",null,"s"),t("mo",{stretchy:"false"},")")])],-1))]),a[134]||(a[134]=Q()),a[135]||(a[135]=t("code",null,"打低分",-1)),a[136]||(a[136]=Q("。"))]),t("li",null,[a[139]||(a[139]=Q("随着")),a[140]||(a[140]=t("code",null,"句子变长、越来越完整",-1)),a[141]||(a[141]=Q("，")),t("mjx-container",H1,[(e(),l("svg",c1,a[137]||(a[137]=[T("",1)]))),a[138]||(a[138]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"V"),t("mo",{stretchy:"false"},"("),t("mi",null,"s"),t("mo",{stretchy:"false"},")")])],-1))]),a[142]||(a[142]=Q("逐渐")),a[143]||(a[143]=t("code",null,"打高分",-1)),a[144]||(a[144]=Q("。"))]),t("li",null,[a[147]||(a[147]=Q("对")),a[148]||(a[148]=t("strong",null,"任意时刻t",-1)),a[149]||(a[149]=Q("，都有")),t("mjx-container",u1,[(e(),l("svg",x1,a[145]||(a[145]=[T("",1)]))),a[146]||(a[146]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mstyle",{mathcolor:"red"},[t("mi",null,"V"),t("mo",{stretchy:"false"},"("),t("mi",null,"s"),t("mo",{stretchy:"false"},")"),t("mo",null,"<"),t("mi",null,"V"),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"s"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"+"),t("mn",null,"1")])]),t("mo",{stretchy:"false"},")")])])],-1))])])])]),a[151]||(a[151]=t("li",null,[t("p",null,[t("strong",null,"优势偏差")]),t("ul",null,[t("li",null,[Q("初期训练阶段，几乎没有KL惩罚，"),t("strong",null,"奖励为0"),Q("，"),t("strong",null,"TD Error 恒大于0"),Q("，导致"),t("code",null,"优势恒大于0"),Q("。")])])],-1))]),t("mjx-container",L1,[(e(),l("svg",w1,a[152]||(a[152]=[T("",1)]))),a[153]||(a[153]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"A"),t("mo",{stretchy:"false"},"^")])]),t("mi",null,"t")])]),t("mo",null,"≈"),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"l"),t("mo",null,"="),t("mn",null,"0")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"T"),t("mo",null,"−"),t("mi",null,"t"),t("mo",null,"−"),t("mn",null,"1")])]),t("mstyle",{mathcolor:"blue"},[t("msup",null,[t("mi",null,"λ"),t("mi",null,"l")])]),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mi",null,"δ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"+"),t("mi",null,"l")])])]),t("mo",null,"="),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"l"),t("mo",null,"="),t("mn",null,"0")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"T"),t("mo",null,"−"),t("mi",null,"t"),t("mo",null,"−"),t("mn",null,"1")])]),t("mstyle",{mathcolor:"blue"},[t("msup",null,[t("mi",null,"λ"),t("mi",null,"l")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"1.2em",maxsize:"1.2em"},"(")]),t("mstyle",{mathcolor:"blue"},[t("munder",null,[t("mrow",{"data-mjx-texclass":"OP"},[t("munder",null,[t("msub",null,[t("mi",null,"r"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"+"),t("mi",null,"l")])]),t("mo",null,"⏟")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"normal"},"初"),t("mi",{mathvariant:"normal"},"期"),t("mi",{mathvariant:"normal"},"为"),t("mn",null,"0")])])]),t("mo",null,"+"),t("mstyle",{mathcolor:"red"},[t("munder",null,[t("mrow",{"data-mjx-texclass":"OP"},[t("munder",null,[t("mrow",null,[t("mi",null,"V"),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"s"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"+"),t("mi",null,"l"),t("mo",null,"+"),t("mn",null,"1")])]),t("mo",{stretchy:"false"},")"),t("mo",null,"−"),t("mi",null,"V"),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"s"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"+"),t("mi",null,"l")])]),t("mo",{stretchy:"false"},")")]),t("mo",null,"⏟")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"normal"},"初"),t("mi",{mathvariant:"normal"},"期"),t("mo",null,">"),t("mn",null,"0")])])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"1.2em",maxsize:"1.2em"},")")]),t("mo",{stretchy:"false"},"⇒"),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"A"),t("mo",{stretchy:"false"},"^")])]),t("mi",null,"t")])]),t("mstyle",{mathcolor:"blue"},[t("mo",null,">"),t("mn",null,"0")])])],-1))]),t("ul",null,[t("li",null,[t("p",null,[t("mjx-container",f1,[(e(),l("svg",V1,a[154]||(a[154]=[T("",1)]))),a[155]||(a[155]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"A"),t("mi",null,"t")])])],-1))]),a[156]||(a[156]=Q("是后面多个TD Error的加权求和，")),a[157]||(a[157]=t("code",null,"由于TD Error恒大于0",-1))]),t("ul",null,[t("li",null,[a[160]||(a[160]=t("code",null,"Token越靠前",-1)),a[161]||(a[161]=Q("，累加正项越多，其")),a[162]||(a[162]=t("code",null,"最终优势值",-1)),a[163]||(a[163]=Q()),t("mjx-container",y1,[(e(),l("svg",k1,a[158]||(a[158]=[T("",1)]))),a[159]||(a[159]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"A"),t("mo",{stretchy:"false"},"^")])]),t("mi",null,"t")])])])],-1))]),a[164]||(a[164]=t("code",null,"就越大",-1)),a[165]||(a[165]=Q("。"))])]),t("mjx-container",M1,[(e(),l("svg",Z1,a[166]||(a[166]=[T("",1)]))),a[167]||(a[167]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"A"),t("mo",{stretchy:"false"},"^")])]),t("mi",null,"t")])]),t("mo",null,"="),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",null,"δ"),t("mi",null,"t")])]),t("mo",null,"+"),t("mstyle",{mathcolor:"blue"},[t("mi",null,"λ")]),t("mo",null,"⋅"),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"A"),t("mo",{stretchy:"false"},"^")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"+"),t("mn",null,"1")])])])])],-1))])])]),a[179]||(a[179]=t("p",null,[t("strong",null,"若TD大于0，越靠前的token，优势值越大，证明过程")],-1)),a[180]||(a[180]=t("ul",null,[t("li",null,"优势值缓慢递减")],-1)),t("mjx-container",b1,[(e(),l("svg",D1,a[168]||(a[168]=[T("",1)]))),a[169]||(a[169]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",null,"δ"),t("mi",null,"t")])]),t("mo",null,">"),t("mn",null,"0"),t("mo",{stretchy:"false"},"⇒"),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"A"),t("mo",{stretchy:"false"},"^")])]),t("mi",null,"t")])]),t("mo",null,">"),t("mstyle",{mathcolor:"blue"},[t("mi",null,"λ")]),t("mo",null,"⋅"),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"A"),t("mo",{stretchy:"false"},"^")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"+"),t("mn",null,"1")])])])])],-1))]),t("mjx-container",v1,[(e(),l("svg",A1,a[170]||(a[170]=[T("",1)]))),a[171]||(a[171]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"A"),t("mo",{stretchy:"false"},"^")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t")])])]),t("mo",null,">"),t("mstyle",{mathcolor:"blue"},[t("mi",null,"λ")]),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"A"),t("mo",{stretchy:"false"},"^")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"+"),t("mn",null,"1")])])]),t("mo",null,">"),t("mstyle",{mathcolor:"blue"},[t("msup",null,[t("mi",null,"λ"),t("mn",null,"2")])]),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"A"),t("mo",{stretchy:"false"},"^")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"+"),t("mn",null,"2")])])]),t("mo",null,">"),t("mstyle",{mathcolor:"blue"},[t("msup",null,[t("mi",null,"λ"),t("mn",null,"3")])]),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"A"),t("mo",{stretchy:"false"},"^")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"+"),t("mn",null,"3")])])]),t("mo",null,">"),t("mo",null,"⋯"),t("mo",null,">"),t("mstyle",{mathcolor:"blue"},[t("msup",null,[t("mi",null,"λ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"T"),t("mo",null,"−"),t("mi",null,"t"),t("mo",null,"−"),t("mn",null,"1")])])]),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"A"),t("mo",{stretchy:"false"},"^")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"T"),t("mo",null,"−"),t("mn",null,"1")])])])])],-1))]),t("ul",null,[t("li",null,[t("p",null,[a[174]||(a[174]=Q("令")),t("mjx-container",j1,[(e(),l("svg",_1,a[172]||(a[172]=[T("",1)]))),a[173]||(a[173]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"δ"),t("mi",null,"t")]),t("mo",null,"≈"),t("mi",null,"c"),t("mo",null,">"),t("mn",null,"0")])],-1))])]),t("mjx-container",C1,[(e(),l("svg",O1,a[175]||(a[175]=[T("",1)]))),a[176]||(a[176]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"A"),t("mo",{stretchy:"false"},"^")])]),t("mi",null,"t")])]),t("mo",null,"="),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"l"),t("mo",null,"="),t("mn",null,"0")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"T"),t("mo",null,"−"),t("mi",null,"t"),t("mo",null,"−"),t("mn",null,"1")])]),t("mstyle",{mathcolor:"blue"},[t("msup",null,[t("mi",null,"λ"),t("mi",null,"l")])]),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mi",null,"δ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"+"),t("mi",null,"l")])])]),t("mo",null,"="),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"l"),t("mo",null,"="),t("mn",null,"0")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"T"),t("mo",null,"−"),t("mi",null,"t"),t("mo",null,"−"),t("mn",null,"1")])]),t("mstyle",{mathcolor:"blue"},[t("msup",null,[t("mi",null,"λ"),t("mi",null,"l")])]),t("mstyle",{mathcolor:"red"},[t("mi",null,"c")]),t("mo",null,"="),t("mstyle",{mathcolor:"red"},[t("mi",null,"c")]),t("mo",null,"⋅"),t("mfrac",null,[t("mrow",null,[t("mn",null,"1"),t("mo",null,"−"),t("mstyle",{mathcolor:"blue"},[t("msup",null,[t("mi",null,"λ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"T"),t("mo",null,"−"),t("mi",null,"t")])])])]),t("mrow",null,[t("mn",null,"1"),t("mo",null,"−"),t("mi",null,"λ")])])])],-1))])]),a[177]||(a[177]=t("li",null,[t("p",null,[Q("从公式可以看出，"),t("code",null,"t越靠前"),Q("，"),t("code",null,"优势值越大"),Q("。")])],-1))])]),a[259]||(a[259]=t("p",null,"如下图所示，前面的token价值小、后面的token价值大，TDError>0，最终导致前面的token优势大，最后导致模型回复长度急剧缩短。",-1)),a[260]||(a[260]=t("img",{src:"https://picx.zhimg.com/v2-46fa27fd61b9bc544197731933475947_r.jpg",style:{display:"block",margin:"auto"},width:"70%"},null,-1)),a[261]||(a[261]=t("h4",{id:"gae-奖励信号衰减",tabindex:"-1"},[Q("GAE 奖励信号衰减 "),t("a",{class:"header-anchor",href:"#gae-奖励信号衰减","aria-label":'Permalink to "GAE 奖励信号衰减"'},"​")],-1)),t("div",R1,[a[202]||(a[202]=t("div",{class:"custom-block-title"},"奖励信号衰减",-1)),a[203]||(a[203]=t("p",null,[Q("更多详细推导见 "),t("a",{href:"http://plmsmile.github.io/posts/llm/rl/theory/09-policy-trpo-ppo.html#gae%E4%B8%AD%E7%9A%84%E5%A5%96%E5%8A%B1%E8%A1%B0%E5%87%8F-llm",target:"_blank",rel:"noreferrer"},"GAE 奖励信号衰减")],-1)),a[204]||(a[204]=t("p",null,[t("strong",null,"背景")],-1)),t("ul",null,[t("li",null,[a[183]||(a[183]=Q("在LLM中，中间token奖励为0、")),a[184]||(a[184]=t("code",null,"仅最后1个token有环境奖励信号",-1)),a[185]||(a[185]=Q()),t("mjx-container",E1,[(e(),l("svg",P1,a[181]||(a[181]=[T("",1)]))),a[182]||(a[182]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mi",null,"r"),t("mi",null,"T")])])])],-1))]),a[186]||(a[186]=Q("。"))]),t("li",null,[a[191]||(a[191]=Q("当")),a[192]||(a[192]=t("code",null,"真实外部信号",-1)),t("mjx-container",S1,[(e(),l("svg",B1,a[187]||(a[187]=[T("",1)]))),a[188]||(a[188]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"r"),t("mi",null,"T")])])],-1))]),a[193]||(a[193]=Q()),a[194]||(a[194]=t("code",null,"传递回第t个token时",-1)),a[195]||(a[195]=Q("，会")),a[196]||(a[196]=t("code",null,"乘以权重",-1)),t("mjx-container",X1,[(e(),l("svg",z1,a[189]||(a[189]=[T("",1)]))),a[190]||(a[190]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mstyle",{mathcolor:"blue"},[t("mo",{stretchy:"false"},"("),t("mi",null,"λ"),t("mi",null,"γ"),t("msup",null,[t("mo",{stretchy:"false"},")"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"T"),t("mo",null,"−"),t("mi",null,"t")])]),t("mo",null,","),t("mo",{stretchy:"false"},"("),t("mi",null,"λ"),t("msup",null,[t("mo",{stretchy:"false"},")"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"T"),t("mo",null,"−"),t("mi",null,"t")])])])])],-1))]),a[197]||(a[197]=Q(" ，")),a[198]||(a[198]=t("code",null,"权重容易变成0",-1)),a[199]||(a[199]=Q("。"))])]),t("mjx-container",I1,[(e(),l("svg",F1,a[200]||(a[200]=[T("",1)]))),a[201]||(a[201]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"A"),t("mo",{stretchy:"false"},"^")])]),t("mi",null,"t")])]),t("mo",null,"="),t("munder",null,[t("mrow",{"data-mjx-texclass":"OP"},[t("munder",null,[t("mrow",null,[t("mstyle",{mathcolor:"blue"},[t("mo",{stretchy:"false"},"("),t("mi",null,"λ"),t("mi",null,"γ"),t("msup",null,[t("mo",{stretchy:"false"},")"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"T"),t("mo",null,"−"),t("mi",null,"t")])])]),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mi",null,"r"),t("mi",null,"T")])])]),t("mo",null,"⏟")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mstyle",{mathcolor:"red"},[t("mi",{mathvariant:"normal"},"真"),t("mi",{mathvariant:"normal"},"实"),t("mi",{mathvariant:"normal"},"奖"),t("mi",{mathvariant:"normal"},"励"),t("mi",{mathvariant:"normal"},"信"),t("mi",{mathvariant:"normal"},"号")])])]),t("mo",null,"+"),t("munder",null,[t("mrow",{"data-mjx-texclass":"OP"},[t("munder",null,[t("mrow",null,[t("mo",{stretchy:"false"},"("),t("mtext",null,"一堆只包含"),t("mi",null,"V"),t("mo",{stretchy:"false"},"("),t("mi",null,"s"),t("mo",{stretchy:"false"},")"),t("mtext",null,"的项"),t("mo",{stretchy:"false"},")")]),t("mo",null,"⏟")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mstyle",{mathcolor:"blue"},[t("mi",{mathvariant:"normal"},"来"),t("mi",{mathvariant:"normal"},"自"),t("mi",{mathvariant:"normal"},"价"),t("mi",{mathvariant:"normal"},"值"),t("mi",{mathvariant:"normal"},"函"),t("mi",{mathvariant:"normal"},"数"),t("mi",{mathvariant:"normal"},"估"),t("mi",{mathvariant:"normal"},"计"),t("mi",{mathvariant:"normal"},"的"),t("mi",{mathvariant:"normal"},"信"),t("mi",{mathvariant:"normal"},"号")])])])])],-1))]),a[205]||(a[205]=T("",2))]),a[262]||(a[262]=T("",5)),t("div",G1,[a[237]||(a[237]=t("div",{class:"custom-block-title"},"Value Pretrain 解决价值偏差",-1)),a[238]||(a[238]=t("p",null,[t("strong",null,"解决问题")],-1)),a[239]||(a[239]=t("ul",null,[t("li",null,"RM初始化Critic带来的价值偏差、λ<1时带来的奖励信号衰减问题。")],-1)),a[240]||(a[240]=t("p",null,[t("strong",null,"核心思想")],-1)),t("ul",null,[t("li",null,[a[208]||(a[208]=t("strong",null,"在正式PPO之前",-1)),a[209]||(a[209]=Q("，")),a[210]||(a[210]=t("strong",null,"固定策略",-1)),a[211]||(a[211]=Q("，使用 ")),t("strong",null,[t("mjx-container",N1,[(e(),l("svg",q1,a[206]||(a[206]=[T("",1)]))),a[207]||(a[207]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"λ"),t("mo",null,"="),t("mn",null,"1")])],-1))])]),a[212]||(a[212]=Q("，")),a[213]||(a[213]=t("strong",null,"对Critic做一次预训练",-1)),a[214]||(a[214]=Q("。"))]),a[215]||(a[215]=t("li",null,[Q("通过"),t("code",null,"固定策略+MC回报"),Q("，"),t("a",{href:"https://plmsmile.github.io/posts/llm/rl/theory/09-policy-trpo-ppo.html#critic-%E5%AD%A6%E4%B9%A0%E8%BF%87%E7%A8%8B",target:"_blank",rel:"noreferrer"},"把价值模型的学习"),t("code",null,"从不稳定的RL过程"),Q("变成 "),t("code",null,"稳定的监督学习过程"),Q("。")],-1))]),a[241]||(a[241]=t("p",null,[t("strong",null,"具体做法")],-1)),t("ul",null,[t("li",null,[t("p",null,[a[218]||(a[218]=t("code",null,"固定策略模型",-1)),a[219]||(a[219]=Q("(如")),t("mjx-container",J1,[(e(),l("svg",$1,a[216]||(a[216]=[T("",1)]))),a[217]||(a[217]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"sft")])])])])],-1))]),a[220]||(a[220]=Q(")，使用")),a[221]||(a[221]=t("code",null,"GAE",-1)),a[222]||(a[222]=Q(" + ")),a[223]||(a[223]=t("code",null,"λ=1",-1)),a[224]||(a[224]=Q("退成")),a[225]||(a[225]=t("code",null,"MC采样",-1)),a[226]||(a[226]=Q("，得到稳定梯度信号。"))])]),t("li",null,[a[235]||(a[235]=t("p",null,[t("code",null,"单独训练Critic模型"),Q("，使其"),t("code",null,"准确预测回报"),Q("，直到收敛，"),t("strong",null,"看2个指标")],-1)),t("ul",null,[a[234]||(a[234]=t("li",null,[t("p",null,[t("strong",null,"Value Loss"),Q("："),t("code",null,"预测价值和真实奖励之间的差距")])],-1)),t("li",null,[a[231]||(a[231]=t("p",null,[t("strong",null,"Explained Variance/解释方差"),Q("：衡量"),t("code",null,"预测趋势和真实趋势"),Q("的匹配程度。")],-1)),a[232]||(a[232]=t("ul",null,[t("li",null,[t("code",null,"预测误差的方差"),Q("除以"),t("code",null,"真实方差"),Q("。预测误差的方差：还剩下多少无法解释的波动性。")])],-1)),t("mjx-container",Y1,[(e(),l("svg",K1,a[227]||(a[227]=[T("",1)]))),a[228]||(a[228]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("mtext",null,"Explaned Variance")]),t("mo",null,"="),t("mn",null,"1"),t("mo",null,"−"),t("mfrac",null,[t("mstyle",{mathcolor:"red"},[t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"Var"),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"Y"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"g"),t("mi",null,"o"),t("mi",null,"l"),t("mi",null,"d")])]),t("mo",null,"−"),t("msub",null,[t("mi",null,"Y"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"p"),t("mi",null,"r"),t("mi",null,"e"),t("mi",null,"d")])]),t("mo",{stretchy:"false"},")")])]),t("mstyle",{mathcolor:"blue"},[t("mtext",null,"Var"),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"Y"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"g"),t("mi",null,"o"),t("mi",null,"l"),t("mi",null,"d")])]),t("mo",{stretchy:"false"},")")])]),t("mstyle",{scriptlevel:"0"},[t("mspace",{width:"1em"})]),t("mo",null,"∈"),t("mstyle",{scriptlevel:"0"},[t("mspace",{width:"0.278em"})]),t("mstyle",{mathcolor:"blue"},[t("mo",{stretchy:"false"},"("),t("mo",null,"−"),t("mi",{mathvariant:"normal"},"∞"),t("mo",null,","),t("mn",null,"1"),t("mo",{stretchy:"false"},"]")])])],-1))]),t("mjx-container",W1,[(e(),l("svg",U1,a[229]||(a[229]=[T("",1)]))),a[230]||(a[230]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("mi",{mathvariant:"normal"},"解"),t("mi",{mathvariant:"normal"},"释"),t("mi",{mathvariant:"normal"},"方"),t("mi",{mathvariant:"normal"},"差")]),t("mo",null,"="),t("mn",null,"1"),t("mo",null,"−"),t("mstyle",{mathcolor:"red"},[t("mi",{mathvariant:"normal"},"无"),t("mi",{mathvariant:"normal"},"法"),t("mi",{mathvariant:"normal"},"解"),t("mi",{mathvariant:"normal"},"释"),t("mi",{mathvariant:"normal"},"方"),t("mi",{mathvariant:"normal"},"差"),t("mi",{mathvariant:"normal"},"占"),t("mi",{mathvariant:"normal"},"总"),t("mi",{mathvariant:"normal"},"方"),t("mi",{mathvariant:"normal"},"差"),t("mi",{mathvariant:"normal"},"的"),t("mi",{mathvariant:"normal"},"比"),t("mi",{mathvariant:"normal"},"例")])])],-1))]),a[233]||(a[233]=t("ul",null,[t("li",null,"接近1：最好情况，模型几乎解释了所有的数据波动。"),t("li",null,"接近0：模型和简单预测所有结果的平均值差不多。"),t("li",null,"负数：模型还不如直接预测平均值，预测甚至是有害的，预测趋势是相反的。")],-1))])])]),a[236]||(a[236]=t("li",null,[t("p",null,[t("strong",null,"正式PPO时"),Q("，"),t("code",null,"使用预训练过的Critic模型"),Q("，而不再使用RM做随机初始化。")])],-1))])]),a[263]||(a[263]=T("",9)),t("div",t2,[a[251]||(a[251]=T("",6)),t("ul",null,[a[249]||(a[249]=t("li",null,[Q("冷启动：使用一些推理数据，来冷启动训练模型，使得按照 "),t("code",null,"<think></think>"),Q("格式输出")],-1)),a[250]||(a[250]=t("li",null,"Value Pretraining：λ=1，Freeze Policy，其他参数同标准PPO。",-1)),t("li",null,[a[246]||(a[246]=Q("Decoupled-GAE：")),t("mjx-container",a2,[(e(),l("svg",Q2,a[242]||(a[242]=[T("",1)]))),a[243]||(a[243]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"λ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"c"),t("mi",null,"r"),t("mi",null,"i"),t("mi",null,"t"),t("mi",null,"i"),t("mi",null,"c")])]),t("mo",null,"="),t("mn",null,"1")])],-1))]),a[247]||(a[247]=Q("， ")),t("mjx-container",T2,[(e(),l("svg",l2,a[244]||(a[244]=[T("",1)]))),a[245]||(a[245]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"λ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"a"),t("mi",null,"c"),t("mi",null,"t"),t("mi",null,"o"),t("mi",null,"r")])]),t("mo",null,"="),t("mn",null,"0.95")])],-1))]),a[248]||(a[248]=Q("。作者也研究了0.9-1.0参数。"))])]),a[252]||(a[252]=T("",4))]),a[264]||(a[264]=T("",13))])}const h2=s(m,[["render",e2]]);export{i2 as __pageData,h2 as default};

import{_ as s,c as l,o as e,ah as T,j as t,a}from"./chunks/framework.CvbyeFFO.js";const E2=JSON.parse('{"title":"PPO 改进系列","description":"","frontmatter":{"title":"PPO 改进系列","date":"2025-09-22T19:37:35.000Z","create":"2025-09-22T19:37:35.000Z","categories":["ppo"],"tags":["ppo","vc-ppo","vapo","价值偏差","长度不一","奖励稀疏","GAE奖励信号衰减","价值预训练","Decoupled-GAE","长度自适应GAE","Token-level Policy","Clip-Higher","正样本LM Loss","分组采样","RLOO","REINFORCE++"]},"headers":[],"relativePath":"posts/llm/rl/theory/10-ppo-series.md","filePath":"posts/llm/rl/theory/10-ppo-series.md","lastUpdated":1762874850000}'),m={name:"posts/llm/rl/theory/10-ppo-series.md"},d={class:"custom-block warning"},o={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},r={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.027ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.455ex",height:"1.931ex",role:"img",focusable:"false",viewBox:"0 -841.7 1969.2 853.7","aria-hidden":"true"},n={class:"custom-block tip"},i={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},h={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.22ex",height:"1.332ex",role:"img",focusable:"false",viewBox:"0 -431 1423 588.8","aria-hidden":"true"},g={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},p={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.186ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.467ex",height:"1.756ex",role:"img",focusable:"false",viewBox:"0 -694 2416.6 776","aria-hidden":"true"},H={class:"custom-block tip"},c={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},u={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.186ex"},xmlns:"http://www.w3.org/2000/svg",width:"16.541ex",height:"2.14ex",role:"img",focusable:"false",viewBox:"0 -864 7311.2 946","aria-hidden":"true"},L={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},x={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.819ex"},xmlns:"http://www.w3.org/2000/svg",width:"46.63ex",height:"6.354ex",role:"img",focusable:"false",viewBox:"0 -1562.5 20610.4 2808.5","aria-hidden":"true"},f={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},w={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.819ex"},xmlns:"http://www.w3.org/2000/svg",width:"29.609ex",height:"6.354ex",role:"img",focusable:"false",viewBox:"0 -1562.5 13087 2808.5","aria-hidden":"true"},V={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},y={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.027ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.319ex",height:"1.597ex",role:"img",focusable:"false",viewBox:"0 -694 583 706","aria-hidden":"true"},k={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},M={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-1.577ex"},xmlns:"http://www.w3.org/2000/svg",width:"17.307ex",height:"4.613ex",role:"img",focusable:"false",viewBox:"0 -1342 7649.6 2039","aria-hidden":"true"},Z={class:"custom-block tip"},b={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},D={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-6.345ex"},xmlns:"http://www.w3.org/2000/svg",width:"99.809ex",height:"10.57ex",role:"img",focusable:"false",viewBox:"0 -1867.4 44115.7 4672.1","aria-hidden":"true"},v={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},j={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-6.42ex"},xmlns:"http://www.w3.org/2000/svg",width:"102.895ex",height:"10.645ex",role:"img",focusable:"false",viewBox:"0 -1867.4 45479.7 4705.1","aria-hidden":"true"},A={class:"custom-block tip"},R={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},O={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"11.895ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 5257.6 1000","aria-hidden":"true"},_={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},C={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.186ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.815ex",height:"1.692ex",role:"img",focusable:"false",viewBox:"0 -666 2128.4 748","aria-hidden":"true"},E={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},P={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.667ex"},xmlns:"http://www.w3.org/2000/svg",width:"17.827ex",height:"2.364ex",role:"img",focusable:"false",viewBox:"0 -750 7879.3 1045","aria-hidden":"true"},S={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},B={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.669ex"},xmlns:"http://www.w3.org/2000/svg",width:"11.17ex",height:"2.176ex",role:"img",focusable:"false",viewBox:"0 -666 4937 961.7","aria-hidden":"true"},X={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},z={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"9.415ex",height:"1.864ex",role:"img",focusable:"false",viewBox:"0 -666 4161.2 823.8","aria-hidden":"true"},I={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},F={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.506ex",height:"1.332ex",role:"img",focusable:"false",viewBox:"0 -431 1549.7 588.8","aria-hidden":"true"},G={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},N={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-6.42ex"},xmlns:"http://www.w3.org/2000/svg",width:"84.93ex",height:"10.645ex",role:"img",focusable:"false",viewBox:"0 -1867.4 37538.8 4705.1","aria-hidden":"true"},q={class:"custom-block tip"},J={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},K={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.65ex"},xmlns:"http://www.w3.org/2000/svg",width:"28.083ex",height:"2.347ex",role:"img",focusable:"false",viewBox:"0 -750 12412.5 1037.2","aria-hidden":"true"},$={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},Y={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-4.215ex"},xmlns:"http://www.w3.org/2000/svg",width:"44.617ex",height:"8.44ex",role:"img",focusable:"false",viewBox:"0 -1867.4 19720.7 3730.5","aria-hidden":"true"},W={class:"custom-block tip"},U={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},t1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.489ex"},xmlns:"http://www.w3.org/2000/svg",width:"15.371ex",height:"2.059ex",role:"img",focusable:"false",viewBox:"0 -694 6793.8 910","aria-hidden":"true"},Q1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},a1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.186ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.827ex",height:"1.692ex",role:"img",focusable:"false",viewBox:"0 -666 3017.6 748","aria-hidden":"true"},T1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},l1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"10.975ex",height:"1.927ex",role:"img",focusable:"false",viewBox:"0 -694 4850.9 851.8","aria-hidden":"true"},e1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},s1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.798ex"},xmlns:"http://www.w3.org/2000/svg",width:"15.051ex",height:"2.755ex",role:"img",focusable:"false",viewBox:"0 -864.9 6652.4 1217.7","aria-hidden":"true"},m1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},d1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.186ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.356ex",height:"1.692ex",role:"img",focusable:"false",viewBox:"0 -666 3251.6 748","aria-hidden":"true"},o1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},r1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.669ex"},xmlns:"http://www.w3.org/2000/svg",width:"11.17ex",height:"2.176ex",role:"img",focusable:"false",viewBox:"0 -666 4937 961.7","aria-hidden":"true"},n1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},i1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"9.415ex",height:"1.864ex",role:"img",focusable:"false",viewBox:"0 -666 4161.2 823.8","aria-hidden":"true"},h1={class:"custom-block warning"},g1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},p1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.561ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2016 1000","aria-hidden":"true"},H1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},c1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.561ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2016 1000","aria-hidden":"true"},u1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},L1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"14.949ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 6607.5 1000","aria-hidden":"true"},x1={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},f1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-4.092ex"},xmlns:"http://www.w3.org/2000/svg",width:"66.168ex",height:"8.003ex",role:"img",focusable:"false",viewBox:"0 -1728.7 29246.1 3537.5","aria-hidden":"true"},w1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},V1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.462ex",height:"1.977ex",role:"img",focusable:"false",viewBox:"0 -716 1088.3 873.8","aria-hidden":"true"},y1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},k1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.462ex",height:"2.809ex",role:"img",focusable:"false",viewBox:"0 -1084 1088.3 1241.8","aria-hidden":"true"},M1={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},Z1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.471ex"},xmlns:"http://www.w3.org/2000/svg",width:"17.475ex",height:"2.923ex",role:"img",focusable:"false",viewBox:"0 -1084 7723.9 1292","aria-hidden":"true"},b1={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},D1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.471ex"},xmlns:"http://www.w3.org/2000/svg",width:"22.377ex",height:"2.923ex",role:"img",focusable:"false",viewBox:"0 -1084 9890.6 1292","aria-hidden":"true"},v1={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},j1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.471ex"},xmlns:"http://www.w3.org/2000/svg",width:"51.207ex",height:"2.923ex",role:"img",focusable:"false",viewBox:"0 -1084 22633.4 1292","aria-hidden":"true"},A1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},R1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"9.915ex",height:"1.979ex",role:"img",focusable:"false",viewBox:"0 -717 4382.4 874.8","aria-hidden":"true"},O1={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},_1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.864ex"},xmlns:"http://www.w3.org/2000/svg",width:"42.653ex",height:"6.775ex",role:"img",focusable:"false",viewBox:"0 -1728.7 18852.7 2994.4","aria-hidden":"true"},C1={class:"custom-block warning"},E1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},P1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.339ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.334ex",height:"1.339ex",role:"img",focusable:"false",viewBox:"0 -442 1031.8 592","aria-hidden":"true"},S1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},B1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.339ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.334ex",height:"1.339ex",role:"img",focusable:"false",viewBox:"0 -442 1031.8 592","aria-hidden":"true"},X1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},z1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"14.665ex",height:"2.47ex",role:"img",focusable:"false",viewBox:"0 -841.7 6482.1 1091.7","aria-hidden":"true"},I1={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},F1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-4.092ex"},xmlns:"http://www.w3.org/2000/svg",width:"40.182ex",height:"6.545ex",role:"img",focusable:"false",viewBox:"0 -1084 17760.3 2892.8","aria-hidden":"true"},G1={class:"custom-block tip"},N1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},q1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.186ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.467ex",height:"1.756ex",role:"img",focusable:"false",viewBox:"0 -694 2416.6 776","aria-hidden":"true"},J1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},K1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.22ex",height:"1.332ex",role:"img",focusable:"false",viewBox:"0 -431 1423 588.8","aria-hidden":"true"},$1={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},Y1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.274ex"},xmlns:"http://www.w3.org/2000/svg",width:"57.014ex",height:"5.679ex",role:"img",focusable:"false",viewBox:"0 -1505 25200.1 2509.9","aria-hidden":"true"},W1={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},U1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.452ex"},xmlns:"http://www.w3.org/2000/svg",width:"45.376ex",height:"2.149ex",role:"img",focusable:"false",viewBox:"0 -750 20056 950","aria-hidden":"true"},t2={class:"custom-block tip"},Q2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},a2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"9.443ex",height:"1.927ex",role:"img",focusable:"false",viewBox:"0 -694 4174 851.8","aria-hidden":"true"},T2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},l2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"12.16ex",height:"1.927ex",role:"img",focusable:"false",viewBox:"0 -694 5374.9 851.8","aria-hidden":"true"},e2={class:"custom-block tip"},s2={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},m2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-6.345ex"},xmlns:"http://www.w3.org/2000/svg",width:"99.809ex",height:"10.57ex",role:"img",focusable:"false",viewBox:"0 -1867.4 44115.7 4672.1","aria-hidden":"true"},d2={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},o2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.811ex"},xmlns:"http://www.w3.org/2000/svg",width:"72.283ex",height:"6.722ex",role:"img",focusable:"false",viewBox:"0 -1728.7 31949.1 2971.1","aria-hidden":"true"},r2={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},n2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.172ex"},xmlns:"http://www.w3.org/2000/svg",width:"36.365ex",height:"6.315ex",role:"img",focusable:"false",viewBox:"0 -1831.2 16073.3 2791.2","aria-hidden":"true"},i2={class:"custom-block note"},h2={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},g2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.811ex"},xmlns:"http://www.w3.org/2000/svg",width:"33.801ex",height:"6.722ex",role:"img",focusable:"false",viewBox:"0 -1728.7 14939.9 2971.1","aria-hidden":"true"},p2={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},H2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.869ex"},xmlns:"http://www.w3.org/2000/svg",width:"30.203ex",height:"2.699ex",role:"img",focusable:"false",viewBox:"0 -809 13349.5 1193.2","aria-hidden":"true"},c2={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},u2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.476ex"},xmlns:"http://www.w3.org/2000/svg",width:"32.214ex",height:"6.103ex",role:"img",focusable:"false",viewBox:"0 -1603.2 14238.7 2697.3","aria-hidden":"true"},L2={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},x2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.592ex"},xmlns:"http://www.w3.org/2000/svg",width:"27.119ex",height:"2.289ex",role:"img",focusable:"false",viewBox:"0 -750 11986.6 1011.6","aria-hidden":"true"},f2={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},w2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.219ex"},xmlns:"http://www.w3.org/2000/svg",width:"18.146ex",height:"5.256ex",role:"img",focusable:"false",viewBox:"0 -1342 8020.7 2323","aria-hidden":"true"},V2={class:"custom-block tip"},y2={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},k2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.148ex"},xmlns:"http://www.w3.org/2000/svg",width:"51.801ex",height:"5.428ex",role:"img",focusable:"false",viewBox:"0 -1449.5 22896 2399","aria-hidden":"true"},M2={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},Z2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.819ex"},xmlns:"http://www.w3.org/2000/svg",width:"56.489ex",height:"7.044ex",role:"img",focusable:"false",viewBox:"0 -1867.4 24968 3113.3","aria-hidden":"true"},b2={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},D2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-3.112ex"},xmlns:"http://www.w3.org/2000/svg",width:"41.176ex",height:"7.067ex",role:"img",focusable:"false",viewBox:"0 -1748.5 18200 3123.8","aria-hidden":"true"};function v2(j2,Q,A2,R2,O2,_2){return e(),l("div",null,[Q[294]||(Q[294]=T("",6)),t("div",d,[Q[8]||(Q[8]=t("div",{class:"custom-block-title"},"价值模型偏差问题",-1)),Q[9]||(Q[9]=t("p",null,[t("strong",null,"1. 价值模型偏差")],-1)),t("ul",null,[Q[7]||(Q[7]=T("",1)),t("li",null,[Q[6]||(Q[6]=t("strong",null,"GAE λ<1时 奖励信号衰减，加剧价值学习难度",-1)),t("ul",null,[t("li",null,[Q[2]||(Q[2]=a("最终环境奖励，传播到第t个token时，衰减因子为")),t("mjx-container",o,[(e(),l("svg",r,Q[0]||(Q[0]=[T("",1)]))),Q[1]||(Q[1]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msup",null,[t("mi",null,"λ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"T"),t("mo",null,"−"),t("mi",null,"t")])])])],-1))]),Q[3]||(Q[3]=a("，"))]),Q[4]||(Q[4]=t("li",null,"T-t很大时，衰减因子几乎为0，无奖励信号",-1)),Q[5]||(Q[5]=t("li",null,"价值模型更新完全依赖自举，难以作为基线，使得训练过程非常不稳定。",-1))])])])]),Q[295]||(Q[295]=T("",10)),t("div",n,[Q[20]||(Q[20]=T("",6)),t("ul",null,[t("li",null,[Q[14]||(Q[14]=a("使用固定策略")),t("mjx-container",i,[(e(),l("svg",h,Q[10]||(Q[10]=[T("",1)]))),Q[11]||(Q[11]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"sft")])])])],-1))]),Q[15]||(Q[15]=a("，生成大量数据；GAE使用")),t("mjx-container",g,[(e(),l("svg",p,Q[12]||(Q[12]=[T("",1)]))),Q[13]||(Q[13]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"λ"),t("mo",null,"="),t("mn",null,"1")])],-1))]),Q[16]||(Q[16]=a("变成无偏MC回报。"))]),Q[17]||(Q[17]=t("li",null,"使用生成数据+MC回报，来训练价值模型。直到收敛，看Value Loss和Explained Variance。",-1)),Q[18]||(Q[18]=t("li",null,"后续PPO使用Value预训练过的模型。",-1)),Q[19]||(Q[19]=t("li",null,[a("具体见 "),t("a",{href:"http://plmsmile.github.io/posts/llm/rl/theory/10-ppo-series.html#valuepretrain-%E4%BB%B7%E5%80%BC%E9%A2%84%E8%AE%AD%E7%BB%83",target:"_blank",rel:"noreferrer"},"VC-PPO 价值预训练")],-1))])]),Q[296]||(Q[296]=T("",4)),t("div",H,[Q[42]||(Q[42]=t("div",{class:"custom-block-title"},"Length-Adaptive GAE",-1)),Q[43]||(Q[43]=t("p",null,[t("strong",null,"目的")],-1)),t("ul",null,[Q[28]||(Q[28]=t("li",null,[t("code",null,"动态调整GAE的λ参数"),a("，"),t("code",null,"适应不同长度"),a("。")],-1)),t("li",null,[Q[25]||(Q[25]=a("如果λ=0.95固定，则存在")),Q[26]||(Q[26]=t("strong",null,"奖励衰减问题",-1)),Q[27]||(Q[27]=a("。 ")),t("ul",null,[t("li",null,[Q[23]||(Q[23]=a("当步数很长l=100时，")),t("mjx-container",c,[(e(),l("svg",u,Q[21]||(Q[21]=[T("",1)]))),Q[22]||(Q[22]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msup",null,[t("mn",null,"0.95"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mn",null,"100")])]),t("mo",null,"≈="),t("mn",null,"0.006")])],-1))]),Q[24]||(Q[24]=a("，奖励信号权重接近0。"))])])])]),Q[44]||(Q[44]=t("p",null,[t("strong",null,"核心思想")],-1)),t("ul",null,[Q[33]||(Q[33]=T("",3)),t("li",null,[Q[31]||(Q[31]=t("p",null,"GAE 权重系数总和",-1)),Q[32]||(Q[32]=t("ul",null,[t("li",null,[t("strong",null,"未来所有奖励信号"),a(),t("code",null,"对当前决策的总影响力"),a("，"),t("a",{href:"https://plmsmile.github.io/posts/llm/rl/theory/04-model-free-prediction-control.html#%CE%BB-%E5%9B%9E%E6%8A%A5",target:"_blank",rel:"noreferrer"},"TD(λ) 权重理解")])],-1)),t("mjx-container",L,[(e(),l("svg",x,Q[29]||(Q[29]=[T("",1)]))),Q[30]||(Q[30]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("munderover",null,[t("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"="),t("mn",null,"0")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"normal"},"∞")])]),t("msubsup",null,[t("mi",null,"λ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"policy")]),t("mi",null,"t")])]),t("mo",null,"="),t("mn",null,"1"),t("mo",null,"+"),t("mi",null,"λ"),t("mo",null,"+"),t("msup",null,[t("mi",null,"λ"),t("mn",null,"2")]),t("mo",null,"+"),t("msup",null,[t("mi",null,"λ"),t("mn",null,"3")]),t("mo",null,"+"),t("mo",null,"⋯"),t("mo",null,"="),t("mfrac",null,[t("mn",null,"1"),t("mstyle",{mathcolor:"blue"},[t("mn",null,"1"),t("mo",null,"−"),t("msub",null,[t("mi",null,"λ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"policy")])])])])])],-1))])])]),Q[45]||(Q[45]=t("p",null,[t("strong",null,"具体做法")],-1)),t("ul",null,[t("li",null,[Q[36]||(Q[36]=t("p",null,[t("code",null,"总影响力"),a("应该"),t("code",null,"与序列长度l成正比")],-1)),t("mjx-container",f,[(e(),l("svg",w,Q[34]||(Q[34]=[T("",1)]))),Q[35]||(Q[35]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("munderover",null,[t("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"="),t("mn",null,"0")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"normal"},"∞")])]),t("msubsup",null,[t("mi",null,"λ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"policy")]),t("mi",null,"t")])]),t("mo",null,"="),t("mfrac",null,[t("mn",null,"1"),t("mstyle",{mathcolor:"blue"},[t("mn",null,"1"),t("mo",null,"−"),t("msub",null,[t("mi",null,"λ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"policy")])])])]),t("mo",null,"="),t("mstyle",{mathcolor:"blue"},[t("mi",null,"α")]),t("mo",null,"⋅"),t("mstyle",{mathcolor:"red"},[t("mi",null,"l")])])],-1))])]),t("li",null,[t("p",null,[t("strong",null,[Q[39]||(Q[39]=a("长度自适应")),t("mjx-container",V,[(e(),l("svg",y,Q[37]||(Q[37]=[t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math"},[t("g",{"data-mml-node":"mi"},[t("path",{"data-c":"1D706",d:"M166 673Q166 685 183 694H202Q292 691 316 644Q322 629 373 486T474 207T524 67Q531 47 537 34T546 15T551 6T555 2T556 -2T550 -11H482Q457 3 450 18T399 152L354 277L340 262Q327 246 293 207T236 141Q211 112 174 69Q123 9 111 -1T83 -12Q47 -12 47 20Q47 37 61 52T199 187Q229 216 266 252T321 306L338 322Q338 323 288 462T234 612Q214 657 183 657Q166 657 166 673Z",style:{"stroke-width":"3"}})])])],-1)]))),Q[38]||(Q[38]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"λ")])],-1))])])]),t("mjx-container",k,[(e(),l("svg",M,Q[40]||(Q[40]=[T("",1)]))),Q[41]||(Q[41]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mi",null,"λ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"policy")])])]),t("mo",null,"="),t("mn",null,"1"),t("mo",null,"−"),t("mfrac",null,[t("mn",null,"1"),t("mrow",null,[t("mstyle",{mathcolor:"blue"},[t("mi",null,"α")]),t("mo",null,"⋅"),t("mstyle",{mathcolor:"red"},[t("mi",null,"l")])])])])],-1))])])])]),t("div",Z,[Q[55]||(Q[55]=T("",3)),t("mjx-container",b,[(e(),l("svg",D,Q[46]||(Q[46]=[T("",1)]))),Q[47]||(Q[47]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{"data-mjx-variant":"-tex-calligraphic",mathvariant:"script"},"L")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"ppo")])]),t("mo",{stretchy:"false"},"("),t("mi",null,"θ"),t("mo",{stretchy:"false"},")")]),t("mo",null,"="),t("mo",null,"−"),t("mstyle",{mathcolor:"blue"},[t("munder",null,[t("mrow",{"data-mjx-texclass":"OP"},[t("munder",null,[t("mrow",null,[t("mfrac",null,[t("mn",null,"1"),t("mi",null,"G")]),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,"="),t("mn",null,"1")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"G")])])]),t("mo",null,"⏟")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"normal"},"样"),t("mi",{mathvariant:"normal"},"本"),t("mi",{mathvariant:"normal"},"间"),t("mi",{mathvariant:"normal"},"平"),t("mi",{mathvariant:"normal"},"均")])])]),t("mstyle",{mathcolor:"red"},[t("munder",null,[t("mrow",{"data-mjx-texclass":"OP"},[t("munder",null,[t("mrow",null,[t("mfrac",null,[t("mn",null,"1"),t("mrow",null,[t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("msub",null,[t("mi",null,"o"),t("mi",null,"i")]),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|")])]),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"="),t("mn",null,"1")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("msub",null,[t("mi",null,"o"),t("mi",null,"t")]),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|")])])]),t("mo",null,"⏟")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"序列内平均")])])]),t("mstyle",{mathcolor:"blue"},[t("mo",{"data-mjx-texclass":"OP",movablelimits:"true"},"min")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"2.047em",maxsize:"2.047em"},"(")]),t("mfrac",null,[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])]),t("mo",null,"∣"),t("mi",null,"q"),t("mo",null,","),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mo",null,"<"),t("mi",null,"t")])]),t("mo",{stretchy:"false"},")")]),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("msub",null,[t("mi",null,"θ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"o"),t("mi",null,"l"),t("mi",null,"d")])])])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])]),t("mo",null,"∣"),t("mi",null,"q"),t("mo",null,","),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mo",null,"<"),t("mi",null,"t")])]),t("mo",{stretchy:"false"},")")])]),t("mo",null,"⋅"),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"A"),t("mo",{stretchy:"false"},"^")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])])]),t("mo",null,","),t("mstyle",{scriptlevel:"0"},[t("mspace",{width:"0.278em"})]),t("mstyle",{mathcolor:"red"},[t("mtext",null,"clip")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"1.2em",maxsize:"1.2em"},"(")]),t("mfrac",null,[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])]),t("mo",null,"∣"),t("mi",null,"q"),t("mo",null,","),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mo",null,"<"),t("mi",null,"t")])]),t("mo",{stretchy:"false"},")")]),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("msub",null,[t("mi",null,"θ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"o"),t("mi",null,"l"),t("mi",null,"d")])])])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])]),t("mo",null,"∣"),t("mi",null,"q"),t("mo",null,","),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mo",null,"<"),t("mi",null,"t")])]),t("mo",{stretchy:"false"},")")])]),t("mo",null,","),t("mstyle",{mathcolor:"blue"},[t("mn",null,"1"),t("mo",null,"−"),t("mi",null,"ϵ")]),t("mo",null,","),t("mstyle",{mathcolor:"blue"},[t("mn",null,"1"),t("mo",null,"+"),t("mi",null,"ϵ")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"1.2em",maxsize:"1.2em"},")")]),t("mo",null,"⋅"),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"A"),t("mo",{stretchy:"false"},"^")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"2.047em",maxsize:"2.047em"},")")])])],-1))]),Q[56]||(Q[56]=t("p",null,[t("strong",null,"VAPO Token-Level Loss")],-1)),t("ul",null,[t("li",null,[Q[50]||(Q[50]=a("不做序列内平均，")),Q[51]||(Q[51]=t("code",null,"直接对所有token做平均",-1)),Q[52]||(Q[52]=a("，")),Q[53]||(Q[53]=t("code",null,"每个token权重相同",-1)),Q[54]||(Q[54]=a("，不论它来自短序列或长序列。")),t("mjx-container",v,[(e(),l("svg",j,Q[48]||(Q[48]=[T("",1)]))),Q[49]||(Q[49]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{"data-mjx-variant":"-tex-calligraphic",mathvariant:"script"},"L")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"VAPO")])]),t("mo",{stretchy:"false"},"("),t("mi",null,"θ"),t("mo",{stretchy:"false"},")")]),t("mo",null,"="),t("mo",null,"−"),t("munder",null,[t("mrow",{"data-mjx-texclass":"OP"},[t("munder",null,[t("mrow",null,[t("mstyle",{mathcolor:"red"},[t("mfrac",null,[t("mn",null,"1"),t("mrow",null,[t("munderover",null,[t("mo",{"data-mjx-texclass":"OP"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,"="),t("mn",null,"1")]),t("mi",null,"G")]),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("msub",null,[t("mi",null,"o"),t("mi",null,"i")]),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|")])])]),t("mstyle",{mathcolor:"blue"},[t("munderover",null,[t("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,"="),t("mn",null,"1")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"G")])])]),t("mstyle",{mathcolor:"red"},[t("munderover",null,[t("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"="),t("mn",null,"1")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("msub",null,[t("mi",null,"o"),t("mi",null,"i")]),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|")])])])]),t("mo",null,"⏟")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mstyle",{mathcolor:"blue"},[t("mtext",null,"所有Token直接做平均")])])]),t("mstyle",{mathcolor:"blue"},[t("mo",{"data-mjx-texclass":"OP",movablelimits:"true"},"min")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"2.047em",maxsize:"2.047em"},"(")]),t("mfrac",null,[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])]),t("mo",null,"∣"),t("mi",null,"q"),t("mo",null,","),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mo",null,"<"),t("mi",null,"t")])]),t("mo",{stretchy:"false"},")")]),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("msub",null,[t("mi",null,"θ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"o"),t("mi",null,"l"),t("mi",null,"d")])])])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])]),t("mo",null,"∣"),t("mi",null,"q"),t("mo",null,","),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mo",null,"<"),t("mi",null,"t")])]),t("mo",{stretchy:"false"},")")])]),t("mo",null,"⋅"),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"A"),t("mo",{stretchy:"false"},"^")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])])]),t("mo",null,","),t("mstyle",{scriptlevel:"0"},[t("mspace",{width:"0.278em"})]),t("mstyle",{mathcolor:"red"},[t("mtext",null,"clip")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"1.2em",maxsize:"1.2em"},"(")]),t("mfrac",null,[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])]),t("mo",null,"∣"),t("mi",null,"q"),t("mo",null,","),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mo",null,"<"),t("mi",null,"t")])]),t("mo",{stretchy:"false"},")")]),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("msub",null,[t("mi",null,"θ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"o"),t("mi",null,"l"),t("mi",null,"d")])])])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])]),t("mo",null,"∣"),t("mi",null,"q"),t("mo",null,","),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mo",null,"<"),t("mi",null,"t")])]),t("mo",{stretchy:"false"},")")])]),t("mo",null,","),t("mstyle",{mathcolor:"blue"},[t("mn",null,"1"),t("mo",null,"−"),t("mi",null,"ϵ")]),t("mo",null,","),t("mstyle",{mathcolor:"blue"},[t("mn",null,"1"),t("mo",null,"+"),t("mi",null,"ϵ")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"1.2em",maxsize:"1.2em"},")")]),t("mo",null,"⋅"),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"A"),t("mo",{stretchy:"false"},"^")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"2.047em",maxsize:"2.047em"},")")])])],-1))])])])]),Q[297]||(Q[297]=t("h4",{id:"解决奖励稀疏问题-clip-higher-正样本lm-loss-分组采样",tabindex:"-1"},[a("解决奖励稀疏问题(Clip-Higher,正样本LM-Loss,分组采样) "),t("a",{class:"header-anchor",href:"#解决奖励稀疏问题-clip-higher-正样本lm-loss-分组采样","aria-label":'Permalink to "解决奖励稀疏问题(Clip-Higher,正样本LM-Loss,分组采样)"'},"​")],-1)),t("div",A,[Q[89]||(Q[89]=t("div",{class:"custom-block-title"},"Clip-Higher",-1)),Q[90]||(Q[90]=t("p",null,[t("strong",null,"标准PPO-Clip问题")],-1)),t("ul",null,[t("li",null,[Q[59]||(Q[59]=a("防止训练一步走太大而崩溃，把")),Q[60]||(Q[60]=t("strong",null,"变化范围",-1)),Q[61]||(Q[61]=a("限制在")),t("mjx-container",R,[(e(),l("svg",O,Q[57]||(Q[57]=[T("",1)]))),Q[58]||(Q[58]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mo",{stretchy:"false"},"["),t("mstyle",{mathcolor:"red"},[t("mn",null,"1"),t("mo",null,"−"),t("mi",null,"ϵ"),t("mo",null,","),t("mn",null,"1"),t("mo",null,"+"),t("mi",null,"ϵ")]),t("mo",{stretchy:"false"},"]")])],-1))])]),t("li",null,[t("strong",null,[t("mjx-container",_,[(e(),l("svg",C,Q[62]||(Q[62]=[T("",1)]))),Q[63]||(Q[63]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mn",null,"1"),t("mo",null,"+"),t("mi",null,"ϵ")])],-1))]),Q[64]||(Q[64]=a("成为探索天花板，太低不利于探索"))]),Q[65]||(Q[65]=T("",1))])]),Q[91]||(Q[91]=t("p",null,[t("strong",null,"Clip-Higher：奖要重奖、罚要慎罚")],-1)),t("ul",null,[t("li",null,[t("p",null,[Q[68]||(Q[68]=a("把上下界解耦为非对称 ")),t("mjx-container",E,[(e(),l("svg",P,Q[66]||(Q[66]=[T("",1)]))),Q[67]||(Q[67]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mo",{stretchy:"false"},"["),t("mstyle",{mathcolor:"blue"},[t("mn",null,"1"),t("mo",null,"−"),t("msub",null,[t("mi",null,"ϵ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"l"),t("mi",null,"o"),t("mi",null,"w")])])]),t("mo",null,","),t("mstyle",{mathcolor:"red"},[t("mn",null,"1"),t("mo",null,"+"),t("msub",null,[t("mi",null,"ϵ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"h"),t("mi",null,"i"),t("mi",null,"g"),t("mi",null,"h")])])]),t("mo",{stretchy:"false"},"]")])],-1))])])]),t("li",null,[t("p",null,[t("strong",null,[Q[71]||(Q[71]=a("提高上界")),t("mjx-container",S,[(e(),l("svg",B,Q[69]||(Q[69]=[T("",1)]))),Q[70]||(Q[70]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"ϵ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"high")])]),t("mo",null,"="),t("mn",null,"0.28")])],-1))]),Q[72]||(Q[72]=a("：奖要重奖"))])]),Q[73]||(Q[73]=t("ul",null,[t("li",null,[a("如0.2->0.28。"),t("code",null,"为奖励信号打开更高天花板"),a("；当"),t("strong",null,"探索到好路径"),a("时，"),t("strong",null,"策略"),a("可以进行"),t("code",null,"大幅度更新"),a("。")]),t("li",null,"为惊喜提供更大奖励空间。")],-1))]),t("li",null,[t("p",null,[t("strong",null,[Q[76]||(Q[76]=a("保持下界")),t("mjx-container",X,[(e(),l("svg",z,Q[74]||(Q[74]=[T("",1)]))),Q[75]||(Q[75]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"ϵ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"low")])]),t("mo",null,"="),t("mn",null,"0.2")])],-1))]),Q[77]||(Q[77]=a("不变或较小：罚要慎罚"))])]),t("ul",null,[t("li",null,[t("strong",null,[Q[80]||(Q[80]=a("如果")),t("mjx-container",I,[(e(),l("svg",F,Q[78]||(Q[78]=[T("",1)]))),Q[79]||(Q[79]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"ϵ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"low")])])])],-1))]),Q[81]||(Q[81]=a("太大"))]),Q[82]||(Q[82]=a("，模型在")),Q[83]||(Q[83]=t("code",null,"惩罚错误路径",-1)),Q[84]||(Q[84]=a("时可能")),Q[85]||(Q[85]=t("code",null,"过于激进",-1))]),Q[86]||(Q[86]=t("li",null,[a("直接"),t("code",null,"把概率压到0"),a("，这样会"),t("code",null,"扼杀多样性"),a("，导致"),t("code",null,"熵崩溃"),a("。")],-1))]),t("mjx-container",G,[(e(),l("svg",N,Q[87]||(Q[87]=[T("",1)]))),Q[88]||(Q[88]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{"data-mjx-variant":"-tex-calligraphic",mathvariant:"script"},"L")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"VAPO")])]),t("mo",{stretchy:"false"},"("),t("mi",null,"θ"),t("mo",{stretchy:"false"},")")]),t("mo",null,"="),t("mo",null,"−"),t("munder",null,[t("mrow",{"data-mjx-texclass":"OP"},[t("munder",null,[t("mrow",null,[t("mstyle",{mathcolor:"red"},[t("mfrac",null,[t("mn",null,"1"),t("mrow",null,[t("munderover",null,[t("mo",{"data-mjx-texclass":"OP"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,"="),t("mn",null,"1")]),t("mi",null,"G")]),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("msub",null,[t("mi",null,"o"),t("mi",null,"i")]),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|")])])]),t("mstyle",{mathcolor:"blue"},[t("munderover",null,[t("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,"="),t("mn",null,"1")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"G")])])]),t("mstyle",{mathcolor:"red"},[t("munderover",null,[t("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"="),t("mn",null,"1")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("msub",null,[t("mi",null,"o"),t("mi",null,"t")]),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|")])])])]),t("mo",null,"⏟")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mstyle",{mathcolor:"blue"},[t("mtext",null,"所有Token直接做平均")])])]),t("mstyle",{mathcolor:"blue"},[t("mo",{"data-mjx-texclass":"OP",movablelimits:"true"},"min")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"2.047em",maxsize:"2.047em"},"(")]),t("msub",null,[t("mi",null,"r"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])]),t("mo",{stretchy:"false"},"("),t("mi",null,"θ"),t("mo",{stretchy:"false"},")"),t("mo",null,"⋅"),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"A"),t("mo",{stretchy:"false"},"^")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])])]),t("mo",null,","),t("mstyle",{scriptlevel:"0"},[t("mspace",{width:"0.278em"})]),t("mstyle",{mathcolor:"red"},[t("mtext",null,"clip")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"1.2em",maxsize:"1.2em"},"(")]),t("msub",null,[t("mi",null,"r"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])]),t("mo",{stretchy:"false"},"("),t("mi",null,"θ"),t("mo",{stretchy:"false"},")"),t("mo",null,","),t("mstyle",{mathcolor:"blue"},[t("mn",null,"1"),t("mo",null,"−"),t("msub",null,[t("mi",null,"ϵ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"low")])])]),t("mo",null,","),t("mstyle",{mathcolor:"red"},[t("mn",null,"1"),t("mo",null,"+"),t("msub",null,[t("mi",null,"ϵ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"high")])])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"1.2em",maxsize:"1.2em"},")")]),t("mo",null,"⋅"),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"A"),t("mo",{stretchy:"false"},"^")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"2.047em",maxsize:"2.047em"},")")])])],-1))])])])]),t("div",q,[Q[96]||(Q[96]=T("",7)),t("mjx-container",J,[(e(),l("svg",K,Q[92]||(Q[92]=[T("",1)]))),Q[93]||(Q[93]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{"data-mjx-variant":"-tex-calligraphic",mathvariant:"script"},"L")]),t("mo",{stretchy:"false"},"("),t("mi",null,"θ"),t("mo",{stretchy:"false"},")")]),t("mo",null,"="),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{"data-mjx-variant":"-tex-calligraphic",mathvariant:"script"},"L")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"ppo")])]),t("mo",{stretchy:"false"},"("),t("mi",null,"θ"),t("mo",{stretchy:"false"},")")]),t("mo",null,"+"),t("mstyle",{mathcolor:"red"},[t("mi",null,"μ"),t("mo",null,"⋅"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{"data-mjx-variant":"-tex-calligraphic",mathvariant:"script"},"L")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"NLL")])]),t("mo",{stretchy:"false"},"("),t("mi",null,"θ"),t("mo",{stretchy:"false"},")")])])],-1))]),Q[97]||(Q[97]=t("ul",null,[t("li",null,[t("strong",null,"NLL Loss"),a("："),t("code",null,"最大化正样本的生成概率"),a("。")]),t("li",null,[a("压榨正样本，不仅告知模型做对，"),t("code",null,"且手把手教学如何做对的"),a("，"),t("code",null,"记住这个过程"),a("。")])],-1)),t("mjx-container",$,[(e(),l("svg",Y,Q[94]||(Q[94]=[T("",1)]))),Q[95]||(Q[95]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{"data-mjx-variant":"-tex-calligraphic",mathvariant:"script"},"L")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"NLL")])]),t("mo",{stretchy:"false"},"("),t("mi",null,"θ"),t("mo",{stretchy:"false"},")")]),t("mo",null,"="),t("mo",null,"−"),t("mstyle",{mathcolor:"red"},[t("mfrac",null,[t("mn",null,"1"),t("mrow",null,[t("munder",null,[t("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("msub",null,[t("mi",null,"o"),t("mi",null,"i")]),t("mo",null,"∈"),t("msub",null,[t("mi",null,"τ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"positive")])])])]),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("msub",null,[t("mi",null,"o"),t("mi",null,"i")]),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|")])])]),t("munder",null,[t("mo",{"data-mjx-texclass":"OP"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",null,"o"),t("mi",null,"i")]),t("mo",null,"∈"),t("mi",null,"τ")])])]),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mstyle",{mathcolor:"blue"},[t("mi",null,"t"),t("mo",null,"="),t("mn",null,"1")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mstyle",{mathcolor:"blue"},[t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("msub",null,[t("mi",null,"o"),t("mi",null,"i")]),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|")])])]),t("mstyle",{mathcolor:"red"},[t("mi",null,"log"),t("mo",{"data-mjx-texclass":"NONE"},"⁡"),t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"a"),t("mi",null,"t")]),t("mo",null,"∣"),t("msub",null,[t("mi",null,"s"),t("mi",null,"t")]),t("mo",{stretchy:"false"},")")])])],-1))])]),Q[298]||(Q[298]=T("",4)),t("div",W,[Q[127]||(Q[127]=T("",8)),t("ul",null,[Q[104]||(Q[104]=t("li",null,[a("Policy 学习率1e-6，"),t("code",null,"Critic 学习率 2e-6"),a("。 "),t("ul",null,[t("li",null,"Critic 必须跟上 Actor的速率，才能提供准确的优势估计。"),t("li",null,"如果更新太慢，提供的就是过时的估计。")])],-1)),Q[105]||(Q[105]=t("li",null,"Batch Size：8192个prompt，每个prompt采样1次",-1)),Q[106]||(Q[106]=t("li",null,"Mini-Batch Size：512",-1)),Q[107]||(Q[107]=t("li",null,"Critic Model：由RM初始化。",-1)),t("li",null,[Q[100]||(Q[100]=a("GAE：")),t("mjx-container",U,[(e(),l("svg",t1,Q[98]||(Q[98]=[T("",1)]))),Q[99]||(Q[99]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"λ"),t("mo",null,"="),t("mn",null,"0.95"),t("mo",null,","),t("mstyle",{scriptlevel:"0"},[t("mspace",{width:"0.278em"})]),t("mi",null,"γ"),t("mo",null,"="),t("mn",null,"1")])],-1))])]),t("li",null,[Q[103]||(Q[103]=a("Clip：")),t("mjx-container",Q1,[(e(),l("svg",a1,Q[101]||(Q[101]=[T("",1)]))),Q[102]||(Q[102]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"ϵ"),t("mo",null,"="),t("mn",null,"0.2")])],-1))])]),Q[108]||(Q[108]=t("li",null,"使用Sample-Loss",-1))]),Q[128]||(Q[128]=t("p",null,[t("strong",null,"VAPO 设置")],-1)),t("ul",null,[Q[123]||(Q[123]=t("li",null,"Critic：使用RM去做ValuePretrain，50个step。",-1)),t("li",null,[Q[116]||(Q[116]=a("Decoupled-GAE： ")),t("ul",null,[t("li",null,[t("mjx-container",T1,[(e(),l("svg",l1,Q[109]||(Q[109]=[T("",1)]))),Q[110]||(Q[110]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"λ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"critic")])]),t("mo",null,"="),t("mn",null,"1.0")])],-1))])]),t("li",null,[t("mjx-container",e1,[(e(),l("svg",s1,Q[111]||(Q[111]=[T("",1)]))),Q[112]||(Q[112]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"λ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"policy")])]),t("mo",null,"="),t("mn",null,"1"),t("mo",null,"−"),t("mfrac",null,[t("mn",null,"1"),t("mrow",null,[t("mi",null,"α"),t("mi",null,"l")])])])],-1))]),Q[115]||(Q[115]=a("，")),t("mjx-container",m1,[(e(),l("svg",d1,Q[113]||(Q[113]=[T("",1)]))),Q[114]||(Q[114]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"α"),t("mo",null,"="),t("mn",null,"0.5")])],-1))])])])]),t("li",null,[Q[121]||(Q[121]=a("Clip-Higher：")),t("mjx-container",o1,[(e(),l("svg",r1,Q[117]||(Q[117]=[T("",1)]))),Q[118]||(Q[118]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"ϵ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"high")])]),t("mo",null,"="),t("mn",null,"0.28")])],-1))]),Q[122]||(Q[122]=a("，")),t("mjx-container",n1,[(e(),l("svg",i1,Q[119]||(Q[119]=[T("",1)]))),Q[120]||(Q[120]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"ϵ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"low")])]),t("mo",null,"="),t("mn",null,"0.2")])],-1))])]),Q[124]||(Q[124]=t("li",null,"Token-Level Loss",-1)),Q[125]||(Q[125]=t("li",null,"正样本 LM Loss",-1)),Q[126]||(Q[126]=t("li",null,"bs=512个prompt，rollout 16次，mini-bs=512",-1))])]),Q[299]||(Q[299]=T("",19)),t("div",h1,[Q[178]||(Q[178]=T("",6)),t("ul",null,[t("li",null,[Q[150]||(Q[150]=t("p",null,[t("strong",null,"打分偏差")],-1)),t("ul",null,[t("li",null,[Q[131]||(Q[131]=a("对")),Q[132]||(Q[132]=t("code",null,"靠前的、更不完整的句子",-1)),Q[133]||(Q[133]=a("状态，")),t("mjx-container",g1,[(e(),l("svg",p1,Q[129]||(Q[129]=[T("",1)]))),Q[130]||(Q[130]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"V"),t("mo",{stretchy:"false"},"("),t("mi",null,"s"),t("mo",{stretchy:"false"},")")])],-1))]),Q[134]||(Q[134]=a()),Q[135]||(Q[135]=t("code",null,"打低分",-1)),Q[136]||(Q[136]=a("。"))]),t("li",null,[Q[139]||(Q[139]=a("随着")),Q[140]||(Q[140]=t("code",null,"句子变长、越来越完整",-1)),Q[141]||(Q[141]=a("，")),t("mjx-container",H1,[(e(),l("svg",c1,Q[137]||(Q[137]=[T("",1)]))),Q[138]||(Q[138]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"V"),t("mo",{stretchy:"false"},"("),t("mi",null,"s"),t("mo",{stretchy:"false"},")")])],-1))]),Q[142]||(Q[142]=a("逐渐")),Q[143]||(Q[143]=t("code",null,"打高分",-1)),Q[144]||(Q[144]=a("。"))]),t("li",null,[Q[147]||(Q[147]=a("对")),Q[148]||(Q[148]=t("strong",null,"任意时刻t",-1)),Q[149]||(Q[149]=a("，都有")),t("mjx-container",u1,[(e(),l("svg",L1,Q[145]||(Q[145]=[T("",1)]))),Q[146]||(Q[146]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mstyle",{mathcolor:"red"},[t("mi",null,"V"),t("mo",{stretchy:"false"},"("),t("mi",null,"s"),t("mo",{stretchy:"false"},")"),t("mo",null,"<"),t("mi",null,"V"),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"s"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"+"),t("mn",null,"1")])]),t("mo",{stretchy:"false"},")")])])],-1))])])])]),Q[151]||(Q[151]=t("li",null,[t("p",null,[t("strong",null,"优势偏差")]),t("ul",null,[t("li",null,[a("初期训练阶段，几乎没有KL惩罚，"),t("strong",null,"奖励为0"),a("，"),t("strong",null,"TD Error 恒大于0"),a("，导致"),t("code",null,"优势恒大于0"),a("。")])])],-1))]),t("mjx-container",x1,[(e(),l("svg",f1,Q[152]||(Q[152]=[T("",1)]))),Q[153]||(Q[153]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"A"),t("mo",{stretchy:"false"},"^")])]),t("mi",null,"t")])]),t("mo",null,"≈"),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"l"),t("mo",null,"="),t("mn",null,"0")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"T"),t("mo",null,"−"),t("mi",null,"t"),t("mo",null,"−"),t("mn",null,"1")])]),t("mstyle",{mathcolor:"blue"},[t("msup",null,[t("mi",null,"λ"),t("mi",null,"l")])]),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mi",null,"δ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"+"),t("mi",null,"l")])])]),t("mo",null,"="),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"l"),t("mo",null,"="),t("mn",null,"0")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"T"),t("mo",null,"−"),t("mi",null,"t"),t("mo",null,"−"),t("mn",null,"1")])]),t("mstyle",{mathcolor:"blue"},[t("msup",null,[t("mi",null,"λ"),t("mi",null,"l")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"1.2em",maxsize:"1.2em"},"(")]),t("mstyle",{mathcolor:"blue"},[t("munder",null,[t("mrow",{"data-mjx-texclass":"OP"},[t("munder",null,[t("msub",null,[t("mi",null,"r"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"+"),t("mi",null,"l")])]),t("mo",null,"⏟")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"normal"},"初"),t("mi",{mathvariant:"normal"},"期"),t("mi",{mathvariant:"normal"},"为"),t("mn",null,"0")])])]),t("mo",null,"+"),t("mstyle",{mathcolor:"red"},[t("munder",null,[t("mrow",{"data-mjx-texclass":"OP"},[t("munder",null,[t("mrow",null,[t("mi",null,"V"),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"s"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"+"),t("mi",null,"l"),t("mo",null,"+"),t("mn",null,"1")])]),t("mo",{stretchy:"false"},")"),t("mo",null,"−"),t("mi",null,"V"),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"s"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"+"),t("mi",null,"l")])]),t("mo",{stretchy:"false"},")")]),t("mo",null,"⏟")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"normal"},"初"),t("mi",{mathvariant:"normal"},"期"),t("mo",null,">"),t("mn",null,"0")])])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"1.2em",maxsize:"1.2em"},")")]),t("mo",{stretchy:"false"},"⇒"),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"A"),t("mo",{stretchy:"false"},"^")])]),t("mi",null,"t")])]),t("mstyle",{mathcolor:"blue"},[t("mo",null,">"),t("mn",null,"0")])])],-1))]),t("ul",null,[t("li",null,[t("p",null,[t("mjx-container",w1,[(e(),l("svg",V1,Q[154]||(Q[154]=[T("",1)]))),Q[155]||(Q[155]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"A"),t("mi",null,"t")])])],-1))]),Q[156]||(Q[156]=a("是后面多个TD Error的加权求和，")),Q[157]||(Q[157]=t("code",null,"由于TD Error恒大于0",-1))]),t("ul",null,[t("li",null,[Q[160]||(Q[160]=t("code",null,"Token越靠前",-1)),Q[161]||(Q[161]=a("，累加正项越多，其")),Q[162]||(Q[162]=t("code",null,"最终优势值",-1)),Q[163]||(Q[163]=a()),t("mjx-container",y1,[(e(),l("svg",k1,Q[158]||(Q[158]=[T("",1)]))),Q[159]||(Q[159]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"A"),t("mo",{stretchy:"false"},"^")])]),t("mi",null,"t")])])])],-1))]),Q[164]||(Q[164]=t("code",null,"就越大",-1)),Q[165]||(Q[165]=a("。"))])]),t("mjx-container",M1,[(e(),l("svg",Z1,Q[166]||(Q[166]=[T("",1)]))),Q[167]||(Q[167]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"A"),t("mo",{stretchy:"false"},"^")])]),t("mi",null,"t")])]),t("mo",null,"="),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",null,"δ"),t("mi",null,"t")])]),t("mo",null,"+"),t("mstyle",{mathcolor:"blue"},[t("mi",null,"λ")]),t("mo",null,"⋅"),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"A"),t("mo",{stretchy:"false"},"^")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"+"),t("mn",null,"1")])])])])],-1))])])]),Q[179]||(Q[179]=t("p",null,[t("strong",null,"若TD大于0，越靠前的token，优势值越大，证明过程")],-1)),Q[180]||(Q[180]=t("ul",null,[t("li",null,"优势值缓慢递减")],-1)),t("mjx-container",b1,[(e(),l("svg",D1,Q[168]||(Q[168]=[T("",1)]))),Q[169]||(Q[169]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",null,"δ"),t("mi",null,"t")])]),t("mo",null,">"),t("mn",null,"0"),t("mo",{stretchy:"false"},"⇒"),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"A"),t("mo",{stretchy:"false"},"^")])]),t("mi",null,"t")])]),t("mo",null,">"),t("mstyle",{mathcolor:"blue"},[t("mi",null,"λ")]),t("mo",null,"⋅"),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"A"),t("mo",{stretchy:"false"},"^")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"+"),t("mn",null,"1")])])])])],-1))]),t("mjx-container",v1,[(e(),l("svg",j1,Q[170]||(Q[170]=[T("",1)]))),Q[171]||(Q[171]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"A"),t("mo",{stretchy:"false"},"^")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t")])])]),t("mo",null,">"),t("mstyle",{mathcolor:"blue"},[t("mi",null,"λ")]),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"A"),t("mo",{stretchy:"false"},"^")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"+"),t("mn",null,"1")])])]),t("mo",null,">"),t("mstyle",{mathcolor:"blue"},[t("msup",null,[t("mi",null,"λ"),t("mn",null,"2")])]),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"A"),t("mo",{stretchy:"false"},"^")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"+"),t("mn",null,"2")])])]),t("mo",null,">"),t("mstyle",{mathcolor:"blue"},[t("msup",null,[t("mi",null,"λ"),t("mn",null,"3")])]),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"A"),t("mo",{stretchy:"false"},"^")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"+"),t("mn",null,"3")])])]),t("mo",null,">"),t("mo",null,"⋯"),t("mo",null,">"),t("mstyle",{mathcolor:"blue"},[t("msup",null,[t("mi",null,"λ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"T"),t("mo",null,"−"),t("mi",null,"t"),t("mo",null,"−"),t("mn",null,"1")])])]),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"A"),t("mo",{stretchy:"false"},"^")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"T"),t("mo",null,"−"),t("mn",null,"1")])])])])],-1))]),t("ul",null,[t("li",null,[t("p",null,[Q[174]||(Q[174]=a("令")),t("mjx-container",A1,[(e(),l("svg",R1,Q[172]||(Q[172]=[T("",1)]))),Q[173]||(Q[173]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"δ"),t("mi",null,"t")]),t("mo",null,"≈"),t("mi",null,"c"),t("mo",null,">"),t("mn",null,"0")])],-1))])]),t("mjx-container",O1,[(e(),l("svg",_1,Q[175]||(Q[175]=[T("",1)]))),Q[176]||(Q[176]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"A"),t("mo",{stretchy:"false"},"^")])]),t("mi",null,"t")])]),t("mo",null,"="),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"l"),t("mo",null,"="),t("mn",null,"0")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"T"),t("mo",null,"−"),t("mi",null,"t"),t("mo",null,"−"),t("mn",null,"1")])]),t("mstyle",{mathcolor:"blue"},[t("msup",null,[t("mi",null,"λ"),t("mi",null,"l")])]),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mi",null,"δ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"+"),t("mi",null,"l")])])]),t("mo",null,"="),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"l"),t("mo",null,"="),t("mn",null,"0")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"T"),t("mo",null,"−"),t("mi",null,"t"),t("mo",null,"−"),t("mn",null,"1")])]),t("mstyle",{mathcolor:"blue"},[t("msup",null,[t("mi",null,"λ"),t("mi",null,"l")])]),t("mstyle",{mathcolor:"red"},[t("mi",null,"c")]),t("mo",null,"="),t("mstyle",{mathcolor:"red"},[t("mi",null,"c")]),t("mo",null,"⋅"),t("mfrac",null,[t("mrow",null,[t("mn",null,"1"),t("mo",null,"−"),t("mstyle",{mathcolor:"blue"},[t("msup",null,[t("mi",null,"λ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"T"),t("mo",null,"−"),t("mi",null,"t")])])])]),t("mrow",null,[t("mn",null,"1"),t("mo",null,"−"),t("mi",null,"λ")])])])],-1))])]),Q[177]||(Q[177]=t("li",null,[t("p",null,[a("从公式可以看出，"),t("code",null,"t越靠前"),a("，"),t("code",null,"优势值越大"),a("。")])],-1))])]),Q[300]||(Q[300]=t("p",null,"如下图所示，前面的token价值小、后面的token价值大，TDError>0，最终导致前面的token优势大，最后导致模型回复长度急剧缩短。",-1)),Q[301]||(Q[301]=t("img",{src:"https://picx.zhimg.com/v2-46fa27fd61b9bc544197731933475947_r.jpg",style:{display:"block",margin:"auto"},width:"70%"},null,-1)),Q[302]||(Q[302]=t("h4",{id:"gae-奖励信号衰减",tabindex:"-1"},[a("GAE 奖励信号衰减 "),t("a",{class:"header-anchor",href:"#gae-奖励信号衰减","aria-label":'Permalink to "GAE 奖励信号衰减"'},"​")],-1)),t("div",C1,[Q[202]||(Q[202]=t("div",{class:"custom-block-title"},"奖励信号衰减",-1)),Q[203]||(Q[203]=t("p",null,[a("更多详细推导见 "),t("a",{href:"http://plmsmile.github.io/posts/llm/rl/theory/09-policy-trpo-ppo.html#gae%E4%B8%AD%E7%9A%84%E5%A5%96%E5%8A%B1%E8%A1%B0%E5%87%8F-llm",target:"_blank",rel:"noreferrer"},"GAE 奖励信号衰减")],-1)),Q[204]||(Q[204]=t("p",null,[t("strong",null,"背景")],-1)),t("ul",null,[t("li",null,[Q[183]||(Q[183]=a("在LLM中，中间token奖励为0、")),Q[184]||(Q[184]=t("code",null,"仅最后1个token有环境奖励信号",-1)),Q[185]||(Q[185]=a()),t("mjx-container",E1,[(e(),l("svg",P1,Q[181]||(Q[181]=[T("",1)]))),Q[182]||(Q[182]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mi",null,"r"),t("mi",null,"T")])])])],-1))]),Q[186]||(Q[186]=a("。"))]),t("li",null,[Q[191]||(Q[191]=a("当")),Q[192]||(Q[192]=t("code",null,"真实外部信号",-1)),t("mjx-container",S1,[(e(),l("svg",B1,Q[187]||(Q[187]=[T("",1)]))),Q[188]||(Q[188]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"r"),t("mi",null,"T")])])],-1))]),Q[193]||(Q[193]=a()),Q[194]||(Q[194]=t("code",null,"传递回第t个token时",-1)),Q[195]||(Q[195]=a("，会")),Q[196]||(Q[196]=t("code",null,"乘以权重",-1)),t("mjx-container",X1,[(e(),l("svg",z1,Q[189]||(Q[189]=[T("",1)]))),Q[190]||(Q[190]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mstyle",{mathcolor:"blue"},[t("mo",{stretchy:"false"},"("),t("mi",null,"λ"),t("mi",null,"γ"),t("msup",null,[t("mo",{stretchy:"false"},")"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"T"),t("mo",null,"−"),t("mi",null,"t")])]),t("mo",null,","),t("mo",{stretchy:"false"},"("),t("mi",null,"λ"),t("msup",null,[t("mo",{stretchy:"false"},")"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"T"),t("mo",null,"−"),t("mi",null,"t")])])])])],-1))]),Q[197]||(Q[197]=a(" ，")),Q[198]||(Q[198]=t("code",null,"权重容易变成0",-1)),Q[199]||(Q[199]=a("。"))])]),t("mjx-container",I1,[(e(),l("svg",F1,Q[200]||(Q[200]=[T("",1)]))),Q[201]||(Q[201]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"A"),t("mo",{stretchy:"false"},"^")])]),t("mi",null,"t")])]),t("mo",null,"="),t("munder",null,[t("mrow",{"data-mjx-texclass":"OP"},[t("munder",null,[t("mrow",null,[t("mstyle",{mathcolor:"blue"},[t("mo",{stretchy:"false"},"("),t("mi",null,"λ"),t("mi",null,"γ"),t("msup",null,[t("mo",{stretchy:"false"},")"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"T"),t("mo",null,"−"),t("mi",null,"t")])])]),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mi",null,"r"),t("mi",null,"T")])])]),t("mo",null,"⏟")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mstyle",{mathcolor:"red"},[t("mi",{mathvariant:"normal"},"真"),t("mi",{mathvariant:"normal"},"实"),t("mi",{mathvariant:"normal"},"奖"),t("mi",{mathvariant:"normal"},"励"),t("mi",{mathvariant:"normal"},"信"),t("mi",{mathvariant:"normal"},"号")])])]),t("mo",null,"+"),t("munder",null,[t("mrow",{"data-mjx-texclass":"OP"},[t("munder",null,[t("mrow",null,[t("mo",{stretchy:"false"},"("),t("mtext",null,"一堆只包含"),t("mi",null,"V"),t("mo",{stretchy:"false"},"("),t("mi",null,"s"),t("mo",{stretchy:"false"},")"),t("mtext",null,"的项"),t("mo",{stretchy:"false"},")")]),t("mo",null,"⏟")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mstyle",{mathcolor:"blue"},[t("mi",{mathvariant:"normal"},"来"),t("mi",{mathvariant:"normal"},"自"),t("mi",{mathvariant:"normal"},"价"),t("mi",{mathvariant:"normal"},"值"),t("mi",{mathvariant:"normal"},"函"),t("mi",{mathvariant:"normal"},"数"),t("mi",{mathvariant:"normal"},"估"),t("mi",{mathvariant:"normal"},"计"),t("mi",{mathvariant:"normal"},"的"),t("mi",{mathvariant:"normal"},"信"),t("mi",{mathvariant:"normal"},"号")])])])])],-1))]),Q[205]||(Q[205]=T("",2))]),Q[303]||(Q[303]=T("",5)),t("div",G1,[Q[237]||(Q[237]=t("div",{class:"custom-block-title"},"Value Pretrain 解决价值偏差",-1)),Q[238]||(Q[238]=t("p",null,[t("strong",null,"解决问题")],-1)),Q[239]||(Q[239]=t("ul",null,[t("li",null,"RM初始化Critic带来的价值偏差、λ<1时带来的奖励信号衰减问题。")],-1)),Q[240]||(Q[240]=t("p",null,[t("strong",null,"核心思想")],-1)),t("ul",null,[t("li",null,[Q[208]||(Q[208]=t("strong",null,"在正式PPO之前",-1)),Q[209]||(Q[209]=a("，")),Q[210]||(Q[210]=t("strong",null,"固定策略",-1)),Q[211]||(Q[211]=a("，使用 ")),t("strong",null,[t("mjx-container",N1,[(e(),l("svg",q1,Q[206]||(Q[206]=[T("",1)]))),Q[207]||(Q[207]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"λ"),t("mo",null,"="),t("mn",null,"1")])],-1))])]),Q[212]||(Q[212]=a("，")),Q[213]||(Q[213]=t("strong",null,"对Critic做一次预训练",-1)),Q[214]||(Q[214]=a("。"))]),Q[215]||(Q[215]=t("li",null,[a("通过"),t("code",null,"固定策略+MC回报"),a("，"),t("a",{href:"https://plmsmile.github.io/posts/llm/rl/theory/09-policy-trpo-ppo.html#critic-%E5%AD%A6%E4%B9%A0%E8%BF%87%E7%A8%8B",target:"_blank",rel:"noreferrer"},"把价值模型的学习"),t("code",null,"从不稳定的RL过程"),a("变成 "),t("code",null,"稳定的监督学习过程"),a("。")],-1))]),Q[241]||(Q[241]=t("p",null,[t("strong",null,"具体做法")],-1)),t("ul",null,[t("li",null,[t("p",null,[Q[218]||(Q[218]=t("code",null,"固定策略模型",-1)),Q[219]||(Q[219]=a("(如")),t("mjx-container",J1,[(e(),l("svg",K1,Q[216]||(Q[216]=[T("",1)]))),Q[217]||(Q[217]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"sft")])])])])],-1))]),Q[220]||(Q[220]=a(")，使用")),Q[221]||(Q[221]=t("code",null,"GAE",-1)),Q[222]||(Q[222]=a(" + ")),Q[223]||(Q[223]=t("code",null,"λ=1",-1)),Q[224]||(Q[224]=a("退成")),Q[225]||(Q[225]=t("code",null,"MC采样",-1)),Q[226]||(Q[226]=a("，得到稳定梯度信号。"))])]),t("li",null,[Q[235]||(Q[235]=t("p",null,[t("code",null,"单独训练Critic模型"),a("，使其"),t("code",null,"准确预测回报"),a("，直到收敛，"),t("strong",null,"看2个指标")],-1)),t("ul",null,[Q[234]||(Q[234]=t("li",null,[t("p",null,[t("strong",null,"Value Loss"),a("："),t("code",null,"预测价值和真实奖励之间的差距")])],-1)),t("li",null,[Q[231]||(Q[231]=t("p",null,[t("strong",null,"Explained Variance/解释方差"),a("：衡量"),t("code",null,"预测趋势和真实趋势"),a("的匹配程度。")],-1)),Q[232]||(Q[232]=t("ul",null,[t("li",null,[t("code",null,"预测误差的方差"),a("除以"),t("code",null,"真实方差"),a("。预测误差的方差：还剩下多少无法解释的波动性。")])],-1)),t("mjx-container",$1,[(e(),l("svg",Y1,Q[227]||(Q[227]=[T("",1)]))),Q[228]||(Q[228]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("mtext",null,"Explaned Variance")]),t("mo",null,"="),t("mn",null,"1"),t("mo",null,"−"),t("mfrac",null,[t("mstyle",{mathcolor:"red"},[t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"Var"),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"Y"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"g"),t("mi",null,"o"),t("mi",null,"l"),t("mi",null,"d")])]),t("mo",null,"−"),t("msub",null,[t("mi",null,"Y"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"p"),t("mi",null,"r"),t("mi",null,"e"),t("mi",null,"d")])]),t("mo",{stretchy:"false"},")")])]),t("mstyle",{mathcolor:"blue"},[t("mtext",null,"Var"),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"Y"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"g"),t("mi",null,"o"),t("mi",null,"l"),t("mi",null,"d")])]),t("mo",{stretchy:"false"},")")])]),t("mstyle",{scriptlevel:"0"},[t("mspace",{width:"1em"})]),t("mo",null,"∈"),t("mstyle",{scriptlevel:"0"},[t("mspace",{width:"0.278em"})]),t("mstyle",{mathcolor:"blue"},[t("mo",{stretchy:"false"},"("),t("mo",null,"−"),t("mi",{mathvariant:"normal"},"∞"),t("mo",null,","),t("mn",null,"1"),t("mo",{stretchy:"false"},"]")])])],-1))]),t("mjx-container",W1,[(e(),l("svg",U1,Q[229]||(Q[229]=[T("",1)]))),Q[230]||(Q[230]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("mi",{mathvariant:"normal"},"解"),t("mi",{mathvariant:"normal"},"释"),t("mi",{mathvariant:"normal"},"方"),t("mi",{mathvariant:"normal"},"差")]),t("mo",null,"="),t("mn",null,"1"),t("mo",null,"−"),t("mstyle",{mathcolor:"red"},[t("mi",{mathvariant:"normal"},"无"),t("mi",{mathvariant:"normal"},"法"),t("mi",{mathvariant:"normal"},"解"),t("mi",{mathvariant:"normal"},"释"),t("mi",{mathvariant:"normal"},"方"),t("mi",{mathvariant:"normal"},"差"),t("mi",{mathvariant:"normal"},"占"),t("mi",{mathvariant:"normal"},"总"),t("mi",{mathvariant:"normal"},"方"),t("mi",{mathvariant:"normal"},"差"),t("mi",{mathvariant:"normal"},"的"),t("mi",{mathvariant:"normal"},"比"),t("mi",{mathvariant:"normal"},"例")])])],-1))]),Q[233]||(Q[233]=t("ul",null,[t("li",null,"接近1：最好情况，模型几乎解释了所有的数据波动。"),t("li",null,"接近0：模型和简单预测所有结果的平均值差不多。"),t("li",null,"负数：模型还不如直接预测平均值，预测甚至是有害的，预测趋势是相反的。")],-1))])])]),Q[236]||(Q[236]=t("li",null,[t("p",null,[t("strong",null,"正式PPO时"),a("，"),t("code",null,"使用预训练过的Critic模型"),a("，而不再使用RM做随机初始化。")])],-1))])]),Q[304]||(Q[304]=T("",9)),t("div",t2,[Q[251]||(Q[251]=T("",6)),t("ul",null,[Q[249]||(Q[249]=t("li",null,[a("冷启动：使用一些推理数据，来冷启动训练模型，使得按照 "),t("code",null,"<think></think>"),a("格式输出")],-1)),Q[250]||(Q[250]=t("li",null,"Value Pretraining：λ=1，Freeze Policy，其他参数同标准PPO。",-1)),t("li",null,[Q[246]||(Q[246]=a("Decoupled-GAE：")),t("mjx-container",Q2,[(e(),l("svg",a2,Q[242]||(Q[242]=[T("",1)]))),Q[243]||(Q[243]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"λ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"c"),t("mi",null,"r"),t("mi",null,"i"),t("mi",null,"t"),t("mi",null,"i"),t("mi",null,"c")])]),t("mo",null,"="),t("mn",null,"1")])],-1))]),Q[247]||(Q[247]=a("， ")),t("mjx-container",T2,[(e(),l("svg",l2,Q[244]||(Q[244]=[T("",1)]))),Q[245]||(Q[245]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"λ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"a"),t("mi",null,"c"),t("mi",null,"t"),t("mi",null,"o"),t("mi",null,"r")])]),t("mo",null,"="),t("mn",null,"0.95")])],-1))]),Q[248]||(Q[248]=a("。作者也研究了0.9-1.0参数。"))])]),Q[252]||(Q[252]=T("",4))]),Q[305]||(Q[305]=T("",20)),t("div",e2,[Q[260]||(Q[260]=T("",5)),t("mjx-container",s2,[(e(),l("svg",m2,Q[253]||(Q[253]=[T("",1)]))),Q[254]||(Q[254]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{"data-mjx-variant":"-tex-calligraphic",mathvariant:"script"},"L")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"ppo")])]),t("mo",{stretchy:"false"},"("),t("mi",null,"θ"),t("mo",{stretchy:"false"},")")]),t("mo",null,"="),t("mo",null,"−"),t("mstyle",{mathcolor:"blue"},[t("munder",null,[t("mrow",{"data-mjx-texclass":"OP"},[t("munder",null,[t("mrow",null,[t("mfrac",null,[t("mn",null,"1"),t("mi",null,"G")]),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,"="),t("mn",null,"1")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"G")])])]),t("mo",null,"⏟")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"normal"},"样"),t("mi",{mathvariant:"normal"},"本"),t("mi",{mathvariant:"normal"},"间"),t("mi",{mathvariant:"normal"},"平"),t("mi",{mathvariant:"normal"},"均")])])]),t("mstyle",{mathcolor:"red"},[t("munder",null,[t("mrow",{"data-mjx-texclass":"OP"},[t("munder",null,[t("mrow",null,[t("mfrac",null,[t("mn",null,"1"),t("mrow",null,[t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("msub",null,[t("mi",null,"o"),t("mi",null,"i")]),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|")])]),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"="),t("mn",null,"1")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("msub",null,[t("mi",null,"o"),t("mi",null,"t")]),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|")])])]),t("mo",null,"⏟")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"序列内平均")])])]),t("mstyle",{mathcolor:"blue"},[t("mo",{"data-mjx-texclass":"OP",movablelimits:"true"},"min")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"2.047em",maxsize:"2.047em"},"(")]),t("mfrac",null,[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])]),t("mo",null,"∣"),t("mi",null,"q"),t("mo",null,","),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mo",null,"<"),t("mi",null,"t")])]),t("mo",{stretchy:"false"},")")]),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("msub",null,[t("mi",null,"θ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"o"),t("mi",null,"l"),t("mi",null,"d")])])])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])]),t("mo",null,"∣"),t("mi",null,"q"),t("mo",null,","),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mo",null,"<"),t("mi",null,"t")])]),t("mo",{stretchy:"false"},")")])]),t("mo",null,"⋅"),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"A"),t("mo",{stretchy:"false"},"^")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])])]),t("mo",null,","),t("mstyle",{scriptlevel:"0"},[t("mspace",{width:"0.278em"})]),t("mstyle",{mathcolor:"red"},[t("mtext",null,"clip")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"1.2em",maxsize:"1.2em"},"(")]),t("mfrac",null,[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])]),t("mo",null,"∣"),t("mi",null,"q"),t("mo",null,","),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mo",null,"<"),t("mi",null,"t")])]),t("mo",{stretchy:"false"},")")]),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("msub",null,[t("mi",null,"θ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"o"),t("mi",null,"l"),t("mi",null,"d")])])])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])]),t("mo",null,"∣"),t("mi",null,"q"),t("mo",null,","),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mo",null,"<"),t("mi",null,"t")])]),t("mo",{stretchy:"false"},")")])]),t("mo",null,","),t("mstyle",{mathcolor:"blue"},[t("mn",null,"1"),t("mo",null,"−"),t("mi",null,"ϵ")]),t("mo",null,","),t("mstyle",{mathcolor:"blue"},[t("mn",null,"1"),t("mo",null,"+"),t("mi",null,"ϵ")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"1.2em",maxsize:"1.2em"},")")]),t("mo",null,"⋅"),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"A"),t("mo",{stretchy:"false"},"^")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,","),t("mi",null,"t")])])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"2.047em",maxsize:"2.047em"},")")])])],-1))]),Q[261]||(Q[261]=t("p",null,[t("strong",null,"优势估计：Token-Level KL 惩罚直接加入Reward")],-1)),Q[262]||(Q[262]=t("ul",null,[t("li",null,[t("code",null,"真实轨迹线奖励"),a(" - "),t("code",null,"KL惩"),a("罚，累加t时刻后面"),t("code",null,"每一个token的KL惩罚累加"),a("，因为是对未来产生影响。")])],-1)),t("mjx-container",d2,[(e(),l("svg",o2,Q[255]||(Q[255]=[T("",1)]))),Q[256]||(Q[256]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("mi",null,"R"),t("mo",{stretchy:"false"},"("),t("mi",null,"q"),t("mo",null,","),t("msub",null,[t("mi",null,"o"),t("mi",null,"t")]),t("mo",{stretchy:"false"},")")]),t("mo",null,"="),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"A"),t("mo",{stretchy:"false"},"^")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"q"),t("mo",null,","),t("msub",null,[t("mi",null,"o"),t("mi",null,"t")])])])]),t("mo",null,"="),t("mstyle",{mathcolor:"blue"},[t("mi",null,"r"),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mn",null,"1"),t("mo",null,":"),t("mi",null,"T")])]),t("mo",null,","),t("mi",null,"q"),t("mo",{stretchy:"false"},")")]),t("mo",null,"−"),t("mi",null,"β"),t("mstyle",{mathcolor:"red"},[t("munderover",null,[t("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,"="),t("mi",null,"t")]),t("mi",null,"T")])]),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",null,"D"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"KL")])]),t("mo",{stretchy:"false"},"("),t("mi",null,"i"),t("mo",{stretchy:"false"},")")]),t("mo",null,"="),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",null,"r"),t("mi",null,"T")])]),t("mo",null,"−"),t("mi",null,"β"),t("mstyle",{mathcolor:"red"},[t("munderover",null,[t("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,"="),t("mi",null,"t")]),t("mi",null,"T")])]),t("mstyle",{mathcolor:"blue"},[t("mi",null,"log")]),t("mfrac",null,[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("msub",null,[t("mi",null,"θ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"o"),t("mi",null,"l"),t("mi",null,"d")])])])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"o"),t("mi",null,"t")]),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("mi",null,"q"),t("mo",null,","),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"<"),t("mi",null,"i")])]),t("mo",{stretchy:"false"},")")]),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("msub",null,[t("mi",null,"θ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"r"),t("mi",null,"e"),t("mi",null,"f")])])])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"o"),t("mi",null,"t")]),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("mi",null,"q"),t("mo",null,","),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"<"),t("mi",null,"i")])]),t("mo",{stretchy:"false"},")")])])])],-1))]),Q[263]||(Q[263]=t("p",null,[t("strong",null,"全局归一化")],-1)),t("ul",null,[t("li",null,[Q[259]||(Q[259]=t("p",null,[a("使用"),t("code",null,"batch-level 归一化")],-1)),t("mjx-container",r2,[(e(),l("svg",n2,Q[257]||(Q[257]=[T("",1)]))),Q[258]||(Q[258]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("msubsup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"A"),t("mo",{stretchy:"false"},"^")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"q"),t("mo",null,","),t("msub",null,[t("mi",null,"o"),t("mi",null,"t")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"norm")])])]),t("mo",null,"="),t("mfrac",null,[t("mrow",null,[t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"A"),t("mo",{stretchy:"false"},"^")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"q"),t("mo",null,","),t("msub",null,[t("mi",null,"o"),t("mi",null,"t")])])])]),t("mo",null,"−"),t("mstyle",{mathcolor:"red"},[t("mtext",null,"mean"),t("mo",{stretchy:"false"},"("),t("mi",null,"A"),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("mi",null,"A"),t("mo",null,"∈"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{"data-mjx-variant":"-tex-calligraphic",mathvariant:"script"},"D")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"batch")])])]),t("mo",{stretchy:"false"},")")]),t("mstyle",{mathcolor:"red"},[t("mtext",null,"std"),t("mo",{stretchy:"false"},"("),t("mi",null,"A"),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("mi",null,"A"),t("mo",null,"∈"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{"data-mjx-variant":"-tex-calligraphic",mathvariant:"script"},"D")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"batch")])]),t("mo",{stretchy:"false"},")"),t("mo",null,"+"),t("mi",null,"ϵ")])])])],-1))])])])]),Q[306]||(Q[306]=t("h4",{id:"reinforce-w-baseline-k-1",tabindex:"-1"},[a("REINFORCE++ w/baseline (k>1) "),t("a",{class:"header-anchor",href:"#reinforce-w-baseline-k-1","aria-label":'Permalink to "REINFORCE++ w/baseline (k>1)"'},"​")],-1)),t("div",i2,[Q[279]||(Q[279]=t("div",{class:"custom-block-title"},"REINFORCE++ w/baseline",-1)),Q[280]||(Q[280]=t("p",null,[t("strong",null,"背景")],-1)),Q[281]||(Q[281]=t("ul",null,[t("li",null,"多步RL场景")],-1)),Q[282]||(Q[282]=t("p",null,[t("strong",null,"核心思想")],-1)),t("ul",null,[t("li",null,[Q[266]||(Q[266]=t("p",null,"轨迹奖励 + Token-Level KL 惩罚",-1)),t("mjx-container",h2,[(e(),l("svg",g2,Q[264]||(Q[264]=[T("",1)]))),Q[265]||(Q[265]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("mi",null,"R"),t("mo",{stretchy:"false"},"("),t("mi",null,"q"),t("mo",null,","),t("msub",null,[t("mi",null,"o"),t("mi",null,"t")]),t("mo",{stretchy:"false"},")")]),t("mo",null,"="),t("mstyle",{mathcolor:"blue"},[t("mi",null,"r"),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mn",null,"1"),t("mo",null,":"),t("mi",null,"T")])]),t("mo",null,","),t("mi",null,"q"),t("mo",{stretchy:"false"},")")]),t("mo",null,"−"),t("mi",null,"β"),t("mstyle",{mathcolor:"red"},[t("munderover",null,[t("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,"="),t("mi",null,"t")]),t("mi",null,"T")])]),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",null,"D"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"KL")])]),t("mo",{stretchy:"false"},"("),t("mi",null,"i"),t("mo",{stretchy:"false"},")")])])],-1))])]),t("li",null,[Q[269]||(Q[269]=t("p",null,[t("code",null,"局部基线"),a("：Local/Group Baseline/Mean")],-1)),t("mjx-container",p2,[(e(),l("svg",H2,Q[267]||(Q[267]=[T("",1)]))),Q[268]||(Q[268]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("msubsup",null,[t("mi",null,"A"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"q"),t("mo",null,","),t("msub",null,[t("mi",null,"o"),t("mi",null,"t")])]),t("mi",{"data-mjx-alternate":"1"},"′")])]),t("mo",null,"="),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",null,"R"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"q"),t("mo",null,","),t("msub",null,[t("mi",null,"o"),t("mi",null,"t")])])])]),t("mo",null,"−"),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mtext",null,"mean"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"group")])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"R"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"q"),t("mo",null,","),t("msub",null,[t("mi",null,"o"),t("mi",null,"t")])])]),t("mo",{stretchy:"false"},")")])])],-1))])]),t("li",null,[Q[272]||(Q[272]=t("p",null,[t("code",null,"全局归一化")],-1)),t("mjx-container",c2,[(e(),l("svg",u2,Q[270]||(Q[270]=[T("",1)]))),Q[271]||(Q[271]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("msubsup",null,[t("mi",null,"A"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"q"),t("mo",null,","),t("msub",null,[t("mi",null,"o"),t("mi",null,"t")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"norm")])])]),t("mo",null,"="),t("mfrac",null,[t("mrow",null,[t("mstyle",{mathcolor:"blue"},[t("msubsup",null,[t("mi",null,"A"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"q"),t("mo",null,","),t("msub",null,[t("mi",null,"o"),t("mi",null,"t")])]),t("mi",{"data-mjx-alternate":"1"},"′")])]),t("mo",null,"−"),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mtext",null,"mean"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"batch")])]),t("mo",{stretchy:"false"},"("),t("mstyle",{mathcolor:"blue"},[t("msubsup",null,[t("mi",null,"A"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"q"),t("mo",null,","),t("msub",null,[t("mi",null,"o"),t("mi",null,"t")])]),t("mi",{"data-mjx-alternate":"1"},"′")])]),t("mo",{stretchy:"false"},")")])]),t("mstyle",{mathcolor:"red"},[t("msub",null,[t("mtext",null,"std"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"batch")])]),t("mo",{stretchy:"false"},"("),t("mstyle",{mathcolor:"blue"},[t("msubsup",null,[t("mi",null,"A"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"q"),t("mo",null,","),t("msub",null,[t("mi",null,"o"),t("mi",null,"t")])]),t("mi",{"data-mjx-alternate":"1"},"′")])]),t("mo",{stretchy:"false"},")"),t("mo",null,"+"),t("mi",null,"ϵ")])])])],-1))])]),t("li",null,[Q[275]||(Q[275]=t("p",null,[t("strong",null,"Loss")],-1)),t("mjx-container",L2,[(e(),l("svg",x2,Q[273]||(Q[273]=[T("",1)]))),Q[274]||(Q[274]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{"data-mjx-variant":"-tex-calligraphic",mathvariant:"script"},"L")]),t("mo",null,"="),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{"data-mjx-variant":"-tex-calligraphic",mathvariant:"script"},"L")]),t("mo",{stretchy:"false"},"("),t("msup",null,[t("mi",null,"A"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"norm")])]),t("mo",{stretchy:"false"},")"),t("mo",null,"−"),t("mi",null,"λ"),t("mo",null,"⋅"),t("msub",null,[t("mi",null,"J"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"D"),t("msub",null,[t("mi",null,"L"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"k"),t("mn",null,"2")])])])]),t("mo",{stretchy:"false"},"("),t("mi",null,"θ"),t("mo",{stretchy:"false"},")")])],-1))])]),t("li",null,[Q[278]||(Q[278]=t("p",null,[t("a",{href:"https://plmsmile.github.io/posts/llm/basic/01-lm-define-information-theory.html#k2-%E4%BD%8E%E6%96%B9%E5%B7%AE%E4%BD%86%E6%9C%89%E5%81%8F",target:"_blank",rel:"noreferrer"},"KL散度使用K2: 低方差"),a("，更稳健")],-1)),t("mjx-container",f2,[(e(),l("svg",w2,Q[276]||(Q[276]=[T("",1)]))),Q[277]||(Q[277]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("msub",null,[t("mi",null,"k"),t("mn",null,"2")]),t("mo",null,"="),t("mfrac",null,[t("mn",null,"1"),t("mn",null,"2")]),t("mo",{stretchy:"false"},"("),t("mi",null,"log"),t("mo",{"data-mjx-texclass":"NONE"},"⁡"),t("mfrac",null,[t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])]),t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"r"),t("mi",null,"e"),t("mi",null,"f")])])]),t("msup",null,[t("mo",{stretchy:"false"},")"),t("mn",null,"2")])])],-1))])])])]),Q[307]||(Q[307]=T("",21)),t("div",V2,[Q[291]||(Q[291]=t("div",{class:"custom-block-title"},"REINFORCE Leave-One-Out",-1)),Q[292]||(Q[292]=t("p",null,[t("strong",null,"REINOFRCE")],-1)),t("mjx-container",y2,[(e(),l("svg",k2,Q[283]||(Q[283]=[T("",1)]))),Q[284]||(Q[284]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("mi",{mathvariant:"normal"},"∇"),t("mi",null,"J"),t("mo",{stretchy:"false"},"("),t("mi",null,"θ"),t("mo",{stretchy:"false"},")")]),t("mo",null,"="),t("msub",null,[t("mi",null,"E"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"x"),t("mo",null,"∼"),t("mi",null,"D"),t("mo",null,","),t("mstyle",{mathcolor:"red"},[t("mi",null,"y"),t("mo",null,"∼"),t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])]),t("mo",{stretchy:"false"},"("),t("mo",null,"⋅"),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("mi",null,"x"),t("mo",{stretchy:"false"},")")])])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"2.047em",maxsize:"2.047em"},"[")]),t("mstyle",{mathcolor:"red"},[t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"1.2em",maxsize:"1.2em"},"(")]),t("mi",null,"R"),t("mo",{stretchy:"false"},"("),t("mi",null,"x"),t("mo",null,","),t("mi",null,"y"),t("mo",{stretchy:"false"},")"),t("mo",null,"−"),t("mi",null,"b"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"1.2em",maxsize:"1.2em"},")")])]),t("mo",null,"⋅"),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",{mathvariant:"normal"},"∇"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])]),t("mi",null,"log"),t("mo",{"data-mjx-texclass":"NONE"},"⁡"),t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])]),t("mo",{stretchy:"false"},"("),t("mi",null,"y"),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("mi",null,"x"),t("mo",{stretchy:"false"},")")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{minsize:"2.047em",maxsize:"2.047em"},"]")])])],-1))]),t("mjx-container",M2,[(e(),l("svg",Z2,Q[285]||(Q[285]=[T("",1)]))),Q[286]||(Q[286]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mi",{mathvariant:"normal"},"∇"),t("msub",null,[t("mi",null,"J"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"REINFORCE")])]),t("mo",{stretchy:"false"},"("),t("mi",null,"θ"),t("mo",{stretchy:"false"},")"),t("mo",null,"="),t("mfrac",null,[t("mn",null,"1"),t("mi",null,"G")]),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,"="),t("mn",null,"1")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"G")])]),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"="),t("mn",null,"1")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("msub",null,[t("mi",null,"o"),t("mi",null,"i")]),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|")])]),t("mstyle",{mathcolor:"red"},[t("mo",{stretchy:"false"},"("),t("mi",null,"R"),t("mo",{stretchy:"false"},"("),t("mi",null,"x"),t("mo",null,","),t("mi",null,"y"),t("mo",{stretchy:"false"},")"),t("mo",null,"−"),t("mi",null,"b"),t("mo",{stretchy:"false"},")")]),t("mo",null,"⋅"),t("mstyle",{mathcolor:"blue"},[t("msub",null,[t("mi",{mathvariant:"normal"},"∇"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])]),t("mi",null,"log"),t("mo",{"data-mjx-texclass":"NONE"},"⁡"),t("msub",null,[t("mi",null,"π"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"θ")])]),t("mo",{stretchy:"false"},"("),t("mi",null,"y"),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("mi",null,"x"),t("mo",{stretchy:"false"},")")])])],-1))]),Q[293]||(Q[293]=t("p",null,[t("strong",null,"REINFORCE Leave-One-Out")],-1)),t("ul",null,[Q[290]||(Q[290]=t("li",null,[t("p",null,"对一个Prompt，G个Rollout")],-1)),t("li",null,[Q[289]||(Q[289]=t("p",null,[a("计算每个advantage的时候，"),t("code",null,"基线"),a("使用"),t("code",null,"其余k-1个的奖励平均值")],-1)),t("mjx-container",b2,[(e(),l("svg",D2,Q[287]||(Q[287]=[T("",1)]))),Q[288]||(Q[288]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mstyle",{mathcolor:"blue"},[t("mi",null,"A"),t("mo",{stretchy:"false"},"("),t("mi",null,"x"),t("mo",null,","),t("msub",null,[t("mi",null,"y"),t("mi",null,"i")]),t("mo",{stretchy:"false"},")")]),t("mo",null,"="),t("mstyle",{mathcolor:"red"},[t("mi",null,"R"),t("mo",{stretchy:"false"},"("),t("mi",null,"x"),t("mo",null,","),t("msub",null,[t("mi",null,"y"),t("mi",null,"i")]),t("mo",{stretchy:"false"},")")]),t("mo",null,"−"),t("mstyle",{mathcolor:"blue"},[t("mfrac",null,[t("mn",null,"1"),t("mrow",null,[t("mi",null,"k"),t("mo",null,"−"),t("mn",null,"1")])]),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP",movablelimits:"false"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"j"),t("mo",null,"="),t("mn",null,"1"),t("mo",null,","),t("mi",null,"j"),t("mo",null,"≠"),t("mi",null,"i")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"G")])])]),t("mstyle",{mathcolor:"red"},[t("mi",null,"R"),t("mo",{stretchy:"false"},"("),t("mi",null,"x"),t("mo",null,","),t("msub",null,[t("mi",null,"y"),t("mi",null,"j")]),t("mo",{stretchy:"false"},")")])])],-1))])])])]),Q[308]||(Q[308]=T("",10))])}const P2=s(m,[["render",v2]]);export{E2 as __pageData,P2 as default};

import{_ as o,c as Q,o as n,ah as l,j as t,a}from"./chunks/framework.CvbyeFFO.js";const G=JSON.parse('{"title":"BERT 详解","description":"","frontmatter":{"title":"BERT 详解","date":"2018-12-15T12:07:30.000Z","tags":["Transformer","语言模型","迁移学习","MLM","NSP","BERT","ELMo","GPT"],"categories":["论文笔记"]},"headers":[],"relativePath":"posts/olds/nlp/52-bert.md","filePath":"posts/olds/nlp/52-bert.md","lastUpdated":null}'),T={name:"posts/olds/nlp/52-bert.md"},s={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},r={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.381ex"},xmlns:"http://www.w3.org/2000/svg",width:"10.94ex",height:"1.926ex",role:"img",focusable:"false",viewBox:"0 -683 4835.7 851.2","aria-hidden":"true"},i={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},d={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"23.79ex",height:"2.059ex",role:"img",focusable:"false",viewBox:"0 -716 10515 910","aria-hidden":"true"},m={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},p={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.381ex"},xmlns:"http://www.w3.org/2000/svg",width:"12.351ex",height:"1.926ex",role:"img",focusable:"false",viewBox:"0 -683 5459.3 851.2","aria-hidden":"true"},h={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},g={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"24.921ex",height:"2.059ex",role:"img",focusable:"false",viewBox:"0 -716 11015 910","aria-hidden":"true"},u={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},c={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.345ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.057ex",height:"1.884ex",role:"img",focusable:"false",viewBox:"0 -680 1351.3 832.7","aria-hidden":"true"},H={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},x={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.339ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.072ex",height:"1.878ex",role:"img",focusable:"false",viewBox:"0 -680 1357.7 830","aria-hidden":"true"},V={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},w={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"19.622ex",height:"2.034ex",role:"img",focusable:"false",viewBox:"0 -705 8672.9 899","aria-hidden":"true"},b={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},k={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.763ex",height:"2.005ex",role:"img",focusable:"false",viewBox:"0 -864 3431.1 886","aria-hidden":"true"},f={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},L={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.763ex",height:"2.005ex",role:"img",focusable:"false",viewBox:"0 -864 3431.1 886","aria-hidden":"true"},y={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},M={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.763ex",height:"2.005ex",role:"img",focusable:"false",viewBox:"0 -864 3431.1 886","aria-hidden":"true"},_={tabindex:"0"},v={style:{"text-align":"center"}},Z={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},S={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.763ex",height:"2.005ex",role:"img",focusable:"false",viewBox:"0 -864 3431.1 886","aria-hidden":"true"},A={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},P={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.763ex",height:"2.005ex",role:"img",focusable:"false",viewBox:"0 -864 3431.1 886","aria-hidden":"true"},C={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},R={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.763ex",height:"2.005ex",role:"img",focusable:"false",viewBox:"0 -864 3431.1 886","aria-hidden":"true"};function E(q,e,D,j,B,N){return n(),Q("div",null,[e[63]||(e[63]=l("",33)),t("ul",null,[t("li",null,[t("mjx-container",s,[(n(),Q("svg",r,e[0]||(e[0]=[l("",1)]))),e[1]||(e[1]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"normal"},"B"),t("mi",{mathvariant:"normal"},"E"),t("mi",{mathvariant:"normal"},"R"),t("mi",{mathvariant:"normal"},"T")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"normal"},"B"),t("mi",{mathvariant:"normal"},"A"),t("mi",{mathvariant:"normal"},"S"),t("mi",{mathvariant:"normal"},"E")])])])],-1))]),e[4]||(e[4]=a(" ：")),t("mjx-container",i,[(n(),Q("svg",d,e[2]||(e[2]=[l("",1)]))),e[3]||(e[3]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"normal"},"L"),t("mo",null,"="),t("mn",null,"12"),t("mo",null,","),t("mi",{mathvariant:"normal"},"H"),t("mo",null,"="),t("mn",null,"768"),t("mo",null,","),t("mi",{mathvariant:"normal"},"A"),t("mo",null,"="),t("mn",null,"12")])])],-1))]),e[5]||(e[5]=a("。总参数为110M。和GPT一样"))]),t("li",null,[t("mjx-container",m,[(n(),Q("svg",p,e[6]||(e[6]=[l("",1)]))),e[7]||(e[7]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"normal"},"B"),t("mi",{mathvariant:"normal"},"E"),t("mi",{mathvariant:"normal"},"R"),t("mi",{mathvariant:"normal"},"T")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"normal"},"L"),t("mi",{mathvariant:"normal"},"A"),t("mi",{mathvariant:"normal"},"R"),t("mi",{mathvariant:"normal"},"G"),t("mi",{mathvariant:"normal"},"E")])])])],-1))]),e[10]||(e[10]=a(" ：")),t("mjx-container",h,[(n(),Q("svg",g,e[8]||(e[8]=[l("",1)]))),e[9]||(e[9]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"normal"},"L"),t("mo",null,"="),t("mn",null,"24"),t("mo",null,","),t("mi",{mathvariant:"normal"},"H"),t("mo",null,"="),t("mn",null,"1024"),t("mo",null,","),t("mi",{mathvariant:"normal"},"A"),t("mo",null,"="),t("mn",null,"16")])])],-1))]),e[11]||(e[11]=a("。总参数为340M。最优模型"))])]),e[64]||(e[64]=l("",6)),t("ul",null,[e[18]||(e[18]=t("li",null,[t("code",null,"CLS"),a("：special classification embedding，用于分类的向量，会聚集所有的分类信息")],-1)),e[19]||(e[19]=t("li",null,[t("code",null,"SEP"),a("：输入是QA或2个句子时，需添加"),t("code",null,"SEP"),a("标记以示区别")],-1)),t("li",null,[t("mjx-container",u,[(n(),Q("svg",c,e[12]||(e[12]=[l("",1)]))),e[13]||(e[13]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"E"),t("mi",null,"A")])])],-1))]),e[16]||(e[16]=a("和")),t("mjx-container",H,[(n(),Q("svg",x,e[14]||(e[14]=[l("",1)]))),e[15]||(e[15]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"E"),t("mi",null,"B")])])],-1))]),e[17]||(e[17]=a("：输入是QA或2个句子时，标记的sentence向量。如只有一个句子，则是sentence A向量"))])]),e[65]||(e[65]=l("",29)),t("ul",null,[e[24]||(e[24]=t("li",null,[t("code",null,"batch_size"),a("：256。每条数据长度：512")],-1)),e[25]||(e[25]=t("li",null,"100万步，40个epoch。语料合计33亿词汇",-1)),t("li",null,[e[22]||(e[22]=t("a",{href:"https://plmsmile.github.io/2018/03/30/35-nerual-network-optim/#adam",target:"_blank",rel:"noreferrer"},"Adam",-1)),e[23]||(e[23]=a(" ：")),t("mjx-container",V,[(n(),Q("svg",w,e[20]||(e[20]=[l("",1)]))),e[21]||(e[21]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"β"),t("mn",null,"1")]),t("mo",null,"="),t("mn",null,"0.9"),t("mo",null,","),t("msub",null,[t("mi",null,"β"),t("mn",null,"2")]),t("mo",null,"="),t("mn",null,"0.999")])],-1))])]),e[26]||(e[26]=t("li",null,"L2权值衰减为0.01。所有层的dropout为0.1",-1)),e[27]||(e[27]=t("li",null,[t("a",{href:"https://github.com/plmsmile/QANet/blob/master/optim.py",target:"_blank",rel:"noreferrer"},"学习率的warmup"),a("的step为10000")],-1)),e[28]||(e[28]=t("li",null,[t("a",{href:"https://arxiv.org/abs/1606.08415",target:"_blank",rel:"noreferrer"},"GELU"),a("激活函数")],-1)),e[29]||(e[29]=t("li",null,"训练loss：LM和NSP的loss加起来",-1)),e[30]||(e[30]=t("li",null,"BERT base 16个TPU，Large 64个TPU，训练4天",-1))]),e[66]||(e[66]=l("",4)),t("ul",null,[e[41]||(e[41]=t("li",null,[t("code",null,"Batch size"),a("：16, 32")],-1)),t("li",null,[e[37]||(e[37]=t("code",null,"学习率",-1)),e[38]||(e[38]=a("：")),t("mjx-container",b,[(n(),Q("svg",k,e[31]||(e[31]=[l("",1)]))),e[32]||(e[32]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mn",null,"5"),t("mo",null,"∗"),t("msup",null,[t("mn",null,"10"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"−"),t("mn",null,"5")])])])],-1))]),e[39]||(e[39]=a("，")),t("mjx-container",f,[(n(),Q("svg",L,e[33]||(e[33]=[l("",1)]))),e[34]||(e[34]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mn",null,"3"),t("mo",null,"∗"),t("msup",null,[t("mn",null,"10"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"−"),t("mn",null,"5")])])])],-1))]),e[40]||(e[40]=a("，")),t("mjx-container",y,[(n(),Q("svg",M,e[35]||(e[35]=[l("",1)]))),e[36]||(e[36]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mn",null,"2"),t("mo",null,"∗"),t("msup",null,[t("mn",null,"10"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"−"),t("mn",null,"5")])])])],-1))])]),e[42]||(e[42]=t("li",null,[t("code",null,"epoch"),a(" ：3,4")],-1))]),e[67]||(e[67]=t("h1",{id:"bert与gpt比较",tabindex:"-1"},[a("BERT与GPT比较 "),t("a",{class:"header-anchor",href:"#bert与gpt比较","aria-label":'Permalink to "BERT与GPT比较"'},"​")],-1)),e[68]||(e[68]=t("p",null,[a("BERT和"),t("a",{href:"https://plmsmile.github.io/2018/12/13/51-opengpt/#gpt%E6%A8%A1%E5%9E%8B",target:"_blank",rel:"noreferrer"},"OpenAI GPT"),a("都是使用Transformer进行预训练语言模型， 再进行finetune达到不错的效果。区别如下：")],-1)),t("table",_,[e[54]||(e[54]=t("thead",null,[t("tr",null,[t("th",{style:{"text-align":"center"}},"项目"),t("th",{style:{"text-align":"center"}},"BERT"),t("th",{style:{"text-align":"center"}},"GPT")])],-1)),t("tbody",null,[e[48]||(e[48]=t("tr",null,[t("td",{style:{"text-align":"center"}},"训练数据"),t("td",{style:{"text-align":"center"}},"BooksCorpus(8亿)+维基百科(25亿)"),t("td",{style:{"text-align":"center"}},"BooksCorpus(8亿)")],-1)),e[49]||(e[49]=t("tr",null,[t("td",{style:{"text-align":"center"}},"任务"),t("td",{style:{"text-align":"center"}},"双向语言模型(MLM)+NSP+Finetune"),t("td",{style:{"text-align":"center"}},"单向语言模型+Finetune")],-1)),e[50]||(e[50]=t("tr",null,[t("td",{style:{"text-align":"center"}},"Transformer"),t("td",{style:{"text-align":"center"}},"Encoder"),t("td",{style:{"text-align":"center"}},"Decoder")],-1)),e[51]||(e[51]=t("tr",null,[t("td",{style:{"text-align":"center"}},"符号"),t("td",{style:{"text-align":"center"}},"CLS, SEP, sentence A-B"),t("td",{style:{"text-align":"center"}},"Start, SEP, 结束(CLS)")],-1)),e[52]||(e[52]=t("tr",null,[t("td",{style:{"text-align":"center"}},"符号使用"),t("td",{style:{"text-align":"center"}},"预训练、finetune过程"),t("td",{style:{"text-align":"center"}},"finetune过程")],-1)),e[53]||(e[53]=t("tr",null,[t("td",{style:{"text-align":"center"}},"Batch数据"),t("td",{style:{"text-align":"center"}},"1M步，128000个词汇"),t("td",{style:{"text-align":"center"}},"1M步，32000个词汇")],-1)),t("tr",null,[e[46]||(e[46]=t("td",{style:{"text-align":"center"}},"finetune学习率",-1)),e[47]||(e[47]=t("td",{style:{"text-align":"center"}},"与特定任务相关",-1)),t("td",v,[e[45]||(e[45]=a("与预训练一样，")),t("mjx-container",Z,[(n(),Q("svg",S,e[43]||(e[43]=[l("",1)]))),e[44]||(e[44]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mn",null,"5"),t("mo",null,"∗"),t("msup",null,[t("mn",null,"10"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"−"),t("mn",null,"5")])])])],-1))])])])])]),e[69]||(e[69]=l("",33)),t("p",null,[e[57]||(e[57]=a("Finetune了3轮，学习率为")),t("mjx-container",A,[(n(),Q("svg",P,e[55]||(e[55]=[l("",1)]))),e[56]||(e[56]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mn",null,"5"),t("mo",null,"∗"),t("msup",null,[t("mn",null,"10"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"−"),t("mn",null,"5")])])])],-1))]),e[58]||(e[58]=a("，batchsize为32。取得了最好的效果"))]),e[70]||(e[70]=l("",5)),t("p",null,[e[61]||(e[61]=a("Finetune了3轮，学习率为")),t("mjx-container",C,[(n(),Q("svg",R,e[59]||(e[59]=[l("",1)]))),e[60]||(e[60]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mn",null,"2"),t("mo",null,"∗"),t("msup",null,[t("mn",null,"10"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"−"),t("mn",null,"5")])])])],-1))]),e[62]||(e[62]=a("，batchsize=16"))]),e[71]||(e[71]=l("",27))])}const O=o(T,[["render",E]]);export{G as __pageData,O as default};
